var y=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var je=y((Kne,Gb)=>{var{toString:Vb}=Object.prototype,PB=/["&<>]/,Ar={each:function(e,r){e&&(Array.isArray(e)?e.forEach(r):Object.keys(e).forEach(i=>{r(e[i],i)}))},some:function(e,r){return e?Array.isArray(e)?e.some(r):Object.keys(e).some(i=>r(e[i],i)):!1},every:function(e,r){return e?Array.isArray(e)?e.every(r):Object.keys(e).every(i=>r(e[i],i)):!0},map:function(e,r){return e?Array.isArray(e)?e.map(r):Object.keys(e).map(i=>r(e[i],i)):[]},keyBy(t,e){return t.reduce((r,i)=>(r[i[e]]=i,r),{})},isEqual:function(e,r){let i=typeof e,n=typeof r,s=Array.isArray(e),a=Array.isArray(r);if(i!==n)return!1;switch(typeof e){case"object":return s||a?s&&a?e.length===r.length&&e.every((o,u)=>{let f=r[u];return Ar.isEqual(o,f)}):!1:Ar.every(e,(o,u)=>{let f=r[u];return Ar.isEqual(o,f)});default:return e===r}},escapeHtml(t){let e=PB.exec(t);if(!e)return t;let r="",i="",n=0,s=e.index;for(;s<t.length;s++){switch(t.charAt(s)){case'"':i="&quot;";break;case"&":i="&amp;";break;case"'":i="&apos;";break;case"<":i="&lt;";break;case">":i="&gt;";break;default:continue}n!==s&&(r+=t.substring(n,s)),n=s+1,r+=i}return n!==s?r+t.substring(n,s):r},strcmp(t,e){return t<e?-1:t>e?1:0},isUndefined(t){return Vb.call(t)==="[object Undefined]"},isObject(t){return Vb.call(t)==="[object Object]"},deepMerge(){let t=arguments[0]||{},{length:e}=arguments,r,i,n;function s(a,o){r=t[o],n=Array.isArray(a),Ar.isObject(a)||n?(n?(n=!1,i=r&&Array.isArray(r)?r:[]):i=r&&Ar.isObject(r)?r:{},t[o]=Ar.deepMerge(i,a)):Ar.isUndefined(a)||(t[o]=a)}for(let a=0;a<e;a++)Ar.each(arguments[a],s);return t}};Gb.exports=Ar});var Me=y((Qne,Zb)=>{var LB=/^[A-Z]+\d+$/,eo={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level(t){return t<=26?1:t<=676?2:3},_fill(t){let e,r,i,n,s,a=1;if(t>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&t>=1){for(;a<=26;)e=this._dictionary[a-1],this._n2l[a]=e,this._l2n[e]=a,a++;this._l2nFill=1}if(this._l2nFill<2&&t>=2){for(a=27;a<=702;)r=a-27,i=r%26,n=Math.floor(r/26),e=this._dictionary[n]+this._dictionary[i],this._n2l[a]=e,this._l2n[e]=a,a++;this._l2nFill=2}if(this._l2nFill<3&&t>=3){for(a=703;a<=16384;)r=a-703,i=r%26,n=Math.floor(r/26)%26,s=Math.floor(r/676),e=this._dictionary[s]+this._dictionary[n]+this._dictionary[i],this._n2l[a]=e,this._l2n[e]=a,a++;this._l2nFill=3}},l2n(t){if(this._l2n[t]||this._fill(t.length),!this._l2n[t])throw new Error(`Out of bounds. Invalid column letter: ${t}`);return this._l2n[t]},n2l(t){if(t<1||t>16384)throw new Error(`${t} is out of bounds. Excel supports columns from 1 to 16384`);return this._n2l[t]||this._fill(this._level(t)),this._n2l[t]},_hash:{},validateAddress(t){if(!LB.test(t))throw new Error(`Invalid Address: ${t}`);return!0},decodeAddress(t){let e=t.length<5&&this._hash[t];if(e)return e;let r=!1,i="",n=0,s=!1,a="",o=0;for(let f=0,h;f<t.length;f++)if(h=t.charCodeAt(f),!s&&h>=65&&h<=90)r=!0,i+=t[f],n=n*26+h-64;else if(h>=48&&h<=57)s=!0,a+=t[f],o=o*10+h-48;else if(s&&r&&h!==36)break;if(!r)n=void 0;else if(n>16384)throw new Error(`Out of bounds. Invalid column letter: ${i}`);s||(o=void 0),t=i+a;let u={address:t,col:n,row:o,$col$row:`$${i}$${a}`};return n<=100&&o<=100&&(this._hash[t]=u,this._hash[u.$col$row]=u),u},getAddress(t,e){if(e){let r=this.n2l(e)+t;return this.decodeAddress(r)}return this.decodeAddress(t)},decode(t){let e=t.split(":");if(e.length===2){let r=this.decodeAddress(e[0]),i=this.decodeAddress(e[1]),n={top:Math.min(r.row,i.row),left:Math.min(r.col,i.col),bottom:Math.max(r.row,i.row),right:Math.max(r.col,i.col)};return n.tl=this.n2l(n.left)+n.top,n.br=this.n2l(n.right)+n.bottom,n.dimensions=`${n.tl}:${n.br}`,n}return this.decodeAddress(t)},decodeEx(t){let e=t.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),r=e[1]||e[2],i=e[3],n=i.split(":");if(n.length>1){let a=this.decodeAddress(n[0]),o=this.decodeAddress(n[1]),u=Math.min(a.row,o.row),f=Math.min(a.col,o.col),h=Math.max(a.row,o.row),g=Math.max(a.col,o.col);return a=this.n2l(f)+u,o=this.n2l(g)+h,{top:u,left:f,bottom:h,right:g,sheetName:r,tl:{address:a,col:f,row:u,$col$row:`$${this.n2l(f)}$${u}`,sheetName:r},br:{address:o,col:g,row:h,$col$row:`$${this.n2l(g)}$${h}`,sheetName:r},dimensions:`${a}:${o}`}}if(i.startsWith("#"))return r?{sheetName:r,error:i}:{error:i};let s=this.decodeAddress(i);return r?{sheetName:r,...s}:s},encodeAddress(t,e){return eo.n2l(e)+t},encode(){switch(arguments.length){case 2:return eo.encodeAddress(arguments[0],arguments[1]);case 4:return`${eo.encodeAddress(arguments[0],arguments[1])}:${eo.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(t,e){let[r,i,,n,s]=t,[a,o]=e;return a>=r&&a<=n&&o>=i&&o<=s}};Zb.exports=eo});var Fr=y((Jne,Yb)=>{var lr=Me(),to=class{constructor(){this.decode(arguments)}setTLBR(e,r,i,n,s){if(arguments.length<4){let a=lr.decodeAddress(e),o=lr.decodeAddress(r);this.model={top:Math.min(a.row,o.row),left:Math.min(a.col,o.col),bottom:Math.max(a.row,o.row),right:Math.max(a.col,o.col),sheetName:i},this.setTLBR(a.row,a.col,o.row,o.col,s)}else this.model={top:Math.min(e,i),left:Math.min(r,n),bottom:Math.max(e,i),right:Math.max(r,n),sheetName:s}}decode(e){switch(e.length){case 5:this.setTLBR(e[0],e[1],e[2],e[3],e[4]);break;case 4:this.setTLBR(e[0],e[1],e[2],e[3]);break;case 3:this.setTLBR(e[0],e[1],e[2]);break;case 2:this.setTLBR(e[0],e[1]);break;case 1:{let r=e[0];if(r instanceof to)this.model={top:r.model.top,left:r.model.left,bottom:r.model.bottom,right:r.model.right,sheetName:r.sheetName};else if(r instanceof Array)this.decode(r);else if(r.top&&r.left&&r.bottom&&r.right)this.model={top:r.top,left:r.left,bottom:r.bottom,right:r.right,sheetName:r.sheetName};else{let i=lr.decodeEx(r);i.top?this.model={top:i.top,left:i.left,bottom:i.bottom,right:i.right,sheetName:i.sheetName}:this.model={top:i.row,left:i.col,bottom:i.row,right:i.col,sheetName:i.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error(`Invalid number of arguments to _getDimensions() - ${e.length}`)}}get top(){return this.model.top||1}set top(e){this.model.top=e}get left(){return this.model.left||1}set left(e){this.model.left=e}get bottom(){return this.model.bottom||1}set bottom(e){this.model.bottom=e}get right(){return this.model.right||1}set right(e){this.model.right=e}get sheetName(){return this.model.sheetName}set sheetName(e){this.model.sheetName=e}get _serialisedSheetName(){let{sheetName:e}=this.model;return e?/^[a-zA-Z0-9]*$/.test(e)?`${e}!`:`'${e}'!`:""}expand(e,r,i,n){(!this.model.top||e<this.top)&&(this.top=e),(!this.model.left||r<this.left)&&(this.left=r),(!this.model.bottom||i>this.bottom)&&(this.bottom=i),(!this.model.right||n>this.right)&&(this.right=n)}expandRow(e){if(e){let{dimensions:r,number:i}=e;r&&this.expand(i,r.min,i,r.max)}}expandToAddress(e){let r=lr.decodeEx(e);this.expand(r.row,r.col,r.row,r.col)}get tl(){return lr.n2l(this.left)+this.top}get $t$l(){return`$${lr.n2l(this.left)}$${this.top}`}get br(){return lr.n2l(this.right)+this.bottom}get $b$r(){return`$${lr.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(e){return!(e.sheetName&&this.sheetName&&e.sheetName!==this.sheetName||e.bottom<this.top||e.top>this.bottom||e.right<this.left||e.left>this.right)}contains(e){let r=lr.decodeEx(e);return this.containsEx(r)}containsEx(e){return e.sheetName&&this.sheetName&&e.sheetName!==this.sheetName?!1:e.row>=this.top&&e.row<=this.bottom&&e.col>=this.left&&e.col<=this.right}forEachAddress(e){for(let r=this.left;r<=this.right;r++)for(let i=this.top;i<=this.bottom;i++)e(lr.encodeAddress(i,r),i,r)}};Yb.exports=to});var Zt=y((ese,Kb)=>{"use strict";Kb.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}});var Jb=y((tse,Qb)=>{var hu=Me(),BB=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,jB=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;function WB(t,e,r){let i=hu.decode(e),n=hu.decode(r);return t.replace(BB,(s,a,o,u,f)=>{if(f)return s;let h=jB.exec(u);if(h){let g=h[1],m=h[2].toUpperCase(),c=h[3],d=h[4];if(m.length>3||m.length===3&&m>"XFD")return s;let v=hu.l2n(m),w=parseInt(d,10);return g||(v+=n.col-i.col),c||(w+=n.row-i.row),(a||"")+(g||"")+hu.n2l(v)+(c||"")+w}return s})}Qb.exports={slideFormula:WB}});var tx=y((rse,ex)=>{var $B=je(),Qi=class{constructor(e){this.note=e}get model(){let e=null;switch(typeof this.note){case"string":e={type:"note",note:{texts:[{text:this.note}]}};break;default:e={type:"note",note:this.note};break}return $B.deepMerge({},Qi.DEFAULT_CONFIGS,e)}set model(e){let{note:r}=e,{texts:i}=r;i.length===1&&Object.keys(i[0]).length===1?this.note=i[0].text:this.note=r}static fromModel(e){let r=new Qi;return r.model=e,r}};Qi.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}};ex.exports=Qi});var nx=y((ise,ix)=>{var HB=Me(),UB=je(),Yt=Zt(),{slideFormula:zB}=Jb(),rx=tx(),K=class{constructor(e,r,i){if(!e||!r)throw new Error("A Cell needs a Row");this._row=e,this._column=r,HB.validateAddress(i),this._address=i,this._value=li.create(K.Types.Null,this),this.style=this._mergeStyle(e.style,r.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(e){this.style.numFmt=e}get font(){return this.style.font}set font(e){this.style.font=e}get alignment(){return this.style.alignment}set alignment(e){this.style.alignment=e}get border(){return this.style.border}set border(e){this.style.border=e}get fill(){return this.style.fill}set fill(e){this.style.fill=e}get protection(){return this.style.protection}set protection(e){this.style.protection=e}_mergeStyle(e,r,i){let n=e&&e.numFmt||r&&r.numFmt;n&&(i.numFmt=n);let s=e&&e.font||r&&r.font;s&&(i.font=s);let a=e&&e.alignment||r&&r.alignment;a&&(i.alignment=a);let o=e&&e.border||r&&r.border;o&&(i.border=o);let u=e&&e.fill||r&&r.fill;u&&(i.fill=u);let f=e&&e.protection||r&&r.protection;return f&&(i.protection=f),i}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===K.Types.Merge}merge(e,r){this._value.release(),this._value=li.create(K.Types.Merge,this,e),r||(this.style=e.style)}unmerge(){this.type===K.Types.Merge&&(this._value.release(),this._value=li.create(K.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(e){return this._value.type!==K.Types.Merge?!1:this._value.isMergedTo(e)}get master(){return this.type===K.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===K.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(e){if(this.type===K.Types.Merge){this._value.master.value=e;return}this._value.release(),this._value=li.create(li.getType(e),this,e)}get note(){return this._comment&&this._comment.note}set note(e){this._comment=new rx(e)}get text(){return this._value.toString()}get html(){return UB.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(e){this.type===K.Types.String&&(this._value=li.create(K.Types.Hyperlink,this,{text:this._value.value,hyperlink:e}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){let{worksheet:e}=this._row;return{sheetName:e.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(e){this.names=[e]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(e){let{definedNames:r}=this.workbook;r.removeAllNames(this.fullAddress),e.forEach(i=>{r.addEx(this.fullAddress,i)})}addName(e){this.workbook.definedNames.addEx(this.fullAddress,e)}removeName(e){this.workbook.definedNames.removeEx(this.fullAddress,e)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(e){this._dataValidations.add(this.address,e)}get model(){let{model:e}=this._value;return e.style=this.style,this._comment&&(e.comment=this._comment.model),e}set model(e){if(this._value.release(),this._value=li.create(e.type,this),this._value.model=e,e.comment)switch(e.comment.type){case"note":this._comment=rx.fromModel(e.comment);break}e.style?this.style=e.style:this.style={}}};K.Types=Yt.ValueType;var od=class{constructor(e){this.model={address:e.address,type:K.Types.Null}}get value(){return null}set value(e){}get type(){return K.Types.Null}get effectiveType(){return K.Types.Null}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){}toString(){return""}},ld=class{constructor(e,r){this.model={address:e.address,type:K.Types.Number,value:r}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return K.Types.Number}get effectiveType(){return K.Types.Number}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}},ud=class{constructor(e,r){this.model={address:e.address,type:K.Types.String,value:r}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return K.Types.String}get effectiveType(){return K.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}},fd=class{constructor(e,r){this.model={address:e.address,type:K.Types.String,value:r}}get value(){return this.model.value}set value(e){this.model.value=e}toString(){return this.model.value.richText.map(e=>e.text).join("")}get type(){return K.Types.RichText}get effectiveType(){return K.Types.RichText}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}},hd=class{constructor(e,r){this.model={address:e.address,type:K.Types.Date,value:r}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return K.Types.Date}get effectiveType(){return K.Types.Date}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}},cd=class{constructor(e,r){this.model={address:e.address,type:K.Types.Hyperlink,text:r?r.text:void 0,hyperlink:r?r.hyperlink:void 0},r&&r.tooltip&&(this.model.tooltip=r.tooltip)}get value(){let e={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(e.tooltip=this.model.tooltip),e}set value(e){this.model={text:e.text,hyperlink:e.hyperlink},e.tooltip&&(this.model.tooltip=e.tooltip)}get text(){return this.model.text}set text(e){this.model.text=e}get hyperlink(){return this.model.hyperlink}set hyperlink(e){this.model.hyperlink=e}get type(){return K.Types.Hyperlink}get effectiveType(){return K.Types.Hyperlink}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}},dd=class{constructor(e,r){this.model={address:e.address,type:K.Types.Merge,master:r?r.address:void 0},this._master=r,r&&r.addMergeRef()}get value(){return this._master.value}set value(e){e instanceof K?(this._master&&this._master.releaseMergeRef(),e.addMergeRef(),this._master=e):this._master.value=e}isMergedTo(e){return e===this._master}get master(){return this._master}get type(){return K.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}},pd=class{constructor(e,r){this.cell=e,this.model={address:e.address,type:K.Types.Formula,shareType:r?r.shareType:void 0,ref:r?r.ref:void 0,formula:r?r.formula:void 0,sharedFormula:r?r.sharedFormula:void 0,result:r?r.result:void 0}}_copyModel(e){let r={},i=n=>{let s=e[n];s&&(r[n]=s)};return i("formula"),i("result"),i("ref"),i("shareType"),i("sharedFormula"),r}get value(){return this._copyModel(this.model)}set value(e){this.model=this._copyModel(e)}validate(e){switch(li.getType(e)){case K.Types.Null:case K.Types.String:case K.Types.Number:case K.Types.Date:break;case K.Types.Hyperlink:case K.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){let e=this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),r=this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g);return{ranges:e,cells:r}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(e){this.model.formula=e}get formulaType(){return this.model.formula?Yt.FormulaType.Master:this.model.sharedFormula?Yt.FormulaType.Shared:Yt.FormulaType.None}get result(){return this.model.result}set result(e){this.model.result=e}get type(){return K.Types.Formula}get effectiveType(){let e=this.model.result;return e==null?Yt.ValueType.Null:e instanceof String||typeof e=="string"?Yt.ValueType.String:typeof e=="number"?Yt.ValueType.Number:e instanceof Date?Yt.ValueType.Date:e.text&&e.hyperlink?Yt.ValueType.Hyperlink:e.formula?Yt.ValueType.Formula:Yt.ValueType.Null}get address(){return this.model.address}set address(e){this.model.address=e}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){let{worksheet:e}=this.cell,r=e.findCell(this.model.sharedFormula);this._translatedFormula=r&&zB(r.formula,r.address,this.model.address)}return this._translatedFormula}toCsvString(){return`${this.model.result||""}`}release(){}toString(){return this.model.result?this.model.result.toString():""}},gd=class{constructor(e,r){this.model={address:e.address,type:K.Types.SharedString,value:r}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return K.Types.SharedString}get effectiveType(){return K.Types.SharedString}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}},md=class{constructor(e,r){this.model={address:e.address,type:K.Types.Boolean,value:r}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return K.Types.Boolean}get effectiveType(){return K.Types.Boolean}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}},vd=class{constructor(e,r){this.model={address:e.address,type:K.Types.Error,value:r}}get value(){return this.model.value}set value(e){this.model.value=e}get type(){return K.Types.Error}get effectiveType(){return K.Types.Error}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}},yd=class{constructor(e,r){this.model={address:e.address,type:K.Types.String,value:JSON.stringify(r),rawValue:r}}get value(){return this.model.rawValue}set value(e){this.model.rawValue=e,this.model.value=JSON.stringify(e)}get type(){return K.Types.String}get effectiveType(){return K.Types.String}get address(){return this.model.address}set address(e){this.model.address=e}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}},li={getType(t){return t==null?K.Types.Null:t instanceof String||typeof t=="string"?K.Types.String:typeof t=="number"?K.Types.Number:typeof t=="boolean"?K.Types.Boolean:t instanceof Date?K.Types.Date:t.text&&t.hyperlink?K.Types.Hyperlink:t.formula||t.sharedFormula?K.Types.Formula:t.richText?K.Types.RichText:t.sharedString?K.Types.SharedString:t.error?K.Types.Error:K.Types.JSON},types:[{t:K.Types.Null,f:od},{t:K.Types.Number,f:ld},{t:K.Types.String,f:ud},{t:K.Types.Date,f:hd},{t:K.Types.Hyperlink,f:cd},{t:K.Types.Formula,f:pd},{t:K.Types.Merge,f:dd},{t:K.Types.JSON,f:yd},{t:K.Types.SharedString,f:gd},{t:K.Types.RichText,f:fd},{t:K.Types.Boolean,f:md},{t:K.Types.Error,f:vd}].reduce((t,e)=>(t[e.t]=e.f,t),[]),create(t,e,r){let i=this.types[t];if(!i)throw new Error(`Could not create Value of type ${t}`);return new i(e,r)}};ix.exports=K});var du=y((nse,ax)=>{"use strict";var XB=je(),cu=Zt(),Ji=Me(),sx=nx(),_d=class{constructor(e,r){this._worksheet=e,this._number=r,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(e){return this._cells[e-1]}getCellEx(e){let r=this._cells[e.col-1];if(!r){let i=this._worksheet.getColumn(e.col);r=new sx(this,i,e.address),this._cells[e.col-1]=r}return r}getCell(e){if(typeof e=="string"){let r=this._worksheet.getColumnKey(e);r?e=r.number:e=Ji.l2n(e)}return this._cells[e-1]||this.getCellEx({address:Ji.encodeAddress(this._number,e),row:this._number,col:e})}splice(e,r,...i){let n=e+r,s=i.length-r,a=this._cells.length,o,u,f;if(s<0)for(o=e+i.length;o<=a;o++)f=this._cells[o-1],u=this._cells[o-s-1],u?(f=this.getCell(o),f.value=u.value,f.style=u.style,f._comment=u._comment):f&&(f.value=null,f.style={},f._comment=void 0);else if(s>0)for(o=a;o>=n;o--)u=this._cells[o-1],u?(f=this.getCell(o+s),f.value=u.value,f.style=u.style,f._comment=u._comment):this._cells[o+s-1]=void 0;for(o=0;o<i.length;o++)f=this.getCell(e+o),f.value=i[o],f.style={},f._comment=void 0}eachCell(e,r){if(r||(r=e,e=null),e&&e.includeEmpty){let i=this._cells.length;for(let n=1;n<=i;n++)r(this.getCell(n),n)}else this._cells.forEach((i,n)=>{i&&i.type!==cu.ValueType.Null&&r(i,n+1)})}addPageBreak(e,r){let i=this._worksheet,n=Math.max(0,e-1)||0,s=Math.max(0,r-1)||16838,a={id:this._number,max:s,man:1};n&&(a.min=n),i.rowBreaks.push(a)}get values(){let e=[];return this._cells.forEach(r=>{r&&r.type!==cu.ValueType.Null&&(e[r.col]=r.value)}),e}set values(e){if(this._cells=[],e)if(e instanceof Array){let r=0;e.hasOwnProperty("0")&&(r=1),e.forEach((i,n)=>{i!==void 0&&(this.getCellEx({address:Ji.encodeAddress(this._number,n+r),row:this._number,col:n+r}).value=i)})}else this._worksheet.eachColumnKey((r,i)=>{e[i]!==void 0&&(this.getCellEx({address:Ji.encodeAddress(this._number,r.number),row:this._number,col:r.number}).value=e[i])})}get hasValues(){return XB.some(this._cells,e=>e&&e.type!==cu.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let e=0;return this.eachCell(()=>{e++}),e}get dimensions(){let e=0,r=0;return this._cells.forEach(i=>{i&&i.type!==cu.ValueType.Null&&((!e||e>i.col)&&(e=i.col),r<i.col&&(r=i.col))}),e>0?{min:e,max:r}:null}_applyStyle(e,r){return this.style[e]=r,this._cells.forEach(i=>{i&&(i[e]=r)}),r}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){let e=[],r=0,i=0;return this._cells.forEach(n=>{if(n){let s=n.model;s&&((!r||r>n.col)&&(r=n.col),i<n.col&&(i=n.col),e.push(s))}}),this.height||e.length?{cells:e,number:this.number,min:r,max:i,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(e){if(e.number!==this._number)throw new Error("Invalid row number in model");this._cells=[];let r;e.cells.forEach(i=>{switch(i.type){case sx.Types.Merge:break;default:{let n;if(i.address)n=Ji.decodeAddress(i.address);else if(r){let{row:a}=r,o=r.col+1;n={row:a,col:o,address:Ji.encodeAddress(a,o),$col$row:`$${Ji.n2l(o)}$${a}`}}r=n;let s=this.getCellEx(n);s.model=i;break}}}),e.height?this.height=e.height:delete this.height,this.hidden=e.hidden,this.outlineLevel=e.outlineLevel||0,this.style=e.style&&JSON.parse(JSON.stringify(e.style))||{}}};ax.exports=_d});var pu=y((sse,ox)=>{"use strict";var VB=je(),GB=Zt(),ZB=Me(),wd=9,is=class{constructor(e,r,i){this._worksheet=e,this._number=r,i!==!1&&(this.defn=i)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return ZB.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==wd}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(e){e?(this.key=e.key,this.width=e.width!==void 0?e.width:wd,this.outlineLevel=e.outlineLevel,e.style?this.style=e.style:this.style={},this.header=e.header,this._hidden=!!e.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(e){e!==void 0?(this._header=e,this.headers.forEach((r,i)=>{this._worksheet.getCell(i+1,this.number).value=r})):this._header=void 0}get key(){return this._key}set key(e){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=e,e&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(e){this._hidden=e}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(e){this._outlineLevel=e}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(e){return this.width===e.width&&this.hidden===e.hidden&&this.outlineLevel===e.outlineLevel&&VB.isEqual(this.style,e.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;let e=this.style;return!(e&&(e.font||e.numFmt||e.alignment||e.border||e.fill||e.protection))}get headerCount(){return this.headers.length}eachCell(e,r){let i=this.number;r||(r=e,e=null),this._worksheet.eachRow(e,(n,s)=>{r(n.getCell(i),s)})}get values(){let e=[];return this.eachCell((r,i)=>{r&&r.type!==GB.ValueType.Null&&(e[i]=r.value)}),e}set values(e){if(!e)return;let r=this.number,i=0;e.hasOwnProperty("0")&&(i=1),e.forEach((n,s)=>{this._worksheet.getCell(s+i,r).value=n})}_applyStyle(e,r){return this.style[e]=r,this.eachCell(i=>{i[e]=r}),r}get numFmt(){return this.style.numFmt}set numFmt(e){this._applyStyle("numFmt",e)}get font(){return this.style.font}set font(e){this._applyStyle("font",e)}get alignment(){return this.style.alignment}set alignment(e){this._applyStyle("alignment",e)}get protection(){return this.style.protection}set protection(e){this._applyStyle("protection",e)}get border(){return this.style.border}set border(e){this._applyStyle("border",e)}get fill(){return this.style.fill}set fill(e){this._applyStyle("fill",e)}static toModel(e){let r=[],i=null;return e&&e.forEach((n,s)=>{n.isDefault?i&&(i=null):!i||!n.equivalentTo(i)?(i={min:s+1,max:s+1,width:n.width!==void 0?n.width:wd,style:n.style,isCustomWidth:n.isCustomWidth,hidden:n.hidden,outlineLevel:n.outlineLevel,collapsed:n.collapsed},r.push(i)):i.max=s+1}),r.length?r:void 0}static fromModel(e,r){r=r||[];let i=[],n=1,s=0;for(;s<r.length;){let a=r[s++];for(;n<a.min;)i.push(new is(e,n++));for(;n<=a.max;)i.push(new is(e,n++,a))}return i.length?i:null}};ox.exports=is});var ux=y((ase,lx)=>{"use strict";var YB=Me(),ns=class{constructor(e,r,i=0){if(!r)this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0;else if(typeof r=="string"){let n=YB.decodeAddress(r);this.nativeCol=n.col+i,this.nativeColOff=0,this.nativeRow=n.row+i,this.nativeRowOff=0}else r.nativeCol!==void 0?(this.nativeCol=r.nativeCol||0,this.nativeColOff=r.nativeColOff||0,this.nativeRow=r.nativeRow||0,this.nativeRowOff=r.nativeRowOff||0):r.col!==void 0?(this.col=r.col+i,this.row=r.row+i):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);this.worksheet=e}static asInstance(e){return e instanceof ns||e==null?e:new ns(e)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(e){this.nativeCol=Math.floor(e),this.nativeColOff=Math.floor((e-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(e){this.nativeRow=Math.floor(e),this.nativeRowOff=Math.floor((e-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(this.worksheet.getColumn(this.nativeCol+1).width*1e4):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(this.worksheet.getRow(this.nativeRow+1).height*1e4):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(e){this.nativeCol=e.nativeCol,this.nativeColOff=e.nativeColOff,this.nativeRow=e.nativeRow,this.nativeRowOff=e.nativeRowOff}};lx.exports=ns});var hx=y((ose,fx)=>{var KB=Me(),gu=ux(),bd=class{constructor(e,r){this.worksheet=e,this.model=r}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model({type:e,imageId:r,range:i,hyperlinks:n}){if(this.type=e,this.imageId=r,e==="image")if(typeof i=="string"){let s=KB.decode(i);this.range={tl:new gu(this.worksheet,{col:s.left,row:s.top},-1),br:new gu(this.worksheet,{col:s.right,row:s.bottom},0),editAs:"oneCell"}}else this.range={tl:new gu(this.worksheet,i.tl,0),br:i.br&&new gu(this.worksheet,i.br,0),ext:i.ext,editAs:i.editAs,hyperlinks:n||i.hyperlinks}}};fx.exports=bd});var dx=y((lse,cx)=>{var mu=Me(),xd=class{constructor(e,r,i){this.table=e,this.column=r,this.index=i}_set(e,r){this.table.cacheState(),this.column[e]=r}get name(){return this.column.name}set name(e){this._set("name",e)}get filterButton(){return this.column.filterButton}set filterButton(e){this.column.filterButton=e}get style(){return this.column.style}set style(e){this.column.style=e}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(e){this._set("totalsRowLabel",e)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(e){this._set("totalsRowFunction",e)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(e){this._set("totalsRowResult",e)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(e){this._set("totalsRowFormula",e)}},Td=class{constructor(e,r){this.worksheet=e,r&&(this.table=r,this.validate(),this.store())}getFormula(e){switch(e.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${e.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${e.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${e.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${e.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${e.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${e.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${e.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${e.name}])`;case"custom":return e.totalsRowFormula;default:throw new Error(`Invalid Totals Row Function: ${e.totalsRowFunction}`)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){let{table:e}=this,r=(f,h,g)=>{f[h]===void 0&&(f[h]=g)};r(e,"headerRow",!0),r(e,"totalsRow",!1),r(e,"style",{}),r(e.style,"theme","TableStyleMedium2"),r(e.style,"showFirstColumn",!1),r(e.style,"showLastColumn",!1),r(e.style,"showRowStripes",!1),r(e.style,"showColumnStripes",!1);let i=(f,h)=>{if(!f)throw new Error(h)};i(e.ref,"Table must have ref"),i(e.columns,"Table must have column definitions"),i(e.rows,"Table must have row definitions"),e.tl=mu.decodeAddress(e.ref);let{row:n,col:s}=e.tl;i(n>0,"Table must be on valid row"),i(s>0,"Table must be on valid col");let{width:a,filterHeight:o,tableHeight:u}=this;e.autoFilterRef=mu.encode(n,s,n+o-1,s+a-1),e.tableRef=mu.encode(n,s,n+u-1,s+a-1),e.columns.forEach((f,h)=>{i(f.name,`Column ${h} must have a name`),h===0?r(f,"totalsRowLabel","Total"):(r(f,"totalsRowFunction","none"),f.totalsRowFormula=this.getFormula(f))})}store(){let e=(o,u)=>{u&&Object.keys(u).forEach(f=>{o[f]=u[f]})},{worksheet:r,table:i}=this,{row:n,col:s}=i.tl,a=0;if(i.headerRow){let o=r.getRow(n+a++);i.columns.forEach((u,f)=>{let{style:h,name:g}=u,m=o.getCell(s+f);m.value=g,e(m,h)})}if(i.rows.forEach(o=>{let u=r.getRow(n+a++);o.forEach((f,h)=>{let g=u.getCell(s+h);g.value=f,e(g,i.columns[h].style)})}),i.totalsRow){let o=r.getRow(n+a++);i.columns.forEach((u,f)=>{let h=o.getCell(s+f);f===0?h.value=u.totalsRowLabel:this.getFormula(u)?h.value={formula:u.totalsRowFormula,result:u.totalsRowResult}:h.value=null,e(h,u.style)})}}load(e){let{table:r}=this,{row:i,col:n}=r.tl,s=0;if(r.headerRow){let a=e.getRow(i+s++);r.columns.forEach((o,u)=>{let f=a.getCell(n+u);f.value=o.name})}if(r.rows.forEach(a=>{let o=e.getRow(i+s++);a.forEach((u,f)=>{let h=o.getCell(n+f);h.value=u})}),r.totalsRow){let a=e.getRow(i+s++);r.columns.forEach((o,u)=>{let f=a.getCell(n+u);u===0?f.value=o.totalsRowLabel:this.getFormula(o)&&(f.value={formula:o.totalsRowFormula,result:o.totalsRowResult})})}}get model(){return this.table}set model(e){this.table=e}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();let e=mu.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let r=0;r<this._cache.tableHeight;r++){let i=this.worksheet.getRow(e.row+r);for(let n=0;n<this._cache.width;n++){let s=i.getCell(e.col+n);s.value=null}}else{for(let r=this.tableHeight;r<this._cache.tableHeight;r++){let i=this.worksheet.getRow(e.row+r);for(let n=0;n<this._cache.width;n++){let s=i.getCell(e.col+n);s.value=null}}for(let r=0;r<this.tableHeight;r++){let i=this.worksheet.getRow(e.row+r);for(let n=this.width;n<this._cache.width;n++){let s=i.getCell(e.col+n);s.value=null}}}this.store()}addRow(e,r){this.cacheState(),r===void 0?this.table.rows.push(e):this.table.rows.splice(r,0,e)}removeRows(e,r=1){this.cacheState(),this.table.rows.splice(e,r)}getColumn(e){let r=this.table.columns[e];return new xd(this,r,e)}addColumn(e,r,i){this.cacheState(),i===void 0?(this.table.columns.push(e),this.table.rows.forEach((n,s)=>{n.push(r[s])})):(this.table.columns.splice(i,0,e),this.table.rows.forEach((n,s)=>{n.splice(i,0,r[s])}))}removeColumns(e,r=1){this.cacheState(),this.table.columns.splice(e,r),this.table.rows.forEach(i=>{i.splice(e,r)})}_assign(e,r,i){this.cacheState(),e[r]=i}get ref(){return this.table.ref}set ref(e){this._assign(this.table,"ref",e)}get name(){return this.table.name}set name(e){this.table.name=e}get displayName(){return this.table.displyName||this.table.name}set displayNamename(e){this.table.displayName=e}get headerRow(){return this.table.headerRow}set headerRow(e){this._assign(this.table,"headerRow",e)}get totalsRow(){return this.table.totalsRow}set totalsRow(e){this._assign(this.table,"totalsRow",e)}get theme(){return this.table.style.name}set theme(e){this.table.style.name=e}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(e){this.table.style.showFirstColumn=e}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(e){this.table.style.showLastColumn=e}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(e){this.table.style.showRowStripes=e}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(e){this.table.style.showColumnStripes=e}};cx.exports=Td});var Cd=y((use,px)=>{var Ed=class{constructor(e){this.model=e||{}}add(e,r){return this.model[e]=r}find(e){return this.model[e]}remove(e){this.model[e]=void 0}};px.exports=Ed});var kd=y((fse,gx)=>{"use strict";var Sd=require("crypto"),QB={hash(t,...e){let r=Sd.createHash(t);return r.update(Buffer.concat(e)),r.digest()},convertPasswordToHash(t,e,r,i){if(e=e.toLowerCase(),Sd.getHashes().indexOf(e)<0)throw new Error(`Hash algorithm '${e}' not supported!`);let s=Buffer.from(t,"utf16le"),a=this.hash(e,Buffer.from(r,"base64"),s);for(let o=0;o<i;o++){let u=Buffer.alloc(4);u.writeUInt32LE(o,0),a=this.hash(e,a,u)}return a.toString("base64")},randomBytes(t){return Sd.randomBytes(t)}};gx.exports=QB});var bx=y((hse,wx)=>{var ro=je(),io=Me(),no=Fr(),mx=du(),vu=pu(),JB=Zt(),Rd=hx(),vx=dx(),yx=Cd(),_x=kd(),Od=class{constructor(e){e=e||{},this.id=e.id,this.orderNo=e.orderNo,this.name=e.name||`Sheet${this.id}`,this.state=e.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this._workbook=e.workbook,this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},e.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!!(e.pageSetup&&(e.pageSetup.fitToWidth||e.pageSetup.fitToHeight)&&!e.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},e.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},e.headerFooter),this.dataValidations=new yx,this.views=e.views||[],this.autoFilter=e.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){let e=new no;return this._rows.forEach(r=>{if(r){let i=r.dimensions;i&&e.expand(r.number,i.min,r.number,i.max)}}),e}get columns(){return this._columns}set columns(e){this._headerRowCount=e.reduce((n,s)=>{let a=s.header&&1||s.headers&&s.headers.length||0;return Math.max(n,a)},0);let r=1,i=this._columns=[];e.forEach(n=>{let s=new vu(this,r++,!1);i.push(s),s.defn=n})}getColumnKey(e){return this._keys[e]}setColumnKey(e,r){this._keys[e]=r}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){ro.each(this._keys,e)}getColumn(e){if(typeof e=="string"){let r=this._keys[e];if(r)return r;e=io.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let r=this._columns.length+1;for(;r<=e;)this._columns.push(new vu(this,r++))}return this._columns[e-1]}spliceColumns(e,r,...i){let s=this._rows.length;if(i.length>0)for(let f=0;f<s;f++){let h=[e,r];i.forEach(m=>{h.push(m[f]||null)});let g=this.getRow(f+1);g.splice.apply(g,h)}else this._rows.forEach(f=>{f&&f.splice(e,r)});let a=i.length-r,o=e+r,u=this._columns.length;if(a<0)for(let f=e+i.length;f<=u;f++)this.getColumn(f).defn=this.getColumn(f-a).defn;else if(a>0)for(let f=u;f>=o;f--)this.getColumn(f+a).defn=this.getColumn(f).defn;for(let f=e;f<e+i.length;f++)this.getColumn(f).defn=null;this.workbook.definedNames.spliceColumns(this.name,e,r,i.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let e=0;return this.eachRow(r=>{e=Math.max(e,r.cellCount)}),e}get actualColumnCount(){let e=[],r=0;return this.eachRow(i=>{i.eachCell(({col:n})=>{e[n]||(e[n]=!0,r++)})}),r}_commitRow(){}get _lastRowNumber(){let e=this._rows,r=e.length;for(;r>0&&e[r-1]===void 0;)r--;return r}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(e){return this._rows[e-1]}findRows(e,r){return this._rows.slice(e-1,e-1+r)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let e=0;return this.eachRow(()=>{e++}),e}getRow(e){let r=this._rows[e-1];return r||(r=this._rows[e-1]=new mx(this,e)),r}getRows(e,r){if(r<1)return;let i=[];for(let n=e;n<e+r;n++)i.push(this.getRow(n));return i}addRow(e,r="n"){let i=this._nextRow,n=this.getRow(i);return n.values=e,this._setStyleOption(i,r[0]==="i"?r:"n"),n}addRows(e,r="n"){let i=[];return e.forEach(n=>{i.push(this.addRow(n,r))}),i}insertRow(e,r,i="n"){return this.spliceRows(e,0,r),this._setStyleOption(e,i),this.getRow(e)}insertRows(e,r,i="n"){if(this.spliceRows(e,0,...r),i!=="n")for(let n=0;n<r.length;n++)i[0]==="o"&&this.findRow(r.length+e+n)!==void 0?this._copyStyle(r.length+e+n,e+n,i[1]==="+"):i[0]==="i"&&this.findRow(e-1)!==void 0&&this._copyStyle(e-1,e+n,i[1]==="+");return this.getRows(e,r.length)}_setStyleOption(e,r="n"){r[0]==="o"&&this.findRow(e+1)!==void 0?this._copyStyle(e+1,e,r[1]==="+"):r[0]==="i"&&this.findRow(e-1)!==void 0&&this._copyStyle(e-1,e,r[1]==="+")}_copyStyle(e,r,i=!1){let n=this.getRow(e),s=this.getRow(r);s.style=Object.freeze({...n.style}),n.eachCell({includeEmpty:i},(a,o)=>{s.getCell(o).style=Object.freeze({...a.style})}),s.height=n.height}duplicateRow(e,r,i=!1){let n=this._rows[e-1],s=new Array(r).fill(n.values);this.spliceRows(e+1,i?0:r,...s);for(let a=0;a<r;a++){let o=this._rows[e+a];o.style=n.style,o.height=n.height,n.eachCell({includeEmpty:!0},(u,f)=>{o.getCell(f).style=u.style})}}spliceRows(e,r,...i){let n=e+r,s=i.length,a=s-r,o=this._rows.length,u,f;if(a<0)for(u=n;u<=o;u++)if(f=this._rows[u-1],f){let h=this.getRow(u+a);h.values=f.values,h.style=f.style,h.height=f.height,f.eachCell({includeEmpty:!0},(g,m)=>{h.getCell(m).style=g.style}),this._rows[u-1]=void 0}else this._rows[u+a-1]=void 0;else if(a>0)for(u=o;u>=n;u--)if(f=this._rows[u-1],f){let h=this.getRow(u+a);h.values=f.values,h.style=f.style,h.height=f.height,f.eachCell({includeEmpty:!0},(g,m)=>{if(h.getCell(m).style=g.style,g._value.constructor.name==="MergeValue"){let c=this.getRow(g._row._number+s).getCell(m),d=g._value._master,v=this.getRow(d._row._number+s).getCell(d._column._number);c.merge(v)}})}else this._rows[u+a-1]=void 0;for(u=0;u<s;u++){let h=this.getRow(e+u);h.style={},h.values=i[u]}this.workbook.definedNames.spliceRows(this.name,e,r,s)}eachRow(e,r){if(r||(r=e,e=void 0),e&&e.includeEmpty){let i=this._rows.length;for(let n=1;n<=i;n++)r(this.getRow(n),n)}else this._rows.forEach(i=>{i&&i.hasValues&&r(i,i.number)})}getSheetValues(){let e=[];return this._rows.forEach(r=>{r&&(e[r.number]=r.values)}),e}findCell(e,r){let i=io.getAddress(e,r),n=this._rows[i.row-1];return n?n.findCell(i.col):void 0}getCell(e,r){let i=io.getAddress(e,r);return this.getRow(i.row).getCellEx(i)}mergeCells(...e){let r=new no(e);this._mergeCellsInternal(r)}mergeCellsWithoutStyle(...e){let r=new no(e);this._mergeCellsInternal(r,!0)}_mergeCellsInternal(e,r){ro.each(this._merges,n=>{if(n.intersects(e))throw new Error("Cannot merge already merged cells")});let i=this.getCell(e.top,e.left);for(let n=e.top;n<=e.bottom;n++)for(let s=e.left;s<=e.right;s++)(n>e.top||s>e.left)&&this.getCell(n,s).merge(i,r);this._merges[i.address]=e}_unMergeMaster(e){let r=this._merges[e.address];if(r){for(let i=r.top;i<=r.bottom;i++)for(let n=r.left;n<=r.right;n++)this.getCell(i,n).unmerge();delete this._merges[e.address]}}get hasMerges(){return ro.some(this._merges,Boolean)}unMergeCells(...e){let r=new no(e);for(let i=r.top;i<=r.bottom;i++)for(let n=r.left;n<=r.right;n++){let s=this.findCell(i,n);s&&(s.type===JB.ValueType.Merge?this._unMergeMaster(s.master):this._merges[s.address]&&this._unMergeMaster(s))}}fillFormula(e,r,i,n="shared"){let s=io.decode(e),{top:a,left:o,bottom:u,right:f}=s,h=f-o+1,g=io.encodeAddress(a,o),m=n==="shared",c;typeof i=="function"?c=i:Array.isArray(i)?Array.isArray(i[0])?c=(v,w)=>i[v-a][w-o]:c=(v,w)=>i[(v-a)*h+(w-o)]:c=()=>{};let d=!0;for(let v=a;v<=u;v++)for(let w=o;w<=f;w++)d?(this.getCell(v,w).value={shareType:n,formula:r,ref:e,result:c(v,w)},d=!1):this.getCell(v,w).value=m?{sharedFormula:g,result:c(v,w)}:c(v,w)}addImage(e,r){let i={type:"image",imageId:e,range:r};this._media.push(new Rd(this,i))}getImages(){return this._media.filter(e=>e.type==="image")}addBackgroundImage(e){let r={type:"background",imageId:e};this._media.push(new Rd(this,r))}getBackgroundImageId(){let e=this._media.find(r=>r.type==="background");return e&&e.imageId}protect(e,r){return new Promise(i=>{this.sheetProtection={sheet:!0},r&&"spinCount"in r&&(r.spinCount=Number.isFinite(r.spinCount)?Math.round(Math.max(0,r.spinCount)):1e5),e&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=_x.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=r&&"spinCount"in r?r.spinCount:1e5,this.sheetProtection.hashValue=_x.convertPasswordToHash(e,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),r&&(this.sheetProtection=Object.assign(this.sheetProtection,r),!e&&"spinCount"in r&&delete this.sheetProtection.spinCount),i()})}unprotect(){this.sheetProtection=null}addTable(e){let r=new vx(this,e);return this.tables[e.name]=r,r}getTable(e){return this.tables[e]}removeTable(e){delete this.tables[e]}getTables(){return Object.values(this.tables)}addConditionalFormatting(e){this.conditionalFormattings.push(e)}removeConditionalFormatting(e){typeof e=="number"?this.conditionalFormattings.splice(e,1):e instanceof Function?this.conditionalFormattings=this.conditionalFormattings.filter(e):this.conditionalFormattings=[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(e){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=e}get model(){let e={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(n=>n.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(n=>n.model),conditionalFormattings:this.conditionalFormattings};e.cols=vu.toModel(this.columns);let r=e.rows=[],i=e.dimensions=new no;return this._rows.forEach(n=>{let s=n&&n.model;s&&(i.expand(s.number,s.min,s.number,s.max),r.push(s))}),e.merges=[],ro.each(this._merges,n=>{e.merges.push(n.range)}),e}_parseRows(e){this._rows=[],e.rows.forEach(r=>{let i=new mx(this,r.number);this._rows[i.number-1]=i,i.model=r})}_parseMergeCells(e){ro.each(e.mergeCells,r=>{this.mergeCellsWithoutStyle(r)})}set model(e){this.name=e.name,this._columns=vu.fromModel(this,e.cols),this._parseRows(e),this._parseMergeCells(e),this.dataValidations=new yx(e.dataValidations),this.properties=e.properties,this.pageSetup=e.pageSetup,this.headerFooter=e.headerFooter,this.views=e.views,this.autoFilter=e.autoFilter,this._media=e.media.map(r=>new Rd(this,r)),this.sheetProtection=e.sheetProtection,this.tables=e.tables.reduce((r,i)=>{let n=new vx;return n.model=i,r[i.name]=n,r},{}),this.conditionalFormattings=e.conditionalFormattings}};wx.exports=Od});var Ex=y((cse,Tx)=>{var xx=je(),yu=Me(),Ad=class{constructor(e){this.template=e,this.sheets={}}addCell(e){this.addCellEx(yu.decodeEx(e))}getCell(e){return this.findCellEx(yu.decodeEx(e),!0)}findCell(e){return this.findCellEx(yu.decodeEx(e),!1)}findCellAt(e,r,i){let n=this.sheets[e],s=n&&n[r];return s&&s[i]}addCellEx(e){if(e.top)for(let r=e.top;r<=e.bottom;r++)for(let i=e.left;i<=e.right;i++)this.getCellAt(e.sheetName,r,i);else this.findCellEx(e,!0)}getCellEx(e){return this.findCellEx(e,!0)}findCellEx(e,r){let i=this.findSheet(e,r),n=this.findSheetRow(i,e,r);return this.findRowCell(n,e,r)}getCellAt(e,r,i){let n=this.sheets[e]||(this.sheets[e]=[]),s=n[r]||(n[r]=[]);return s[i]||(s[i]={sheetName:e,address:yu.n2l(i)+r,row:r,col:i})}removeCellEx(e){let r=this.findSheet(e);if(!r)return;let i=this.findSheetRow(r,e);!i||delete i[e.col]}forEachInSheet(e,r){let i=this.sheets[e];i&&i.forEach((n,s)=>{n&&n.forEach((a,o)=>{a&&r(a,s,o)})})}forEach(e){xx.each(this.sheets,(r,i)=>{this.forEachInSheet(i,e)})}map(e){let r=[];return this.forEach(i=>{r.push(e(i))}),r}findSheet(e,r){let i=e.sheetName;if(this.sheets[i])return this.sheets[i];if(r)return this.sheets[i]=[]}findSheetRow(e,r,i){let{row:n}=r;if(e&&e[n])return e[n];if(i)return e[n]=[]}findRowCell(e,r,i){let{col:n}=r;if(e&&e[n])return e[n];if(i)return e[n]=this.template?Object.assign(r,JSON.parse(JSON.stringify(this.template))):r}spliceRows(e,r,i,n){let s=this.sheets[e];if(s){let a=[];for(let o=0;o<n;o++)a.push([]);s.splice(r,i,...a)}}spliceColumns(e,r,i,n){let s=this.sheets[e];if(s){let a=[];for(let o=0;o<n;o++)a.push(null);xx.each(s,o=>{o.splice(r,i,...a)})}}};Tx.exports=Ad});var Nd=y((dse,Sx)=>{"use strict";var ss=je(),so=Me(),Cx=Ex(),ej=Fr(),tj=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/,Fd=class{constructor(){this.matrixMap={}}getMatrix(e){return this.matrixMap[e]||(this.matrixMap[e]=new Cx)}add(e,r){let i=so.decodeEx(e);this.addEx(i,r)}addEx(e,r){let i=this.getMatrix(r);if(e.top)for(let n=e.left;n<=e.right;n++)for(let s=e.top;s<=e.bottom;s++){let a={sheetName:e.sheetName,address:so.n2l(n)+s,row:s,col:n};i.addCellEx(a)}else i.addCellEx(e)}remove(e,r){let i=so.decodeEx(e);this.removeEx(i,r)}removeEx(e,r){this.getMatrix(r).removeCellEx(e)}removeAllNames(e){ss.each(this.matrixMap,r=>{r.removeCellEx(e)})}forEach(e){ss.each(this.matrixMap,(r,i)=>{r.forEach(n=>{e(i,n)})})}getNames(e){return this.getNamesEx(so.decodeEx(e))}getNamesEx(e){return ss.map(this.matrixMap,(r,i)=>r.findCellEx(e)&&i).filter(Boolean)}_explore(e,r){r.mark=!1;let{sheetName:i}=r,n=new ej(r.row,r.col,r.row,r.col,i),s,a;function o(f,h){let g=e.findCellAt(i,f,r.col);return!g||!g.mark?!1:(n[h]=f,g.mark=!1,!0)}for(a=r.row-1;o(a,"top");a--);for(a=r.row+1;o(a,"bottom");a++);function u(f,h){let g=[];for(a=n.top;a<=n.bottom;a++){let m=e.findCellAt(i,a,f);if(m&&m.mark)g.push(m);else return!1}n[h]=f;for(let m=0;m<g.length;m++)g[m].mark=!1;return!0}for(s=r.col-1;u(s,"left");s--);for(s=r.col+1;u(s,"right");s++);return n}getRanges(e,r){if(r=r||this.matrixMap[e],!r)return{name:e,ranges:[]};r.forEach(n=>{n.mark=!0});let i=r.map(n=>n.mark&&this._explore(r,n)).filter(Boolean).map(n=>n.$shortRange);return{name:e,ranges:i}}normaliseMatrix(e,r){e.forEachInSheet(r,(i,n,s)=>{i&&(i.row!==n||i.col!==s)&&(i.row=n,i.col=s,i.address=so.n2l(s)+n)})}spliceRows(e,r,i,n){ss.each(this.matrixMap,s=>{s.spliceRows(e,r,i,n),this.normaliseMatrix(s,e)})}spliceColumns(e,r,i,n){ss.each(this.matrixMap,s=>{s.spliceColumns(e,r,i,n),this.normaliseMatrix(s,e)})}get model(){return ss.map(this.matrixMap,(e,r)=>this.getRanges(r,e)).filter(e=>e.ranges.length)}set model(e){let r=this.matrixMap={};e.forEach(i=>{let n=r[i.name]=new Cx;i.ranges.forEach(s=>{tj.test(s.split("!").pop()||"")&&n.addCell(s)})})}};Sx.exports=Fd});var At=y((pse,Dd)=>{"use strict";typeof process>"u"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?Dd.exports={nextTick:rj}:Dd.exports=process;function rj(t,e,r,i){if(typeof t!="function")throw new TypeError('"callback" argument must be a function');var n=arguments.length,s,a;switch(n){case 0:case 1:return process.nextTick(t);case 2:return process.nextTick(function(){t.call(null,e)});case 3:return process.nextTick(function(){t.call(null,e,r)});case 4:return process.nextTick(function(){t.call(null,e,r,i)});default:for(s=new Array(n-1),a=0;a<s.length;)s[a++]=arguments[a];return process.nextTick(function(){t.apply(null,s)})}}});var _u=y((gse,kx)=>{var ij={}.toString;kx.exports=Array.isArray||function(t){return ij.call(t)=="[object Array]"}});var qd=y((mse,Rx)=>{Rx.exports=require("stream")});var ao=y((Id,Ax)=>{var wu=require("buffer"),Nr=wu.Buffer;function Ox(t,e){for(var r in t)e[r]=t[r]}Nr.from&&Nr.alloc&&Nr.allocUnsafe&&Nr.allocUnsafeSlow?Ax.exports=wu:(Ox(wu,Id),Id.Buffer=as);function as(t,e,r){return Nr(t,e,r)}Ox(Nr,as);as.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Nr(t,e,r)};as.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=Nr(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};as.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Nr(t)};as.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return wu.SlowBuffer(t)}});var ht=y(ft=>{function nj(t){return Array.isArray?Array.isArray(t):bu(t)==="[object Array]"}ft.isArray=nj;function sj(t){return typeof t=="boolean"}ft.isBoolean=sj;function aj(t){return t===null}ft.isNull=aj;function oj(t){return t==null}ft.isNullOrUndefined=oj;function lj(t){return typeof t=="number"}ft.isNumber=lj;function uj(t){return typeof t=="string"}ft.isString=uj;function fj(t){return typeof t=="symbol"}ft.isSymbol=fj;function hj(t){return t===void 0}ft.isUndefined=hj;function cj(t){return bu(t)==="[object RegExp]"}ft.isRegExp=cj;function dj(t){return typeof t=="object"&&t!==null}ft.isObject=dj;function pj(t){return bu(t)==="[object Date]"}ft.isDate=pj;function gj(t){return bu(t)==="[object Error]"||t instanceof Error}ft.isError=gj;function mj(t){return typeof t=="function"}ft.isFunction=mj;function vj(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}ft.isPrimitive=vj;ft.isBuffer=require("buffer").Buffer.isBuffer;function bu(t){return Object.prototype.toString.call(t)}});var Fx=y((yse,Md)=>{typeof Object.create=="function"?Md.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Md.exports=function(e,r){if(r){e.super_=r;var i=function(){};i.prototype=r.prototype,e.prototype=new i,e.prototype.constructor=e}}});var le=y((_se,Ld)=>{try{if(Pd=require("util"),typeof Pd.inherits!="function")throw"";Ld.exports=Pd.inherits}catch{Ld.exports=Fx()}var Pd});var Dx=y((wse,Bd)=>{"use strict";function yj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Nx=ao().Buffer,oo=require("util");function _j(t,e,r){t.copy(e,r)}Bd.exports=function(){function t(){yj(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(r){var i={data:r,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length},t.prototype.unshift=function(r){var i={data:r,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length},t.prototype.shift=function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(r){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=r+i.data;return n},t.prototype.concat=function(r){if(this.length===0)return Nx.alloc(0);for(var i=Nx.allocUnsafe(r>>>0),n=this.head,s=0;n;)_j(n.data,i,s),s+=n.data.length,n=n.next;return i},t}();oo&&oo.inspect&&oo.inspect.custom&&(Bd.exports.prototype[oo.inspect.custom]=function(){var t=oo.inspect({length:this.length});return this.constructor.name+" "+t})});var jd=y((bse,qx)=>{"use strict";var xu=At();function wj(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,xu.nextTick(Tu,this,t)):xu.nextTick(Tu,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted||(r._writableState.errorEmitted=!0,xu.nextTick(Tu,r,s)):xu.nextTick(Tu,r,s):e&&e(s)}),this)}function bj(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Tu(t,e){t.emit("error",e)}qx.exports={destroy:wj,undestroy:bj}});var lo=y((xse,Ix)=>{Ix.exports=require("util").deprecate});var $d=y((Tse,Hx)=>{"use strict";var en=At();Hx.exports=He;function Px(t){var e=this;this.next=null,this.entry=null,this.finish=function(){Bj(e,t)}}var xj=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:en.nextTick,os;He.WritableState=fo;var Lx=Object.create(ht());Lx.inherits=le();var Tj={deprecate:lo()},Bx=qd(),Cu=ao().Buffer,Ej=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Cj(t){return Cu.from(t)}function Sj(t){return Cu.isBuffer(t)||t instanceof Ej}var jx=jd();Lx.inherits(He,Bx);function kj(){}function fo(t,e){os=os||tn(),t=t||{};var r=e instanceof os;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,n=t.writableHighWaterMark,s=this.objectMode?16:16*1024;i||i===0?this.highWaterMark=i:r&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=t.decodeStrings===!1;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(o){qj(e,o)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Px(this)}fo.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(fo.prototype,"buffer",{get:Tj.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var Eu;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Eu=Function.prototype[Symbol.hasInstance],Object.defineProperty(He,Symbol.hasInstance,{value:function(t){return Eu.call(this,t)?!0:this!==He?!1:t&&t._writableState instanceof fo}})):Eu=function(t){return t instanceof this};function He(t){if(os=os||tn(),!Eu.call(He,this)&&!(this instanceof os))return new He(t);this._writableState=new fo(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),Bx.call(this)}He.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function Rj(t,e){var r=new Error("write after end");t.emit("error",r),en.nextTick(e,r)}function Oj(t,e,r,i){var n=!0,s=!1;return r===null?s=new TypeError("May not write null values to stream"):typeof r!="string"&&r!==void 0&&!e.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),en.nextTick(i,s),n=!1),n}He.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&Sj(t);return s&&!Cu.isBuffer(t)&&(t=Cj(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof r!="function"&&(r=kj),i.ended?Rj(this,r):(s||Oj(this,i,t,r))&&(i.pendingcb++,n=Fj(this,i,s,t,e,r)),n};He.prototype.cork=function(){var t=this._writableState;t.corked++};He.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Wx(this,t))};He.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function Aj(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=Cu.from(e,r)),e}Object.defineProperty(He.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Fj(t,e,r,i,n,s){if(!r){var a=Aj(e,i,n);i!==a&&(r=!0,n="buffer",i=a)}var o=e.objectMode?1:i.length;e.length+=o;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var f=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},f?f.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Wd(t,e,!1,o,i,n,s);return u}function Wd(t,e,r,i,n,s,a){e.writelen=i,e.writecb=a,e.writing=!0,e.sync=!0,r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function Nj(t,e,r,i,n){--e.pendingcb,r?(en.nextTick(n,i),en.nextTick(uo,t,e),t._writableState.errorEmitted=!0,t.emit("error",i)):(n(i),t._writableState.errorEmitted=!0,t.emit("error",i),uo(t,e))}function Dj(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function qj(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if(Dj(r),e)Nj(t,r,i,e,n);else{var s=$x(r);!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Wx(t,r),i?xj(Mx,t,r,s,n):Mx(t,r,s,n)}}function Mx(t,e,r,i){r||Ij(t,e),e.pendingcb--,i(),uo(t,e)}function Ij(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function Wx(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var a=0,o=!0;r;)n[a]=r,r.isBuf||(o=!1),r=r.next,a+=1;n.allBuffers=o,Wd(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new Px(e),e.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,f=r.encoding,h=r.callback,g=e.objectMode?1:u.length;if(Wd(t,e,!1,g,u,f,h),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}He.prototype._write=function(t,e,r){r(new Error("_write() is not implemented"))};He.prototype._writev=null;He.prototype.end=function(t,e,r){var i=this._writableState;typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||Lj(this,i,r)};function $x(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function Mj(t,e){t._final(function(r){e.pendingcb--,r&&t.emit("error",r),e.prefinished=!0,t.emit("prefinish"),uo(t,e)})}function Pj(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,en.nextTick(Mj,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function uo(t,e){var r=$x(e);return r&&(Pj(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),r}function Lj(t,e,r){e.ending=!0,uo(t,e),r&&(e.finished?en.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function Bj(t,e,r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}Object.defineProperty(He.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){!this._writableState||(this._writableState.destroyed=t)}});He.prototype.destroy=jx.destroy;He.prototype._undestroy=jx.undestroy;He.prototype._destroy=function(t,e){this.end(),e(t)}});var tn=y((Ese,Vx)=>{"use strict";var Ux=At(),jj=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};Vx.exports=Dr;var zx=Object.create(ht());zx.inherits=le();var Xx=zd(),Ud=$d();zx.inherits(Dr,Xx);for(Hd=jj(Ud.prototype),Su=0;Su<Hd.length;Su++)ku=Hd[Su],Dr.prototype[ku]||(Dr.prototype[ku]=Ud.prototype[ku]);var Hd,ku,Su;function Dr(t){if(!(this instanceof Dr))return new Dr(t);Xx.call(this,t),Ud.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",Wj)}Object.defineProperty(Dr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Wj(){this.allowHalfOpen||this._writableState.ended||Ux.nextTick($j,this)}function $j(t){t.end()}Object.defineProperty(Dr.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});Dr.prototype._destroy=function(t,e){this.push(null),this.end(),Ux.nextTick(e,t)}});var Gd=y(Zx=>{"use strict";var Vd=ao().Buffer,Gx=Vd.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Hj(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function Uj(t){var e=Hj(t);if(typeof e!="string"&&(Vd.isEncoding===Gx||!Gx(t)))throw new Error("Unknown encoding: "+t);return e||t}Zx.StringDecoder=ho;function ho(t){this.encoding=Uj(t);var e;switch(this.encoding){case"utf16le":this.text=Yj,this.end=Kj,e=4;break;case"utf8":this.fillLast=Vj,e=4;break;case"base64":this.text=Qj,this.end=Jj,e=3;break;default:this.write=e6,this.end=t6;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Vd.allocUnsafe(e)}ho.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};ho.prototype.end=Zj;ho.prototype.text=Gj;ho.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function Xd(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function zj(t,e,r){var i=e.length-1;if(i<r)return 0;var n=Xd(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||n===-2?0:(n=Xd(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||n===-2?0:(n=Xd(e[i]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function Xj(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function Vj(t){var e=this.lastTotal-this.lastNeed,r=Xj(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function Gj(t,e){var r=zj(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function Zj(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function Yj(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function Kj(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function Qj(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function Jj(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function e6(t){return t.toString(this.encoding)}function t6(t){return t&&t.length?this.write(t):""}});var zd=y((kse,oT)=>{"use strict";var us=At();oT.exports=Re;var r6=_u(),co;Re.ReadableState=rT;var Sse=require("events").EventEmitter,Jx=function(t,e){return t.listeners(e).length},Jd=qd(),po=ao().Buffer,i6=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function n6(t){return po.from(t)}function s6(t){return po.isBuffer(t)||t instanceof i6}var eT=Object.create(ht());eT.inherits=le();var Zd=require("util"),ge=void 0;Zd&&Zd.debuglog?ge=Zd.debuglog("stream"):ge=function(){};var a6=Dx(),tT=jd(),ls;eT.inherits(Re,Jd);var Yd=["error","close","destroy","pause","resume"];function o6(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):r6(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function rT(t,e){co=co||tn(),t=t||{};var r=e instanceof co;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,n=t.readableHighWaterMark,s=this.objectMode?16:16*1024;i||i===0?this.highWaterMark=i:r&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new a6,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(ls||(ls=Gd().StringDecoder),this.decoder=new ls(t.encoding),this.encoding=t.encoding)}function Re(t){if(co=co||tn(),!(this instanceof Re))return new Re(t);this._readableState=new rT(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),Jd.call(this)}Object.defineProperty(Re.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){!this._readableState||(this._readableState.destroyed=t)}});Re.prototype.destroy=tT.destroy;Re.prototype._undestroy=tT.undestroy;Re.prototype._destroy=function(t,e){this.push(null),e(t)};Re.prototype.push=function(t,e){var r=this._readableState,i;return r.objectMode?i=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=po.from(t,e),e=""),i=!0),iT(this,t,e,!1,i)};Re.prototype.unshift=function(t){return iT(this,t,null,!0,!1)};function iT(t,e,r,i,n){var s=t._readableState;if(e===null)s.reading=!1,h6(t,s);else{var a;n||(a=l6(s,e)),a?t.emit("error",a):s.objectMode||e&&e.length>0?(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==po.prototype&&(e=n6(e)),i?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):Kd(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?Kd(t,s,e,!1):nT(t,s)):Kd(t,s,e,!1))):i||(s.reading=!1)}return u6(s)}function Kd(t,e,r,i){e.flowing&&e.length===0&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Ru(t)),nT(t,e)}function l6(t,e){var r;return!s6(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new TypeError("Invalid non-string/buffer chunk")),r}function u6(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}Re.prototype.isPaused=function(){return this._readableState.flowing===!1};Re.prototype.setEncoding=function(t){return ls||(ls=Gd().StringDecoder),this._readableState.decoder=new ls(t),this._readableState.encoding=t,this};var Yx=8388608;function f6(t){return t>=Yx?t=Yx:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function Kx(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=f6(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Re.prototype.read=function(t){ge("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return ge("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Qd(this):Ru(this),null;if(t=Kx(t,e),t===0&&e.ended)return e.length===0&&Qd(this),null;var i=e.needReadable;ge("need readable",i),(e.length===0||e.length-t<e.highWaterMark)&&(i=!0,ge("length less than watermark",i)),e.ended||e.reading?(i=!1,ge("reading or ended",i)):i&&(ge("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Kx(r,e)));var n;return t>0?n=sT(t,e):n=null,n===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&Qd(this)),n!==null&&this.emit("data",n),n};function h6(t,e){if(!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,Ru(t)}}function Ru(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(ge("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?us.nextTick(Qx,t):Qx(t))}function Qx(t){ge("emit readable"),t.emit("readable"),ep(t)}function nT(t,e){e.readingMore||(e.readingMore=!0,us.nextTick(c6,t,e))}function c6(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(ge("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}Re.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};Re.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,ge("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=n?o:w;i.endEmitted?us.nextTick(s):r.once("end",s),t.on("unpipe",a);function a(b,C){ge("onunpipe"),b===r&&C&&C.hasUnpiped===!1&&(C.hasUnpiped=!0,h())}function o(){ge("onend"),t.end()}var u=d6(r);t.on("drain",u);var f=!1;function h(){ge("cleanup"),t.removeListener("close",d),t.removeListener("finish",v),t.removeListener("drain",u),t.removeListener("error",c),t.removeListener("unpipe",a),r.removeListener("end",o),r.removeListener("end",w),r.removeListener("data",m),f=!0,i.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&u()}var g=!1;r.on("data",m);function m(b){ge("ondata"),g=!1;var C=t.write(b);C===!1&&!g&&((i.pipesCount===1&&i.pipes===t||i.pipesCount>1&&aT(i.pipes,t)!==-1)&&!f&&(ge("false write response, pause",i.awaitDrain),i.awaitDrain++,g=!0),r.pause())}function c(b){ge("onerror",b),w(),t.removeListener("error",c),Jx(t,"error")===0&&t.emit("error",b)}o6(t,"error",c);function d(){t.removeListener("finish",v),w()}t.once("close",d);function v(){ge("onfinish"),t.removeListener("close",d),w()}t.once("finish",v);function w(){ge("unpipe"),r.unpipe(t)}return t.emit("pipe",r),i.flowing||(ge("pipe resume"),r.resume()),t};function d6(t){return function(){var e=t._readableState;ge("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&Jx(t,"data")&&(e.flowing=!0,ep(t))}}Re.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=aT(e.pipes,t);return a===-1?this:(e.pipes.splice(a,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Re.prototype.on=function(t,e){var r=Jd.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var i=this._readableState;!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&Ru(this):us.nextTick(p6,this))}return r};Re.prototype.addListener=Re.prototype.on;function p6(t){ge("readable nexttick read 0"),t.read(0)}Re.prototype.resume=function(){var t=this._readableState;return t.flowing||(ge("resume"),t.flowing=!0,g6(this,t)),this};function g6(t,e){e.resumeScheduled||(e.resumeScheduled=!0,us.nextTick(m6,t,e))}function m6(t,e){e.reading||(ge("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),ep(t),e.flowing&&!e.reading&&t.read(0)}Re.prototype.pause=function(){return ge("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(ge("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function ep(t){var e=t._readableState;for(ge("flow",e.flowing);e.flowing&&t.read()!==null;);}Re.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;t.on("end",function(){if(ge("wrapped end"),r.decoder&&!r.ended){var a=r.decoder.end();a&&a.length&&e.push(a)}e.push(null)}),t.on("data",function(a){if(ge("wrapped data"),r.decoder&&(a=r.decoder.write(a)),!(r.objectMode&&a==null)&&!(!r.objectMode&&(!a||!a.length))){var o=e.push(a);o||(i=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(a){return function(){return t[a].apply(t,arguments)}}(n));for(var s=0;s<Yd.length;s++)t.on(Yd[s],this.emit.bind(this,Yd[s]));return this._read=function(a){ge("wrapped _read",a),i&&(i=!1,t.resume())},this};Object.defineProperty(Re.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Re._fromList=sT;function sT(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.head.data:r=e.buffer.concat(e.length),e.buffer.clear()):r=v6(t,e.buffer,e.decoder),r}function v6(t,e,r){var i;return t<e.head.data.length?(i=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?i=e.shift():i=r?y6(t,e):_6(t,e),i}function y6(t,e){var r=e.head,i=1,n=r.data;for(t-=n.length;r=r.next;){var s=r.data,a=t>s.length?s.length:t;if(a===s.length?n+=s:n+=s.slice(0,t),t-=a,t===0){a===s.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=s.slice(a));break}++i}return e.length-=i,n}function _6(t,e){var r=po.allocUnsafe(t),i=e.head,n=1;for(i.data.copy(r),t-=i.data.length;i=i.next;){var s=i.data,a=t>s.length?s.length:t;if(s.copy(r,r.length-t,0,a),t-=a,t===0){a===s.length?(++n,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=s.slice(a));break}++n}return e.length-=n,r}function Qd(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,us.nextTick(w6,e,t))}function w6(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function aT(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}});var tp=y((Rse,fT)=>{"use strict";fT.exports=qr;var Ou=tn(),uT=Object.create(ht());uT.inherits=le();uT.inherits(qr,Ou);function b6(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,e!=null&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function qr(t){if(!(this instanceof qr))return new qr(t);Ou.call(this,t),this._transformState={afterTransform:b6.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",x6)}function x6(){var t=this;typeof this._flush=="function"?this._flush(function(e,r){lT(t,e,r)}):lT(this,null,null)}qr.prototype.push=function(t,e){return this._transformState.needTransform=!1,Ou.prototype.push.call(this,t,e)};qr.prototype._transform=function(t,e,r){throw new Error("_transform() is not implemented")};qr.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};qr.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};qr.prototype._destroy=function(t,e){var r=this;Ou.prototype._destroy.call(this,t,function(i){e(i),r.emit("close")})};function lT(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var pT=y((Ose,dT)=>{"use strict";dT.exports=go;var hT=tp(),cT=Object.create(ht());cT.inherits=le();cT.inherits(go,hT);function go(t){if(!(this instanceof go))return new go(t);hT.call(this,t)}go.prototype._transform=function(t,e,r){r(null,t)}});var rp=y((rt,Au)=>{var ur=require("stream");process.env.READABLE_STREAM==="disable"&&ur?(Au.exports=ur,rt=Au.exports=ur.Readable,rt.Readable=ur.Readable,rt.Writable=ur.Writable,rt.Duplex=ur.Duplex,rt.Transform=ur.Transform,rt.PassThrough=ur.PassThrough,rt.Stream=ur):(rt=Au.exports=zd(),rt.Stream=ur||rt,rt.Readable=rt,rt.Writable=$d(),rt.Duplex=tn(),rt.Transform=tp(),rt.PassThrough=pT())});var Ir=y(Ft=>{"use strict";Ft.base64=!0;Ft.array=!0;Ft.string=!0;Ft.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u";Ft.nodebuffer=typeof Buffer<"u";Ft.uint8array=typeof Uint8Array<"u";if(typeof ArrayBuffer>"u")Ft.blob=!1;else{ip=new ArrayBuffer(0);try{Ft.blob=new Blob([ip],{type:"application/zip"}).size===0}catch{try{gT=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,np=new gT,np.append(ip),Ft.blob=np.getBlob("application/zip").size===0}catch{Ft.blob=!1}}}var ip,gT,np;try{Ft.nodestream=!!rp().Readable}catch{Ft.nodestream=!1}});var ap=y(sp=>{"use strict";var T6=Pe(),E6=Ir(),fr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";sp.encode=function(t){for(var e=[],r,i,n,s,a,o,u,f=0,h=t.length,g=h,m=T6.getTypeOf(t)!=="string";f<t.length;)g=h-f,m?(r=t[f++],i=f<h?t[f++]:0,n=f<h?t[f++]:0):(r=t.charCodeAt(f++),i=f<h?t.charCodeAt(f++):0,n=f<h?t.charCodeAt(f++):0),s=r>>2,a=(r&3)<<4|i>>4,o=g>1?(i&15)<<2|n>>6:64,u=g>2?n&63:64,e.push(fr.charAt(s)+fr.charAt(a)+fr.charAt(o)+fr.charAt(u));return e.join("")};sp.decode=function(t){var e,r,i,n,s,a,o,u=0,f=0,h="data:";if(t.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");t=t.replace(/[^A-Za-z0-9+/=]/g,"");var g=t.length*3/4;if(t.charAt(t.length-1)===fr.charAt(64)&&g--,t.charAt(t.length-2)===fr.charAt(64)&&g--,g%1!==0)throw new Error("Invalid base64 input, bad content length.");var m;for(E6.uint8array?m=new Uint8Array(g|0):m=new Array(g|0);u<t.length;)n=fr.indexOf(t.charAt(u++)),s=fr.indexOf(t.charAt(u++)),a=fr.indexOf(t.charAt(u++)),o=fr.indexOf(t.charAt(u++)),e=n<<2|s>>4,r=(s&15)<<4|a>>2,i=(a&3)<<6|o,m[f++]=e,a!==64&&(m[f++]=r),o!==64&&(m[f++]=i);return m}});var mo=y((Nse,mT)=>{"use strict";mT.exports={isNode:typeof Buffer<"u",newBufferFrom:function(t,e){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,e);if(typeof t=="number")throw new Error('The "data" argument must not be a number');return new Buffer(t,e)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var e=new Buffer(t);return e.fill(0),e},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&typeof t.on=="function"&&typeof t.pause=="function"&&typeof t.resume=="function"}}});var wT=y((Dse,_T)=>{"use strict";var vT=global.MutationObserver||global.WebKitMutationObserver,fs;process.browser?vT?(op=0,yT=new vT(vo),lp=global.document.createTextNode(""),yT.observe(lp,{characterData:!0}),fs=function(){lp.data=op=++op%2}):!global.setImmediate&&typeof global.MessageChannel<"u"?(up=new global.MessageChannel,up.port1.onmessage=vo,fs=function(){up.port2.postMessage(0)}):"document"in global&&"onreadystatechange"in global.document.createElement("script")?fs=function(){var t=global.document.createElement("script");t.onreadystatechange=function(){vo(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},global.document.documentElement.appendChild(t)}:fs=function(){setTimeout(vo,0)}:fs=function(){process.nextTick(vo)};var op,yT,lp,up,fp,yo=[];function vo(){fp=!0;for(var t,e,r=yo.length;r;){for(e=yo,yo=[],t=-1;++t<r;)e[t]();r=yo.length}fp=!1}_T.exports=C6;function C6(t){yo.push(t)===1&&!fp&&fs()}});var kT=y((qse,ST)=>{"use strict";var bT=wT();function hs(){}var ct={},xT=["REJECTED"],hp=["FULFILLED"],TT=["PENDING"];process.browser||(_o=["UNHANDLED"]);var _o;ST.exports=ui;function ui(t){if(typeof t!="function")throw new TypeError("resolver must be a function");this.state=TT,this.queue=[],this.outcome=void 0,process.browser||(this.handled=_o),t!==hs&&ET(this,t)}ui.prototype.finally=function(t){if(typeof t!="function")return this;var e=this.constructor;return this.then(r,i);function r(n){function s(){return n}return e.resolve(t()).then(s)}function i(n){function s(){throw n}return e.resolve(t()).then(s)}};ui.prototype.catch=function(t){return this.then(null,t)};ui.prototype.then=function(t,e){if(typeof t!="function"&&this.state===hp||typeof e!="function"&&this.state===xT)return this;var r=new this.constructor(hs);if(process.browser||this.handled===_o&&(this.handled=null),this.state!==TT){var i=this.state===hp?t:e;cp(r,i,this.outcome)}else this.queue.push(new wo(r,t,e));return r};function wo(t,e,r){this.promise=t,typeof e=="function"&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),typeof r=="function"&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}wo.prototype.callFulfilled=function(t){ct.resolve(this.promise,t)};wo.prototype.otherCallFulfilled=function(t){cp(this.promise,this.onFulfilled,t)};wo.prototype.callRejected=function(t){ct.reject(this.promise,t)};wo.prototype.otherCallRejected=function(t){cp(this.promise,this.onRejected,t)};function cp(t,e,r){bT(function(){var i;try{i=e(r)}catch(n){return ct.reject(t,n)}i===t?ct.reject(t,new TypeError("Cannot resolve promise with itself")):ct.resolve(t,i)})}ct.resolve=function(t,e){var r=CT(S6,e);if(r.status==="error")return ct.reject(t,r.value);var i=r.value;if(i)ET(t,i);else{t.state=hp,t.outcome=e;for(var n=-1,s=t.queue.length;++n<s;)t.queue[n].callFulfilled(e)}return t};ct.reject=function(t,e){t.state=xT,t.outcome=e,process.browser||t.handled===_o&&bT(function(){t.handled===_o&&process.emit("unhandledRejection",e,t)});for(var r=-1,i=t.queue.length;++r<i;)t.queue[r].callRejected(e);return t};function S6(t){var e=t&&t.then;if(t&&(typeof t=="object"||typeof t=="function")&&typeof e=="function")return function(){e.apply(t,arguments)}}function ET(t,e){var r=!1;function i(o){r||(r=!0,ct.reject(t,o))}function n(o){r||(r=!0,ct.resolve(t,o))}function s(){e(n,i)}var a=CT(s);a.status==="error"&&i(a.value)}function CT(t,e){var r={};try{r.value=t(e),r.status="success"}catch(i){r.status="error",r.value=i}return r}ui.resolve=k6;function k6(t){return t instanceof this?t:ct.resolve(new this(hs),t)}ui.reject=R6;function R6(t){var e=new this(hs);return ct.reject(e,t)}ui.all=O6;function O6(t){var e=this;if(Object.prototype.toString.call(t)!=="[object Array]")return this.reject(new TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);for(var n=new Array(r),s=0,a=-1,o=new this(hs);++a<r;)u(t[a],a);return o;function u(f,h){e.resolve(f).then(g,function(m){i||(i=!0,ct.reject(o,m))});function g(m){n[h]=m,++s===r&&!i&&(i=!0,ct.resolve(o,n))}}}ui.race=A6;function A6(t){var e=this;if(Object.prototype.toString.call(t)!=="[object Array]")return this.reject(new TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);for(var n=-1,s=new this(hs);++n<r;)a(t[n]);return s;function a(o){e.resolve(o).then(function(u){i||(i=!0,ct.resolve(s,u))},function(u){i||(i=!0,ct.reject(s,u))})}}});var cs=y((Ise,RT)=>{"use strict";var dp=null;typeof Promise<"u"?dp=Promise:dp=kT();RT.exports={Promise:dp}});var pp=y(OT=>{(function(t,e){"use strict";if(t.setImmediate)return;var r=1,i={},n=!1,s=t.document,a;function o(C){typeof C!="function"&&(C=new Function(""+C));for(var O=new Array(arguments.length-1),R=0;R<O.length;R++)O[R]=arguments[R+1];var M={callback:C,args:O};return i[r]=M,a(r),r++}function u(C){delete i[C]}function f(C){var O=C.callback,R=C.args;switch(R.length){case 0:O();break;case 1:O(R[0]);break;case 2:O(R[0],R[1]);break;case 3:O(R[0],R[1],R[2]);break;default:O.apply(e,R);break}}function h(C){if(n)setTimeout(h,0,C);else{var O=i[C];if(O){n=!0;try{f(O)}finally{u(C),n=!1}}}}function g(){a=function(C){process.nextTick(function(){h(C)})}}function m(){if(t.postMessage&&!t.importScripts){var C=!0,O=t.onmessage;return t.onmessage=function(){C=!1},t.postMessage("","*"),t.onmessage=O,C}}function c(){var C="setImmediate$"+Math.random()+"$",O=function(R){R.source===t&&typeof R.data=="string"&&R.data.indexOf(C)===0&&h(+R.data.slice(C.length))};t.addEventListener?t.addEventListener("message",O,!1):t.attachEvent("onmessage",O),a=function(R){t.postMessage(C+R,"*")}}function d(){var C=new MessageChannel;C.port1.onmessage=function(O){var R=O.data;h(R)},a=function(O){C.port2.postMessage(O)}}function v(){var C=s.documentElement;a=function(O){var R=s.createElement("script");R.onreadystatechange=function(){h(O),R.onreadystatechange=null,C.removeChild(R),R=null},C.appendChild(R)}}function w(){a=function(C){setTimeout(h,0,C)}}var b=Object.getPrototypeOf&&Object.getPrototypeOf(t);b=b&&b.setTimeout?b:t,{}.toString.call(t.process)==="[object process]"?g():m()?c():t.MessageChannel?d():s&&"onreadystatechange"in s.createElement("script")?v():w(),b.setImmediate=o,b.clearImmediate=u})(typeof self>"u"?typeof global>"u"?OT:global:self)});var Pe=y(Ue=>{"use strict";var fi=Ir(),F6=ap(),ds=mo(),gp=cs();pp();function N6(t){var e=null;return fi.uint8array?e=new Uint8Array(t.length):e=new Array(t.length),Nu(t,e)}Ue.newBlob=function(t,e){Ue.checkSupport("blob");try{return new Blob([t],{type:e})}catch{try{var r=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,i=new r;return i.append(t),i.getBlob(e)}catch{throw new Error("Bug : can't construct the Blob.")}}};function bo(t){return t}function Nu(t,e){for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)&255;return e}var Fu={stringifyByChunk:function(t,e,r){var i=[],n=0,s=t.length;if(s<=r)return String.fromCharCode.apply(null,t);for(;n<s;)e==="array"||e==="nodebuffer"?i.push(String.fromCharCode.apply(null,t.slice(n,Math.min(n+r,s)))):i.push(String.fromCharCode.apply(null,t.subarray(n,Math.min(n+r,s)))),n+=r;return i.join("")},stringifyByChar:function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},applyCanBeUsed:{uint8array:function(){try{return fi.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return fi.nodebuffer&&String.fromCharCode.apply(null,ds.allocBuffer(1)).length===1}catch{return!1}}()}};function xo(t){var e=65536,r=Ue.getTypeOf(t),i=!0;if(r==="uint8array"?i=Fu.applyCanBeUsed.uint8array:r==="nodebuffer"&&(i=Fu.applyCanBeUsed.nodebuffer),i)for(;e>1;)try{return Fu.stringifyByChunk(t,r,e)}catch{e=Math.floor(e/2)}return Fu.stringifyByChar(t)}Ue.applyFromCharCode=xo;function Du(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}var hi={};hi.string={string:bo,array:function(t){return Nu(t,new Array(t.length))},arraybuffer:function(t){return hi.string.uint8array(t).buffer},uint8array:function(t){return Nu(t,new Uint8Array(t.length))},nodebuffer:function(t){return Nu(t,ds.allocBuffer(t.length))}};hi.array={string:xo,array:bo,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return ds.newBufferFrom(t)}};hi.arraybuffer={string:function(t){return xo(new Uint8Array(t))},array:function(t){return Du(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:bo,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return ds.newBufferFrom(new Uint8Array(t))}};hi.uint8array={string:xo,array:function(t){return Du(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:bo,nodebuffer:function(t){return ds.newBufferFrom(t)}};hi.nodebuffer={string:xo,array:function(t){return Du(t,new Array(t.length))},arraybuffer:function(t){return hi.nodebuffer.uint8array(t).buffer},uint8array:function(t){return Du(t,new Uint8Array(t.length))},nodebuffer:bo};Ue.transformTo=function(t,e){if(e||(e=""),!t)return e;Ue.checkSupport(t);var r=Ue.getTypeOf(e),i=hi[r][t](e);return i};Ue.resolve=function(t){for(var e=t.split("/"),r=[],i=0;i<e.length;i++){var n=e[i];n==="."||n===""&&i!==0&&i!==e.length-1||(n===".."?r.pop():r.push(n))}return r.join("/")};Ue.getTypeOf=function(t){if(typeof t=="string")return"string";if(Object.prototype.toString.call(t)==="[object Array]")return"array";if(fi.nodebuffer&&ds.isBuffer(t))return"nodebuffer";if(fi.uint8array&&t instanceof Uint8Array)return"uint8array";if(fi.arraybuffer&&t instanceof ArrayBuffer)return"arraybuffer"};Ue.checkSupport=function(t){var e=fi[t.toLowerCase()];if(!e)throw new Error(t+" is not supported by this platform")};Ue.MAX_VALUE_16BITS=65535;Ue.MAX_VALUE_32BITS=-1;Ue.pretty=function(t){var e="",r,i;for(i=0;i<(t||"").length;i++)r=t.charCodeAt(i),e+="\\x"+(r<16?"0":"")+r.toString(16).toUpperCase();return e};Ue.delay=function(t,e,r){setImmediate(function(){t.apply(r||null,e||[])})};Ue.inherits=function(t,e){var r=function(){};r.prototype=e.prototype,t.prototype=new r};Ue.extend=function(){var t={},e,r;for(e=0;e<arguments.length;e++)for(r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&typeof t[r]>"u"&&(t[r]=arguments[e][r]);return t};Ue.prepareContent=function(t,e,r,i,n){var s=gp.Promise.resolve(e).then(function(a){var o=fi.blob&&(a instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(a))!==-1);return o&&typeof FileReader<"u"?new gp.Promise(function(u,f){var h=new FileReader;h.onload=function(g){u(g.target.result)},h.onerror=function(g){f(g.target.error)},h.readAsArrayBuffer(a)}):a});return s.then(function(a){var o=Ue.getTypeOf(a);return o?(o==="arraybuffer"?a=Ue.transformTo("uint8array",a):o==="string"&&(n?a=F6.decode(a):r&&i!==!0&&(a=N6(a))),a):gp.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}});var Nt=y((Lse,FT)=>{"use strict";function AT(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}AT.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return this.isFinished?!1:(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",function(r){e.processChunk(r)}),t.on("end",function(){e.end()}),t.on("error",function(r){e.error(r)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)!Object.prototype.hasOwnProperty.call(this.extraStreamInfo,t)||(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}};FT.exports=AT});var gs=y(ci=>{"use strict";var ps=Pe(),rn=Ir(),D6=mo(),qu=Nt(),To=new Array(256);for(Mr=0;Mr<256;Mr++)To[Mr]=Mr>=252?6:Mr>=248?5:Mr>=240?4:Mr>=224?3:Mr>=192?2:1;var Mr;To[254]=To[254]=1;var q6=function(t){var e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<a&&(i=t.charCodeAt(n+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(rn.uint8array?e=new Uint8Array(o):e=new Array(o),s=0,n=0;s<o;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<a&&(i=t.charCodeAt(n+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e},I6=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+To[t[r]]>e?r:e},M6=function(t){var e,r,i,n,s=t.length,a=new Array(s*2);for(r=0,e=0;e<s;){if(i=t[e++],i<128){a[r++]=i;continue}if(n=To[i],n>4){a[r++]=65533,e+=n-1;continue}for(i&=n===2?31:n===3?15:7;n>1&&e<s;)i=i<<6|t[e++]&63,n--;if(n>1){a[r++]=65533;continue}i<65536?a[r++]=i:(i-=65536,a[r++]=55296|i>>10&1023,a[r++]=56320|i&1023)}return a.length!==r&&(a.subarray?a=a.subarray(0,r):a.length=r),ps.applyFromCharCode(a)};ci.utf8encode=function(e){return rn.nodebuffer?D6.newBufferFrom(e,"utf-8"):q6(e)};ci.utf8decode=function(e){return rn.nodebuffer?ps.transformTo("nodebuffer",e).toString("utf-8"):(e=ps.transformTo(rn.uint8array?"uint8array":"array",e),M6(e))};function Iu(){qu.call(this,"utf-8 decode"),this.leftOver=null}ps.inherits(Iu,qu);Iu.prototype.processChunk=function(t){var e=ps.transformTo(rn.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(rn.uint8array){var r=e;e=new Uint8Array(r.length+this.leftOver.length),e.set(this.leftOver,0),e.set(r,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var i=I6(e),n=e;i!==e.length&&(rn.uint8array?(n=e.subarray(0,i),this.leftOver=e.subarray(i,e.length)):(n=e.slice(0,i),this.leftOver=e.slice(i,e.length))),this.push({data:ci.utf8decode(n),meta:t.meta})};Iu.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:ci.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)};ci.Utf8DecodeWorker=Iu;function mp(){qu.call(this,"utf-8 encode")}ps.inherits(mp,qu);mp.prototype.processChunk=function(t){this.push({data:ci.utf8encode(t.data),meta:t.meta})};ci.Utf8EncodeWorker=mp});var IT=y((jse,qT)=>{"use strict";var NT=Nt(),DT=Pe();function vp(t){NT.call(this,"ConvertWorker to "+t),this.destType=t}DT.inherits(vp,NT);vp.prototype.processChunk=function(t){this.push({data:DT.transformTo(this.destType,t.data),meta:t.meta})};qT.exports=vp});var LT=y((Wse,PT)=>{"use strict";var MT=rp().Readable,P6=Pe();P6.inherits(yp,MT);function yp(t,e,r){MT.call(this,e),this._helper=t;var i=this;t.on("data",function(n,s){i.push(n)||i._helper.pause(),r&&r(s)}).on("error",function(n){i.emit("error",n)}).on("end",function(){i.push(null)})}yp.prototype._read=function(){this._helper.resume()};PT.exports=yp});var _p=y(($se,WT)=>{"use strict";var nn=Pe(),L6=IT(),B6=Nt(),j6=ap(),W6=Ir(),$6=cs(),BT=null;if(W6.nodestream)try{BT=LT()}catch{}function H6(t,e,r){switch(t){case"blob":return nn.newBlob(nn.transformTo("arraybuffer",e),r);case"base64":return j6.encode(e);default:return nn.transformTo(t,e)}}function U6(t,e){var r,i=0,n=null,s=0;for(r=0;r<e.length;r++)s+=e[r].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(n=new Uint8Array(s),r=0;r<e.length;r++)n.set(e[r],i),i+=e[r].length;return n;case"nodebuffer":return Buffer.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}function z6(t,e){return new $6.Promise(function(r,i){var n=[],s=t._internalType,a=t._outputType,o=t._mimeType;t.on("data",function(u,f){n.push(u),e&&e(f)}).on("error",function(u){n=[],i(u)}).on("end",function(){try{var u=H6(a,U6(s,n),o);r(u)}catch(f){i(f)}n=[]}).resume()})}function jT(t,e,r){var i=e;switch(e){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string";break}try{this._internalType=i,this._outputType=e,this._mimeType=r,nn.checkSupport(i),this._worker=t.pipe(new L6(i)),t.lock()}catch(n){this._worker=new B6("error"),this._worker.error(n)}}jT.prototype={accumulate:function(t){return z6(this,t)},on:function(t,e){var r=this;return t==="data"?this._worker.on(t,function(i){e.call(r,i.data,i.meta)}):this._worker.on(t,function(){nn.delay(e,arguments,r)}),this},resume:function(){return nn.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(nn.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new BT(this,{objectMode:this._outputType!=="nodebuffer"},t)}};WT.exports=jT});var wp=y(Kt=>{"use strict";Kt.base64=!1;Kt.binary=!1;Kt.dir=!1;Kt.createFolders=!0;Kt.date=null;Kt.compression=null;Kt.compressionOptions=null;Kt.comment=null;Kt.unixPermissions=null;Kt.dosPermissions=null});var bp=y((Use,$T)=>{"use strict";var Mu=Pe(),Pu=Nt(),X6=16*1024;function ms(t){Pu.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then(function(r){e.dataIsReady=!0,e.data=r,e.max=r&&r.length||0,e.type=Mu.getTypeOf(r),e.isPaused||e._tickAndRepeat()},function(r){e.error(r)})}Mu.inherits(ms,Pu);ms.prototype.cleanUp=function(){Pu.prototype.cleanUp.call(this),this.data=null};ms.prototype.resume=function(){return Pu.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,Mu.delay(this._tickAndRepeat,[],this)),!0):!1};ms.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(Mu.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))};ms.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=X6,e=null,r=Math.min(this.max,this.index+t);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,r);break;case"uint8array":e=this.data.subarray(this.index,r);break;case"array":case"nodebuffer":e=this.data.slice(this.index,r);break}return this.index=r,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})};$T.exports=ms});var Lu=y((zse,UT)=>{"use strict";var V6=Pe();function G6(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e}var HT=G6();function Z6(t,e,r,i){var n=HT,s=i+r;t=t^-1;for(var a=i;a<s;a++)t=t>>>8^n[(t^e[a])&255];return t^-1}function Y6(t,e,r,i){var n=HT,s=i+r;t=t^-1;for(var a=i;a<s;a++)t=t>>>8^n[(t^e.charCodeAt(a))&255];return t^-1}UT.exports=function(e,r){if(typeof e>"u"||!e.length)return 0;var i=V6.getTypeOf(e)!=="string";return i?Z6(r|0,e,e.length,0):Y6(r|0,e,e.length,0)}});var Tp=y((Xse,XT)=>{"use strict";var zT=Nt(),K6=Lu(),Q6=Pe();function xp(){zT.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}Q6.inherits(xp,zT);xp.prototype.processChunk=function(t){this.streamInfo.crc32=K6(t.data,this.streamInfo.crc32||0),this.push(t)};XT.exports=xp});var GT=y((Vse,VT)=>{"use strict";var J6=Pe(),Ep=Nt();function Cp(t){Ep.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}J6.inherits(Cp,Ep);Cp.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}Ep.prototype.processChunk.call(this,t)};VT.exports=Cp});var Bu=y((Gse,KT)=>{"use strict";var ZT=cs(),YT=bp(),e3=Tp(),Sp=GT();function kp(t,e,r,i,n){this.compressedSize=t,this.uncompressedSize=e,this.crc32=r,this.compression=i,this.compressedContent=n}kp.prototype={getContentWorker:function(){var t=new YT(ZT.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new Sp("data_length")),e=this;return t.on("end",function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),t},getCompressedWorker:function(){return new YT(ZT.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};kp.createWorkerFrom=function(t,e,r){return t.pipe(new e3).pipe(new Sp("uncompressedSize")).pipe(e.compressWorker(r)).pipe(new Sp("compressedSize")).withStreamInfo("compression",e)};KT.exports=kp});var tE=y((Zse,eE)=>{"use strict";var t3=_p(),r3=bp(),Rp=gs(),Op=Bu(),QT=Nt(),Ap=function(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};Ap.prototype={internalStream:function(t){var e=null,r="string";try{if(!t)throw new Error("No output type specified.");r=t.toLowerCase();var i=r==="string"||r==="text";(r==="binarystring"||r==="text")&&(r="string"),e=this._decompressWorker();var n=!this._dataBinary;n&&!i&&(e=e.pipe(new Rp.Utf8EncodeWorker)),!n&&i&&(e=e.pipe(new Rp.Utf8DecodeWorker))}catch(s){e=new QT("error"),e.error(s)}return new t3(e,r,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof Op&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new Rp.Utf8EncodeWorker)),Op.createWorkerFrom(r,t,e)},_decompressWorker:function(){return this._data instanceof Op?this._data.getContentWorker():this._data instanceof QT?this._data:new r3(this._data)}};var JT=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],i3=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")};for(ju=0;ju<JT.length;ju++)Ap.prototype[JT[ju]]=i3;var ju;eE.exports=Ap});var Pr=y(vt=>{"use strict";var n3=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function s3(t,e){return Object.prototype.hasOwnProperty.call(t,e)}vt.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(var i in r)s3(r,i)&&(t[i]=r[i])}}return t};vt.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a3={arraySet:function(t,e,r,i,n){if(e.subarray&&t.subarray){t.set(e.subarray(r,r+i),n);return}for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){var e,r,i,n,s,a;for(i=0,e=0,r=t.length;e<r;e++)i+=t[e].length;for(a=new Uint8Array(i),n=0,e=0,r=t.length;e<r;e++)s=t[e],a.set(s,n),n+=s.length;return a}},o3={arraySet:function(t,e,r,i,n){for(var s=0;s<i;s++)t[n+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};vt.setTyped=function(t){t?(vt.Buf8=Uint8Array,vt.Buf16=Uint16Array,vt.Buf32=Int32Array,vt.assign(vt,a3)):(vt.Buf8=Array,vt.Buf16=Array,vt.Buf32=Array,vt.assign(vt,o3))};vt.setTyped(n3)});var EE=y(_s=>{"use strict";var l3=Pr(),u3=4,rE=0,iE=1,f3=2;function ys(t){for(var e=t.length;--e>=0;)t[e]=0}var h3=0,uE=1,c3=2,d3=3,p3=258,Pp=29,Oo=256,Co=Oo+1+Pp,vs=30,Lp=19,fE=2*Co+1,sn=15,Fp=16,g3=7,Bp=256,hE=16,cE=17,dE=18,Ip=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Wu=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],m3=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],pE=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],v3=512,Lr=new Array((Co+2)*2);ys(Lr);var Eo=new Array(vs*2);ys(Eo);var So=new Array(v3);ys(So);var ko=new Array(p3-d3+1);ys(ko);var jp=new Array(Pp);ys(jp);var $u=new Array(vs);ys($u);function Np(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}var gE,mE,vE;function Dp(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function yE(t){return t<256?So[t]:So[256+(t>>>7)]}function Ro(t,e){t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255}function Tt(t,e,r){t.bi_valid>Fp-r?(t.bi_buf|=e<<t.bi_valid&65535,Ro(t,t.bi_buf),t.bi_buf=e>>Fp-t.bi_valid,t.bi_valid+=r-Fp):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function hr(t,e,r){Tt(t,r[e*2],r[e*2+1])}function _E(t,e){var r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1}function y3(t){t.bi_valid===16?(Ro(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function _3(t,e){var r=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,u=e.stat_desc.max_length,f,h,g,m,c,d,v=0;for(m=0;m<=sn;m++)t.bl_count[m]=0;for(r[t.heap[t.heap_max]*2+1]=0,f=t.heap_max+1;f<fE;f++)h=t.heap[f],m=r[r[h*2+1]*2+1]+1,m>u&&(m=u,v++),r[h*2+1]=m,!(h>i)&&(t.bl_count[m]++,c=0,h>=o&&(c=a[h-o]),d=r[h*2],t.opt_len+=d*(m+c),s&&(t.static_len+=d*(n[h*2+1]+c)));if(v!==0){do{for(m=u-1;t.bl_count[m]===0;)m--;t.bl_count[m]--,t.bl_count[m+1]+=2,t.bl_count[u]--,v-=2}while(v>0);for(m=u;m!==0;m--)for(h=t.bl_count[m];h!==0;)g=t.heap[--f],!(g>i)&&(r[g*2+1]!==m&&(t.opt_len+=(m-r[g*2+1])*r[g*2],r[g*2+1]=m),h--)}}function wE(t,e,r){var i=new Array(sn+1),n=0,s,a;for(s=1;s<=sn;s++)i[s]=n=n+r[s-1]<<1;for(a=0;a<=e;a++){var o=t[a*2+1];o!==0&&(t[a*2]=_E(i[o]++,o))}}function w3(){var t,e,r,i,n,s=new Array(sn+1);for(r=0,i=0;i<Pp-1;i++)for(jp[i]=r,t=0;t<1<<Ip[i];t++)ko[r++]=i;for(ko[r-1]=i,n=0,i=0;i<16;i++)for($u[i]=n,t=0;t<1<<Wu[i];t++)So[n++]=i;for(n>>=7;i<vs;i++)for($u[i]=n<<7,t=0;t<1<<Wu[i]-7;t++)So[256+n++]=i;for(e=0;e<=sn;e++)s[e]=0;for(t=0;t<=143;)Lr[t*2+1]=8,t++,s[8]++;for(;t<=255;)Lr[t*2+1]=9,t++,s[9]++;for(;t<=279;)Lr[t*2+1]=7,t++,s[7]++;for(;t<=287;)Lr[t*2+1]=8,t++,s[8]++;for(wE(Lr,Co+1,s),t=0;t<vs;t++)Eo[t*2+1]=5,Eo[t*2]=_E(t,5);gE=new Np(Lr,Ip,Oo+1,Co,sn),mE=new Np(Eo,Wu,0,vs,sn),vE=new Np(new Array(0),m3,0,Lp,g3)}function bE(t){var e;for(e=0;e<Co;e++)t.dyn_ltree[e*2]=0;for(e=0;e<vs;e++)t.dyn_dtree[e*2]=0;for(e=0;e<Lp;e++)t.bl_tree[e*2]=0;t.dyn_ltree[Bp*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function xE(t){t.bi_valid>8?Ro(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function b3(t,e,r,i){xE(t),i&&(Ro(t,r),Ro(t,~r)),l3.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function nE(t,e,r,i){var n=e*2,s=r*2;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]}function qp(t,e,r){for(var i=t.heap[r],n=r<<1;n<=t.heap_len&&(n<t.heap_len&&nE(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!nE(e,i,t.heap[n],t.depth));)t.heap[r]=t.heap[n],r=n,n<<=1;t.heap[r]=i}function sE(t,e,r){var i,n,s=0,a,o;if(t.last_lit!==0)do i=t.pending_buf[t.d_buf+s*2]<<8|t.pending_buf[t.d_buf+s*2+1],n=t.pending_buf[t.l_buf+s],s++,i===0?hr(t,n,e):(a=ko[n],hr(t,a+Oo+1,e),o=Ip[a],o!==0&&(n-=jp[a],Tt(t,n,o)),i--,a=yE(i),hr(t,a,r),o=Wu[a],o!==0&&(i-=$u[a],Tt(t,i,o)));while(s<t.last_lit);hr(t,Bp,e)}function Mp(t,e){var r=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,a,o,u=-1,f;for(t.heap_len=0,t.heap_max=fE,a=0;a<s;a++)r[a*2]!==0?(t.heap[++t.heap_len]=u=a,t.depth[a]=0):r[a*2+1]=0;for(;t.heap_len<2;)f=t.heap[++t.heap_len]=u<2?++u:0,r[f*2]=1,t.depth[f]=0,t.opt_len--,n&&(t.static_len-=i[f*2+1]);for(e.max_code=u,a=t.heap_len>>1;a>=1;a--)qp(t,r,a);f=s;do a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],qp(t,r,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,r[f*2]=r[a*2]+r[o*2],t.depth[f]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,r[a*2+1]=r[o*2+1]=f,t.heap[1]=f++,qp(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],_3(t,e),wE(r,u,t.bl_count)}function aE(t,e,r){var i,n=-1,s,a=e[0*2+1],o=0,u=7,f=4;for(a===0&&(u=138,f=3),e[(r+1)*2+1]=65535,i=0;i<=r;i++)s=a,a=e[(i+1)*2+1],!(++o<u&&s===a)&&(o<f?t.bl_tree[s*2]+=o:s!==0?(s!==n&&t.bl_tree[s*2]++,t.bl_tree[hE*2]++):o<=10?t.bl_tree[cE*2]++:t.bl_tree[dE*2]++,o=0,n=s,a===0?(u=138,f=3):s===a?(u=6,f=3):(u=7,f=4))}function oE(t,e,r){var i,n=-1,s,a=e[0*2+1],o=0,u=7,f=4;for(a===0&&(u=138,f=3),i=0;i<=r;i++)if(s=a,a=e[(i+1)*2+1],!(++o<u&&s===a)){if(o<f)do hr(t,s,t.bl_tree);while(--o!==0);else s!==0?(s!==n&&(hr(t,s,t.bl_tree),o--),hr(t,hE,t.bl_tree),Tt(t,o-3,2)):o<=10?(hr(t,cE,t.bl_tree),Tt(t,o-3,3)):(hr(t,dE,t.bl_tree),Tt(t,o-11,7));o=0,n=s,a===0?(u=138,f=3):s===a?(u=6,f=3):(u=7,f=4)}}function x3(t){var e;for(aE(t,t.dyn_ltree,t.l_desc.max_code),aE(t,t.dyn_dtree,t.d_desc.max_code),Mp(t,t.bl_desc),e=Lp-1;e>=3&&t.bl_tree[pE[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e}function T3(t,e,r,i){var n;for(Tt(t,e-257,5),Tt(t,r-1,5),Tt(t,i-4,4),n=0;n<i;n++)Tt(t,t.bl_tree[pE[n]*2+1],3);oE(t,t.dyn_ltree,e-1),oE(t,t.dyn_dtree,r-1)}function E3(t){var e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return rE;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return iE;for(r=32;r<Oo;r++)if(t.dyn_ltree[r*2]!==0)return iE;return rE}var lE=!1;function C3(t){lE||(w3(),lE=!0),t.l_desc=new Dp(t.dyn_ltree,gE),t.d_desc=new Dp(t.dyn_dtree,mE),t.bl_desc=new Dp(t.bl_tree,vE),t.bi_buf=0,t.bi_valid=0,bE(t)}function TE(t,e,r,i){Tt(t,(h3<<1)+(i?1:0),3),b3(t,e,r,!0)}function S3(t){Tt(t,uE<<1,3),hr(t,Bp,Lr),y3(t)}function k3(t,e,r,i){var n,s,a=0;t.level>0?(t.strm.data_type===f3&&(t.strm.data_type=E3(t)),Mp(t,t.l_desc),Mp(t,t.d_desc),a=x3(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&e!==-1?TE(t,e,r,i):t.strategy===u3||s===n?(Tt(t,(uE<<1)+(i?1:0),3),sE(t,Lr,Eo)):(Tt(t,(c3<<1)+(i?1:0),3),T3(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),sE(t,t.dyn_ltree,t.dyn_dtree)),bE(t),i&&xE(t)}function R3(t,e,r){return t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(ko[r]+Oo+1)*2]++,t.dyn_dtree[yE(e)*2]++),t.last_lit===t.lit_bufsize-1}_s._tr_init=C3;_s._tr_stored_block=TE;_s._tr_flush_block=k3;_s._tr_tally=R3;_s._tr_align=S3});var Wp=y((Qse,CE)=>{"use strict";function O3(t,e,r,i){for(var n=t&65535|0,s=t>>>16&65535|0,a=0;r!==0;){a=r>2e3?2e3:r,r-=a;do n=n+e[i++]|0,s=s+n|0;while(--a);n%=65521,s%=65521}return n|s<<16|0}CE.exports=O3});var $p=y((Jse,SE)=>{"use strict";function A3(){for(var t,e=[],r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e}var F3=A3();function N3(t,e,r,i){var n=F3,s=i+r;t^=-1;for(var a=i;a<s;a++)t=t>>>8^n[(t^e[a])&255];return t^-1}SE.exports=N3});var Hu=y((eae,kE)=>{"use strict";kE.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var ME=y(pr=>{"use strict";var yt=Pr(),Lt=EE(),FE=Wp(),di=$p(),D3=Hu(),un=0,q3=1,I3=3,yi=4,RE=5,dr=0,OE=1,Bt=-2,M3=-3,Hp=-5,P3=-1,L3=1,Uu=2,B3=3,j3=4,W3=0,$3=2,Gu=8,H3=9,U3=15,z3=8,X3=29,V3=256,zp=V3+1+X3,G3=30,Z3=19,Y3=2*zp+1,K3=15,oe=3,mi=258,Qt=mi+oe+1,Q3=32,Zu=42,Xp=69,zu=73,Xu=91,Vu=103,an=113,Fo=666,Ve=1,No=2,on=3,xs=4,J3=3;function vi(t,e){return t.msg=D3[e],e}function AE(t){return(t<<1)-(t>4?9:0)}function gi(t){for(var e=t.length;--e>=0;)t[e]=0}function pi(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(yt.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))}function it(t,e){Lt._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,pi(t.strm)}function de(t,e){t.pending_buf[t.pending++]=e}function Ao(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255}function e4(t,e,r,i){var n=t.avail_in;return n>i&&(n=i),n===0?0:(t.avail_in-=n,yt.arraySet(e,t.input,t.next_in,n,r),t.state.wrap===1?t.adler=FE(t.adler,e,n,r):t.state.wrap===2&&(t.adler=di(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)}function NE(t,e){var r=t.max_chain_length,i=t.strstart,n,s,a=t.prev_length,o=t.nice_match,u=t.strstart>t.w_size-Qt?t.strstart-(t.w_size-Qt):0,f=t.window,h=t.w_mask,g=t.prev,m=t.strstart+mi,c=f[i+a-1],d=f[i+a];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do if(n=e,!(f[n+a]!==d||f[n+a-1]!==c||f[n]!==f[i]||f[++n]!==f[i+1])){i+=2,n++;do;while(f[++i]===f[++n]&&f[++i]===f[++n]&&f[++i]===f[++n]&&f[++i]===f[++n]&&f[++i]===f[++n]&&f[++i]===f[++n]&&f[++i]===f[++n]&&f[++i]===f[++n]&&i<m);if(s=mi-(m-i),i=m-mi,s>a){if(t.match_start=e,a=s,s>=o)break;c=f[i+a-1],d=f[i+a]}}while((e=g[e&h])>u&&--r!==0);return a<=t.lookahead?a:t.lookahead}function ln(t){var e=t.w_size,r,i,n,s,a;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Qt)){yt.arraySet(t.window,t.window,e,e,0),t.match_start-=e,t.strstart-=e,t.block_start-=e,i=t.hash_size,r=i;do n=t.head[--r],t.head[r]=n>=e?n-e:0;while(--i);i=e,r=i;do n=t.prev[--r],t.prev[r]=n>=e?n-e:0;while(--i);s+=e}if(t.strm.avail_in===0)break;if(i=e4(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=i,t.lookahead+t.insert>=oe)for(a=t.strstart-t.insert,t.ins_h=t.window[a],t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[a+oe-1])&t.hash_mask,t.prev[a&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=a,a++,t.insert--,!(t.lookahead+t.insert<oe)););}while(t.lookahead<Qt&&t.strm.avail_in!==0)}function t4(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ln(t),t.lookahead===0&&e===un)return Ve;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+r;if((t.strstart===0||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,it(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Qt&&(it(t,!1),t.strm.avail_out===0))return Ve}return t.insert=0,e===yi?(it(t,!0),t.strm.avail_out===0?on:xs):(t.strstart>t.block_start&&(it(t,!1),t.strm.avail_out===0),Ve)}function Up(t,e){for(var r,i;;){if(t.lookahead<Qt){if(ln(t),t.lookahead<Qt&&e===un)return Ve;if(t.lookahead===0)break}if(r=0,t.lookahead>=oe&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+oe-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Qt&&(t.match_length=NE(t,r)),t.match_length>=oe)if(i=Lt._tr_tally(t,t.strstart-t.match_start,t.match_length-oe),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=oe){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+oe-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=Lt._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(it(t,!1),t.strm.avail_out===0))return Ve}return t.insert=t.strstart<oe-1?t.strstart:oe-1,e===yi?(it(t,!0),t.strm.avail_out===0?on:xs):t.last_lit&&(it(t,!1),t.strm.avail_out===0)?Ve:No}function ws(t,e){for(var r,i,n;;){if(t.lookahead<Qt){if(ln(t),t.lookahead<Qt&&e===un)return Ve;if(t.lookahead===0)break}if(r=0,t.lookahead>=oe&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+oe-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=oe-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Qt&&(t.match_length=NE(t,r),t.match_length<=5&&(t.strategy===L3||t.match_length===oe&&t.strstart-t.match_start>4096)&&(t.match_length=oe-1)),t.prev_length>=oe&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-oe,i=Lt._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-oe),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+oe-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=oe-1,t.strstart++,i&&(it(t,!1),t.strm.avail_out===0))return Ve}else if(t.match_available){if(i=Lt._tr_tally(t,0,t.window[t.strstart-1]),i&&it(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Ve}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Lt._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<oe-1?t.strstart:oe-1,e===yi?(it(t,!0),t.strm.avail_out===0?on:xs):t.last_lit&&(it(t,!1),t.strm.avail_out===0)?Ve:No}function r4(t,e){for(var r,i,n,s,a=t.window;;){if(t.lookahead<=mi){if(ln(t),t.lookahead<=mi&&e===un)return Ve;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=oe&&t.strstart>0&&(n=t.strstart-1,i=a[n],i===a[++n]&&i===a[++n]&&i===a[++n])){s=t.strstart+mi;do;while(i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&i===a[++n]&&n<s);t.match_length=mi-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=oe?(r=Lt._tr_tally(t,1,t.match_length-oe),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Lt._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(it(t,!1),t.strm.avail_out===0))return Ve}return t.insert=0,e===yi?(it(t,!0),t.strm.avail_out===0?on:xs):t.last_lit&&(it(t,!1),t.strm.avail_out===0)?Ve:No}function i4(t,e){for(var r;;){if(t.lookahead===0&&(ln(t),t.lookahead===0)){if(e===un)return Ve;break}if(t.match_length=0,r=Lt._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(it(t,!1),t.strm.avail_out===0))return Ve}return t.insert=0,e===yi?(it(t,!0),t.strm.avail_out===0?on:xs):t.last_lit&&(it(t,!1),t.strm.avail_out===0)?Ve:No}function cr(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}var bs;bs=[new cr(0,0,0,0,t4),new cr(4,4,8,4,Up),new cr(4,5,16,8,Up),new cr(4,6,32,32,Up),new cr(4,4,16,16,ws),new cr(8,16,32,32,ws),new cr(8,16,128,128,ws),new cr(8,32,128,256,ws),new cr(32,128,258,1024,ws),new cr(32,258,258,4096,ws)];function n4(t){t.window_size=2*t.w_size,gi(t.head),t.max_lazy_match=bs[t.level].max_lazy,t.good_match=bs[t.level].good_length,t.nice_match=bs[t.level].nice_length,t.max_chain_length=bs[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=oe-1,t.match_available=0,t.ins_h=0}function s4(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Gu,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new yt.Buf16(Y3*2),this.dyn_dtree=new yt.Buf16((2*G3+1)*2),this.bl_tree=new yt.Buf16((2*Z3+1)*2),gi(this.dyn_ltree),gi(this.dyn_dtree),gi(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new yt.Buf16(K3+1),this.heap=new yt.Buf16(2*zp+1),gi(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new yt.Buf16(2*zp+1),gi(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function DE(t){var e;return!t||!t.state?vi(t,Bt):(t.total_in=t.total_out=0,t.data_type=$3,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Zu:an,t.adler=e.wrap===2?0:1,e.last_flush=un,Lt._tr_init(e),dr)}function qE(t){var e=DE(t);return e===dr&&n4(t.state),e}function a4(t,e){return!t||!t.state||t.state.wrap!==2?Bt:(t.state.gzhead=e,dr)}function IE(t,e,r,i,n,s){if(!t)return Bt;var a=1;if(e===P3&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),n<1||n>H3||r!==Gu||i<8||i>15||e<0||e>9||s<0||s>j3)return vi(t,Bt);i===8&&(i=9);var o=new s4;return t.state=o,o.strm=t,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+oe-1)/oe),o.window=new yt.Buf8(o.w_size*2),o.head=new yt.Buf16(o.hash_size),o.prev=new yt.Buf16(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new yt.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=e,o.strategy=s,o.method=r,qE(t)}function o4(t,e){return IE(t,e,Gu,U3,z3,W3)}function l4(t,e){var r,i,n,s;if(!t||!t.state||e>RE||e<0)return t?vi(t,Bt):Bt;if(i=t.state,!t.output||!t.input&&t.avail_in!==0||i.status===Fo&&e!==yi)return vi(t,t.avail_out===0?Hp:Bt);if(i.strm=t,r=i.last_flush,i.last_flush=e,i.status===Zu)if(i.wrap===2)t.adler=0,de(i,31),de(i,139),de(i,8),i.gzhead?(de(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),de(i,i.gzhead.time&255),de(i,i.gzhead.time>>8&255),de(i,i.gzhead.time>>16&255),de(i,i.gzhead.time>>24&255),de(i,i.level===9?2:i.strategy>=Uu||i.level<2?4:0),de(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(de(i,i.gzhead.extra.length&255),de(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=di(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Xp):(de(i,0),de(i,0),de(i,0),de(i,0),de(i,0),de(i,i.level===9?2:i.strategy>=Uu||i.level<2?4:0),de(i,J3),i.status=an);else{var a=Gu+(i.w_bits-8<<4)<<8,o=-1;i.strategy>=Uu||i.level<2?o=0:i.level<6?o=1:i.level===6?o=2:o=3,a|=o<<6,i.strstart!==0&&(a|=Q3),a+=31-a%31,i.status=an,Ao(i,a),i.strstart!==0&&(Ao(i,t.adler>>>16),Ao(i,t.adler&65535)),t.adler=1}if(i.status===Xp)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=di(t.adler,i.pending_buf,i.pending-n,n)),pi(t),n=i.pending,i.pending===i.pending_buf_size));)de(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(t.adler=di(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=zu)}else i.status=zu;if(i.status===zu)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=di(t.adler,i.pending_buf,i.pending-n,n)),pi(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,de(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(t.adler=di(t.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.gzindex=0,i.status=Xu)}else i.status=Xu;if(i.status===Xu)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(t.adler=di(t.adler,i.pending_buf,i.pending-n,n)),pi(t),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,de(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(t.adler=di(t.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.status=Vu)}else i.status=Vu;if(i.status===Vu&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&pi(t),i.pending+2<=i.pending_buf_size&&(de(i,t.adler&255),de(i,t.adler>>8&255),t.adler=0,i.status=an)):i.status=an),i.pending!==0){if(pi(t),t.avail_out===0)return i.last_flush=-1,dr}else if(t.avail_in===0&&AE(e)<=AE(r)&&e!==yi)return vi(t,Hp);if(i.status===Fo&&t.avail_in!==0)return vi(t,Hp);if(t.avail_in!==0||i.lookahead!==0||e!==un&&i.status!==Fo){var u=i.strategy===Uu?i4(i,e):i.strategy===B3?r4(i,e):bs[i.level].func(i,e);if((u===on||u===xs)&&(i.status=Fo),u===Ve||u===on)return t.avail_out===0&&(i.last_flush=-1),dr;if(u===No&&(e===q3?Lt._tr_align(i):e!==RE&&(Lt._tr_stored_block(i,0,0,!1),e===I3&&(gi(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),pi(t),t.avail_out===0))return i.last_flush=-1,dr}return e!==yi?dr:i.wrap<=0?OE:(i.wrap===2?(de(i,t.adler&255),de(i,t.adler>>8&255),de(i,t.adler>>16&255),de(i,t.adler>>24&255),de(i,t.total_in&255),de(i,t.total_in>>8&255),de(i,t.total_in>>16&255),de(i,t.total_in>>24&255)):(Ao(i,t.adler>>>16),Ao(i,t.adler&65535)),pi(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?dr:OE)}function u4(t){var e;return!t||!t.state?Bt:(e=t.state.status,e!==Zu&&e!==Xp&&e!==zu&&e!==Xu&&e!==Vu&&e!==an&&e!==Fo?vi(t,Bt):(t.state=null,e===an?vi(t,M3):dr))}function f4(t,e){var r=e.length,i,n,s,a,o,u,f,h;if(!t||!t.state||(i=t.state,a=i.wrap,a===2||a===1&&i.status!==Zu||i.lookahead))return Bt;for(a===1&&(t.adler=FE(t.adler,e,r,0)),i.wrap=0,r>=i.w_size&&(a===0&&(gi(i.head),i.strstart=0,i.block_start=0,i.insert=0),h=new yt.Buf8(i.w_size),yt.arraySet(h,e,r-i.w_size,i.w_size,0),e=h,r=i.w_size),o=t.avail_in,u=t.next_in,f=t.input,t.avail_in=r,t.next_in=0,t.input=e,ln(i);i.lookahead>=oe;){n=i.strstart,s=i.lookahead-(oe-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+oe-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++;while(--s);i.strstart=n,i.lookahead=oe-1,ln(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=oe-1,i.match_available=0,t.next_in=u,t.input=f,t.avail_in=o,i.wrap=a,dr}pr.deflateInit=o4;pr.deflateInit2=IE;pr.deflateReset=qE;pr.deflateResetKeep=DE;pr.deflateSetHeader=a4;pr.deflate=l4;pr.deflateEnd=u4;pr.deflateSetDictionary=f4;pr.deflateInfo="pako deflate (from Nodeca project)"});var Vp=y(Ts=>{"use strict";var Yu=Pr(),PE=!0,LE=!0;try{String.fromCharCode.apply(null,[0])}catch{PE=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{LE=!1}var Do=new Yu.Buf8(256);for(Br=0;Br<256;Br++)Do[Br]=Br>=252?6:Br>=248?5:Br>=240?4:Br>=224?3:Br>=192?2:1;var Br;Do[254]=Do[254]=1;Ts.string2buf=function(t){var e,r,i,n,s,a=t.length,o=0;for(n=0;n<a;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<a&&(i=t.charCodeAt(n+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Yu.Buf8(o),s=0,n=0;s<o;n++)r=t.charCodeAt(n),(r&64512)===55296&&n+1<a&&(i=t.charCodeAt(n+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|r&63):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|r&63):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|r&63);return e};function BE(t,e){if(e<65534&&(t.subarray&&LE||!t.subarray&&PE))return String.fromCharCode.apply(null,Yu.shrinkBuf(t,e));for(var r="",i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r}Ts.buf2binstring=function(t){return BE(t,t.length)};Ts.binstring2buf=function(t){for(var e=new Yu.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e};Ts.buf2string=function(t,e){var r,i,n,s,a=e||t.length,o=new Array(a*2);for(i=0,r=0;r<a;){if(n=t[r++],n<128){o[i++]=n;continue}if(s=Do[n],s>4){o[i++]=65533,r+=s-1;continue}for(n&=s===2?31:s===3?15:7;s>1&&r<a;)n=n<<6|t[r++]&63,s--;if(s>1){o[i++]=65533;continue}n<65536?o[i++]=n:(n-=65536,o[i++]=55296|n>>10&1023,o[i++]=56320|n&1023)}return BE(o,i)};Ts.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Do[t[r]]>e?r:e}});var Gp=y((iae,jE)=>{"use strict";function h4(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}jE.exports=h4});var UE=y(Mo=>{"use strict";var qo=ME(),Io=Pr(),Yp=Vp(),Kp=Hu(),c4=Gp(),HE=Object.prototype.toString,d4=0,Zp=4,Es=0,WE=1,$E=2,p4=-1,g4=0,m4=8;function fn(t){if(!(this instanceof fn))return new fn(t);this.options=Io.assign({level:p4,method:m4,chunkSize:16384,windowBits:15,memLevel:8,strategy:g4,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c4,this.strm.avail_out=0;var r=qo.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==Es)throw new Error(Kp[r]);if(e.header&&qo.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=Yp.string2buf(e.dictionary):HE.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,r=qo.deflateSetDictionary(this.strm,i),r!==Es)throw new Error(Kp[r]);this._dict_set=!0}}fn.prototype.push=function(t,e){var r=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;s=e===~~e?e:e===!0?Zp:d4,typeof t=="string"?r.input=Yp.string2buf(t):HE.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new Io.Buf8(i),r.next_out=0,r.avail_out=i),n=qo.deflate(r,s),n!==WE&&n!==Es)return this.onEnd(n),this.ended=!0,!1;(r.avail_out===0||r.avail_in===0&&(s===Zp||s===$E))&&(this.options.to==="string"?this.onData(Yp.buf2binstring(Io.shrinkBuf(r.output,r.next_out))):this.onData(Io.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||r.avail_out===0)&&n!==WE);return s===Zp?(n=qo.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Es):(s===$E&&(this.onEnd(Es),r.avail_out=0),!0)};fn.prototype.onData=function(t){this.chunks.push(t)};fn.prototype.onEnd=function(t){t===Es&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Io.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Qp(t,e){var r=new fn(e);if(r.push(t,!0),r.err)throw r.msg||Kp[r.err];return r.result}function v4(t,e){return e=e||{},e.raw=!0,Qp(t,e)}function y4(t,e){return e=e||{},e.gzip=!0,Qp(t,e)}Mo.Deflate=fn;Mo.deflate=Qp;Mo.deflateRaw=v4;Mo.gzip=y4});var XE=y((sae,zE)=>{"use strict";var Ku=30,_4=12;zE.exports=function(e,r){var i,n,s,a,o,u,f,h,g,m,c,d,v,w,b,C,O,R,M,X,H,W,P,G,q;i=e.state,n=e.next_in,G=e.input,s=n+(e.avail_in-5),a=e.next_out,q=e.output,o=a-(r-e.avail_out),u=a+(e.avail_out-257),f=i.dmax,h=i.wsize,g=i.whave,m=i.wnext,c=i.window,d=i.hold,v=i.bits,w=i.lencode,b=i.distcode,C=(1<<i.lenbits)-1,O=(1<<i.distbits)-1;e:do{v<15&&(d+=G[n++]<<v,v+=8,d+=G[n++]<<v,v+=8),R=w[d&C];t:for(;;){if(M=R>>>24,d>>>=M,v-=M,M=R>>>16&255,M===0)q[a++]=R&65535;else if(M&16){X=R&65535,M&=15,M&&(v<M&&(d+=G[n++]<<v,v+=8),X+=d&(1<<M)-1,d>>>=M,v-=M),v<15&&(d+=G[n++]<<v,v+=8,d+=G[n++]<<v,v+=8),R=b[d&O];r:for(;;){if(M=R>>>24,d>>>=M,v-=M,M=R>>>16&255,M&16){if(H=R&65535,M&=15,v<M&&(d+=G[n++]<<v,v+=8,v<M&&(d+=G[n++]<<v,v+=8)),H+=d&(1<<M)-1,H>f){e.msg="invalid distance too far back",i.mode=Ku;break e}if(d>>>=M,v-=M,M=a-o,H>M){if(M=H-M,M>g&&i.sane){e.msg="invalid distance too far back",i.mode=Ku;break e}if(W=0,P=c,m===0){if(W+=h-M,M<X){X-=M;do q[a++]=c[W++];while(--M);W=a-H,P=q}}else if(m<M){if(W+=h+m-M,M-=m,M<X){X-=M;do q[a++]=c[W++];while(--M);if(W=0,m<X){M=m,X-=M;do q[a++]=c[W++];while(--M);W=a-H,P=q}}}else if(W+=m-M,M<X){X-=M;do q[a++]=c[W++];while(--M);W=a-H,P=q}for(;X>2;)q[a++]=P[W++],q[a++]=P[W++],q[a++]=P[W++],X-=3;X&&(q[a++]=P[W++],X>1&&(q[a++]=P[W++]))}else{W=a-H;do q[a++]=q[W++],q[a++]=q[W++],q[a++]=q[W++],X-=3;while(X>2);X&&(q[a++]=q[W++],X>1&&(q[a++]=q[W++]))}}else if((M&64)===0){R=b[(R&65535)+(d&(1<<M)-1)];continue r}else{e.msg="invalid distance code",i.mode=Ku;break e}break}}else if((M&64)===0){R=w[(R&65535)+(d&(1<<M)-1)];continue t}else if(M&32){i.mode=_4;break e}else{e.msg="invalid literal/length code",i.mode=Ku;break e}break}}while(n<s&&a<u);X=v>>3,n-=X,v-=X<<3,d&=(1<<v)-1,e.next_in=n,e.next_out=a,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=a<u?257+(u-a):257-(a-u),i.hold=d,i.bits=v}});var JE=y((aae,QE)=>{"use strict";var VE=Pr(),Cs=15,GE=852,ZE=592,YE=0,Jp=1,KE=2,w4=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],b4=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],x4=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],T4=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];QE.exports=function(e,r,i,n,s,a,o,u){var f=u.bits,h=0,g=0,m=0,c=0,d=0,v=0,w=0,b=0,C=0,O=0,R,M,X,H,W,P=null,G=0,q,E=new VE.Buf16(Cs+1),A=new VE.Buf16(Cs+1),$=null,B=0,T,k,N;for(h=0;h<=Cs;h++)E[h]=0;for(g=0;g<n;g++)E[r[i+g]]++;for(d=f,c=Cs;c>=1&&E[c]===0;c--);if(d>c&&(d=c),c===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,u.bits=1,0;for(m=1;m<c&&E[m]===0;m++);for(d<m&&(d=m),b=1,h=1;h<=Cs;h++)if(b<<=1,b-=E[h],b<0)return-1;if(b>0&&(e===YE||c!==1))return-1;for(A[1]=0,h=1;h<Cs;h++)A[h+1]=A[h]+E[h];for(g=0;g<n;g++)r[i+g]!==0&&(o[A[r[i+g]]++]=g);if(e===YE?(P=$=o,q=19):e===Jp?(P=w4,G-=257,$=b4,B-=257,q=256):(P=x4,$=T4,q=-1),O=0,g=0,h=m,W=a,v=d,w=0,X=-1,C=1<<d,H=C-1,e===Jp&&C>GE||e===KE&&C>ZE)return 1;for(;;){T=h-w,o[g]<q?(k=0,N=o[g]):o[g]>q?(k=$[B+o[g]],N=P[G+o[g]]):(k=32+64,N=0),R=1<<h-w,M=1<<v,m=M;do M-=R,s[W+(O>>w)+M]=T<<24|k<<16|N|0;while(M!==0);for(R=1<<h-1;O&R;)R>>=1;if(R!==0?(O&=R-1,O+=R):O=0,g++,--E[h]===0){if(h===c)break;h=r[i+o[g]]}if(h>d&&(O&H)!==X){for(w===0&&(w=d),W+=m,v=h-w,b=1<<v;v+w<c&&(b-=E[v+w],!(b<=0));)v++,b<<=1;if(C+=1<<v,e===Jp&&C>GE||e===KE&&C>ZE)return 1;X=O&H,s[X]=d<<24|v<<16|W-a|0}}return O!==0&&(s[W+O]=h-w<<24|64<<16|0),u.bits=d,0}});var q1=y(Jt=>{"use strict";var Dt=Pr(),sg=Wp(),gr=$p(),E4=XE(),Po=JE(),C4=0,C1=1,S1=2,e1=4,S4=5,Qu=6,hn=0,k4=1,R4=2,jt=-2,k1=-3,ag=-4,O4=-5,t1=8,R1=1,r1=2,i1=3,n1=4,s1=5,a1=6,o1=7,l1=8,u1=9,f1=10,tf=11,jr=12,eg=13,h1=14,tg=15,c1=16,d1=17,p1=18,g1=19,Ju=20,ef=21,m1=22,v1=23,y1=24,_1=25,w1=26,rg=27,b1=28,x1=29,qe=30,og=31,A4=32,F4=852,N4=592,D4=15,q4=D4;function T1(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function I4(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Dt.Buf16(320),this.work=new Dt.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function O1(t){var e;return!t||!t.state?jt:(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=R1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Dt.Buf32(F4),e.distcode=e.distdyn=new Dt.Buf32(N4),e.sane=1,e.back=-1,hn)}function A1(t){var e;return!t||!t.state?jt:(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,O1(t))}function F1(t,e){var r,i;return!t||!t.state||(i=t.state,e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?jt:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,A1(t))}function N1(t,e){var r,i;return t?(i=new I4,t.state=i,i.window=null,r=F1(t,e),r!==hn&&(t.state=null),r):jt}function M4(t){return N1(t,q4)}var E1=!0,ig,ng;function P4(t){if(E1){var e;for(ig=new Dt.Buf32(512),ng=new Dt.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Po(C1,t.lens,0,288,ig,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Po(S1,t.lens,0,32,ng,0,t.work,{bits:5}),E1=!1}t.lencode=ig,t.lenbits=9,t.distcode=ng,t.distbits=5}function D1(t,e,r,i){var n,s=t.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Dt.Buf8(s.wsize)),i>=s.wsize?(Dt.arraySet(s.window,e,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),Dt.arraySet(s.window,e,r-i,n,s.wnext),i-=n,i?(Dt.arraySet(s.window,e,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function L4(t,e){var r,i,n,s,a,o,u,f,h,g,m,c,d,v,w=0,b,C,O,R,M,X,H,W,P=new Dt.Buf8(4),G,q,E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return jt;r=t.state,r.mode===jr&&(r.mode=eg),a=t.next_out,n=t.output,u=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,f=r.hold,h=r.bits,g=o,m=u,W=hn;e:for(;;)switch(r.mode){case R1:if(r.wrap===0){r.mode=eg;break}for(;h<16;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if(r.wrap&2&&f===35615){r.check=0,P[0]=f&255,P[1]=f>>>8&255,r.check=gr(r.check,P,2,0),f=0,h=0,r.mode=r1;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((f&255)<<8)+(f>>8))%31){t.msg="incorrect header check",r.mode=qe;break}if((f&15)!==t1){t.msg="unknown compression method",r.mode=qe;break}if(f>>>=4,h-=4,H=(f&15)+8,r.wbits===0)r.wbits=H;else if(H>r.wbits){t.msg="invalid window size",r.mode=qe;break}r.dmax=1<<H,t.adler=r.check=1,r.mode=f&512?f1:jr,f=0,h=0;break;case r1:for(;h<16;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if(r.flags=f,(r.flags&255)!==t1){t.msg="unknown compression method",r.mode=qe;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=qe;break}r.head&&(r.head.text=f>>8&1),r.flags&512&&(P[0]=f&255,P[1]=f>>>8&255,r.check=gr(r.check,P,2,0)),f=0,h=0,r.mode=i1;case i1:for(;h<32;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}r.head&&(r.head.time=f),r.flags&512&&(P[0]=f&255,P[1]=f>>>8&255,P[2]=f>>>16&255,P[3]=f>>>24&255,r.check=gr(r.check,P,4,0)),f=0,h=0,r.mode=n1;case n1:for(;h<16;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}r.head&&(r.head.xflags=f&255,r.head.os=f>>8),r.flags&512&&(P[0]=f&255,P[1]=f>>>8&255,r.check=gr(r.check,P,2,0)),f=0,h=0,r.mode=s1;case s1:if(r.flags&1024){for(;h<16;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}r.length=f,r.head&&(r.head.extra_len=f),r.flags&512&&(P[0]=f&255,P[1]=f>>>8&255,r.check=gr(r.check,P,2,0)),f=0,h=0}else r.head&&(r.head.extra=null);r.mode=a1;case a1:if(r.flags&1024&&(c=r.length,c>o&&(c=o),c&&(r.head&&(H=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),Dt.arraySet(r.head.extra,i,s,c,H)),r.flags&512&&(r.check=gr(r.check,i,c,s)),o-=c,s+=c,r.length-=c),r.length))break e;r.length=0,r.mode=o1;case o1:if(r.flags&2048){if(o===0)break e;c=0;do H=i[s+c++],r.head&&H&&r.length<65536&&(r.head.name+=String.fromCharCode(H));while(H&&c<o);if(r.flags&512&&(r.check=gr(r.check,i,c,s)),o-=c,s+=c,H)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=l1;case l1:if(r.flags&4096){if(o===0)break e;c=0;do H=i[s+c++],r.head&&H&&r.length<65536&&(r.head.comment+=String.fromCharCode(H));while(H&&c<o);if(r.flags&512&&(r.check=gr(r.check,i,c,s)),o-=c,s+=c,H)break e}else r.head&&(r.head.comment=null);r.mode=u1;case u1:if(r.flags&512){for(;h<16;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if(f!==(r.check&65535)){t.msg="header crc mismatch",r.mode=qe;break}f=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=jr;break;case f1:for(;h<32;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}t.adler=r.check=T1(f),f=0,h=0,r.mode=tf;case tf:if(r.havedict===0)return t.next_out=a,t.avail_out=u,t.next_in=s,t.avail_in=o,r.hold=f,r.bits=h,R4;t.adler=r.check=1,r.mode=jr;case jr:if(e===S4||e===Qu)break e;case eg:if(r.last){f>>>=h&7,h-=h&7,r.mode=rg;break}for(;h<3;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}switch(r.last=f&1,f>>>=1,h-=1,f&3){case 0:r.mode=h1;break;case 1:if(P4(r),r.mode=Ju,e===Qu){f>>>=2,h-=2;break e}break;case 2:r.mode=d1;break;case 3:t.msg="invalid block type",r.mode=qe}f>>>=2,h-=2;break;case h1:for(f>>>=h&7,h-=h&7;h<32;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if((f&65535)!==(f>>>16^65535)){t.msg="invalid stored block lengths",r.mode=qe;break}if(r.length=f&65535,f=0,h=0,r.mode=tg,e===Qu)break e;case tg:r.mode=c1;case c1:if(c=r.length,c){if(c>o&&(c=o),c>u&&(c=u),c===0)break e;Dt.arraySet(n,i,s,c,a),o-=c,s+=c,u-=c,a+=c,r.length-=c;break}r.mode=jr;break;case d1:for(;h<14;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if(r.nlen=(f&31)+257,f>>>=5,h-=5,r.ndist=(f&31)+1,f>>>=5,h-=5,r.ncode=(f&15)+4,f>>>=4,h-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=qe;break}r.have=0,r.mode=p1;case p1:for(;r.have<r.ncode;){for(;h<3;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}r.lens[E[r.have++]]=f&7,f>>>=3,h-=3}for(;r.have<19;)r.lens[E[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,G={bits:r.lenbits},W=Po(C4,r.lens,0,19,r.lencode,0,r.work,G),r.lenbits=G.bits,W){t.msg="invalid code lengths set",r.mode=qe;break}r.have=0,r.mode=g1;case g1:for(;r.have<r.nlen+r.ndist;){for(;w=r.lencode[f&(1<<r.lenbits)-1],b=w>>>24,C=w>>>16&255,O=w&65535,!(b<=h);){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if(O<16)f>>>=b,h-=b,r.lens[r.have++]=O;else{if(O===16){for(q=b+2;h<q;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if(f>>>=b,h-=b,r.have===0){t.msg="invalid bit length repeat",r.mode=qe;break}H=r.lens[r.have-1],c=3+(f&3),f>>>=2,h-=2}else if(O===17){for(q=b+3;h<q;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}f>>>=b,h-=b,H=0,c=3+(f&7),f>>>=3,h-=3}else{for(q=b+7;h<q;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}f>>>=b,h-=b,H=0,c=11+(f&127),f>>>=7,h-=7}if(r.have+c>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=qe;break}for(;c--;)r.lens[r.have++]=H}}if(r.mode===qe)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=qe;break}if(r.lenbits=9,G={bits:r.lenbits},W=Po(C1,r.lens,0,r.nlen,r.lencode,0,r.work,G),r.lenbits=G.bits,W){t.msg="invalid literal/lengths set",r.mode=qe;break}if(r.distbits=6,r.distcode=r.distdyn,G={bits:r.distbits},W=Po(S1,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,G),r.distbits=G.bits,W){t.msg="invalid distances set",r.mode=qe;break}if(r.mode=Ju,e===Qu)break e;case Ju:r.mode=ef;case ef:if(o>=6&&u>=258){t.next_out=a,t.avail_out=u,t.next_in=s,t.avail_in=o,r.hold=f,r.bits=h,E4(t,m),a=t.next_out,n=t.output,u=t.avail_out,s=t.next_in,i=t.input,o=t.avail_in,f=r.hold,h=r.bits,r.mode===jr&&(r.back=-1);break}for(r.back=0;w=r.lencode[f&(1<<r.lenbits)-1],b=w>>>24,C=w>>>16&255,O=w&65535,!(b<=h);){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if(C&&(C&240)===0){for(R=b,M=C,X=O;w=r.lencode[X+((f&(1<<R+M)-1)>>R)],b=w>>>24,C=w>>>16&255,O=w&65535,!(R+b<=h);){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}f>>>=R,h-=R,r.back+=R}if(f>>>=b,h-=b,r.back+=b,r.length=O,C===0){r.mode=w1;break}if(C&32){r.back=-1,r.mode=jr;break}if(C&64){t.msg="invalid literal/length code",r.mode=qe;break}r.extra=C&15,r.mode=m1;case m1:if(r.extra){for(q=r.extra;h<q;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=v1;case v1:for(;w=r.distcode[f&(1<<r.distbits)-1],b=w>>>24,C=w>>>16&255,O=w&65535,!(b<=h);){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if((C&240)===0){for(R=b,M=C,X=O;w=r.distcode[X+((f&(1<<R+M)-1)>>R)],b=w>>>24,C=w>>>16&255,O=w&65535,!(R+b<=h);){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}f>>>=R,h-=R,r.back+=R}if(f>>>=b,h-=b,r.back+=b,C&64){t.msg="invalid distance code",r.mode=qe;break}r.offset=O,r.extra=C&15,r.mode=y1;case y1:if(r.extra){for(q=r.extra;h<q;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=qe;break}r.mode=_1;case _1:if(u===0)break e;if(c=m-u,r.offset>c){if(c=r.offset-c,c>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=qe;break}c>r.wnext?(c-=r.wnext,d=r.wsize-c):d=r.wnext-c,c>r.length&&(c=r.length),v=r.window}else v=n,d=a-r.offset,c=r.length;c>u&&(c=u),u-=c,r.length-=c;do n[a++]=v[d++];while(--c);r.length===0&&(r.mode=ef);break;case w1:if(u===0)break e;n[a++]=r.length,u--,r.mode=ef;break;case rg:if(r.wrap){for(;h<32;){if(o===0)break e;o--,f|=i[s++]<<h,h+=8}if(m-=u,t.total_out+=m,r.total+=m,m&&(t.adler=r.check=r.flags?gr(r.check,n,m,a-m):sg(r.check,n,m,a-m)),m=u,(r.flags?f:T1(f))!==r.check){t.msg="incorrect data check",r.mode=qe;break}f=0,h=0}r.mode=b1;case b1:if(r.wrap&&r.flags){for(;h<32;){if(o===0)break e;o--,f+=i[s++]<<h,h+=8}if(f!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=qe;break}f=0,h=0}r.mode=x1;case x1:W=k4;break e;case qe:W=k1;break e;case og:return ag;case A4:default:return jt}return t.next_out=a,t.avail_out=u,t.next_in=s,t.avail_in=o,r.hold=f,r.bits=h,(r.wsize||m!==t.avail_out&&r.mode<qe&&(r.mode<rg||e!==e1))&&D1(t,t.output,t.next_out,m-t.avail_out)?(r.mode=og,ag):(g-=t.avail_in,m-=t.avail_out,t.total_in+=g,t.total_out+=m,r.total+=m,r.wrap&&m&&(t.adler=r.check=r.flags?gr(r.check,n,m,t.next_out-m):sg(r.check,n,m,t.next_out-m)),t.data_type=r.bits+(r.last?64:0)+(r.mode===jr?128:0)+(r.mode===Ju||r.mode===tg?256:0),(g===0&&m===0||e===e1)&&W===hn&&(W=O4),W)}function B4(t){if(!t||!t.state)return jt;var e=t.state;return e.window&&(e.window=null),t.state=null,hn}function j4(t,e){var r;return!t||!t.state||(r=t.state,(r.wrap&2)===0)?jt:(r.head=e,e.done=!1,hn)}function W4(t,e){var r=e.length,i,n,s;return!t||!t.state||(i=t.state,i.wrap!==0&&i.mode!==tf)?jt:i.mode===tf&&(n=1,n=sg(n,e,r,0),n!==i.check)?k1:(s=D1(t,e,r,r),s?(i.mode=og,ag):(i.havedict=1,hn))}Jt.inflateReset=A1;Jt.inflateReset2=F1;Jt.inflateResetKeep=O1;Jt.inflateInit=M4;Jt.inflateInit2=N1;Jt.inflate=L4;Jt.inflateEnd=B4;Jt.inflateGetHeader=j4;Jt.inflateSetDictionary=W4;Jt.inflateInfo="pako inflate (from Nodeca project)"});var lg=y((lae,I1)=>{"use strict";I1.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var P1=y((uae,M1)=>{"use strict";function $4(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}M1.exports=$4});var B1=y(Bo=>{"use strict";var Ss=q1(),Lo=Pr(),rf=Vp(),$e=lg(),ug=Hu(),H4=Gp(),U4=P1(),L1=Object.prototype.toString;function cn(t){if(!(this instanceof cn))return new cn(t);this.options=Lo.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new H4,this.strm.avail_out=0;var r=Ss.inflateInit2(this.strm,e.windowBits);if(r!==$e.Z_OK)throw new Error(ug[r]);if(this.header=new U4,Ss.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=rf.string2buf(e.dictionary):L1.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Ss.inflateSetDictionary(this.strm,e.dictionary),r!==$e.Z_OK)))throw new Error(ug[r])}cn.prototype.push=function(t,e){var r=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,a,o,u,f,h=!1;if(this.ended)return!1;a=e===~~e?e:e===!0?$e.Z_FINISH:$e.Z_NO_FLUSH,typeof t=="string"?r.input=rf.binstring2buf(t):L1.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new Lo.Buf8(i),r.next_out=0,r.avail_out=i),s=Ss.inflate(r,$e.Z_NO_FLUSH),s===$e.Z_NEED_DICT&&n&&(s=Ss.inflateSetDictionary(this.strm,n)),s===$e.Z_BUF_ERROR&&h===!0&&(s=$e.Z_OK,h=!1),s!==$e.Z_STREAM_END&&s!==$e.Z_OK)return this.onEnd(s),this.ended=!0,!1;r.next_out&&(r.avail_out===0||s===$e.Z_STREAM_END||r.avail_in===0&&(a===$e.Z_FINISH||a===$e.Z_SYNC_FLUSH))&&(this.options.to==="string"?(o=rf.utf8border(r.output,r.next_out),u=r.next_out-o,f=rf.buf2string(r.output,o),r.next_out=u,r.avail_out=i-u,u&&Lo.arraySet(r.output,r.output,o,u,0),this.onData(f)):this.onData(Lo.shrinkBuf(r.output,r.next_out))),r.avail_in===0&&r.avail_out===0&&(h=!0)}while((r.avail_in>0||r.avail_out===0)&&s!==$e.Z_STREAM_END);return s===$e.Z_STREAM_END&&(a=$e.Z_FINISH),a===$e.Z_FINISH?(s=Ss.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===$e.Z_OK):(a===$e.Z_SYNC_FLUSH&&(this.onEnd($e.Z_OK),r.avail_out=0),!0)};cn.prototype.onData=function(t){this.chunks.push(t)};cn.prototype.onEnd=function(t){t===$e.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Lo.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function fg(t,e){var r=new cn(e);if(r.push(t,!0),r.err)throw r.msg||ug[r.err];return r.result}function z4(t,e){return e=e||{},e.raw=!0,fg(t,e)}Bo.Inflate=cn;Bo.inflate=fg;Bo.inflateRaw=z4;Bo.ungzip=fg});var $1=y((hae,W1)=>{"use strict";var X4=Pr().assign,V4=UE(),G4=B1(),Z4=lg(),j1={};X4(j1,V4,G4,Z4);W1.exports=j1});var U1=y(sf=>{"use strict";var Y4=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",K4=$1(),H1=Pe(),nf=Nt(),Q4=Y4?"uint8array":"array";sf.magic="\b\0";function dn(t,e){nf.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}H1.inherits(dn,nf);dn.prototype.processChunk=function(t){this.meta=t.meta,this._pako===null&&this._createPako(),this._pako.push(H1.transformTo(Q4,t.data),!1)};dn.prototype.flush=function(){nf.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)};dn.prototype.cleanUp=function(){nf.prototype.cleanUp.call(this),this._pako=null};dn.prototype._createPako=function(){this._pako=new K4[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}};sf.compressWorker=function(t){return new dn("Deflate",t)};sf.uncompressWorker=function(){return new dn("Inflate",{})}});var cg=y(hg=>{"use strict";var z1=Nt();hg.STORE={magic:"\0\0",compressWorker:function(){return new z1("STORE compression")},uncompressWorker:function(){return new z1("STORE decompression")}};hg.DEFLATE=U1()});var dg=y(pn=>{"use strict";pn.LOCAL_FILE_HEADER="PK";pn.CENTRAL_FILE_HEADER="PK";pn.CENTRAL_DIRECTORY_END="PK";pn.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07";pn.ZIP64_CENTRAL_DIRECTORY_END="PK";pn.DATA_DESCRIPTOR="PK\x07\b"});var Z1=y((gae,G1)=>{"use strict";var ks=Pe(),Rs=Nt(),pg=gs(),X1=Lu(),af=dg(),ke=function(t,e){var r="",i;for(i=0;i<e;i++)r+=String.fromCharCode(t&255),t=t>>>8;return r},J4=function(t,e){var r=t;return t||(r=e?16893:33204),(r&65535)<<16},e8=function(t){return(t||0)&63},V1=function(t,e,r,i,n,s){var a=t.file,o=t.compression,u=s!==pg.utf8encode,f=ks.transformTo("string",s(a.name)),h=ks.transformTo("string",pg.utf8encode(a.name)),g=a.comment,m=ks.transformTo("string",s(g)),c=ks.transformTo("string",pg.utf8encode(g)),d=h.length!==a.name.length,v=c.length!==g.length,w,b,C="",O="",R="",M=a.dir,X=a.date,H={crc32:0,compressedSize:0,uncompressedSize:0};(!e||r)&&(H.crc32=t.crc32,H.compressedSize=t.compressedSize,H.uncompressedSize=t.uncompressedSize);var W=0;e&&(W|=8),!u&&(d||v)&&(W|=2048);var P=0,G=0;M&&(P|=16),n==="UNIX"?(G=798,P|=J4(a.unixPermissions,M)):(G=20,P|=e8(a.dosPermissions,M)),w=X.getUTCHours(),w=w<<6,w=w|X.getUTCMinutes(),w=w<<5,w=w|X.getUTCSeconds()/2,b=X.getUTCFullYear()-1980,b=b<<4,b=b|X.getUTCMonth()+1,b=b<<5,b=b|X.getUTCDate(),d&&(O=ke(1,1)+ke(X1(f),4)+h,C+="up"+ke(O.length,2)+O),v&&(R=ke(1,1)+ke(X1(m),4)+c,C+="uc"+ke(R.length,2)+R);var q="";q+=`
\0`,q+=ke(W,2),q+=o.magic,q+=ke(w,2),q+=ke(b,2),q+=ke(H.crc32,4),q+=ke(H.compressedSize,4),q+=ke(H.uncompressedSize,4),q+=ke(f.length,2),q+=ke(C.length,2);var E=af.LOCAL_FILE_HEADER+q+f+C,A=af.CENTRAL_FILE_HEADER+ke(G,2)+q+ke(m.length,2)+"\0\0\0\0"+ke(P,4)+ke(i,4)+f+C+m;return{fileRecord:E,dirRecord:A}},t8=function(t,e,r,i,n){var s="",a=ks.transformTo("string",n(i));return s=af.CENTRAL_DIRECTORY_END+"\0\0\0\0"+ke(t,2)+ke(t,2)+ke(e,4)+ke(r,4)+ke(a.length,2)+a,s},r8=function(t){var e="";return e=af.DATA_DESCRIPTOR+ke(t.crc32,4)+ke(t.compressedSize,4)+ke(t.uncompressedSize,4),e};function er(t,e,r,i){Rs.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}ks.inherits(er,Rs);er.prototype.push=function(t){var e=t.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,Rs.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(e+100*(r-i-1))/r:100}}))};er.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var r=V1(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0};er.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,r=V1(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),e)this.push({data:r8(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null};er.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var r=this.bytesWritten-t,i=t8(this.dirRecords.length,r,t,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})};er.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()};er.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",function(r){e.processChunk(r)}),t.on("end",function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()}),t.on("error",function(r){e.error(r)}),this};er.prototype.resume=function(){if(!Rs.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0};er.prototype.error=function(t){var e=this._sources;if(!Rs.prototype.error.call(this,t))return!1;for(var r=0;r<e.length;r++)try{e[r].error(t)}catch{}return!0};er.prototype.lock=function(){Rs.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()};G1.exports=er});var K1=y(Y1=>{"use strict";var i8=cg(),n8=Z1(),s8=function(t,e){var r=t||e,i=i8[r];if(!i)throw new Error(r+" is not a valid compression method !");return i};Y1.generateWorker=function(t,e,r){var i=new n8(e.streamFiles,r,e.platform,e.encodeFileName),n=0;try{t.forEach(function(s,a){n++;var o=s8(a.options.compression,e.compression),u=a.options.compressionOptions||e.compressionOptions||{},f=a.dir,h=a.date;a._compressWorker(o,u).withStreamInfo("file",{name:s,dir:f,date:h,comment:a.comment||"",unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions}).pipe(i)}),i.entriesCount=n}catch(s){i.error(s)}return i}});var J1=y((vae,Q1)=>{"use strict";var a8=Pe(),of=Nt();function jo(t,e){of.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}a8.inherits(jo,of);jo.prototype._bindStream=function(t){var e=this;this._stream=t,t.pause(),t.on("data",function(r){e.push({data:r,meta:{percent:0}})}).on("error",function(r){e.isPaused?this.generatedError=r:e.error(r)}).on("end",function(){e.isPaused?e._upstreamEnded=!0:e.end()})};jo.prototype.pause=function(){return of.prototype.pause.call(this)?(this._stream.pause(),!0):!1};jo.prototype.resume=function(){return of.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};Q1.exports=jo});var uC=y((yae,lC)=>{"use strict";var o8=gs(),Wo=Pe(),iC=Nt(),l8=_p(),nC=wp(),eC=Bu(),u8=tE(),f8=K1(),tC=mo(),h8=J1(),sC=function(t,e,r){var i=Wo.getTypeOf(e),n,s=Wo.extend(r||{},nC);s.date=s.date||new Date,s.compression!==null&&(s.compression=s.compression.toUpperCase()),typeof s.unixPermissions=="string"&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&s.unixPermissions&16384&&(s.dir=!0),s.dosPermissions&&s.dosPermissions&16&&(s.dir=!0),s.dir&&(t=aC(t)),s.createFolders&&(n=c8(t))&&oC.call(this,n,!0);var a=i==="string"&&s.binary===!1&&s.base64===!1;(!r||typeof r.binary>"u")&&(s.binary=!a);var o=e instanceof eC&&e.uncompressedSize===0;(o||s.dir||!e||e.length===0)&&(s.base64=!1,s.binary=!0,e="",s.compression="STORE",i="string");var u=null;e instanceof eC||e instanceof iC?u=e:tC.isNode&&tC.isStream(e)?u=new h8(t,e):u=Wo.prepareContent(t,e,s.binary,s.optimizedBinaryString,s.base64);var f=new u8(t,u,s);this.files[t]=f},c8=function(t){t.slice(-1)==="/"&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},aC=function(t){return t.slice(-1)!=="/"&&(t+="/"),t},oC=function(t,e){return e=typeof e<"u"?e:nC.createFolders,t=aC(t),this.files[t]||sC.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function rC(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var d8={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,r,i;for(e in this.files)i=this.files[e],r=e.slice(this.root.length,e.length),r&&e.slice(0,this.root.length)===this.root&&t(r,i)},filter:function(t){var e=[];return this.forEach(function(r,i){t(r,i)&&e.push(i)}),e},file:function(t,e,r){if(arguments.length===1)if(rC(t)){var i=t;return this.filter(function(s,a){return!a.dir&&i.test(s)})}else{var n=this.files[this.root+t];return n&&!n.dir?n:null}else t=this.root+t,sC.call(this,t,e,r);return this},folder:function(t){if(!t)return this;if(rC(t))return this.filter(function(n,s){return s.dir&&t.test(n)});var e=this.root+t,r=oC.call(this,e),i=this.clone();return i.root=r.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||(t.slice(-1)!=="/"&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var r=this.filter(function(n,s){return s.name.slice(0,t.length)===t}),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,r={};try{if(r=Wo.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o8.utf8encode}),r.type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),r.type==="binarystring"&&(r.type="string"),!r.type)throw new Error("No output type specified.");Wo.checkSupport(r.type),(r.platform==="darwin"||r.platform==="freebsd"||r.platform==="linux"||r.platform==="sunos")&&(r.platform="UNIX"),r.platform==="win32"&&(r.platform="DOS");var i=r.comment||this.comment||"";e=f8.generateWorker(this,r,i)}catch(n){e=new iC("error"),e.error(n)}return new l8(e,r.type||"string",r.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return t=t||{},t.type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};lC.exports=d8});var gg=y((_ae,hC)=>{"use strict";var p8=Pe();function fC(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}fC.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var e=0,r;for(this.checkOffset(t),r=this.index+t-1;r>=this.index;r--)e=(e<<8)+this.byteAt(r);return this.index+=t,e},readString:function(t){return p8.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(t&31)<<1))}};hC.exports=fC});var mg=y((wae,dC)=>{"use strict";var cC=gg(),g8=Pe();function Os(t){cC.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=t[e]&255}g8.inherits(Os,cC);Os.prototype.byteAt=function(t){return this.data[this.zero+t]};Os.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===e&&this.data[s+1]===r&&this.data[s+2]===i&&this.data[s+3]===n)return s-this.zero;return-1};Os.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1),i=t.charCodeAt(2),n=t.charCodeAt(3),s=this.readData(4);return e===s[0]&&r===s[1]&&i===s[2]&&n===s[3]};Os.prototype.readData=function(t){if(this.checkOffset(t),t===0)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};dC.exports=Os});var mC=y((bae,gC)=>{"use strict";var pC=gg(),m8=Pe();function As(t){pC.call(this,t)}m8.inherits(As,pC);As.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)};As.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero};As.prototype.readAndCheckSignature=function(t){var e=this.readData(4);return t===e};As.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};gC.exports=As});var yg=y((xae,yC)=>{"use strict";var vC=mg(),v8=Pe();function vg(t){vC.call(this,t)}v8.inherits(vg,vC);vg.prototype.readData=function(t){if(this.checkOffset(t),t===0)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};yC.exports=vg});var bC=y((Tae,wC)=>{"use strict";var _C=yg(),y8=Pe();function _g(t){_C.call(this,t)}y8.inherits(_g,_C);_g.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};wC.exports=_g});var wg=y((Eae,TC)=>{"use strict";var lf=Pe(),xC=Ir(),_8=mg(),w8=mC(),b8=bC(),x8=yg();TC.exports=function(t){var e=lf.getTypeOf(t);return lf.checkSupport(e),e==="string"&&!xC.uint8array?new w8(t):e==="nodebuffer"?new b8(t):xC.uint8array?new x8(lf.transformTo("uint8array",t)):new _8(lf.transformTo("array",t))}});var kC=y((Cae,SC)=>{"use strict";var bg=wg(),_i=Pe(),T8=Bu(),EC=Lu(),uf=gs(),ff=cg(),E8=Ir(),C8=0,S8=3,k8=function(t){for(var e in ff)if(!!Object.prototype.hasOwnProperty.call(ff,e)&&ff[e].magic===t)return ff[e];return null};function CC(t,e){this.options=t,this.loadOptions=e}CC.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(e=k8(this.compressionMethod),e===null)throw new Error("Corrupted zip : compression "+_i.pretty(this.compressionMethod)+" unknown (inner file : "+_i.transformTo("string",this.fileName)+")");this.decompressed=new T8(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),t===C8&&(this.dosPermissions=this.externalFileAttributes&63),t===S8&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(!!this.extraFields[1]){var t=bg(this.extraFields[1].value);this.uncompressedSize===_i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===_i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===_i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===_i.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var e=t.index+this.extraFieldsLength,r,i,n;for(this.extraFields||(this.extraFields={});t.index+4<e;)r=t.readInt(2),i=t.readInt(2),n=t.readData(i),this.extraFields[r]={id:r,length:i,value:n};t.setIndex(e)},handleUTF8:function(){var t=E8.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=uf.utf8decode(this.fileName),this.fileCommentStr=uf.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(e!==null)this.fileNameStr=e;else{var r=_i.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(i!==null)this.fileCommentStr=i;else{var n=_i.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(n)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=bg(t.value);return e.readInt(1)!==1||EC(this.fileName)!==e.readInt(4)?null:uf.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=bg(t.value);return e.readInt(1)!==1||EC(this.fileComment)!==e.readInt(4)?null:uf.utf8decode(e.readData(t.length-5))}return null}};SC.exports=CC});var AC=y((Sae,OC)=>{"use strict";var R8=wg(),Wr=Pe(),tr=dg(),O8=kC(),A8=Ir();function RC(t){this.files=[],this.loadOptions=t}RC.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+Wr.pretty(e)+", expected "+Wr.pretty(t)+")")}},isSignature:function(t,e){var r=this.reader.index;this.reader.setIndex(t);var i=this.reader.readString(4),n=i===e;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=A8.uint8array?"uint8array":"array",r=Wr.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t=this.zip64EndOfCentralSize-44,e=0,r,i,n;e<t;)r=this.reader.readInt(2),i=this.reader.readInt(4),n=this.reader.readData(i),this.zip64ExtensibleData[r]={id:r,length:i,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(tr.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(tr.CENTRAL_FILE_HEADER);)t=new O8({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(tr.CENTRAL_DIRECTORY_END);if(t<0){var e=!this.isSignature(0,tr.LOCAL_FILE_HEADER);throw e?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(t);var r=t;if(this.checkSignature(tr.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===Wr.MAX_VALUE_16BITS||this.diskWithCentralDirStart===Wr.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===Wr.MAX_VALUE_16BITS||this.centralDirRecords===Wr.MAX_VALUE_16BITS||this.centralDirSize===Wr.MAX_VALUE_32BITS||this.centralDirOffset===Wr.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(tr.ZIP64_CENTRAL_DIRECTORY_LOCATOR),t<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(tr.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,tr.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(tr.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(tr.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var n=r-i;if(n>0)this.isSignature(r,tr.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(t){this.reader=R8(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};OC.exports=RC});var DC=y((kae,NC)=>{"use strict";var xg=Pe(),hf=cs(),F8=gs(),N8=AC(),D8=Tp(),FC=mo();function q8(t){return new hf.Promise(function(e,r){var i=t.decompressed.getContentWorker().pipe(new D8);i.on("error",function(n){r(n)}).on("end",function(){i.streamInfo.crc32!==t.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):e()}).resume()})}NC.exports=function(t,e){var r=this;return e=xg.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:F8.utf8decode}),FC.isNode&&FC.isStream(t)?hf.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):xg.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then(function(i){var n=new N8(e);return n.load(i),n}).then(function(n){var s=[hf.Promise.resolve(n)],a=n.files;if(e.checkCRC32)for(var o=0;o<a.length;o++)s.push(q8(a[o]));return hf.Promise.all(s)}).then(function(n){for(var s=n.shift(),a=s.files,o=0;o<a.length;o++){var u=a[o],f=u.fileNameStr,h=xg.resolve(u.fileNameStr);r.file(h,u.decompressed,{binary:!0,optimizedBinaryString:!0,date:u.date,dir:u.dir,comment:u.fileCommentStr.length?u.fileCommentStr:null,unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions,createFolders:e.createFolders}),u.dir||(r.file(h).unsafeOriginalName=f)}return s.zipComment.length&&(r.comment=s.zipComment),r})}});var Tg=y((Rae,qC)=>{"use strict";function Wt(){if(!(this instanceof Wt))return new Wt;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new Wt;for(var e in this)typeof this[e]!="function"&&(t[e]=this[e]);return t}}Wt.prototype=uC();Wt.prototype.loadAsync=DC();Wt.support=Ir();Wt.defaults=wp();Wt.version="3.10.1";Wt.loadAsync=function(t,e){return new Wt().loadAsync(t,e)};Wt.external=cs();qC.exports=Wt});var Eg=y((Oae,IC)=>{IC.exports=require("stream")});var WC=y((Aae,jC)=>{"use strict";function MC(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function PC(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MC(Object(r),!0).forEach(function(i){I8(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MC(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function I8(t,e,r){return e=BC(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M8(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LC(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,BC(i.key),i)}}function P8(t,e,r){return e&&LC(t.prototype,e),r&&LC(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BC(t){var e=L8(t,"string");return typeof e=="symbol"?e:String(e)}function L8(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var B8=require("buffer"),cf=B8.Buffer,j8=require("util"),Cg=j8.inspect,W8=Cg&&Cg.custom||"inspect";function $8(t,e,r){cf.prototype.copy.call(t,e,r)}jC.exports=function(){function t(){M8(this,t),this.head=null,this.tail=null,this.length=0}return P8(t,[{key:"push",value:function(r){var i={data:r,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(r){var i={data:r,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=r+i.data;return n}},{key:"concat",value:function(r){if(this.length===0)return cf.alloc(0);for(var i=cf.allocUnsafe(r>>>0),n=this.head,s=0;n;)$8(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(r,i){var n;return r<this.head.data.length?(n=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?n=this.shift():n=i?this._getString(r):this._getBuffer(r),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var i=this.head,n=1,s=i.data;for(r-=s.length;i=i.next;){var a=i.data,o=r>a.length?a.length:r;if(o===a.length?s+=a:s+=a.slice(0,r),r-=o,r===0){o===a.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=a.slice(o));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(r){var i=cf.allocUnsafe(r),n=this.head,s=1;for(n.data.copy(i),r-=n.data.length;n=n.next;){var a=n.data,o=r>a.length?a.length:r;if(a.copy(i,i.length-r,0,o),r-=o,r===0){o===a.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=a.slice(o));break}++s}return this.length-=s,i}},{key:W8,value:function(r,i){return Cg(this,PC(PC({},i),{},{depth:0,customInspect:!1}))}}]),t}()});var kg=y((Fae,HC)=>{"use strict";function H8(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Sg,this,t)):process.nextTick(Sg,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted?process.nextTick(df,r):(r._writableState.errorEmitted=!0,process.nextTick($C,r,s)):process.nextTick($C,r,s):e?(process.nextTick(df,r),e(s)):process.nextTick(df,r)}),this)}function $C(t,e){Sg(t,e),df(t)}function df(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function U8(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Sg(t,e){t.emit("error",e)}function z8(t,e){var r=t._readableState,i=t._writableState;r&&r.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}HC.exports={destroy:H8,undestroy:U8,errorOrDestroy:z8}});var wi=y((Nae,XC)=>{"use strict";var zC={};function $t(t,e,r){r||(r=Error);function i(s,a,o){return typeof e=="string"?e:e(s,a,o)}class n extends r{constructor(a,o,u){super(i(a,o,u))}}n.prototype.name=r.name,n.prototype.code=t,zC[t]=n}function UC(t,e){if(Array.isArray(t)){let r=t.length;return t=t.map(i=>String(i)),r>2?`one of ${e} ${t.slice(0,r-1).join(", ")}, or `+t[r-1]:r===2?`one of ${e} ${t[0]} or ${t[1]}`:`of ${e} ${t[0]}`}else return`of ${e} ${String(t)}`}function X8(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function V8(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function G8(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}$t("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);$t("ERR_INVALID_ARG_TYPE",function(t,e,r){let i;typeof e=="string"&&X8(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";let n;if(V8(t," argument"))n=`The ${t} ${i} ${UC(e,"type")}`;else{let s=G8(t,".")?"property":"argument";n=`The "${t}" ${s} ${i} ${UC(e,"type")}`}return n+=`. Received type ${typeof r}`,n},TypeError);$t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");$t("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});$t("ERR_STREAM_PREMATURE_CLOSE","Premature close");$t("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});$t("ERR_MULTIPLE_CALLBACK","Callback called multiple times");$t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");$t("ERR_STREAM_WRITE_AFTER_END","write after end");$t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);$t("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);$t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");XC.exports.codes=zC});var Rg=y((Dae,VC)=>{"use strict";var Z8=wi().codes.ERR_INVALID_OPT_VALUE;function Y8(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function K8(t,e,r,i){var n=Y8(e,i,r);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?r:"highWaterMark";throw new Z8(s,n)}return Math.floor(n)}return t.objectMode?16:16*1024}VC.exports={getHighWaterMark:K8}});var Fg=y((qae,JC)=>{"use strict";JC.exports=We;function ZC(t){var e=this;this.next=null,this.entry=null,this.finish=function(){EW(e,t)}}var Fs;We.WritableState=Ho;var Q8={deprecate:lo()},YC=Eg(),gf=require("buffer").Buffer,J8=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function eW(t){return gf.from(t)}function tW(t){return gf.isBuffer(t)||t instanceof J8}var Ag=kg(),rW=Rg(),iW=rW.getHighWaterMark,bi=wi().codes,nW=bi.ERR_INVALID_ARG_TYPE,sW=bi.ERR_METHOD_NOT_IMPLEMENTED,aW=bi.ERR_MULTIPLE_CALLBACK,oW=bi.ERR_STREAM_CANNOT_PIPE,lW=bi.ERR_STREAM_DESTROYED,uW=bi.ERR_STREAM_NULL_VALUES,fW=bi.ERR_STREAM_WRITE_AFTER_END,hW=bi.ERR_UNKNOWN_ENCODING,Ns=Ag.errorOrDestroy;le()(We,YC);function cW(){}function Ho(t,e,r){Fs=Fs||gn(),t=t||{},typeof r!="boolean"&&(r=e instanceof Fs),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=iW(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=t.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){_W(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new ZC(this)}Ho.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(Ho.prototype,"buffer",{get:Q8.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var pf;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(pf=Function.prototype[Symbol.hasInstance],Object.defineProperty(We,Symbol.hasInstance,{value:function(e){return pf.call(this,e)?!0:this!==We?!1:e&&e._writableState instanceof Ho}})):pf=function(e){return e instanceof this};function We(t){Fs=Fs||gn();var e=this instanceof Fs;if(!e&&!pf.call(We,this))return new We(t);this._writableState=new Ho(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),YC.call(this)}We.prototype.pipe=function(){Ns(this,new oW)};function dW(t,e){var r=new fW;Ns(t,r),process.nextTick(e,r)}function pW(t,e,r,i){var n;return r===null?n=new uW:typeof r!="string"&&!e.objectMode&&(n=new nW("chunk",["string","Buffer"],r)),n?(Ns(t,n),process.nextTick(i,n),!1):!0}We.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&tW(t);return s&&!gf.isBuffer(t)&&(t=eW(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof r!="function"&&(r=cW),i.ending?dW(this,r):(s||pW(this,i,t,r))&&(i.pendingcb++,n=mW(this,i,s,t,e,r)),n};We.prototype.cork=function(){this._writableState.corked++};We.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&KC(this,t))};We.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new hW(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(We.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function gW(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=gf.from(e,r)),e}Object.defineProperty(We.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function mW(t,e,r,i,n,s){if(!r){var a=gW(e,i,n);i!==a&&(r=!0,n="buffer",i=a)}var o=e.objectMode?1:i.length;e.length+=o;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var f=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},f?f.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Og(t,e,!1,o,i,n,s);return u}function Og(t,e,r,i,n,s,a){e.writelen=i,e.writecb=a,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new lW("write")):r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function vW(t,e,r,i,n){--e.pendingcb,r?(process.nextTick(n,i),process.nextTick($o,t,e),t._writableState.errorEmitted=!0,Ns(t,i)):(n(i),t._writableState.errorEmitted=!0,Ns(t,i),$o(t,e))}function yW(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function _W(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if(typeof n!="function")throw new aW;if(yW(r),e)vW(t,r,i,e,n);else{var s=QC(r)||t.destroyed;!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&KC(t,r),i?process.nextTick(GC,t,r,s,n):GC(t,r,s,n)}}function GC(t,e,r,i){r||wW(t,e),e.pendingcb--,i(),$o(t,e)}function wW(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function KC(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var a=0,o=!0;r;)n[a]=r,r.isBuf||(o=!1),r=r.next,a+=1;n.allBuffers=o,Og(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new ZC(e),e.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,f=r.encoding,h=r.callback,g=e.objectMode?1:u.length;if(Og(t,e,!1,g,u,f,h),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}We.prototype._write=function(t,e,r){r(new sW("_write()"))};We.prototype._writev=null;We.prototype.end=function(t,e,r){var i=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||TW(this,i,r),this};Object.defineProperty(We.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function QC(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function bW(t,e){t._final(function(r){e.pendingcb--,r&&Ns(t,r),e.prefinished=!0,t.emit("prefinish"),$o(t,e)})}function xW(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(bW,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function $o(t,e){var r=QC(e);if(r&&(xW(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return r}function TW(t,e,r){e.ending=!0,$o(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function EW(t,e,r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}Object.defineProperty(We.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});We.prototype.destroy=Ag.destroy;We.prototype._undestroy=Ag.undestroy;We.prototype._destroy=function(t,e){e(t)}});var gn=y((Iae,tS)=>{"use strict";var CW=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};tS.exports=mr;var eS=qg(),Dg=Fg();le()(mr,eS);for(Ng=CW(Dg.prototype),mf=0;mf<Ng.length;mf++)vf=Ng[mf],mr.prototype[vf]||(mr.prototype[vf]=Dg.prototype[vf]);var Ng,vf,mf;function mr(t){if(!(this instanceof mr))return new mr(t);eS.call(this,t),Dg.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",SW)))}Object.defineProperty(mr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(mr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(mr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function SW(){this._writableState.ended||process.nextTick(kW,this)}function kW(t){t.end()}Object.defineProperty(mr.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var nS=y((Ig,iS)=>{var yf=require("buffer"),vr=yf.Buffer;function rS(t,e){for(var r in t)e[r]=t[r]}vr.from&&vr.alloc&&vr.allocUnsafe&&vr.allocUnsafeSlow?iS.exports=yf:(rS(yf,Ig),Ig.Buffer=mn);function mn(t,e,r){return vr(t,e,r)}mn.prototype=Object.create(vr.prototype);rS(vr,mn);mn.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return vr(t,e,r)};mn.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=vr(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};mn.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return vr(t)};mn.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return yf.SlowBuffer(t)}});var Lg=y(aS=>{"use strict";var Pg=nS().Buffer,sS=Pg.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function RW(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function OW(t){var e=RW(t);if(typeof e!="string"&&(Pg.isEncoding===sS||!sS(t)))throw new Error("Unknown encoding: "+t);return e||t}aS.StringDecoder=Uo;function Uo(t){this.encoding=OW(t);var e;switch(this.encoding){case"utf16le":this.text=IW,this.end=MW,e=4;break;case"utf8":this.fillLast=NW,e=4;break;case"base64":this.text=PW,this.end=LW,e=3;break;default:this.write=BW,this.end=jW;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Pg.allocUnsafe(e)}Uo.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};Uo.prototype.end=qW;Uo.prototype.text=DW;Uo.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function Mg(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function AW(t,e,r){var i=e.length-1;if(i<r)return 0;var n=Mg(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||n===-2?0:(n=Mg(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||n===-2?0:(n=Mg(e[i]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function FW(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function NW(t){var e=this.lastTotal-this.lastNeed,r=FW(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function DW(t,e){var r=AW(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function qW(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function IW(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function MW(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function PW(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function LW(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function BW(t){return t.toString(this.encoding)}function jW(t){return t&&t.length?this.write(t):""}});var _f=y((Pae,uS)=>{"use strict";var oS=wi().codes.ERR_STREAM_PREMATURE_CLOSE;function WW(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];t.apply(this,i)}}}function $W(){}function HW(t){return t.setHeader&&typeof t.abort=="function"}function lS(t,e,r){if(typeof e=="function")return lS(t,null,e);e||(e={}),r=WW(r||$W);var i=e.readable||e.readable!==!1&&t.readable,n=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||o()},a=t._writableState&&t._writableState.finished,o=function(){n=!1,a=!0,i||r.call(t)},u=t._readableState&&t._readableState.endEmitted,f=function(){i=!1,u=!0,n||r.call(t)},h=function(d){r.call(t,d)},g=function(){var d;if(i&&!u)return(!t._readableState||!t._readableState.ended)&&(d=new oS),r.call(t,d);if(n&&!a)return(!t._writableState||!t._writableState.ended)&&(d=new oS),r.call(t,d)},m=function(){t.req.on("finish",o)};return HW(t)?(t.on("complete",o),t.on("abort",g),t.req?m():t.on("request",m)):n&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",f),t.on("finish",o),e.error!==!1&&t.on("error",h),t.on("close",g),function(){t.removeListener("complete",o),t.removeListener("abort",g),t.removeListener("request",m),t.req&&t.req.removeListener("finish",o),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",o),t.removeListener("end",f),t.removeListener("error",h),t.removeListener("close",g)}}uS.exports=lS});var hS=y((Lae,fS)=>{"use strict";var wf;function xi(t,e,r){return e=UW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UW(t){var e=zW(t,"string");return typeof e=="symbol"?e:String(e)}function zW(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var XW=_f(),Ti=Symbol("lastResolve"),vn=Symbol("lastReject"),zo=Symbol("error"),bf=Symbol("ended"),yn=Symbol("lastPromise"),Bg=Symbol("handlePromise"),_n=Symbol("stream");function Ei(t,e){return{value:t,done:e}}function VW(t){var e=t[Ti];if(e!==null){var r=t[_n].read();r!==null&&(t[yn]=null,t[Ti]=null,t[vn]=null,e(Ei(r,!1)))}}function GW(t){process.nextTick(VW,t)}function ZW(t,e){return function(r,i){t.then(function(){if(e[bf]){r(Ei(void 0,!0));return}e[Bg](r,i)},i)}}var YW=Object.getPrototypeOf(function(){}),KW=Object.setPrototypeOf((wf={get stream(){return this[_n]},next:function(){var e=this,r=this[zo];if(r!==null)return Promise.reject(r);if(this[bf])return Promise.resolve(Ei(void 0,!0));if(this[_n].destroyed)return new Promise(function(a,o){process.nextTick(function(){e[zo]?o(e[zo]):a(Ei(void 0,!0))})});var i=this[yn],n;if(i)n=new Promise(ZW(i,this));else{var s=this[_n].read();if(s!==null)return Promise.resolve(Ei(s,!1));n=new Promise(this[Bg])}return this[yn]=n,n}},xi(wf,Symbol.asyncIterator,function(){return this}),xi(wf,"return",function(){var e=this;return new Promise(function(r,i){e[_n].destroy(null,function(n){if(n){i(n);return}r(Ei(void 0,!0))})})}),wf),YW),QW=function(e){var r,i=Object.create(KW,(r={},xi(r,_n,{value:e,writable:!0}),xi(r,Ti,{value:null,writable:!0}),xi(r,vn,{value:null,writable:!0}),xi(r,zo,{value:null,writable:!0}),xi(r,bf,{value:e._readableState.endEmitted,writable:!0}),xi(r,Bg,{value:function(s,a){var o=i[_n].read();o?(i[yn]=null,i[Ti]=null,i[vn]=null,s(Ei(o,!1))):(i[Ti]=s,i[vn]=a)},writable:!0}),r));return i[yn]=null,XW(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[vn];s!==null&&(i[yn]=null,i[Ti]=null,i[vn]=null,s(n)),i[zo]=n;return}var a=i[Ti];a!==null&&(i[yn]=null,i[Ti]=null,i[vn]=null,a(Ei(void 0,!0))),i[bf]=!0}),e.on("readable",GW.bind(null,i)),i};fS.exports=QW});var gS=y((Bae,pS)=>{"use strict";function cS(t,e,r,i,n,s,a){try{var o=t[s](a),u=o.value}catch(f){r(f);return}o.done?e(u):Promise.resolve(u).then(i,n)}function JW(t){return function(){var e=this,r=arguments;return new Promise(function(i,n){var s=t.apply(e,r);function a(u){cS(s,i,n,a,o,"next",u)}function o(u){cS(s,i,n,a,o,"throw",u)}a(void 0)})}}function dS(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function e$(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dS(Object(r),!0).forEach(function(i){t$(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dS(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function t$(t,e,r){return e=r$(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r$(t){var e=i$(t,"string");return typeof e=="symbol"?e:String(e)}function i$(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var n$=wi().codes.ERR_INVALID_ARG_TYPE;function s$(t,e,r){var i;if(e&&typeof e.next=="function")i=e;else if(e&&e[Symbol.asyncIterator])i=e[Symbol.asyncIterator]();else if(e&&e[Symbol.iterator])i=e[Symbol.iterator]();else throw new n$("iterable",["Iterable"],e);var n=new t(e$({objectMode:!0},r)),s=!1;n._read=function(){s||(s=!0,a())};function a(){return o.apply(this,arguments)}function o(){return o=JW(function*(){try{var u=yield i.next(),f=u.value,h=u.done;h?n.push(null):n.push(yield f)?a():s=!1}catch(g){n.destroy(g)}}),o.apply(this,arguments)}return n}pS.exports=s$});var qg=y((Wae,CS)=>{"use strict";CS.exports=ue;var Ds;ue.ReadableState=_S;var jae=require("events").EventEmitter,yS=function(e,r){return e.listeners(r).length},Vo=Eg(),xf=require("buffer").Buffer,a$=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function o$(t){return xf.from(t)}function l$(t){return xf.isBuffer(t)||t instanceof a$}var jg=require("util"),se;jg&&jg.debuglog?se=jg.debuglog("stream"):se=function(){};var u$=WC(),Vg=kg(),f$=Rg(),h$=f$.getHighWaterMark,Tf=wi().codes,c$=Tf.ERR_INVALID_ARG_TYPE,d$=Tf.ERR_STREAM_PUSH_AFTER_EOF,p$=Tf.ERR_METHOD_NOT_IMPLEMENTED,g$=Tf.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,qs,Wg,$g;le()(ue,Vo);var Xo=Vg.errorOrDestroy,Hg=["error","close","destroy","pause","resume"];function m$(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function _S(t,e,r){Ds=Ds||gn(),t=t||{},typeof r!="boolean"&&(r=e instanceof Ds),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=h$(this,t,"readableHighWaterMark",r),this.buffer=new u$,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(qs||(qs=Lg().StringDecoder),this.decoder=new qs(t.encoding),this.encoding=t.encoding)}function ue(t){if(Ds=Ds||gn(),!(this instanceof ue))return new ue(t);var e=this instanceof Ds;this._readableState=new _S(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),Vo.call(this)}Object.defineProperty(ue.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});ue.prototype.destroy=Vg.destroy;ue.prototype._undestroy=Vg.undestroy;ue.prototype._destroy=function(t,e){e(t)};ue.prototype.push=function(t,e){var r=this._readableState,i;return r.objectMode?i=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=xf.from(t,e),e=""),i=!0),wS(this,t,e,!1,i)};ue.prototype.unshift=function(t){return wS(this,t,null,!0,!1)};function wS(t,e,r,i,n){se("readableAddChunk",e);var s=t._readableState;if(e===null)s.reading=!1,_$(t,s);else{var a;if(n||(a=v$(s,e)),a)Xo(t,a);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==xf.prototype&&(e=o$(e)),i)s.endEmitted?Xo(t,new g$):Ug(t,s,e,!0);else if(s.ended)Xo(t,new d$);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?Ug(t,s,e,!1):Xg(t,s)):Ug(t,s,e,!1)}else i||(s.reading=!1,Xg(t,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function Ug(t,e,r,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Ef(t)),Xg(t,e)}function v$(t,e){var r;return!l$(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new c$("chunk",["string","Buffer","Uint8Array"],e)),r}ue.prototype.isPaused=function(){return this._readableState.flowing===!1};ue.prototype.setEncoding=function(t){qs||(qs=Lg().StringDecoder);var e=new qs(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";r!==null;)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var mS=1073741824;function y$(t){return t>=mS?t=mS:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function vS(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=y$(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}ue.prototype.read=function(t){se("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return se("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?zg(this):Ef(this),null;if(t=vS(t,e),t===0&&e.ended)return e.length===0&&zg(this),null;var i=e.needReadable;se("need readable",i),(e.length===0||e.length-t<e.highWaterMark)&&(i=!0,se("length less than watermark",i)),e.ended||e.reading?(i=!1,se("reading or ended",i)):i&&(se("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=vS(r,e)));var n;return t>0?n=TS(t,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&zg(this)),n!==null&&this.emit("data",n),n};function _$(t,e){if(se("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?Ef(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,bS(t)))}}function Ef(t){var e=t._readableState;se("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(se("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(bS,t))}function bS(t){var e=t._readableState;se("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Gg(t)}function Xg(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(w$,t,e))}function w$(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(se("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}ue.prototype._read=function(t){Xo(this,new p$("_read()"))};ue.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,se("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=n?o:v;i.endEmitted?process.nextTick(s):r.once("end",s),t.on("unpipe",a);function a(w,b){se("onunpipe"),w===r&&b&&b.hasUnpiped===!1&&(b.hasUnpiped=!0,h())}function o(){se("onend"),t.end()}var u=b$(r);t.on("drain",u);var f=!1;function h(){se("cleanup"),t.removeListener("close",c),t.removeListener("finish",d),t.removeListener("drain",u),t.removeListener("error",m),t.removeListener("unpipe",a),r.removeListener("end",o),r.removeListener("end",v),r.removeListener("data",g),f=!0,i.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&u()}r.on("data",g);function g(w){se("ondata");var b=t.write(w);se("dest.write",b),b===!1&&((i.pipesCount===1&&i.pipes===t||i.pipesCount>1&&ES(i.pipes,t)!==-1)&&!f&&(se("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function m(w){se("onerror",w),v(),t.removeListener("error",m),yS(t,"error")===0&&Xo(t,w)}m$(t,"error",m);function c(){t.removeListener("finish",d),v()}t.once("close",c);function d(){se("onfinish"),t.removeListener("close",c),v()}t.once("finish",d);function v(){se("unpipe"),r.unpipe(t)}return t.emit("pipe",r),i.flowing||(se("pipe resume"),r.resume()),t};function b$(t){return function(){var r=t._readableState;se("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&yS(t,"data")&&(r.flowing=!0,Gg(t))}}ue.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=ES(e.pipes,t);return a===-1?this:(e.pipes.splice(a,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};ue.prototype.on=function(t,e){var r=Vo.prototype.on.call(this,t,e),i=this._readableState;return t==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):t==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,se("on readable",i.length,i.reading),i.length?Ef(this):i.reading||process.nextTick(x$,this)),r};ue.prototype.addListener=ue.prototype.on;ue.prototype.removeListener=function(t,e){var r=Vo.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(xS,this),r};ue.prototype.removeAllListeners=function(t){var e=Vo.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(xS,this),e};function xS(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function x$(t){se("readable nexttick read 0"),t.read(0)}ue.prototype.resume=function(){var t=this._readableState;return t.flowing||(se("resume"),t.flowing=!t.readableListening,T$(this,t)),t.paused=!1,this};function T$(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(E$,t,e))}function E$(t,e){se("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Gg(t),e.flowing&&!e.reading&&t.read(0)}ue.prototype.pause=function(){return se("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(se("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Gg(t){var e=t._readableState;for(se("flow",e.flowing);e.flowing&&t.read()!==null;);}ue.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;t.on("end",function(){if(se("wrapped end"),r.decoder&&!r.ended){var a=r.decoder.end();a&&a.length&&e.push(a)}e.push(null)}),t.on("data",function(a){if(se("wrapped data"),r.decoder&&(a=r.decoder.write(a)),!(r.objectMode&&a==null)&&!(!r.objectMode&&(!a||!a.length))){var o=e.push(a);o||(i=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(o){return function(){return t[o].apply(t,arguments)}}(n));for(var s=0;s<Hg.length;s++)t.on(Hg[s],this.emit.bind(this,Hg[s]));return this._read=function(a){se("wrapped _read",a),i&&(i=!1,t.resume())},this};typeof Symbol=="function"&&(ue.prototype[Symbol.asyncIterator]=function(){return Wg===void 0&&(Wg=hS()),Wg(this)});Object.defineProperty(ue.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(ue.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(ue.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});ue._fromList=TS;Object.defineProperty(ue.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function TS(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function zg(t){var e=t._readableState;se("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(C$,e,t))}function C$(t,e){if(se("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(ue.from=function(t,e){return $g===void 0&&($g=gS()),$g(ue,t,e)});function ES(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}});var Zg=y(($ae,kS)=>{"use strict";kS.exports=$r;var Cf=wi().codes,S$=Cf.ERR_METHOD_NOT_IMPLEMENTED,k$=Cf.ERR_MULTIPLE_CALLBACK,R$=Cf.ERR_TRANSFORM_ALREADY_TRANSFORMING,O$=Cf.ERR_TRANSFORM_WITH_LENGTH_0,Sf=gn();le()($r,Sf);function A$(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(i===null)return this.emit("error",new k$);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function $r(t){if(!(this instanceof $r))return new $r(t);Sf.call(this,t),this._transformState={afterTransform:A$.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",F$)}function F$(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){SS(t,e,r)}):SS(this,null,null)}$r.prototype.push=function(t,e){return this._transformState.needTransform=!1,Sf.prototype.push.call(this,t,e)};$r.prototype._transform=function(t,e,r){r(new S$("_transform()"))};$r.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};$r.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};$r.prototype._destroy=function(t,e){Sf.prototype._destroy.call(this,t,function(r){e(r)})};function SS(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new O$;if(t._transformState.transforming)throw new R$;return t.push(null)}});var AS=y((Hae,OS)=>{"use strict";OS.exports=Go;var RS=Zg();le()(Go,RS);function Go(t){if(!(this instanceof Go))return new Go(t);RS.call(this,t)}Go.prototype._transform=function(t,e,r){r(null,t)}});var IS=y((Uae,qS)=>{"use strict";var Yg;function N$(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var DS=wi().codes,D$=DS.ERR_MISSING_ARGS,q$=DS.ERR_STREAM_DESTROYED;function FS(t){if(t)throw t}function I$(t){return t.setHeader&&typeof t.abort=="function"}function M$(t,e,r,i){i=N$(i);var n=!1;t.on("close",function(){n=!0}),Yg===void 0&&(Yg=_f()),Yg(t,{readable:e,writable:r},function(a){if(a)return i(a);n=!0,i()});var s=!1;return function(a){if(!n&&!s){if(s=!0,I$(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();i(a||new q$("pipe"))}}}function NS(t){t()}function P$(t,e){return t.pipe(e)}function L$(t){return!t.length||typeof t[t.length-1]!="function"?FS:t.pop()}function B$(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=L$(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new D$("streams");var n,s=e.map(function(a,o){var u=o<e.length-1,f=o>0;return M$(a,u,f,function(h){n||(n=h),h&&s.forEach(NS),!u&&(s.forEach(NS),i(n))})});return e.reduce(P$)}qS.exports=B$});var Ko=y((Ht,Yo)=>{var Zo=require("stream");process.env.READABLE_STREAM==="disable"&&Zo?(Yo.exports=Zo.Readable,Object.assign(Yo.exports,Zo),Yo.exports.Stream=Zo):(Ht=Yo.exports=qg(),Ht.Stream=Zo||Ht,Ht.Readable=Ht,Ht.Writable=Fg(),Ht.Duplex=gn(),Ht.Transform=Zg(),Ht.PassThrough=AS(),Ht.finished=_f(),Ht.pipeline=IS())});var qt=y((zae,LS)=>{var MS=require("fs"),j$=function(t,e,r,i){t.super_=e,i||(i=r,r=null),r&&Object.keys(r).forEach(s=>{Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))});let n={constructor:{value:t,enumerable:!1,writable:!1,configurable:!0}};i&&Object.keys(i).forEach(s=>{n[s]=Object.getOwnPropertyDescriptor(i,s)}),t.prototype=Object.create(e.prototype,n)},W$=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,PS={nop(){},promiseImmediate(t){return new Promise(e=>{global.setImmediate?setImmediate(()=>{e(t)}):setTimeout(()=>{e(t)},1)})},inherits:j$,dateToExcel(t,e){return 25569+t.getTime()/(24*3600*1e3)-(e?1462:0)},excelToDate(t,e){let r=Math.round((t-25569+(e?1462:0))*24*3600*1e3);return new Date(r)},parsePath(t){let e=t.lastIndexOf("/");return{path:t.substring(0,e),name:t.substring(e+1)}},getRelsPath(t){let e=PS.parsePath(t);return`${e.path}/_rels/${e.name}.rels`},xmlEncode(t){let e=W$.exec(t);if(!e)return t;let r="",i="",n=0,s=e.index;for(;s<t.length;s++){let a=t.charCodeAt(s);switch(a){case 34:i="&quot;";break;case 38:i="&amp;";break;case 39:i="&apos;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;case 127:i="";break;default:{if(a<=31&&(a<=8||a>=11&&a!==13)){i="";break}continue}}n!==s&&(r+=t.substring(n,s)),n=s+1,i&&(r+=i)}return n!==s?r+t.substring(n,s):r},xmlDecode(t){return t.replace(/&([a-z]*);/g,e=>{switch(e){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return e}})},validInt(t){let e=parseInt(t,10);return Number.isNaN(e)?0:e},isDateFmt(t){return t?(t=t.replace(/\[[^\]]*]/g,""),t=t.replace(/"[^"]*"/g,""),t.match(/[ymdhMsb]+/)!==null):!1},fs:{exists(t){return new Promise(e=>{MS.access(t,MS.constants.F_OK,r=>{e(!r)})})}},toIsoDateString(t){return t.toIsoString().subsstr(0,10)}};LS.exports=PS});var Qg=y((Xae,BS)=>{var Kg=class{constructor(e){this._buf=Buffer.alloc(e&&e.size||16384),this._encoding=e&&e.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=Buffer.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(e){e=e||0,this._buffer=void 0,this._inPos=e}_grow(e){let r=this._buf.length*2;for(;r<e;)r*=2;let i=Buffer.alloc(r);this._buf.copy(i,0),this._buf=i}addText(e){this._buffer=void 0;let r=this._inPos+this._buf.write(e,this._inPos,this._encoding);for(;r>=this._buf.length-4;)this._grow(this._inPos+e.length),r=this._inPos+this._buf.write(e,this._inPos,this._encoding);this._inPos=r}addStringBuf(e){e.length&&(this._buffer=void 0,this.length+e.length>this.capacity&&this._grow(this.length+e.length),e._buf.copy(this._buf,this._inPos,0,e.length),this._inPos+=e.length)}};BS.exports=Kg});var Qo=y((Vae,$S)=>{var $$=Ko(),jS=qt(),H$=Qg(),Jg=class{constructor(e,r){this._data=e,this._encoding=r}get length(){return this.toBuffer().length}copy(e,r,i,n){return this.toBuffer().copy(e,r,i,n)}toBuffer(){return this._buffer||(this._buffer=Buffer.from(this._data,this._encoding)),this._buffer}},em=class{constructor(e){this._data=e}get length(){return this._data.length}copy(e,r,i,n){return this._data._buf.copy(e,r,i,n)}toBuffer(){return this._data.toBuffer()}},tm=class{constructor(e){this._data=e}get length(){return this._data.length}copy(e,r,i,n){this._data.copy(e,r,i,n)}toBuffer(){return this._data}},rm=class{constructor(e){this.size=e,this.buffer=Buffer.alloc(e),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;let e=Buffer.alloc(this.iWrite-this.iRead);return this.buffer.copy(e,0,this.iRead,this.iWrite),e}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(e){let r;return e===0?null:e===void 0||e>=this.length?(r=this.toBuffer(),this.iRead=this.iWrite,r):(r=Buffer.alloc(e),this.buffer.copy(r,0,this.iRead,e),this.iRead+=e,r)}write(e,r,i){let n=Math.min(i,this.size-this.iWrite);return e.copy(this.buffer,this.iWrite,r,r+n),this.iWrite+=n,n}},WS=function(t){t=t||{},this.bufSize=t.bufSize||1024*1024,this.buffers=[],this.batch=t.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};jS.inherits(WS,$$.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return Buffer.concat(this.buffers.map(t=>t.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){let e=this.buffers[this.buffers.length-1];if(!e.full)return e}let t=new rm(this.bufSize);return this.buffers.push(t),t},async _pipe(t){let e=function(r){return new Promise(i=>{r.write(t.toBuffer(),()=>{i()})})};await Promise.all(this.pipes.map(e))},_writeToBuffers(t){let e=0,r=t.length;for(;e<r;){let i=this._getWritableBuffer();e+=i.write(t,e,r-e)}},async write(t,e,r){e instanceof Function&&(r=e,e="utf8"),r=r||jS.nop;let i;if(t instanceof H$)i=new em(t);else if(t instanceof Buffer)i=new tm(t);else if(typeof t=="string"||t instanceof String||t instanceof ArrayBuffer)i=new Jg(t,e);else throw new Error("Chunk must be one of type String, Buffer or StringBuf.");if(this.pipes.length)if(this.batch)for(this._writeToBuffers(i);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(i),process.nextTick(r)):(await this._pipe(i),r());else this.paused||this.emit("data",i.toBuffer()),this._writeToBuffers(i),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(t,e,r){let i=n=>{n?r(n):(this._flush(),this.pipes.forEach(s=>{s.end()}),this.emit("finish"))};t?this.write(t,e,i):i()},read(t){let e;if(t){for(e=[];t&&this.buffers.length&&!this.buffers[0].eod;){let r=this.buffers[0],i=r.read(t);t-=i.length,e.push(i),r.eod&&r.full&&this.buffers.shift()}return Buffer.concat(e)}return e=this.buffers.map(r=>r.toBuffer()).filter(Boolean),this.buffers=[],Buffer.concat(e)},setEncoding(t){this.encoding=t},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(t){this.pipes.push(t),!this.paused&&this.buffers.length&&this.end()},unpipe(t){this.pipes=this.pipes.filter(e=>e!==t)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}});$S.exports=WS});var XS=y(zS=>{var HS=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:US}=require("buffer");function U$(t){return typeof t!="string"?t:HS?US.from(HS.encode(t).buffer):US.from(t)}zS.stringToBuffer=U$});var GS=y((Zae,VS)=>{var z$=require("events"),X$=Tg(),V$=Qo(),{stringToBuffer:G$}=XS(),im=class extends z$.EventEmitter{constructor(e){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},e),this.zip=new X$,this.stream=new V$}append(e,r){r.hasOwnProperty("base64")&&r.base64?this.zip.file(r.name,e,{base64:!0}):(process.browser&&typeof e=="string"&&(e=G$(e)),this.zip.file(r.name,e))}async finalize(){let e=await this.zip.generateAsync(this.options);this.stream.end(e),this.emit("finish")}read(e){return this.stream.read(e)}setEncoding(e){return this.stream.setEncoding(e)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(e,r){return this.stream.pipe(e,r)}unpipe(e){return this.stream.unpipe(e)}unshift(e){return this.stream.unshift(e)}wrap(e){return this.stream.wrap(e)}};VS.exports={ZipWriter:im}});var nt=y((Yae,KS)=>{var Z$=je(),ZS=qt(),Y$="<",kf=">",K$="</",Q$="/>",J$='="',eH='"',tH=" ";function YS(t,e,r){t.push(tH),t.push(e),t.push(J$),t.push(ZS.xmlEncode(r.toString())),t.push(eH)}function nm(t,e){e&&Z$.each(e,(r,i)=>{r!==void 0&&YS(t,i,r)})}var Rf=class{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(e){let r=this._xml;r.push("<?xml"),nm(r,e),r.push(`?>
`)}openNode(e,r){let i=this.tos,n=this._xml;i&&this.open&&n.push(kf),this._stack.push(e),n.push(Y$),n.push(e),nm(n,r),this.leaf=!0,this.open=!0}addAttribute(e,r){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");r!==void 0&&YS(this._xml,e,r)}addAttributes(e){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");nm(this._xml,e)}writeText(e){let r=this._xml;this.open&&(r.push(kf),this.open=!1),this.leaf=!1,r.push(ZS.xmlEncode(e.toString()))}writeXml(e){this.open&&(this._xml.push(kf),this.open=!1),this.leaf=!1,this._xml.push(e)}closeNode(){let e=this._stack.pop(),r=this._xml;this.leaf?r.push(Q$):(r.push(K$),r.push(e),r.push(kf)),this.open=!1,this.leaf=!1}leafNode(e,r,i){this.openNode(e,r),i!==void 0&&this.writeText(i),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){let e=this._rollbacks.pop();this._xml.length>e.xml&&this._xml.splice(e.xml,this._xml.length-e.xml),this._stack.length>e.stack&&this._stack.splice(e.stack,this._stack.length-e.stack),this.leaf=e.leaf,this.open=e.open}get xml(){return this.closeAll(),this._xml.join("")}};Rf.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"};KS.exports=Rf});var sm=y(JS=>{var QS=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function rH(t){return typeof t=="string"?t:QS?QS.decode(t):t.toString()}JS.bufferToString=rH});var tk=y(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.CHAR=`	
\r -\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}`;Oe.S=` 	\r
`;Oe.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";Oe.NAME_CHAR="-"+Oe.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";Oe.CHAR_RE=new RegExp("^["+Oe.CHAR+"]$","u");Oe.S_RE=new RegExp("^["+Oe.S+"]+$","u");Oe.NAME_START_CHAR_RE=new RegExp("^["+Oe.NAME_START_CHAR+"]$","u");Oe.NAME_CHAR_RE=new RegExp("^["+Oe.NAME_CHAR+"]$","u");Oe.NAME_RE=new RegExp("^["+Oe.NAME_START_CHAR+"]["+Oe.NAME_CHAR+"]*$","u");Oe.NMTOKEN_RE=new RegExp("^["+Oe.NAME_CHAR+"]+$","u");var am=9,om=10,lm=13,um=32;Oe.S_LIST=[um,om,lm,am];function iH(t){return t>=um&&t<=55295||t===om||t===lm||t===am||t>=57344&&t<=65533||t>=65536&&t<=1114111}Oe.isChar=iH;function nH(t){return t===um||t===om||t===lm||t===am}Oe.isS=nH;function ek(t){return t>=65&&t<=90||t>=97&&t<=122||t===58||t===95||t===8204||t===8205||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Oe.isNameStartChar=ek;function sH(t){return ek(t)||t>=48&&t<=57||t===45||t===46||t===183||t>=768&&t<=879||t>=8255&&t<=8256}Oe.isNameChar=sH});var ok=y(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});_e.CHAR="-\uD7FF\uE000-\uFFFD\u{10000}-\u{10FFFF}";_e.RESTRICTED_CHAR="-\b\v\f-\x7F-\x84\x86-\x9F";_e.S=` 	\r
`;_e.NAME_START_CHAR=":A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";_e.NAME_CHAR="-"+_e.NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";_e.CHAR_RE=new RegExp("^["+_e.CHAR+"]$","u");_e.RESTRICTED_CHAR_RE=new RegExp("^["+_e.RESTRICTED_CHAR+"]$","u");_e.S_RE=new RegExp("^["+_e.S+"]+$","u");_e.NAME_START_CHAR_RE=new RegExp("^["+_e.NAME_START_CHAR+"]$","u");_e.NAME_CHAR_RE=new RegExp("^["+_e.NAME_CHAR+"]$","u");_e.NAME_RE=new RegExp("^["+_e.NAME_START_CHAR+"]["+_e.NAME_CHAR+"]*$","u");_e.NMTOKEN_RE=new RegExp("^["+_e.NAME_CHAR+"]+$","u");var rk=9,ik=10,nk=13,sk=32;_e.S_LIST=[sk,ik,nk,rk];function aH(t){return t>=1&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111}_e.isChar=aH;function oH(t){return t>=1&&t<=8||t===11||t===12||t>=14&&t<=31||t>=127&&t<=132||t>=134&&t<=159}_e.isRestrictedChar=oH;function lH(t){return t===9||t===10||t===13||t>31&&t<127||t===133||t>159&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111}_e.isCharAndNotRestricted=lH;function uH(t){return t===sk||t===ik||t===nk||t===rk}_e.isS=uH;function ak(t){return t>=65&&t<=90||t>=97&&t<=122||t===58||t===95||t===8204||t===8205||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}_e.isNameStartChar=ak;function fH(t){return ak(t)||t>=48&&t<=57||t===45||t===46||t===183||t>=768&&t<=879||t>=8255&&t<=8256}_e.isNameChar=fH});var uk=y(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.NC_NAME_START_CHAR="A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u{10000}-\u{EFFFF}";Et.NC_NAME_CHAR="-"+Et.NC_NAME_START_CHAR+".0-9\xB7\u0300-\u036F\u203F-\u2040";Et.NC_NAME_START_CHAR_RE=new RegExp("^["+Et.NC_NAME_START_CHAR+"]$","u");Et.NC_NAME_CHAR_RE=new RegExp("^["+Et.NC_NAME_CHAR+"]$","u");Et.NC_NAME_RE=new RegExp("^["+Et.NC_NAME_START_CHAR+"]["+Et.NC_NAME_CHAR+"]*$","u");function lk(t){return t>=65&&t<=90||t===95||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Et.isNCNameStartChar=lk;function hH(t){return lk(t)||t===45||t===46||t>=48&&t<=57||t===183||t>=768&&t<=879||t>=8255&&t<=8256}Et.isNCNameChar=hH});var Ok=y(If=>{"use strict";Object.defineProperty(If,"__esModule",{value:!0});var Bs=tk(),cH=ok(),Tm=uk(),Ct=Bs.isS,dH=Bs.isChar,Jo=Bs.isNameStartChar,fk=Bs.isNameChar,Ek=Bs.S_LIST,pH=Bs.NAME_RE,gH=cH.isChar,mH=Tm.isNCNameStartChar,vH=Tm.isNCNameChar,yH=Tm.NC_NAME_RE,qf="http://www.w3.org/XML/1998/namespace",Ls="http://www.w3.org/2000/xmlns/",_H={__proto__:null,xml:qf,xmlns:Ls},wH={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},Ie=-1,yr=-2,hk=0,bH=1,fm=2,xH=3,Is=4,TH=5,EH=6,CH=7,hm=8,SH=9,kH=10,RH=11,OH=12,_t=13,Of=14,cm=15,AH=16,dm=17,FH=18,NH=19,pm=20,DH=21,qH=22,IH=23,ck=24,gm=25,Af=26,dk=27,MH=28,PH=29,pk=30,LH=31,BH=32,wn=33,jH=34,mm=35,el=36,vm=37,WH=38,gk=39,mk=40,$H=41,vk=42,HH=43,UH=44,ym=9,rr=10,_m=13,yk=32,_k=33,Ck=34,tl=38,Sk=39,Ff=45,Nf=47,zH=59,Ci=60,Ms=61,Ge=62,st=63,kk=91,Ps=93,wk=133,bk=8232,Df=t=>t===Ck||t===Sk,Rk=[Ck,Sk],XH=[...Rk,kk,Ge],VH=[...Rk,Ci,Ps],GH=[Ms,st,...Ek],ZH=[...Ek,Ge,tl,Ci];function bm(t,e,r){switch(e){case"xml":r!==qf&&t.fail(`xml prefix must be bound to ${qf}.`);break;case"xmlns":r!==Ls&&t.fail(`xmlns prefix must be bound to ${Ls}.`);break;default:}switch(r){case Ls:t.fail(e===""?`the default namespace may not be set to ${r}.`:`may not assign a prefix (even "xmlns") to the URI ${Ls}.`);break;case qf:switch(e){case"xml":break;case"":t.fail(`the default namespace may not be set to ${r}.`);break;default:t.fail("may not assign the xml namespace to another prefix.")}break;default:}}function YH(t,e){for(let r of Object.keys(e))bm(t,r,e[r])}var KH=t=>yH.test(t),QH=t=>pH.test(t),bn=0,xk=1,wm=2;If.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];var Tk={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"},xm=class{constructor(e){this.opt=e??{},this.fragmentOpt=!!this.opt.fragment;let r=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,r){this.nameStartCheck=mH,this.nameCheck=vH,this.isName=KH,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},_H);let i=this.opt.additionalNamespaces;i!=null&&(YH(this,i),Object.assign(this.ns,i))}else this.nameStartCheck=Jo,this.nameCheck=fk,this.isName=QH,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var e;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=bn,this.attribList=[];let{fragmentOpt:r}=this;this.state=r?_t:hk,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=r,this.xmlDeclPossible=!r,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:i}=this.opt;if(i===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");i="1.0"}this.setXMLVersion(i),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(wH),(e=this.readyHandler)===null||e===void 0||e.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(e,r){this[Tk[e]]=r}off(e){this[Tk[e]]=void 0}makeError(e){var r;let i=(r=this.fileName)!==null&&r!==void 0?r:"";return this.trackPosition&&(i.length>0&&(i+=":"),i+=`${this.line}:${this.column}`),i.length>0&&(i+=": "),new Error(i+e)}fail(e){let r=this.makeError(e),i=this.errorHandler;if(i===void 0)throw r;return i(r),this}write(e){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let r=!1;e===null?(r=!0,e=""):typeof e=="object"&&(e=e.toString()),this.carriedFromPrevious!==void 0&&(e=`${this.carriedFromPrevious}${e}`,this.carriedFromPrevious=void 0);let i=e.length,n=e.charCodeAt(i-1);!r&&(n===_m||n>=55296&&n<=56319)&&(this.carriedFromPrevious=e[i-1],i--,e=e.slice(0,i));let{stateTable:s}=this;for(this.chunk=e,this.i=0;this.i<i;)s[this.state].call(this);return this.chunkPosition+=i,r?this.end():this}close(){return this.write(null)}getCode10(){let{chunk:e,i:r}=this;if(this.prevI=r,this.i=r+1,r>=e.length)return Ie;let i=e.charCodeAt(r);if(this.column++,i<55296){if(i>=yk||i===ym)return i;switch(i){case rr:return this.line++,this.column=0,this.positionAtNewLine=this.position,rr;case _m:return e.charCodeAt(r+1)===rr&&(this.i=r+2),this.line++,this.column=0,this.positionAtNewLine=this.position,yr;default:return this.fail("disallowed character."),i}}if(i>56319)return i>=57344&&i<=65533||this.fail("disallowed character."),i;let n=65536+(i-55296)*1024+(e.charCodeAt(r+1)-56320);return this.i=r+2,n>1114111&&this.fail("disallowed character."),n}getCode11(){let{chunk:e,i:r}=this;if(this.prevI=r,this.i=r+1,r>=e.length)return Ie;let i=e.charCodeAt(r);if(this.column++,i<55296){if(i>31&&i<127||i>159&&i!==bk||i===ym)return i;switch(i){case rr:return this.line++,this.column=0,this.positionAtNewLine=this.position,rr;case _m:{let s=e.charCodeAt(r+1);(s===rr||s===wk)&&(this.i=r+2)}case wk:case bk:return this.line++,this.column=0,this.positionAtNewLine=this.position,yr;default:return this.fail("disallowed character."),i}}if(i>56319)return i>=57344&&i<=65533||this.fail("disallowed character."),i;let n=65536+(i-55296)*1024+(e.charCodeAt(r+1)-56320);return this.i=r+2,n>1114111&&this.fail("disallowed character."),n}getCodeNorm(){let e=this.getCode();return e===yr?rr:e}unget(){this.i=this.prevI,this.column--}captureTo(e){let{i:r}=this,{chunk:i}=this;for(;;){let n=this.getCode(),s=n===yr,a=s?rr:n;if(a===Ie||e.includes(a))return this.text+=i.slice(r,this.prevI),a;s&&(this.text+=`${i.slice(r,this.prevI)}
`,r=this.i)}}captureToChar(e){let{i:r}=this,{chunk:i}=this;for(;;){let n=this.getCode();switch(n){case yr:this.text+=`${i.slice(r,this.prevI)}
`,r=this.i,n=rr;break;case Ie:return this.text+=i.slice(r),!1;default:}if(n===e)return this.text+=i.slice(r,this.prevI),!0}}captureNameChars(){let{chunk:e,i:r}=this;for(;;){let i=this.getCode();if(i===Ie)return this.name+=e.slice(r),Ie;if(!fk(i))return this.name+=e.slice(r,this.prevI),i===yr?rr:i}}skipSpaces(){for(;;){let e=this.getCodeNorm();if(e===Ie||!Ct(e))return e}}setXMLVersion(e){this.currentXMLVersion=e,e==="1.0"?(this.isChar=dH,this.getCode=this.getCode10):(this.isChar=gH,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=bH}sBeginWhitespace(){let e=this.i,r=this.skipSpaces();switch(this.prevI!==e&&(this.xmlDeclPossible=!1),r){case Ci:if(this.state=cm,this.text.length!==0)throw new Error("no-empty text at start");break;case Ie:break;default:this.unget(),this.state=_t,this.xmlDeclPossible=!1}}sDoctype(){var e;let r=this.captureTo(XH);switch(r){case Ge:{(e=this.doctypeHandler)===null||e===void 0||e.call(this,this.text),this.text="",this.state=_t,this.doctype=!0;break}case Ie:break;default:this.text+=String.fromCodePoint(r),r===kk?this.state=Is:Df(r)&&(this.state=xH,this.q=r)}}sDoctypeQuote(){let e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.q=null,this.state=fm)}sDTD(){let e=this.captureTo(VH);e!==Ie&&(this.text+=String.fromCodePoint(e),e===Ps?this.state=fm:e===Ci?this.state=EH:Df(e)&&(this.state=TH,this.q=e))}sDTDQuoted(){let e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.state=Is,this.q=null)}sDTDOpenWaka(){let e=this.getCodeNorm();switch(this.text+=String.fromCodePoint(e),e){case _k:this.state=CH,this.openWakaBang="";break;case st:this.state=RH;break;default:this.state=Is}}sDTDOpenWakaBang(){let e=String.fromCodePoint(this.getCodeNorm()),r=this.openWakaBang+=e;this.text+=e,r!=="-"&&(this.state=r==="--"?hm:Is,this.openWakaBang="")}sDTDComment(){this.captureToChar(Ff)&&(this.text+="-",this.state=SH)}sDTDCommentEnding(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),this.state=e===Ff?kH:hm}sDTDCommentEnded(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),e===Ge?this.state=Is:(this.fail("malformed comment."),this.state=hm)}sDTDPI(){this.captureToChar(st)&&(this.text+="?",this.state=OH)}sDTDPIEnding(){let e=this.getCodeNorm();this.text+=String.fromCodePoint(e),e===Ge&&(this.state=Is)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:e}=this,{chunk:r}=this;e:for(;;)switch(this.getCode()){case yr:this.entity+=`${r.slice(e,this.prevI)}
`,e=this.i;break;case zH:{let{entityReturnState:i}=this,n=this.entity+r.slice(e,this.prevI);this.state=i;let s;n===""?(this.fail("empty entity name."),s="&;"):(s=this.parseEntity(n),this.entity=""),(i!==_t||this.textHandler!==void 0)&&(this.text+=s);break e}case Ie:this.entity+=r.slice(e);break e;default:}}sOpenWaka(){let e=this.getCode();if(Jo(e))this.state=jH,this.unget(),this.xmlDeclPossible=!1;else switch(e){case Nf:this.state=HH,this.xmlDeclPossible=!1;break;case _k:this.state=AH,this.openWakaBang="",this.xmlDeclPossible=!1;break;case st:this.state=IH;break;default:this.fail("disallowed character in tag name"),this.state=_t,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=pm,this.openWakaBang="";break;case"--":this.state=dm,this.openWakaBang="";break;case"DOCTYPE":this.state=fm,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(Ff)&&(this.state=FH)}sCommentEnding(){var e;let r=this.getCodeNorm();r===Ff?(this.state=NH,(e=this.commentHandler)===null||e===void 0||e.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(r)}`,this.state=dm)}sCommentEnded(){let e=this.getCodeNorm();e!==Ge?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(e)}`,this.state=dm):this.state=_t}sCData(){this.captureToChar(Ps)&&(this.state=DH)}sCDataEnding(){let e=this.getCodeNorm();e===Ps?this.state=qH:(this.text+=`]${String.fromCodePoint(e)}`,this.state=pm)}sCDataEnding2(){var e;let r=this.getCodeNorm();switch(r){case Ge:{(e=this.cdataHandler)===null||e===void 0||e.call(this,this.text),this.text="",this.state=_t;break}case Ps:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(r)}`,this.state=pm}}sPIFirstChar(){let e=this.getCodeNorm();this.nameStartCheck(e)?(this.piTarget+=String.fromCodePoint(e),this.state=ck):e===st||Ct(e)?(this.fail("processing instruction without a target."),this.state=e===st?Af:gm):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(e),this.state=ck)}sPIRest(){let{chunk:e,i:r}=this;for(;;){let i=this.getCodeNorm();if(i===Ie){this.piTarget+=e.slice(r);return}if(!this.nameCheck(i)){this.piTarget+=e.slice(r,this.prevI);let n=i===st;n||Ct(i)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=n?wn:dk):this.state=n?Af:gm:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(i));break}}}sPIBody(){if(this.text.length===0){let e=this.getCodeNorm();e===st?this.state=Af:Ct(e)||(this.text=String.fromCodePoint(e))}else this.captureToChar(st)&&(this.state=Af)}sPIEnding(){var e;let r=this.getCodeNorm();if(r===Ge){let{piTarget:i}=this;i.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(e=this.piHandler)===null||e===void 0||e.call(this,{target:i,body:this.text}),this.piTarget=this.text="",this.state=_t}else r===st?this.text+="?":(this.text+=`?${String.fromCodePoint(r)}`,this.state=gm);this.xmlDeclPossible=!1}sXMLDeclNameStart(){let e=this.skipSpaces();if(e===st){this.state=wn;return}e!==Ie&&(this.state=MH,this.name=String.fromCodePoint(e))}sXMLDeclName(){let e=this.captureTo(GH);if(e===st){this.state=wn,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(!!(Ct(e)||e===Ms)){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=e===Ms?pk:PH}}sXMLDeclEq(){let e=this.getCodeNorm();if(e===st){this.state=wn,this.fail("XML declaration is incomplete.");return}Ct(e)||(e!==Ms&&this.fail("value required."),this.state=pk)}sXMLDeclValueStart(){let e=this.getCodeNorm();if(e===st){this.state=wn,this.fail("XML declaration is incomplete.");return}Ct(e)||(Df(e)?this.q=e:(this.fail("value must be quoted."),this.q=yk),this.state=LH)}sXMLDeclValue(){let e=this.captureTo([this.q,st]);if(e===st){this.state=wn,this.text="",this.fail("XML declaration is incomplete.");return}if(e===Ie)return;let r=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];let i=r;this.xmlDecl.version=i,/^1\.[0-9]+$/.test(i)?this.opt.forceXMLVersion||this.setXMLVersion(i):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(r)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=r;break;case"standalone":r!=="yes"&&r!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=r;break;default:}this.name="",this.state=BH}sXMLDeclSeparator(){let e=this.getCodeNorm();if(e===st){this.state=wn;return}Ct(e)||(this.fail("whitespace required."),this.unget()),this.state=dk}sXMLDeclEnding(){var e;this.getCodeNorm()===Ge?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(e=this.xmldeclHandler)===null||e===void 0||e.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=_t):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var e;let r=this.captureNameChars();if(r===Ie)return;let i=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=i.ns=Object.create(null)),(e=this.openTagStartHandler)===null||e===void 0||e.call(this,i),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),r){case Ge:this.openTag();break;case Nf:this.state=mm;break;default:Ct(r)||this.fail("disallowed character in tag name."),this.state=el}}sOpenTagSlash(){this.getCode()===Ge?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=el)}sAttrib(){let e=this.skipSpaces();e!==Ie&&(Jo(e)?(this.unget(),this.state=vm):e===Ge?this.openTag():e===Nf?this.state=mm:this.fail("disallowed character in attribute name."))}sAttribName(){let e=this.captureNameChars();e===Ms?this.state=gk:Ct(e)?this.state=WH:e===Ge?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):e!==Ie&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){let e=this.skipSpaces();switch(e){case Ie:return;case Ms:this.state=gk;break;default:this.fail("attribute without value."),this.text="",this.name="",e===Ge?this.openTag():Jo(e)?(this.unget(),this.state=vm):(this.fail("disallowed character in attribute name."),this.state=el)}}sAttribValue(){let e=this.getCodeNorm();Df(e)?(this.q=e,this.state=mk):Ct(e)||(this.fail("unquoted attribute value."),this.state=vk,this.unget())}sAttribValueQuoted(){let{q:e,chunk:r}=this,{i}=this;for(;;)switch(this.getCode()){case e:this.pushAttrib(this.name,this.text+r.slice(i,this.prevI)),this.name=this.text="",this.q=null,this.state=$H;return;case tl:this.text+=r.slice(i,this.prevI),this.state=Of,this.entityReturnState=mk;return;case rr:case yr:case ym:this.text+=`${r.slice(i,this.prevI)} `,i=this.i;break;case Ci:this.text+=r.slice(i,this.prevI),this.fail("disallowed character.");return;case Ie:this.text+=r.slice(i);return;default:}}sAttribValueClosed(){let e=this.getCodeNorm();Ct(e)?this.state=el:e===Ge?this.openTag():e===Nf?this.state=mm:Jo(e)?(this.fail("no whitespace between attributes."),this.unget(),this.state=vm):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){let e=this.captureTo(ZH);switch(e){case tl:this.state=Of,this.entityReturnState=vk;break;case Ci:this.fail("disallowed character.");break;case Ie:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",e===Ge?this.openTag():this.state=el}}sCloseTag(){let e=this.captureNameChars();e===Ge?this.closeTag():Ct(e)?this.state=UH:e!==Ie&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case Ge:this.closeTag();break;case Ie:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:e,forbiddenState:r}=this,{chunk:i,textHandler:n}=this;e:for(;;)switch(this.getCode()){case Ci:{if(this.state=cm,n!==void 0){let{text:s}=this,a=i.slice(e,this.prevI);s.length!==0?(n(s+a),this.text=""):a.length!==0&&n(a)}r=bn;break e}case tl:this.state=Of,this.entityReturnState=_t,n!==void 0&&(this.text+=i.slice(e,this.prevI)),r=bn;break e;case Ps:switch(r){case bn:r=xk;break;case xk:r=wm;break;case wm:break;default:throw new Error("impossible state")}break;case Ge:r===wm&&this.fail('the string "]]>" is disallowed in char data.'),r=bn;break;case yr:n!==void 0&&(this.text+=`${i.slice(e,this.prevI)}
`),e=this.i,r=bn;break;case Ie:n!==void 0&&(this.text+=i.slice(e));break e;default:r=bn}this.forbiddenState=r}handleTextOutsideRoot(){let{i:e}=this,{chunk:r,textHandler:i}=this,n=!1;e:for(;;){let s=this.getCode();switch(s){case Ci:{if(this.state=cm,i!==void 0){let{text:a}=this,o=r.slice(e,this.prevI);a.length!==0?(i(a+o),this.text=""):o.length!==0&&i(o)}break e}case tl:this.state=Of,this.entityReturnState=_t,i!==void 0&&(this.text+=r.slice(e,this.prevI)),n=!0;break e;case yr:i!==void 0&&(this.text+=`${r.slice(e,this.prevI)}
`),e=this.i;break;case Ie:i!==void 0&&(this.text+=r.slice(e));break e;default:Ct(s)||(n=!0)}}!n||(!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(e,r){var i;let{prefix:n,local:s}=this.qname(e),a={name:e,prefix:n,local:s,value:r};if(this.attribList.push(a),(i=this.attributeHandler)===null||i===void 0||i.call(this,a),n==="xmlns"){let o=r.trim();this.currentXMLVersion==="1.0"&&o===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[s]=o,bm(this,s,o)}else if(e==="xmlns"){let o=r.trim();this.topNS[""]=o,bm(this,"",o)}}pushAttribPlain(e,r){var i;let n={name:e,value:r};this.attribList.push(n),(i=this.attributeHandler)===null||i===void 0||i.call(this,n)}end(){var e,r;this.sawRoot||this.fail("document must contain a root element.");let{tags:i}=this;for(;i.length>0;){let s=i.pop();this.fail(`unclosed tag: ${s.name}`)}this.state!==hk&&this.state!==_t&&this.fail("unexpected end.");let{text:n}=this;return n.length!==0&&((e=this.textHandler)===null||e===void 0||e.call(this,n),this.text=""),this._closed=!0,(r=this.endHandler)===null||r===void 0||r.call(this),this._init(),this}resolve(e){var r,i;let n=this.topNS[e];if(n!==void 0)return n;let{tags:s}=this;for(let a=s.length-1;a>=0;a--)if(n=s[a].ns[e],n!==void 0)return n;return n=this.ns[e],n!==void 0?n:(i=(r=this.opt).resolvePrefix)===null||i===void 0?void 0:i.call(r,e)}qname(e){let r=e.indexOf(":");if(r===-1)return{prefix:"",local:e};let i=e.slice(r+1),n=e.slice(0,r);return(n===""||i===""||i.includes(":"))&&this.fail(`malformed name: ${e}.`),{prefix:n,local:i}}processAttribsNS(){var e;let{attribList:r}=this,i=this.tag;{let{prefix:a,local:o}=this.qname(i.name);i.prefix=a,i.local=o;let u=i.uri=(e=this.resolve(a))!==null&&e!==void 0?e:"";a!==""&&(a==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),u===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(a)}.`),i.uri=a))}if(r.length===0)return;let{attributes:n}=i,s=new Set;for(let a of r){let{name:o,prefix:u,local:f}=a,h,g;u===""?(h=o==="xmlns"?Ls:"",g=o):(h=this.resolve(u),h===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(u)}.`),h=u),g=`{${h}}${f}`),s.has(g)&&this.fail(`duplicate attribute: ${g}.`),s.add(g),a.uri=h,n[o]=a}this.attribList=[]}processAttribsPlain(){let{attribList:e}=this,r=this.tag.attributes;for(let{name:i,value:n}of e)r[i]!==void 0&&this.fail(`duplicate attribute: ${i}.`),r[i]=n;this.attribList=[]}openTag(){var e;this.processAttribs();let{tags:r}=this,i=this.tag;i.isSelfClosing=!1,(e=this.openTagHandler)===null||e===void 0||e.call(this,i),r.push(i),this.state=_t,this.name=""}openSelfClosingTag(){var e,r,i;this.processAttribs();let{tags:n}=this,s=this.tag;s.isSelfClosing=!0,(e=this.openTagHandler)===null||e===void 0||e.call(this,s),(r=this.closeTagHandler)===null||r===void 0||r.call(this,s),(this.tag=(i=n[n.length-1])!==null&&i!==void 0?i:null)===null&&(this.closedRoot=!0),this.state=_t,this.name=""}closeTag(){let{tags:e,name:r}=this;if(this.state=_t,this.name="",r===""){this.fail("weird empty close tag."),this.text+="</>";return}let i=this.closeTagHandler,n=e.length;for(;n-- >0;){let s=this.tag=e.pop();if(this.topNS=s.ns,i?.(s),s.name===r)break;this.fail("unexpected close tag.")}n===0?this.closedRoot=!0:n<0&&(this.fail(`unmatched closing tag: ${r}.`),this.text+=`</${r}>`)}parseEntity(e){if(e[0]!=="#"){let i=this.ENTITIES[e];return i!==void 0?i:(this.fail(this.isName(e)?"undefined entity.":"disallowed character in entity name."),`&${e};`)}let r=NaN;return e[1]==="x"&&/^#x[0-9a-f]+$/i.test(e)?r=parseInt(e.slice(2),16):/^#[0-9]+$/.test(e)&&(r=parseInt(e.slice(1),10)),this.isChar(r)?String.fromCodePoint(r):(this.fail("malformed character entity."),`&${e};`)}};If.SaxesParser=xm});var rl=y((roe,Ak)=>{var{SaxesParser:JH}=Ok(),{PassThrough:eU}=Ko(),{bufferToString:tU}=sm();Ak.exports=async function*(t){t.pipe&&!t[Symbol.asyncIterator]&&(t=t.pipe(new eU));let e=new JH,r;e.on("error",n=>{r=n});let i=[];e.on("opentag",n=>i.push({eventType:"opentag",value:n})),e.on("text",n=>i.push({eventType:"text",value:n})),e.on("closetag",n=>i.push({eventType:"closetag",value:n}));for await(let n of t){if(e.write(tU(n)),r)throw r;yield i,i=[]}}});var Z=y((ioe,Fk)=>{var rU=rl(),iU=nt(),Si=class{prepare(){}render(){}parseOpen(e){}parseText(e){}parseClose(e){}reconcile(e,r){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(e=>{e instanceof Si?e.reset():e.xform&&e.xform.reset()})}mergeModel(e){this.model=Object.assign(this.model||{},e)}async parse(e){for await(let r of e)for(let{eventType:i,value:n}of r)if(i==="opentag")this.parseOpen(n);else if(i==="text")this.parseText(n);else if(i==="closetag"&&!this.parseClose(n.name))return this.model;return this.model}async parseStream(e){return this.parse(rU(e))}get xml(){return this.toXml(this.model)}toXml(e){let r=new iU;return this.render(r,e),r.xml}static toAttribute(e,r,i=!1){if(e===void 0){if(i)return r}else if(i||e!==r)return e.toString()}static toStringAttribute(e,r,i=!1){return Si.toAttribute(e,r,i)}static toStringValue(e,r){return e===void 0?r:e}static toBoolAttribute(e,r,i=!1){if(e===void 0){if(i)return r}else if(i||e!==r)return e?"1":"0"}static toBoolValue(e,r){return e===void 0?r:e==="1"}static toIntAttribute(e,r,i=!1){return Si.toAttribute(e,r,i)}static toIntValue(e,r){return e===void 0?r:parseInt(e,10)}static toFloatAttribute(e,r,i=!1){return Si.toAttribute(e,r,i)}static toFloatValue(e,r){return e===void 0?r:parseFloat(e)}};Fk.exports=Si});var js=y((noe,Dk)=>{var nU=Z(),sU=nt();function Nk(t,e){t.openNode(e.tag,e.$),e.c&&e.c.forEach(r=>{Nk(t,r)}),e.t&&t.writeText(e.t),t.closeNode()}var Em=class extends nU{constructor(e){super(),this._model=e}render(e){if(!this._xml){let r=new sU;Nk(r,this._model),this._xml=r.xml}e.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(e){switch(e){case this._model.tag:return!1;default:return!0}}};Dk.exports=Em});var xn=y((soe,qk)=>{var aU=Z(),Cm=class extends aU{constructor(e){super(),this.tag=e.tag,this.always=!!e.always,this.count=e.count,this.empty=e.empty,this.$count=e.$count||"count",this.$=e.$,this.childXform=e.childXform,this.maxItems=e.maxItems}prepare(e,r){let{childXform:i}=this;e&&e.forEach((n,s)=>{r.index=s,i.prepare(n,r)})}render(e,r){if(this.always||r&&r.length){e.openNode(this.tag,this.$),this.count&&e.addAttribute(this.$count,r&&r.length||0);let{childXform:i}=this;(r||[]).forEach((n,s)=>{i.render(e,n,s)}),e.closeNode()}else this.empty&&e.leafNode(this.tag)}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:return this.model=[],!0;default:return this.childXform.parseOpen(e)?(this.parser=this.childXform,!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(e,r){if(e){let{childXform:i}=this;e.forEach(n=>{i.reconcile(n,r)})}}};qk.exports=Cm});var ki=y((aoe,Ik)=>{var oU=Z(),Sm=class extends oU{constructor(e){super(),this.name=e||"color"}get tag(){return this.name}render(e,r){return r?(e.openNode(this.name),r.argb?e.addAttribute("rgb",r.argb):r.theme!==void 0?(e.addAttribute("theme",r.theme),r.tint!==void 0&&e.addAttribute("tint",r.tint)):r.indexed!==void 0?e.addAttribute("indexed",r.indexed):e.addAttribute("auto","1"),e.closeNode(),!0):!1}parseOpen(e){return e.name===this.name?(e.attributes.rgb?this.model={argb:e.attributes.rgb}:e.attributes.theme?(this.model={theme:parseInt(e.attributes.theme,10)},e.attributes.tint&&(this.model.tint=parseFloat(e.attributes.tint))):e.attributes.indexed?this.model={indexed:parseInt(e.attributes.indexed,10)}:this.model=void 0,!0):!1}parseText(){}parseClose(){return!1}};Ik.exports=Sm});var Pk=y((ooe,Mk)=>{var lU=Z(),km=class extends lU{constructor(e){super(),this.tag=e.tag,this.attr=e.attr}render(e,r){r&&(e.openNode(this.tag),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}};Mk.exports=km});var Mf=y((loe,Lk)=>{var uU=Z(),Rm=class extends uU{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this.zero=e.zero}render(e,r){(r||this.zero)&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,r):e.writeText(r),e.closeNode())}parseOpen(e){return e.name===this.tag?(this.attr?this.model=parseInt(e.attributes[this.attr],10):this.text=[],!0):!1}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}};Lk.exports=Rm});var Pf=y((uoe,Bk)=>{var fU=Z(),Om=class extends fU{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs}render(e,r){r!==void 0&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,r):e.writeText(r),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=e.attributes[this.attr]:this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}};Bk.exports=Om});var Wk=y((foe,jk)=>{var hU=Z(),Ws=class extends hU{constructor(e){super(),this.model=e}get tag(){return"u"}render(e,r){if(r=r||this.model,r===!0)e.leafNode("u");else{let i=Ws.Attributes[r];i&&e.leafNode("u",i)}}parseOpen(e){e.name==="u"&&(this.model=e.attributes.val||!0)}parseText(){}parseClose(){return!1}};Ws.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}};jk.exports=Ws});var Lf=y((hoe,$k)=>{"use strict";var cU=ki(),Tn=Pk(),Am=Mf(),Fm=Pf(),dU=Wk(),pU=je(),gU=Z(),$s=class extends gU{constructor(e){super(),this.options=e||$s.OPTIONS,this.map={b:{prop:"bold",xform:new Tn({tag:"b",attr:"val"})},i:{prop:"italic",xform:new Tn({tag:"i",attr:"val"})},u:{prop:"underline",xform:new dU},charset:{prop:"charset",xform:new Am({tag:"charset",attr:"val"})},color:{prop:"color",xform:new cU},condense:{prop:"condense",xform:new Tn({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new Tn({tag:"extend",attr:"val"})},family:{prop:"family",xform:new Am({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new Tn({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new Fm({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new Fm({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new Tn({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new Tn({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new Am({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new Fm({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(e,r){let{map:i}=this;e.openNode(this.options.tagName),pU.each(this.map,(n,s)=>{i[s].xform.render(e,r[n.prop])}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(this.map[e.name])return this.parser=this.map[e.name].xform,this.parser.parseOpen(e);switch(e.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser&&!this.parser.parseClose(e)){let r=this.map[e];return this.parser.model&&(this.model[r.prop]=this.parser.model),this.parser=void 0,!0}switch(e){case this.options.tagName:return!1;default:return!0}}};$s.OPTIONS={tagName:"font",fontNameTag:"name"};$k.exports=$s});var Dm=y((coe,Hk)=>{var $f=Z(),Nm=ki(),Bf=class extends $f{constructor(){super(),this.map={color:new Nm}}get tag(){return"stop"}render(e,r){e.openNode("stop"),e.addAttribute("position",r.position),this.map.color.render(e,r.color),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"stop":return this.model={position:parseFloat(e.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(){}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model.color=this.parser.model,this.parser=void 0),!0):!1}},jf=class extends $f{constructor(){super(),this.map={fgColor:new Nm("fgColor"),bgColor:new Nm("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(e,r){e.openNode("patternFill"),e.addAttribute("patternType",r.pattern),r.fgColor&&this.map.fgColor.render(e,r.fgColor),r.bgColor&&this.map.bgColor.render(e,r.bgColor),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"patternFill":return this.model={type:"pattern",pattern:e.attributes.patternType},!0;default:return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser.model&&(this.model[e]=this.parser.model),this.parser=void 0),!0):!1}},Wf=class extends $f{constructor(){super(),this.map={stop:new Bf}}get name(){return"gradient"}get tag(){return"gradientFill"}render(e,r){switch(e.openNode("gradientFill"),r.gradient){case"angle":e.addAttribute("degree",r.degree);break;case"path":e.addAttribute("type","path"),r.center.left&&(e.addAttribute("left",r.center.left),r.center.right===void 0&&e.addAttribute("right",r.center.left)),r.center.right&&e.addAttribute("right",r.center.right),r.center.top&&(e.addAttribute("top",r.center.top),r.center.bottom===void 0&&e.addAttribute("bottom",r.center.top)),r.center.bottom&&e.addAttribute("bottom",r.center.bottom);break;default:break}let i=this.map.stop;r.stops.forEach(n=>{i.render(e,n)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"gradientFill":{let r=this.model={stops:[]};return e.attributes.degree?(r.gradient="angle",r.degree=parseInt(e.attributes.degree,10)):e.attributes.type==="path"&&(r.gradient="path",r.center={left:e.attributes.left?parseFloat(e.attributes.left):0,top:e.attributes.top?parseFloat(e.attributes.top):0},e.attributes.right!==e.attributes.left&&(r.center.right=e.attributes.right?parseFloat(e.attributes.right):0),e.attributes.bottom!==e.attributes.top&&(r.center.bottom=e.attributes.bottom?parseFloat(e.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0):!1}},Hr=class extends $f{constructor(){super(),this.map={patternFill:new jf,gradientFill:new Wf}}get tag(){return"fill"}render(e,r){switch(e.addRollback(),e.openNode("fill"),r.type){case"pattern":this.map.patternFill.render(e,r);break;case"gradient":this.map.gradientFill.render(e,r);break;default:e.rollback();return}e.closeNode(),e.commit()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"fill":return this.model={},!0;default:return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0):!1}validStyle(e){return Hr.validPatternValues[e]}};Hr.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((t,e)=>(t[e]=!0,t),{});Hr.StopXform=Bf;Hr.PatternFillXform=jf;Hr.GradientFillXform=Wf;Hk.exports=Hr});var Im=y((doe,zk)=>{var Uk=Z(),mU=ki(),_r=class extends Uk{constructor(e){super(),this.name=e,this.map={color:new mU}}get tag(){return this.name}render(e,r,i){let n=r&&r.color||i||this.defaultColor;e.openNode(this.name),r&&r.style&&(e.addAttribute("style",r.style),n&&this.map.color.render(e,n)),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.name:{let{style:r}=e.attributes;return r?this.model={style:r}:this.model=void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(e===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(e){return _r.validStyleValues[e]}};_r.validStyleValues=["thin","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((t,e)=>(t[e]=!0,t),{});var qm=class extends Uk{constructor(){super(),this.map={top:new _r("top"),left:new _r("left"),bottom:new _r("bottom"),right:new _r("right"),diagonal:new _r("diagonal")}}render(e,r){let{color:i}=r;e.openNode("border"),r.diagonal&&r.diagonal.style&&(r.diagonal.up&&e.addAttribute("diagonalUp","1"),r.diagonal.down&&e.addAttribute("diagonalDown","1"));function n(s,a){s&&!s.color&&r.color&&(s={...s,color:r.color}),a.render(e,s,i)}n(r.left,this.map.left),n(r.right,this.map.right),n(r.top,this.map.top),n(r.bottom,this.map.bottom),n(r.diagonal,this.map.diagonal),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"border":return this.reset(),this.diagonalUp=!!e.attributes.diagonalUp,this.diagonalDown=!!e.attributes.diagonalDown,!0;default:return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;if(e==="border"){let r=this.model={},i=function(n,s,a){s&&(a&&Object.assign(s,a),r[n]=s)};i("left",this.map.left.model),i("right",this.map.right.model),i("top",this.map.top.model),i("bottom",this.map.bottom.model),i("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}};zk.exports=qm});var Vk=y((poe,Xk)=>{Xk.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},28:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"ja-jp":'yyyy"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":'yyyy"\uB144" mm"\uC6D4" dd"\uC77C"'},32:{"zh-tw":'hh"\u6642"mm"\u5206"',"zh-cn":'h"\u65F6"mm"\u5206"',"ja-jp":'h"\u6642"mm"\u5206"',"ko-kr":'h"\uC2DC" mm"\uBD84"'},33:{"zh-tw":'hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'h"\u6642"mm"\u5206"ss"\u79D2"',"ko-kr":'h"\uC2DC" mm"\uBD84" ss"\uCD08"'},34:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},51:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},52:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},55:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"',"ja-jp":'yyyy"\u5E74"m"\u6708"',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'\u4E0A\u5348/\u4E0B\u5348 hh"\u6642"mm"\u5206"ss"\u79D2"',"zh-cn":'\u4E0A\u5348/\u4E0B\u5348 h"\u65F6"mm"\u5206"ss"\u79D2"',"ja-jp":'m"\u6708"d"\u65E5"',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy"\u5E74"m"\u6708"',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"\u5E74" mm"\u6708" dd"\u65E5"'},58:{"zh-tw":'[$-404]e"\u5E74"m"\u6708"d"\u65E5"',"zh-cn":'m"\u6708"d"\u65E5"',"ja-jp":'[$-411]ggge"\u5E74"m"\u6708"d"\u65E5"',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}});var Pm=y((goe,Gk)=>{var vU=je(),Mm=Vk(),yU=Z();function _U(){let t={};return vU.each(Mm,(e,r)=>{e.f&&(t[e.f]=parseInt(r,10))}),t}var wU=_U(),il=class extends yU{constructor(e,r){super(),this.id=e,this.formatCode=r}get tag(){return"numFmt"}render(e,r){e.leafNode("numFmt",{numFmtId:r.id,formatCode:r.formatCode})}parseOpen(e){switch(e.name){case"numFmt":return this.model={id:parseInt(e.attributes.numFmtId,10),formatCode:e.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}};il.getDefaultFmtId=function(e){return wU[e]};il.getDefaultFmtCode=function(e){return Mm[e]&&Mm[e].f};Gk.exports=il});var jm=y((moe,Kk)=>{var Zk=Zt(),Lm=qt(),bU=Z(),En={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((t,e)=>(t[e]=!0,t),{}),horizontal(t){return this.horizontalValues[t]?t:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((t,e)=>(t[e]=!0,t),{}),vertical(t){return t==="middle"?"center":this.verticalValues[t]?t:void 0},wrapText(t){return t?!0:void 0},shrinkToFit(t){return t?!0:void 0},textRotation(t){switch(t){case"vertical":return t;default:return t=Lm.validInt(t),t>=-90&&t<=90?t:void 0}},indent(t){return t=Lm.validInt(t),Math.max(0,t)},readingOrder(t){switch(t){case"ltr":return Zk.ReadingOrder.LeftToRight;case"rtl":return Zk.ReadingOrder.RightToLeft;default:return}}},Yk={toXml(t){if(t=En.textRotation(t),t){if(t==="vertical")return 255;let e=Math.round(t);if(e>=0&&e<=90)return e;if(e<0&&e>=-90)return 90-e}},toModel(t){let e=Lm.validInt(t);if(e!==void 0){if(e===255)return"vertical";if(e>=0&&e<=90)return e;if(e>90&&e<=180)return 90-e}}},Bm=class extends bU{get tag(){return"alignment"}render(e,r){e.addRollback(),e.openNode("alignment");let i=!1;function n(s,a){a&&(e.addAttribute(s,a),i=!0)}n("horizontal",En.horizontal(r.horizontal)),n("vertical",En.vertical(r.vertical)),n("wrapText",En.wrapText(r.wrapText)?"1":!1),n("shrinkToFit",En.shrinkToFit(r.shrinkToFit)?"1":!1),n("indent",En.indent(r.indent)),n("textRotation",Yk.toXml(r.textRotation)),n("readingOrder",En.readingOrder(r.readingOrder)),e.closeNode(),i?e.commit():e.rollback()}parseOpen(e){let r={},i=!1;function n(s,a,o){s&&(r[a]=o,i=!0)}n(e.attributes.horizontal,"horizontal",e.attributes.horizontal),n(e.attributes.vertical,"vertical",e.attributes.vertical==="center"?"middle":e.attributes.vertical),n(e.attributes.wrapText,"wrapText",!!e.attributes.wrapText),n(e.attributes.shrinkToFit,"shrinkToFit",!!e.attributes.shrinkToFit),n(e.attributes.indent,"indent",parseInt(e.attributes.indent,10)),n(e.attributes.textRotation,"textRotation",Yk.toModel(e.attributes.textRotation)),n(e.attributes.readingOrder,"readingOrder",e.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=i?r:null}parseText(){}parseClose(){return!1}};Kk.exports=Bm});var $m=y((voe,Jk)=>{var xU=Z(),Qk={boolean(t,e){return t===void 0?e:t}},Wm=class extends xU{get tag(){return"protection"}render(e,r){e.addRollback(),e.openNode("protection");let i=!1;function n(s,a){a!==void 0&&(e.addAttribute(s,a),i=!0)}n("locked",Qk.boolean(r.locked,!0)?void 0:"0"),n("hidden",Qk.boolean(r.hidden,!1)?"1":void 0),e.closeNode(),i?e.commit():e.rollback()}parseOpen(e){let r={locked:e.attributes.locked!=="0",hidden:e.attributes.hidden==="1"},i=!r.locked||r.hidden;this.model=i?r:null}parseText(){}parseClose(){return!1}};Jk.exports=Wm});var tR=y((yoe,eR)=>{var TU=Z(),EU=jm(),CU=$m(),Hm=class extends TU{constructor(e){super(),this.xfId=!!(e&&e.xfId),this.map={alignment:new EU,protection:new CU}}get tag(){return"xf"}render(e,r){e.openNode("xf",{numFmtId:r.numFmtId||0,fontId:r.fontId||0,fillId:r.fillId||0,borderId:r.borderId||0}),this.xfId&&e.addAttribute("xfId",r.xfId||0),r.numFmtId&&e.addAttribute("applyNumberFormat","1"),r.fontId&&e.addAttribute("applyFont","1"),r.fillId&&e.addAttribute("applyFill","1"),r.borderId&&e.addAttribute("applyBorder","1"),r.alignment&&e.addAttribute("applyAlignment","1"),r.protection&&e.addAttribute("applyProtection","1"),r.alignment&&this.map.alignment.render(e,r.alignment),r.protection&&this.map.protection.render(e,r.protection),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"xf":return this.model={numFmtId:parseInt(e.attributes.numFmtId,10),fontId:parseInt(e.attributes.fontId,10),fillId:parseInt(e.attributes.fillId,10),borderId:parseInt(e.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(e.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(e),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):e!=="xf"}};eR.exports=Hm});var iR=y((_oe,rR)=>{var SU=Z(),kU=jm(),RU=Im(),OU=Dm(),AU=Lf(),FU=Pm(),NU=$m(),Um=class extends SU{constructor(){super(),this.map={alignment:new kU,border:new RU,fill:new OU,font:new AU,numFmt:new FU,protection:new NU}}get tag(){return"dxf"}render(e,r){e.openNode(this.tag),r.font&&this.map.font.render(e,r.font),r.numFmt&&this.map.numFmt.render(e,r.numFmt),r.fill&&this.map.fill.render(e,r.fill),r.alignment&&this.map.alignment.render(e,r.alignment),r.border&&this.map.border.render(e,r.border),r.protection&&this.map.protection.render(e,r.protection),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):e===this.tag?(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1):!0}};rR.exports=Um});var zf=y((woe,oR)=>{var Uf=Zt(),DU=nt(),qU=Z(),Hf=js(),Cn=xn(),nR=Lf(),sR=Dm(),aR=Im(),nl=Pm(),zm=tR(),IU=iR(),MU=164,wt=class extends qU{constructor(e){super(),this.map={numFmts:new Cn({tag:"numFmts",count:!0,childXform:new nl}),fonts:new Cn({tag:"fonts",count:!0,childXform:new nR,$:{"x14ac:knownFonts":1}}),fills:new Cn({tag:"fills",count:!0,childXform:new sR}),borders:new Cn({tag:"borders",count:!0,childXform:new aR}),cellStyleXfs:new Cn({tag:"cellStyleXfs",count:!0,childXform:new zm}),cellXfs:new Cn({tag:"cellXfs",count:!0,childXform:new zm({xfId:!0})}),dxfs:new Cn({tag:"dxfs",always:!0,count:!0,childXform:new IU}),numFmt:new nl,font:new nR,fill:new sR,border:new aR,style:new zm({xfId:!0}),cellStyles:wt.STATIC_XFORMS.cellStyles,tableStyles:wt.STATIC_XFORMS.tableStyles,extLst:wt.STATIC_XFORMS.extLst},e&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(e,r){r=r||this.model,e.openXml(DU.StdDocAttributes),e.openNode("styleSheet",wt.STYLESHEET_ATTRIBUTES),this.index?(r.numFmts&&r.numFmts.length&&(e.openNode("numFmts",{count:r.numFmts.length}),r.numFmts.forEach(i=>{e.writeXml(i)}),e.closeNode()),r.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),e.openNode("fonts",{count:r.fonts.length,"x14ac:knownFonts":1}),r.fonts.forEach(i=>{e.writeXml(i)}),e.closeNode(),e.openNode("fills",{count:r.fills.length}),r.fills.forEach(i=>{e.writeXml(i)}),e.closeNode(),e.openNode("borders",{count:r.borders.length}),r.borders.forEach(i=>{e.writeXml(i)}),e.closeNode(),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),e.openNode("cellXfs",{count:r.styles.length}),r.styles.forEach(i=>{e.writeXml(i)}),e.closeNode()):(this.map.numFmts.render(e,r.numFmts),this.map.fonts.render(e,r.fonts),this.map.fills.render(e,r.fills),this.map.borders.render(e,r.borders),this.map.cellStyleXfs.render(e,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(e,r.styles)),wt.STATIC_XFORMS.cellStyles.render(e),this.map.dxfs.render(e,r.dxfs),wt.STATIC_XFORMS.tableStyles.render(e),wt.STATIC_XFORMS.extLst.render(e),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"styleSheet":{this.model={};let r=(i,n)=>{n.model&&n.model.length&&(this.model[i]=n.model)};if(r("numFmts",this.map.numFmts),r("fonts",this.map.fonts),r("fills",this.map.fills),r("borders",this.map.borders),r("styles",this.map.cellXfs),r("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){let i=this.index.numFmt;this.model.numFmts.forEach(n=>{i[n.id]=n.formatCode})}return!1}default:return!0}}addStyleModel(e,r){if(!e)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(e))return this.weakMap.get(e);let i={};if(r=r||Uf.ValueType.Number,e.numFmt)i.numFmtId=this._addNumFmtStr(e.numFmt);else switch(r){case Uf.ValueType.Number:i.numFmtId=this._addNumFmtStr("General");break;case Uf.ValueType.Date:i.numFmtId=this._addNumFmtStr("mm-dd-yy");break;default:break}e.font&&(i.fontId=this._addFont(e.font)),e.border&&(i.borderId=this._addBorder(e.border)),e.fill&&(i.fillId=this._addFill(e.fill)),e.alignment&&(i.alignment=e.alignment),e.protection&&(i.protection=e.protection);let n=this._addStyle(i);return this.weakMap&&this.weakMap.set(e,n),n}getStyleModel(e){let r=this.model.styles[e];if(!r)return null;let i=this.index.model[e];if(i)return i;if(i=this.index.model[e]={},r.numFmtId){let s=this.index.numFmt[r.numFmtId]||nl.getDefaultFmtCode(r.numFmtId);s&&(i.numFmt=s)}function n(s,a,o){if(o||o===0){let u=a[o];u&&(i[s]=u)}}return n("font",this.model.fonts,r.fontId),n("border",this.model.borders,r.borderId),n("fill",this.model.fills,r.fillId),r.alignment&&(i.alignment=r.alignment),r.protection&&(i.protection=r.protection),i}addDxfStyle(e){return this.model.dxfs.push(e),this.model.dxfs.length-1}getDxfStyle(e){return this.model.dxfs[e]}_addStyle(e){let r=this.map.style.toXml(e),i=this.index.style[r];return i===void 0&&(i=this.index.style[r]=this.model.styles.length,this.model.styles.push(r)),i}_addNumFmtStr(e){let r=nl.getDefaultFmtId(e);if(r!==void 0||(r=this.index.numFmt[e],r!==void 0))return r;r=this.index.numFmt[e]=MU+this.model.numFmts.length;let i=this.map.numFmt.toXml({id:r,formatCode:e});return this.model.numFmts.push(i),r}_addFont(e){let r=this.map.font.toXml(e),i=this.index.font[r];return i===void 0&&(i=this.index.font[r]=this.model.fonts.length,this.model.fonts.push(r)),i}_addBorder(e){let r=this.map.border.toXml(e),i=this.index.border[r];return i===void 0&&(i=this.index.border[r]=this.model.borders.length,this.model.borders.push(r)),i}_addFill(e){let r=this.map.fill.toXml(e),i=this.index.fill[r];return i===void 0&&(i=this.index.fill[r]=this.model.fills.length,this.model.fills.push(r)),i}};wt.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"};wt.STATIC_XFORMS={cellStyles:new Hf({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new Hf({tag:"dxfs",$:{count:0}}),tableStyles:new Hf({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new Hf({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})};var Xm=class extends wt{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(e){return e.autodrain(),Promise.resolve()}addStyleModel(e,r){switch(r){case Uf.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){let e={numFmtId:nl.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(e)}return this._dateStyleId}getStyleModel(){return{}}};wt.Mock=Xm;oR.exports=wt});var uR=y((boe,lR)=>{var PU=Z(),Vm=class extends PU{constructor(e){super(),this.tag=e.tag,this.attr=e.attr,this.attrs=e.attrs,this._format=e.format||function(r){try{return Number.isNaN(r.getTime())?"":r.toISOString()}catch{return""}},this._parse=e.parse||function(r){return new Date(r)}}render(e,r){r&&(e.openNode(this.tag),this.attrs&&e.addAttributes(this.attrs),this.attr?e.addAttribute(this.attr,this._format(r)):e.writeText(this._format(r)),e.closeNode())}parseOpen(e){e.name===this.tag&&(this.attr?this.model=this._parse(e.attributes[this.attr]):this.text=[])}parseText(e){this.attr||this.text.push(e)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}};lR.exports=Vm});var Zm=y((xoe,fR)=>{var LU=nt(),BU=Z(),Gm=uR(),Ut=Pf(),jU=Mf(),It=class extends BU{constructor(){super(),this.map={"dc:creator":new Ut({tag:"dc:creator"}),"dc:title":new Ut({tag:"dc:title"}),"dc:subject":new Ut({tag:"dc:subject"}),"dc:description":new Ut({tag:"dc:description"}),"dc:identifier":new Ut({tag:"dc:identifier"}),"dc:language":new Ut({tag:"dc:language"}),"cp:keywords":new Ut({tag:"cp:keywords"}),"cp:category":new Ut({tag:"cp:category"}),"cp:lastModifiedBy":new Ut({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new Gm({tag:"cp:lastPrinted",format:It.DateFormat}),"cp:revision":new jU({tag:"cp:revision"}),"cp:version":new Ut({tag:"cp:version"}),"cp:contentStatus":new Ut({tag:"cp:contentStatus"}),"cp:contentType":new Ut({tag:"cp:contentType"}),"dcterms:created":new Gm({tag:"dcterms:created",attrs:It.DateAttrs,format:It.DateFormat}),"dcterms:modified":new Gm({tag:"dcterms:modified",attrs:It.DateAttrs,format:It.DateFormat})}}render(e,r){e.openXml(LU.StdDocAttributes),e.openNode("cp:coreProperties",It.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(e,r.creator),this.map["dc:title"].render(e,r.title),this.map["dc:subject"].render(e,r.subject),this.map["dc:description"].render(e,r.description),this.map["dc:identifier"].render(e,r.identifier),this.map["dc:language"].render(e,r.language),this.map["cp:keywords"].render(e,r.keywords),this.map["cp:category"].render(e,r.category),this.map["cp:lastModifiedBy"].render(e,r.lastModifiedBy),this.map["cp:lastPrinted"].render(e,r.lastPrinted),this.map["cp:revision"].render(e,r.revision),this.map["cp:version"].render(e,r.version),this.map["cp:contentStatus"].render(e,r.contentStatus),this.map["cp:contentType"].render(e,r.contentType),this.map["dcterms:created"].render(e,r.created),this.map["dcterms:modified"].render(e,r.modified),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[e.name],this.parser)return this.parser.parseOpen(e),!0;throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error(`Unexpected xml node in parseClose: ${e}`)}}};It.DateFormat=function(t){return t.toISOString().replace(/[.]\d{3}/,"")};It.DateAttrs={"xsi:type":"dcterms:W3CDTF"};It.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"};fR.exports=It});var Xf=y((Toe,hR)=>{var WU=Z(),Ym=class extends WU{get tag(){return"t"}render(e,r){e.openNode("t"),/^\s|\n|\s$/.test(r)&&e.addAttribute("xml:space","preserve"),e.writeText(r),e.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(e,r)=>String.fromCharCode(parseInt(r,16)))}parseOpen(e){switch(e.name){case"t":return this._text=[],!0;default:return!1}}parseText(e){this._text.push(e)}parseClose(){return!1}};hR.exports=Ym});var sl=y((Eoe,cR)=>{var $U=Xf(),HU=Lf(),UU=Z(),Hs=class extends UU{constructor(e){super(),this.model=e}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new $U)}get fontXform(){return this._fontXform||(this._fontXform=new HU(Hs.FONT_OPTIONS))}render(e,r){r=r||this.model,e.openNode("r"),r.font&&this.fontXform.render(e,r.font),this.textXform.render(e,r.text),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(e),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){switch(e){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(e),!0}}};Hs.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"};cR.exports=Hs});var pR=y((Coe,dR)=>{var zU=Xf(),XU=sl(),VU=Z(),Km=class extends VU{constructor(){super(),this.map={r:new XU,t:new zU}}get tag(){return"rPh"}render(e,r){if(e.openNode(this.tag,{sb:r.sb||0,eb:r.eb||0}),r&&r.hasOwnProperty("richText")&&r.richText){let{r:i}=this.map;r.richText.forEach(n=>{i.render(e,n)})}else r&&this.map.t.render(e,r.text);e.closeNode()}parseOpen(e){let{name:r}=e;return this.parser?(this.parser.parseOpen(e),!0):r===this.tag?(this.model={sb:parseInt(e.attributes.sb,10),eb:parseInt(e.attributes.eb,10)},!0):(this.parser=this.map[r],this.parser?(this.parser.parseOpen(e),!0):!1)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let r=this.model.richText;r||(r=this.model.richText=[]),r.push(this.parser.model);break}case"t":this.model.text=this.parser.model;break;default:break}this.parser=void 0}return!0}switch(e){case this.tag:return!1;default:return!0}}};dR.exports=Km});var mR=y((Soe,gR)=>{var GU=Xf(),ZU=sl(),YU=pR(),KU=Z(),Qm=class extends KU{constructor(e){super(),this.model=e,this.map={r:new ZU,t:new GU,rPh:new YU}}get tag(){return"si"}render(e,r){e.openNode(this.tag),r&&r.hasOwnProperty("richText")&&r.richText?r.richText.length?r.richText.forEach(i=>{this.map.r.render(e,i)}):this.map.t.render(e,""):r!=null&&this.map.t.render(e,r),e.closeNode()}parseOpen(e){let{name:r}=e;return this.parser?(this.parser.parseOpen(e),!0):r===this.tag?(this.model={},!0):(this.parser=this.map[r],this.parser?(this.parser.parseOpen(e),!0):!1)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){switch(e){case"r":{let r=this.model.richText;r||(r=this.model.richText=[]),r.push(this.parser.model);break}case"t":this.model=this.parser.model;break;default:break}this.parser=void 0}return!0}switch(e){case this.tag:return!1;default:return!0}}};gR.exports=Qm});var ev=y((koe,vR)=>{var QU=nt(),JU=Z(),ez=mR(),Jm=class extends JU{constructor(e){super(),this.model=e||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new ez)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(e){return this.model.values[e]}add(e){return e.richText?this.addRichText(e):this.addText(e)}addText(e){let r=this.hash[e];return r===void 0&&(r=this.hash[e]=this.model.values.length,this.model.values.push(e)),this.model.count++,r}addRichText(e){let r=this.sharedStringXform.toXml(e),i=this.rich[r];return i===void 0&&(i=this.rich[r]=this.model.values.length,this.model.values.push(e)),this.model.count++,i}render(e,r){r=r||this._values,e.openXml(QU.StdDocAttributes),e.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:r.count,uniqueCount:r.values.length});let i=this.sharedStringXform;r.values.forEach(n=>{i.render(e,n)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(e),!0;default:throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(e){case"sst":return!1;default:throw new Error(`Unexpected xml node in parseClose: ${e}`)}}};vR.exports=Jm});var _R=y((Roe,yR)=>{var tz=Z(),tv=class extends tz{render(e,r){e.leafNode("Relationship",r)}parseOpen(e){switch(e.name){case"Relationship":return this.model=e.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}};yR.exports=tv});var Vf=y((Ooe,wR)=>{var rz=nt(),iz=Z(),nz=_R(),Us=class extends iz{constructor(){super(),this.map={Relationship:new nz}}render(e,r){r=r||this._values,e.openXml(rz.StdDocAttributes),e.openNode("Relationships",Us.RELATIONSHIPS_ATTRIBUTES),r.forEach(i=>{this.map.Relationship.render(e,i)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[e.name],this.parser)return this.parser.parseOpen(e),!0;throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(e){case"Relationships":return!1;default:throw new Error(`Unexpected xml node in parseClose: ${e}`)}}};Us.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"};wR.exports=Us});var rv=y((Aoe,bR)=>{var sz=nt(),az=Z(),zs=class extends az{render(e,r){e.openXml(sz.StdDocAttributes),e.openNode("Types",zs.PROPERTY_ATTRIBUTES);let i={};(r.media||[]).forEach(s=>{if(s.type==="image"){let a=s.extension;i[a]||(i[a]=!0,e.leafNode("Default",{Extension:a,ContentType:`image/${a}`}))}}),e.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),e.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),e.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),r.worksheets.forEach(s=>{let a=`/xl/worksheets/sheet${s.id}.xml`;e.leafNode("Override",{PartName:a,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),e.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),e.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),r.sharedStrings&&r.sharedStrings.count&&e.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),r.tables&&r.tables.forEach(s=>{e.leafNode("Override",{PartName:`/xl/tables/${s.target}`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),r.drawings&&r.drawings.forEach(s=>{e.leafNode("Override",{PartName:`/xl/drawings/${s.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),r.commentRefs&&(e.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),r.commentRefs.forEach(({commentName:s})=>{e.leafNode("Override",{PartName:`/xl/${s}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),e.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),e.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),e.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}};zs.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"};bR.exports=zs});var TR=y((Foe,xR)=>{var oz=Z(),iv=class extends oz{render(e,r){e.openNode("HeadingPairs"),e.openNode("vt:vector",{size:2,baseType:"variant"}),e.openNode("vt:variant"),e.leafNode("vt:lpstr",void 0,"Worksheets"),e.closeNode(),e.openNode("vt:variant"),e.leafNode("vt:i4",void 0,r.length),e.closeNode(),e.closeNode(),e.closeNode()}parseOpen(e){return e.name==="HeadingPairs"}parseText(){}parseClose(e){return e!=="HeadingPairs"}};xR.exports=iv});var CR=y((Noe,ER)=>{var lz=Z(),nv=class extends lz{render(e,r){e.openNode("TitlesOfParts"),e.openNode("vt:vector",{size:r.length,baseType:"lpstr"}),r.forEach(i=>{e.leafNode("vt:lpstr",void 0,i.name)}),e.closeNode(),e.closeNode()}parseOpen(e){return e.name==="TitlesOfParts"}parseText(){}parseClose(e){return e!=="TitlesOfParts"}};ER.exports=nv});var sv=y((Doe,kR)=>{var uz=nt(),fz=Z(),SR=Pf(),hz=TR(),cz=CR(),Ri=class extends fz{constructor(){super(),this.map={Company:new SR({tag:"Company"}),Manager:new SR({tag:"Manager"}),HeadingPairs:new hz,TitleOfParts:new cz}}render(e,r){e.openXml(uz.StdDocAttributes),e.openNode("Properties",Ri.PROPERTY_ATTRIBUTES),e.leafNode("Application",void 0,"Microsoft Excel"),e.leafNode("DocSecurity",void 0,"0"),e.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(e,r.worksheets),this.map.TitleOfParts.render(e,r.worksheets),this.map.Company.render(e,r.company||""),this.map.Manager.render(e,r.manager),e.leafNode("LinksUpToDate",void 0,"false"),e.leafNode("SharedDoc",void 0,"false"),e.leafNode("HyperlinksChanged",void 0,"false"),e.leafNode("AppVersion",void 0,"16.0300"),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"Properties":return!0;default:return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}};Ri.DateFormat=function(t){return t.toISOString().replace(/[.]\d{3,6}/,"")};Ri.DateAttrs={"xsi:type":"dcterms:W3CDTF"};Ri.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"};kR.exports=Ri});var OR=y((qoe,RR)=>{var dz=Z(),pz=Me(),ov=class extends dz{render(e,r){e.openNode("definedName",{name:r.name,localSheetId:r.localSheetId}),e.writeText(r.ranges.join(",")),e.closeNode()}parseOpen(e){switch(e.name){case"definedName":return this._parsedName=e.attributes.name,this._parsedLocalSheetId=e.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(e){this._parsedText.push(e)}parseClose(){return this.model={name:this._parsedName,ranges:gz(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}};function av(t){try{return pz.decodeEx(t),!0}catch{return!1}}function gz(t){let e=[],r=!1,i="";return t.split(",").forEach(n=>{if(!n)return;let s=(n.match(/'/g)||[]).length;if(!s){r?i+=`${n},`:av(n)&&e.push(n);return}let a=s%2===0;!r&&a&&av(n)?e.push(n):r&&!a?(r=!1,av(i+n)&&e.push(i+n),i=""):(r=!0,i+=`${n},`)}),e}RR.exports=ov});var FR=y((Ioe,AR)=>{var mz=qt(),vz=Z(),lv=class extends vz{render(e,r){e.leafNode("sheet",{sheetId:r.id,name:r.name,state:r.state,"r:id":r.rId})}parseOpen(e){return e.name==="sheet"?(this.model={name:mz.xmlDecode(e.attributes.name),id:parseInt(e.attributes.sheetId,10),state:e.attributes.state,rId:e.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}};AR.exports=lv});var DR=y((Moe,NR)=>{var yz=Z(),uv=class extends yz{render(e,r){let i={xWindow:r.x||0,yWindow:r.y||0,windowWidth:r.width||12e3,windowHeight:r.height||24e3,firstSheet:r.firstSheet,activeTab:r.activeTab};r.visibility&&r.visibility!=="visible"&&(i.visibility=r.visibility),e.leafNode("workbookView",i)}parseOpen(e){if(e.name==="workbookView"){let r=this.model={},i=function(s,a,o){let u=a!==void 0?r[s]=a:o;u!==void 0&&(r[s]=u)},n=function(s,a,o){let u=a!==void 0?r[s]=parseInt(a,10):o;u!==void 0&&(r[s]=u)};return n("x",e.attributes.xWindow,0),n("y",e.attributes.yWindow,0),n("width",e.attributes.windowWidth,25e3),n("height",e.attributes.windowHeight,1e4),i("visibility",e.attributes.visibility,"visible"),n("activeTab",e.attributes.activeTab,void 0),n("firstSheet",e.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}};NR.exports=uv});var IR=y((Poe,qR)=>{var _z=Z(),fv=class extends _z{render(e,r){e.leafNode("workbookPr",{date1904:r.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(e){return e.name==="workbookPr"?(this.model={date1904:e.attributes.date1904==="1"},!0):!1}parseText(){}parseClose(){return!1}};qR.exports=fv});var PR=y((Loe,MR)=>{var wz=Z(),hv=class extends wz{render(e,r){e.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:r.fullCalcOnLoad?1:void 0})}parseOpen(e){return e.name==="calcPr"?(this.model={},!0):!1}parseText(){}parseClose(){return!1}};MR.exports=hv});var Gf=y((Boe,LR)=>{var bz=je(),xz=Me(),Tz=nt(),Ez=Z(),Cz=js(),cv=xn(),Sz=OR(),kz=FR(),Rz=DR(),Oz=IR(),Az=PR(),Oi=class extends Ez{constructor(){super(),this.map={fileVersion:Oi.STATIC_XFORMS.fileVersion,workbookPr:new Oz,bookViews:new cv({tag:"bookViews",count:!1,childXform:new Rz}),sheets:new cv({tag:"sheets",count:!1,childXform:new kz}),definedNames:new cv({tag:"definedNames",count:!1,childXform:new Sz}),calcPr:new Az}}prepare(e){e.sheets=e.worksheets;let r=[],i=0;e.sheets.forEach(n=>{if(n.pageSetup&&n.pageSetup.printArea&&n.pageSetup.printArea.split("&&").forEach(s=>{let a=s.split(":"),o={name:"_xlnm.Print_Area",ranges:[`'${n.name}'!$${a[0]}:$${a[1]}`],localSheetId:i};r.push(o)}),n.pageSetup&&(n.pageSetup.printTitlesRow||n.pageSetup.printTitlesColumn)){let s=[];if(n.pageSetup.printTitlesColumn){let o=n.pageSetup.printTitlesColumn.split(":");s.push(`'${n.name}'!$${o[0]}:$${o[1]}`)}if(n.pageSetup.printTitlesRow){let o=n.pageSetup.printTitlesRow.split(":");s.push(`'${n.name}'!$${o[0]}:$${o[1]}`)}let a={name:"_xlnm.Print_Titles",ranges:s,localSheetId:i};r.push(a)}i++}),r.length&&(e.definedNames=e.definedNames.concat(r)),(e.media||[]).forEach((n,s)=>{n.name=n.type+(s+1)})}render(e,r){e.openXml(Tz.StdDocAttributes),e.openNode("workbook",Oi.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(e),this.map.workbookPr.render(e,r.properties),this.map.bookViews.render(e,r.views),this.map.sheets.render(e,r.sheets),this.map.definedNames.render(e,r.definedNames),this.map.calcPr.render(e,r.calcProperties),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"workbook":return!0;default:return this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(e){let r=(e.workbookRels||[]).reduce((o,u)=>(o[u.Id]=u,o),{}),i=[],n,s=0;(e.sheets||[]).forEach(o=>{let u=r[o.rId];!u||(n=e.worksheetHash[`xl/${u.Target.replace(/^(\s|\/xl\/)+/,"")}`],n&&(n.name=o.name,n.id=o.id,n.state=o.state,i[s++]=n))});let a=[];bz.each(e.definedNames,o=>{if(o.name==="_xlnm.Print_Area"){if(n=i[o.localSheetId],n){n.pageSetup||(n.pageSetup={});let u=xz.decodeEx(o.ranges[0]);n.pageSetup.printArea=n.pageSetup.printArea?`${n.pageSetup.printArea}&&${u.dimensions}`:u.dimensions}}else if(o.name==="_xlnm.Print_Titles"){if(n=i[o.localSheetId],n){n.pageSetup||(n.pageSetup={});let u=o.ranges.join(","),f=/\$/g,h=/\$\d+:\$\d+/,g=u.match(h);if(g&&g.length){let d=g[0];n.pageSetup.printTitlesRow=d.replace(f,"")}let m=/\$[A-Z]+:\$[A-Z]+/,c=u.match(m);if(c&&c.length){let d=c[0];n.pageSetup.printTitlesColumn=d.replace(f,"")}}}else a.push(o)}),e.definedNames=a,e.media.forEach((o,u)=>{o.index=u})}};Oi.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"};Oi.STATIC_XFORMS={fileVersion:new Cz({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})};LR.exports=Oi});var Ai=y((joe,BR)=>{"use strict";BR.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}});var UR=y((Woe,HR)=>{var jR=je(),Fz=Fr(),WR=Me(),$R=Zt(),dv=class{constructor(){this.merges={}}add(e){if(this.merges[e.master])this.merges[e.master].expandToAddress(e.address);else{let r=`${e.master}:${e.address}`;this.merges[e.master]=new Fz(r)}}get mergeCells(){return jR.map(this.merges,e=>e.range)}reconcile(e,r){jR.each(e,i=>{let n=WR.decode(i);for(let s=n.top;s<=n.bottom;s++){let a=r[s-1];for(let o=n.left;o<=n.right;o++){let u=a.cells[o-1];u?u.type===$R.ValueType.Merge&&(u.master=n.tl):a.cells[o]={type:$R.ValueType.Null,address:WR.encodeAddress(s,o)}}}})}getMasterAddress(e){let r=this.hash[e];return r&&r.tl}};HR.exports=dv});var VR=y(($oe,XR)=>{var Fi=qt(),Nz=Z(),Dz=Fr(),re=Zt(),qz=sl();function zR(t){if(t==null)return re.ValueType.Null;if(t instanceof String||typeof t=="string")return re.ValueType.String;if(typeof t=="number")return re.ValueType.Number;if(typeof t=="boolean")return re.ValueType.Boolean;if(t instanceof Date)return re.ValueType.Date;if(t.text&&t.hyperlink)return re.ValueType.Hyperlink;if(t.formula)return re.ValueType.Formula;if(t.error)return re.ValueType.Error;throw new Error("I could not understand type of value")}function Iz(t){switch(t.type){case re.ValueType.Formula:return zR(t.result);default:return t.type}}var pv=class extends Nz{constructor(){super(),this.richTextXForm=new qz}get tag(){return"c"}prepare(e,r){let i=r.styles.addStyleModel(e.style||{},Iz(e));switch(i&&(e.styleId=i),e.comment&&r.comments.push({...e.comment,ref:e.address}),e.type){case re.ValueType.String:case re.ValueType.RichText:r.sharedStrings&&(e.ssId=r.sharedStrings.add(e.value));break;case re.ValueType.Date:r.date1904&&(e.date1904=!0);break;case re.ValueType.Hyperlink:r.sharedStrings&&e.text!==void 0&&e.text!==null&&(e.ssId=r.sharedStrings.add(e.text)),r.hyperlinks.push({address:e.address,target:e.hyperlink,tooltip:e.tooltip});break;case re.ValueType.Merge:r.merges.add(e);break;case re.ValueType.Formula:if(r.date1904&&(e.date1904=!0),e.shareType==="shared"&&(e.si=r.siFormulae++),e.formula)r.formulae[e.address]=e;else if(e.sharedFormula){let n=r.formulae[e.sharedFormula];if(!n)throw new Error(`Shared Formula master must exist above and or left of clone for cell ${e.address}`);n.si===void 0?(n.shareType="shared",n.si=r.siFormulae++,n.range=new Dz(n.address,e.address)):n.range&&n.range.expandToAddress(e.address),e.si=n.si}break;default:break}}renderFormula(e,r){let i=null;switch(r.shareType){case"shared":i={t:"shared",ref:r.ref||r.range.range,si:r.si};break;case"array":i={t:"array",ref:r.ref};break;default:r.si!==void 0&&(i={t:"shared",si:r.si});break}switch(zR(r.result)){case re.ValueType.Null:e.leafNode("f",i,r.formula);break;case re.ValueType.String:e.addAttribute("t","str"),e.leafNode("f",i,r.formula),e.leafNode("v",null,r.result);break;case re.ValueType.Number:e.leafNode("f",i,r.formula),e.leafNode("v",null,r.result);break;case re.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("f",i,r.formula),e.leafNode("v",null,r.result?1:0);break;case re.ValueType.Error:e.addAttribute("t","e"),e.leafNode("f",i,r.formula),e.leafNode("v",null,r.result.error);break;case re.ValueType.Date:e.leafNode("f",i,r.formula),e.leafNode("v",null,Fi.dateToExcel(r.result,r.date1904));break;default:throw new Error("I could not understand type of value")}}render(e,r){if(!(r.type===re.ValueType.Null&&!r.styleId)){switch(e.openNode("c"),e.addAttribute("r",r.address),r.styleId&&e.addAttribute("s",r.styleId),r.type){case re.ValueType.Null:break;case re.ValueType.Number:e.leafNode("v",null,r.value);break;case re.ValueType.Boolean:e.addAttribute("t","b"),e.leafNode("v",null,r.value?"1":"0");break;case re.ValueType.Error:e.addAttribute("t","e"),e.leafNode("v",null,r.value.error);break;case re.ValueType.String:case re.ValueType.RichText:r.ssId!==void 0?(e.addAttribute("t","s"),e.leafNode("v",null,r.ssId)):r.value&&r.value.richText?(e.addAttribute("t","inlineStr"),e.openNode("is"),r.value.richText.forEach(i=>{this.richTextXForm.render(e,i)}),e.closeNode("is")):(e.addAttribute("t","str"),e.leafNode("v",null,r.value));break;case re.ValueType.Date:e.leafNode("v",null,Fi.dateToExcel(r.value,r.date1904));break;case re.ValueType.Hyperlink:r.ssId!==void 0?(e.addAttribute("t","s"),e.leafNode("v",null,r.ssId)):(e.addAttribute("t","str"),e.leafNode("v",null,r.text));break;case re.ValueType.Formula:this.renderFormula(e,r);break;case re.ValueType.Merge:break;default:break}e.closeNode()}}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"c":return this.model={address:e.attributes.r},this.t=e.attributes.t,e.attributes.s&&(this.model.styleId=parseInt(e.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=e.attributes.si,this.model.shareType=e.attributes.t,this.model.ref=e.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){if(this.parser){this.parser.parseText(e);return}switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+e:e;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+e:e:this.model.value=this.model.value?this.model.value+e:e;break;default:break}}parseClose(e){switch(e){case"c":{let{model:r}=this;if(r.formula||r.shareType)r.type=re.ValueType.Formula,r.value&&(this.t==="str"?r.result=Fi.xmlDecode(r.value):this.t==="b"?r.result=parseInt(r.value,10)!==0:this.t==="e"?r.result={error:r.value}:r.result=parseFloat(r.value),r.value=void 0);else if(r.value!==void 0)switch(this.t){case"s":r.type=re.ValueType.String,r.value=parseInt(r.value,10);break;case"str":r.type=re.ValueType.String,r.value=Fi.xmlDecode(r.value);break;case"inlineStr":r.type=re.ValueType.String;break;case"b":r.type=re.ValueType.Boolean,r.value=parseInt(r.value,10)!==0;break;case"e":r.type=re.ValueType.Error,r.value={error:r.value};break;default:r.type=re.ValueType.Number,r.value=parseFloat(r.value);break}else r.styleId?r.type=re.ValueType.Null:r.type=re.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(e),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return this.parser?(this.parser.parseClose(e),!0):!1}}reconcile(e,r){let i=e.styleId&&r.styles&&r.styles.getStyleModel(e.styleId);switch(i&&(e.style=i),e.styleId!==void 0&&(e.styleId=void 0),e.type){case re.ValueType.String:typeof e.value=="number"&&r.sharedStrings&&(e.value=r.sharedStrings.getString(e.value)),e.value.richText&&(e.type=re.ValueType.RichText);break;case re.ValueType.Number:i&&Fi.isDateFmt(i.numFmt)&&(e.type=re.ValueType.Date,e.value=Fi.excelToDate(e.value,r.date1904));break;case re.ValueType.Formula:e.result!==void 0&&i&&Fi.isDateFmt(i.numFmt)&&(e.result=Fi.excelToDate(e.result,r.date1904)),e.shareType==="shared"&&(e.ref?r.formulae[e.si]=e.address:(e.sharedFormula=r.formulae[e.si],delete e.shareType),delete e.si);break;default:break}let n=r.hyperlinkMap[e.address];n&&(e.type===re.ValueType.Formula?(e.text=e.result,e.result=void 0):(e.text=e.value,e.value=void 0),e.type=re.ValueType.Hyperlink,e.hyperlink=n);let s=r.commentsMap&&r.commentsMap[e.address];s&&(e.comment=s)}};XR.exports=pv});var mv=y((Hoe,GR)=>{var Mz=Z(),Pz=VR(),gv=class extends Mz{constructor(e){super(),this.maxItems=e&&e.maxItems,this.map={c:new Pz}}get tag(){return"row"}prepare(e,r){let i=r.styles.addStyleModel(e.style);i&&(e.styleId=i);let n=this.map.c;e.cells.forEach(s=>{n.prepare(s,r)})}render(e,r,i){e.openNode("row"),e.addAttribute("r",r.number),r.height&&(e.addAttribute("ht",r.height),e.addAttribute("customHeight","1")),r.hidden&&e.addAttribute("hidden","1"),r.min>0&&r.max>0&&r.min<=r.max&&e.addAttribute("spans",`${r.min}:${r.max}`),r.styleId&&(e.addAttribute("s",r.styleId),e.addAttribute("customFormat","1")),e.addAttribute("x14ac:dyDescent","0.25"),r.outlineLevel&&e.addAttribute("outlineLevel",r.outlineLevel),r.collapsed&&e.addAttribute("collapsed","1");let n=this.map.c;r.cells.forEach(s=>{n.render(e,s,i)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;if(e.name==="row"){this.numRowsSeen+=1;let r=e.attributes.spans?e.attributes.spans.split(":").map(n=>parseInt(n,10)):[void 0,void 0],i=this.model={number:parseInt(e.attributes.r,10),min:r[0],max:r[1],cells:[]};return e.attributes.s&&(i.styleId=parseInt(e.attributes.s,10)),(e.attributes.hidden===!0||e.attributes.hidden==="true"||e.attributes.hidden===1||e.attributes.hidden==="1")&&(i.hidden=!0),e.attributes.bestFit&&(i.bestFit=!0),e.attributes.ht&&(i.height=parseFloat(e.attributes.ht)),e.attributes.outlineLevel&&(i.outlineLevel=parseInt(e.attributes.outlineLevel,10)),e.attributes.collapsed&&(i.collapsed=!0),!0}return this.parser=this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):!1}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser){if(!this.parser.parseClose(e)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(e,r){e.style=e.styleId?r.styles.getStyleModel(e.styleId):{},e.styleId!==void 0&&(e.styleId=void 0);let i=this.map.c;e.cells.forEach(n=>{i.reconcile(n,r)})}};GR.exports=gv});var yv=y((Uoe,ZR)=>{var Lz=Z(),vv=class extends Lz{get tag(){return"col"}prepare(e,r){let i=r.styles.addStyleModel(e.style||{});i&&(e.styleId=i)}render(e,r){e.openNode("col"),e.addAttribute("min",r.min),e.addAttribute("max",r.max),r.width&&e.addAttribute("width",r.width),r.styleId&&e.addAttribute("style",r.styleId),r.hidden&&e.addAttribute("hidden","1"),r.bestFit&&e.addAttribute("bestFit","1"),r.outlineLevel&&e.addAttribute("outlineLevel",r.outlineLevel),r.collapsed&&e.addAttribute("collapsed","1"),e.addAttribute("customWidth","1"),e.closeNode()}parseOpen(e){if(e.name==="col"){let r=this.model={min:parseInt(e.attributes.min||"0",10),max:parseInt(e.attributes.max||"0",10),width:e.attributes.width===void 0?void 0:parseFloat(e.attributes.width||"0")};return e.attributes.style&&(r.styleId=parseInt(e.attributes.style,10)),(e.attributes.hidden===!0||e.attributes.hidden==="true"||e.attributes.hidden===1||e.attributes.hidden==="1")&&(r.hidden=!0),e.attributes.bestFit&&(r.bestFit=!0),e.attributes.outlineLevel&&(r.outlineLevel=parseInt(e.attributes.outlineLevel,10)),e.attributes.collapsed&&(r.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(e,r){e.styleId&&(e.style=r.styles.getStyleModel(e.styleId))}};ZR.exports=vv});var KR=y((zoe,YR)=>{var Bz=Z(),_v=class extends Bz{get tag(){return"dimension"}render(e,r){r&&e.leafNode("dimension",{ref:r})}parseOpen(e){return e.name==="dimension"?(this.model=e.attributes.ref,!0):!1}parseText(){}parseClose(){return!1}};YR.exports=_v});var bv=y((Xoe,QR)=>{var jz=Z(),wv=class extends jz{get tag(){return"hyperlink"}render(e,r){e.leafNode("hyperlink",{ref:r.address,"r:id":r.rId,tooltip:r.tooltip})}parseOpen(e){return e.name==="hyperlink"?(this.model={address:e.attributes.ref,rId:e.attributes["r:id"],tooltip:e.attributes.tooltip},!0):!1}parseText(){}parseClose(){return!1}};QR.exports=wv});var eO=y((Voe,JR)=>{var Wz=Z(),xv=class extends Wz{get tag(){return"mergeCell"}render(e,r){e.leafNode("mergeCell",{ref:r})}parseOpen(e){return e.name==="mergeCell"?(this.model=e.attributes.ref,!0):!1}parseText(){}parseClose(){return!1}};JR.exports=xv});var Cv=y((Goe,rO)=>{var al=je(),tO=qt(),Xs=Me(),$z=Z(),Hz=Fr();function Vs(t,e,r,i){let n=e[r];n!==void 0?t[r]=n:i!==void 0&&(t[r]=i)}function Uz(t){switch(t){case"1":case"true":return!0;default:return!1}}function Tv(t,e,r,i){let n=e[r];n!==void 0?t[r]=Uz(n):i!==void 0&&(t[r]=i)}function zz(t){let e=al.map(t,(n,s)=>({address:s,dataValidation:n,marked:!1})).sort((n,s)=>al.strcmp(n.address,s.address)),r=al.keyBy(e,"address"),i=(n,s,a)=>{for(let o=0;o<s;o++){let u=Xs.encodeAddress(n.row+o,a);if(!t[u]||!al.isEqual(t[n.address],t[u]))return!1}return!0};return e.map(n=>{if(!n.marked){let s=Xs.decodeEx(n.address);if(s.dimensions)return r[s.dimensions].marked=!0,{...n.dataValidation,sqref:n.address};let a=1,o=Xs.encodeAddress(s.row+a,s.col);for(;t[o]&&al.isEqual(n.dataValidation,t[o]);)a++,o=Xs.encodeAddress(s.row+a,s.col);let u=1;for(;i(s,a,s.col+u);)u++;for(let f=0;f<a;f++)for(let h=0;h<u;h++)o=Xs.encodeAddress(s.row+f,s.col+h),r[o].marked=!0;if(a>1||u>1){let f=s.row+(a-1),h=s.col+(u-1);return{...n.dataValidation,sqref:`${n.address}:${Xs.encodeAddress(f,h)}`}}return{...n.dataValidation,sqref:n.address}}return null}).filter(Boolean)}var Ev=class extends $z{get tag(){return"dataValidations"}render(e,r){let i=zz(r);i.length&&(e.openNode("dataValidations",{count:i.length}),i.forEach(n=>{e.openNode("dataValidation"),n.type!=="any"&&(e.addAttribute("type",n.type),n.operator&&n.type!=="list"&&n.operator!=="between"&&e.addAttribute("operator",n.operator),n.allowBlank&&e.addAttribute("allowBlank","1")),n.showInputMessage&&e.addAttribute("showInputMessage","1"),n.promptTitle&&e.addAttribute("promptTitle",n.promptTitle),n.prompt&&e.addAttribute("prompt",n.prompt),n.showErrorMessage&&e.addAttribute("showErrorMessage","1"),n.errorStyle&&e.addAttribute("errorStyle",n.errorStyle),n.errorTitle&&e.addAttribute("errorTitle",n.errorTitle),n.error&&e.addAttribute("error",n.error),e.addAttribute("sqref",n.sqref),(n.formulae||[]).forEach((s,a)=>{e.openNode(`formula${a+1}`),n.type==="date"?e.writeText(tO.dateToExcel(new Date(s))):e.writeText(s),e.closeNode()}),e.closeNode()}),e.closeNode())}parseOpen(e){switch(e.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=e.attributes.sqref;let r={type:e.attributes.type||"any",formulae:[]};switch(e.attributes.type&&Tv(r,e.attributes,"allowBlank"),Tv(r,e.attributes,"showInputMessage"),Tv(r,e.attributes,"showErrorMessage"),r.type){case"any":case"list":case"custom":break;default:Vs(r,e.attributes,"operator","between");break}return Vs(r,e.attributes,"promptTitle"),Vs(r,e.attributes,"prompt"),Vs(r,e.attributes,"errorStyle"),Vs(r,e.attributes,"errorTitle"),Vs(r,e.attributes,"error"),this._dataValidation=r,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(e){this._formula&&this._formula.push(e)}parseClose(e){switch(e){case"dataValidations":return!1;case"dataValidation":return(!this._dataValidation.formulae||!this._dataValidation.formulae.length)&&(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(i=>{i.includes(":")?new Hz(i).forEachAddress(s=>{this.model[s]=this._dataValidation}):this.model[i]=this._dataValidation}),!0;case"formula1":case"formula2":{let r=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":r=parseInt(r,10);break;case"decimal":r=parseFloat(r);break;case"date":r=tO.excelToDate(parseFloat(r));break;default:break}return this._dataValidation.formulae.push(r),this._formula=void 0,!0}default:return!0}}};rO.exports=Ev});var nO=y((Zoe,iO)=>{var Xz=Z(),Sv=class extends Xz{get tag(){return"pageSetUpPr"}render(e,r){return r&&r.fitToPage?(e.leafNode(this.tag,{fitToPage:r.fitToPage?"1":void 0}),!0):!1}parseOpen(e){return e.name===this.tag?(this.model={fitToPage:e.attributes.fitToPage==="1"},!0):!1}parseText(){}parseClose(){return!1}};iO.exports=Sv});var aO=y((Yoe,sO)=>{var Vz=Z(),Gs=t=>typeof t<"u",kv=class extends Vz{get tag(){return"outlinePr"}render(e,r){return r&&(Gs(r.summaryBelow)||Gs(r.summaryRight))?(e.leafNode(this.tag,{summaryBelow:Gs(r.summaryBelow)?Number(r.summaryBelow):void 0,summaryRight:Gs(r.summaryRight)?Number(r.summaryRight):void 0}),!0):!1}parseOpen(e){return e.name===this.tag?(this.model={summaryBelow:Gs(e.attributes.summaryBelow)?Boolean(Number(e.attributes.summaryBelow)):void 0,summaryRight:Gs(e.attributes.summaryRight)?Boolean(Number(e.attributes.summaryRight)):void 0},!0):!1}parseText(){}parseClose(){return!1}};sO.exports=kv});var Ov=y((Koe,oO)=>{var Gz=Z(),Zz=ki(),Yz=nO(),Kz=aO(),Rv=class extends Gz{constructor(){super(),this.map={tabColor:new Zz("tabColor"),pageSetUpPr:new Yz,outlinePr:new Kz}}get tag(){return"sheetPr"}render(e,r){if(r){e.addRollback(),e.openNode("sheetPr");let i=!1;i=this.map.tabColor.render(e,r.tabColor)||i,i=this.map.pageSetUpPr.render(e,r.pageSetup)||i,i=this.map.outlinePr.render(e,r.outlineProperties)||i,i?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.reset(),!0):this.map[e.name]?(this.parser=this.map[e.name],this.parser.parseOpen(e),!0):!1}parseText(e){return this.parser?(this.parser.parseText(e),!0):!1}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}};oO.exports=Rv});var Fv=y((Qoe,lO)=>{var Qz=je(),Jz=Z(),Av=class extends Jz{get tag(){return"sheetFormatPr"}render(e,r){if(r){let i={defaultRowHeight:r.defaultRowHeight,outlineLevelRow:r.outlineLevelRow,outlineLevelCol:r.outlineLevelCol,"x14ac:dyDescent":r.dyDescent};r.defaultColWidth&&(i.defaultColWidth=r.defaultColWidth),(!r.defaultRowHeight||r.defaultRowHeight!==15)&&(i.customHeight="1"),Qz.some(i,n=>n!==void 0)&&e.leafNode("sheetFormatPr",i)}}parseOpen(e){return e.name==="sheetFormatPr"?(this.model={defaultRowHeight:parseFloat(e.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(e.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(e.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(e.attributes.outlineLevelCol||"0",10)},e.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(e.attributes.defaultColWidth)),!0):!1}parseText(){}parseClose(){return!1}};lO.exports=Av});var Dv=y((Joe,uO)=>{var eX=Me(),tX=Z(),rX={frozen:"frozen",frozenSplit:"frozen",split:"split"},Nv=class extends tX{get tag(){return"sheetView"}prepare(e){switch(e.state){case"frozen":case"split":break;default:e.state="normal";break}}render(e,r){e.openNode("sheetView",{workbookViewId:r.workbookViewId||0});let i=function(u,f,h){h&&e.addAttribute(u,f)};i("rightToLeft","1",r.rightToLeft===!0),i("tabSelected","1",r.tabSelected),i("showRuler","0",r.showRuler===!1),i("showRowColHeaders","0",r.showRowColHeaders===!1),i("showGridLines","0",r.showGridLines===!1),i("zoomScale",r.zoomScale,r.zoomScale),i("zoomScaleNormal",r.zoomScaleNormal,r.zoomScaleNormal),i("view",r.style,r.style);let n,s,a,o;switch(r.state){case"frozen":s=r.xSplit||0,a=r.ySplit||0,n=r.topLeftCell||eX.getAddress(a+1,s+1).address,o=r.xSplit&&r.ySplit&&"bottomRight"||r.xSplit&&"topRight"||"bottomLeft",e.leafNode("pane",{xSplit:r.xSplit||void 0,ySplit:r.ySplit||void 0,topLeftCell:n,activePane:o,state:"frozen"}),e.leafNode("selection",{pane:o,activeCell:r.activeCell,sqref:r.activeCell});break;case"split":r.activePane==="topLeft"&&(r.activePane=void 0),e.leafNode("pane",{xSplit:r.xSplit||void 0,ySplit:r.ySplit||void 0,topLeftCell:r.topLeftCell,activePane:r.activePane}),e.leafNode("selection",{pane:r.activePane,activeCell:r.activeCell,sqref:r.activeCell});break;case"normal":r.activeCell&&e.leafNode("selection",{activeCell:r.activeCell,sqref:r.activeCell});break;default:break}e.closeNode()}parseOpen(e){switch(e.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(e.attributes.workbookViewId,10),rightToLeft:e.attributes.rightToLeft==="1",tabSelected:e.attributes.tabSelected==="1",showRuler:e.attributes.showRuler!=="0",showRowColHeaders:e.attributes.showRowColHeaders!=="0",showGridLines:e.attributes.showGridLines!=="0",zoomScale:parseInt(e.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(e.attributes.zoomScaleNormal||"100",10),style:e.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(e.attributes.xSplit||"0",10),ySplit:parseInt(e.attributes.ySplit||"0",10),topLeftCell:e.attributes.topLeftCell,activePane:e.attributes.activePane||"topLeft",state:e.attributes.state},!0;case"selection":{let r=e.attributes.pane||"topLeft";return this.selections[r]={pane:r,activeCell:e.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(e){let r,i;switch(e){case"sheetView":return this.sheetView&&this.pane?(r=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:rX[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(r.activePane=this.pane.activePane),i=this.selections[this.pane.activePane],i&&i.activeCell&&(r.activeCell=i.activeCell),this.sheetView.style&&(r.style=this.sheetView.style)):(r=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},i=this.selections.topLeft,i&&i.activeCell&&(r.activeCell=i.activeCell),this.sheetView.style&&(r.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}};uO.exports=Nv});var Iv=y((ele,fO)=>{var iX=je(),nX=Z();function St(t,e){return t?e:void 0}function zt(t,e){return t===e?!0:void 0}var qv=class extends nX{get tag(){return"sheetProtection"}render(e,r){if(r){let i={sheet:St(r.sheet,"1"),selectLockedCells:r.selectLockedCells===!1?"1":void 0,selectUnlockedCells:r.selectUnlockedCells===!1?"1":void 0,formatCells:St(r.formatCells,"0"),formatColumns:St(r.formatColumns,"0"),formatRows:St(r.formatRows,"0"),insertColumns:St(r.insertColumns,"0"),insertRows:St(r.insertRows,"0"),insertHyperlinks:St(r.insertHyperlinks,"0"),deleteColumns:St(r.deleteColumns,"0"),deleteRows:St(r.deleteRows,"0"),sort:St(r.sort,"0"),autoFilter:St(r.autoFilter,"0"),pivotTables:St(r.pivotTables,"0")};r.sheet&&(i.algorithmName=r.algorithmName,i.hashValue=r.hashValue,i.saltValue=r.saltValue,i.spinCount=r.spinCount,i.objects=St(r.objects===!1,"1"),i.scenarios=St(r.scenarios===!1,"1")),iX.some(i,n=>n!==void 0)&&e.leafNode(this.tag,i)}}parseOpen(e){switch(e.name){case this.tag:return this.model={sheet:zt(e.attributes.sheet,"1"),objects:e.attributes.objects==="1"?!1:void 0,scenarios:e.attributes.scenarios==="1"?!1:void 0,selectLockedCells:e.attributes.selectLockedCells==="1"?!1:void 0,selectUnlockedCells:e.attributes.selectUnlockedCells==="1"?!1:void 0,formatCells:zt(e.attributes.formatCells,"0"),formatColumns:zt(e.attributes.formatColumns,"0"),formatRows:zt(e.attributes.formatRows,"0"),insertColumns:zt(e.attributes.insertColumns,"0"),insertRows:zt(e.attributes.insertRows,"0"),insertHyperlinks:zt(e.attributes.insertHyperlinks,"0"),deleteColumns:zt(e.attributes.deleteColumns,"0"),deleteRows:zt(e.attributes.deleteRows,"0"),sort:zt(e.attributes.sort,"0"),autoFilter:zt(e.attributes.autoFilter,"0"),pivotTables:zt(e.attributes.pivotTables,"0")},e.attributes.algorithmName&&(this.model.algorithmName=e.attributes.algorithmName,this.model.hashValue=e.attributes.hashValue,this.model.saltValue=e.attributes.saltValue,this.model.spinCount=parseInt(e.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}};fO.exports=qv});var Pv=y((tle,hO)=>{var sX=je(),aX=Z(),Mv=class extends aX{get tag(){return"pageMargins"}render(e,r){if(r){let i={left:r.left,right:r.right,top:r.top,bottom:r.bottom,header:r.header,footer:r.footer};sX.some(i,n=>n!==void 0)&&e.leafNode(this.tag,i)}}parseOpen(e){switch(e.name){case this.tag:return this.model={left:parseFloat(e.attributes.left||.7),right:parseFloat(e.attributes.right||.7),top:parseFloat(e.attributes.top||.75),bottom:parseFloat(e.attributes.bottom||.75),header:parseFloat(e.attributes.header||.3),footer:parseFloat(e.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}};hO.exports=Mv});var Bv=y((rle,cO)=>{var oX=je(),lX=Z();function Zf(t){return t?"1":void 0}function uX(t){switch(t){case"overThenDown":return t;default:return}}function fX(t){switch(t){case"atEnd":case"asDisplyed":return t;default:return}}function hX(t){switch(t){case"dash":case"blank":case"NA":return t;default:return}}function cX(t){return t!==void 0?parseInt(t,10):void 0}var Lv=class extends lX{get tag(){return"pageSetup"}render(e,r){if(r){let i={paperSize:r.paperSize,orientation:r.orientation,horizontalDpi:r.horizontalDpi,verticalDpi:r.verticalDpi,pageOrder:uX(r.pageOrder),blackAndWhite:Zf(r.blackAndWhite),draft:Zf(r.draft),cellComments:fX(r.cellComments),errors:hX(r.errors),scale:r.scale,fitToWidth:r.fitToWidth,fitToHeight:r.fitToHeight,firstPageNumber:r.firstPageNumber,useFirstPageNumber:Zf(r.firstPageNumber),usePrinterDefaults:Zf(r.usePrinterDefaults),copies:r.copies};oX.some(i,n=>n!==void 0)&&e.leafNode(this.tag,i)}}parseOpen(e){switch(e.name){case this.tag:return this.model={paperSize:cX(e.attributes.paperSize),orientation:e.attributes.orientation||"portrait",horizontalDpi:parseInt(e.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(e.attributes.verticalDpi||"4294967295",10),pageOrder:e.attributes.pageOrder||"downThenOver",blackAndWhite:e.attributes.blackAndWhite==="1",draft:e.attributes.draft==="1",cellComments:e.attributes.cellComments||"None",errors:e.attributes.errors||"displayed",scale:parseInt(e.attributes.scale||"100",10),fitToWidth:parseInt(e.attributes.fitToWidth||"1",10),fitToHeight:parseInt(e.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(e.attributes.firstPageNumber||"1",10),useFirstPageNumber:e.attributes.useFirstPageNumber==="1",usePrinterDefaults:e.attributes.usePrinterDefaults==="1",copies:parseInt(e.attributes.copies||"1",10)},!0;default:return!1}}parseText(){}parseClose(){return!1}};cO.exports=Lv});var pO=y((ile,dO)=>{var dX=je(),pX=Z();function Yf(t){return t?"1":void 0}var jv=class extends pX{get tag(){return"printOptions"}render(e,r){if(r){let i={headings:Yf(r.showRowColHeaders),gridLines:Yf(r.showGridLines),horizontalCentered:Yf(r.horizontalCentered),verticalCentered:Yf(r.verticalCentered)};dX.some(i,n=>n!==void 0)&&e.leafNode(this.tag,i)}}parseOpen(e){switch(e.name){case this.tag:return this.model={showRowColHeaders:e.attributes.headings==="1",showGridLines:e.attributes.gridLines==="1",horizontalCentered:e.attributes.horizontalCentered==="1",verticalCentered:e.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}};dO.exports=jv});var $v=y((nle,gO)=>{var gX=Me(),mX=Z(),Wv=class extends mX{get tag(){return"autoFilter"}render(e,r){if(r)if(typeof r=="string")e.leafNode("autoFilter",{ref:r});else{let i=function(a){return typeof a=="string"?a:gX.getAddress(a.row,a.column).address},n=i(r.from),s=i(r.to);n&&s&&e.leafNode("autoFilter",{ref:`${n}:${s}`})}}parseOpen(e){e.name==="autoFilter"&&(this.model=e.attributes.ref)}};gO.exports=Wv});var Uv=y((sle,mO)=>{var vX=Z(),Hv=class extends vX{get tag(){return"picture"}render(e,r){r&&e.leafNode(this.tag,{"r:id":r.rId})}parseOpen(e){switch(e.name){case this.tag:return this.model={rId:e.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}};mO.exports=Hv});var yO=y((ale,vO)=>{var yX=Z(),zv=class extends yX{get tag(){return"drawing"}render(e,r){r&&e.leafNode(this.tag,{"r:id":r.rId})}parseOpen(e){switch(e.name){case this.tag:return this.model={rId:e.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}};vO.exports=zv});var wO=y((ole,_O)=>{var _X=Z(),Xv=class extends _X{get tag(){return"tablePart"}render(e,r){r&&e.leafNode(this.tag,{"r:id":r.rId})}parseOpen(e){switch(e.name){case this.tag:return this.model={rId:e.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}};_O.exports=Xv});var xO=y((lle,bO)=>{var wX=Z(),Vv=class extends wX{get tag(){return"brk"}render(e,r){e.leafNode("brk",r)}parseOpen(e){return e.name==="brk"?(this.model=e.attributes.ref,!0):!1}parseText(){}parseClose(){return!1}};bO.exports=Vv});var Zv=y((ule,TO)=>{"use strict";var bX=xO(),xX=xn(),Gv=class extends xX{constructor(){let e={tag:"rowBreaks",count:!0,childXform:new bX};super(e)}render(e,r){if(r&&r.length){e.openNode(this.tag,this.$),this.count&&(e.addAttribute(this.$count,r.length),e.addAttribute("manualBreakCount",r.length));let{childXform:i}=this;r.forEach(n=>{i.render(e,n)}),e.closeNode()}else this.empty&&e.leafNode(this.tag)}};TO.exports=Gv});var Kv=y((fle,EO)=>{var TX=Z(),Yv=class extends TX{get tag(){return"headerFooter"}render(e,r){if(r){e.addRollback();let i=!1;e.openNode("headerFooter"),r.differentFirst&&(e.addAttribute("differentFirst","1"),i=!0),r.differentOddEven&&(e.addAttribute("differentOddEven","1"),i=!0),r.oddHeader&&typeof r.oddHeader=="string"&&(e.leafNode("oddHeader",null,r.oddHeader),i=!0),r.oddFooter&&typeof r.oddFooter=="string"&&(e.leafNode("oddFooter",null,r.oddFooter),i=!0),r.evenHeader&&typeof r.evenHeader=="string"&&(e.leafNode("evenHeader",null,r.evenHeader),i=!0),r.evenFooter&&typeof r.evenFooter=="string"&&(e.leafNode("evenFooter",null,r.evenFooter),i=!0),r.firstHeader&&typeof r.firstHeader=="string"&&(e.leafNode("firstHeader",null,r.firstHeader),i=!0),r.firstFooter&&typeof r.firstFooter=="string"&&(e.leafNode("firstFooter",null,r.firstFooter),i=!0),i?(e.closeNode(),e.commit()):e.rollback()}}parseOpen(e){switch(e.name){case"headerFooter":return this.model={},e.attributes.differentFirst&&(this.model.differentFirst=parseInt(e.attributes.differentFirst,0)===1),e.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(e.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(e){switch(this.currentNode){case"oddHeader":this.model.oddHeader=e;break;case"oddFooter":this.model.oddFooter=e;break;case"evenHeader":this.model.evenHeader=e;break;case"evenFooter":this.model.evenFooter=e;break;case"firstHeader":this.model.firstHeader=e;break;case"firstFooter":this.model.firstFooter=e;break;default:break}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}};EO.exports=Yv});var kt=y((hle,CO)=>{var EX=Z(),Qv=class extends EX{createNewModel(e){return{}}parseOpen(e){return this.parser=this.parser||this.map[e.name],this.parser?(this.parser.parseOpen(e),!0):e.name===this.tag?(this.model=this.createNewModel(e),!0):!1}parseText(e){this.parser&&this.parser.parseText(e)}onParserClose(e,r){this.model[e]=r.model}parseClose(e){return this.parser?(this.parser.parseClose(e)||(this.onParserClose(e,this.parser),this.parser=void 0),!0):e!==this.tag}};CO.exports=Qv});var Kf=y((cle,kO)=>{var SO=Z(),Jv=class extends SO{get tag(){return"cfvo"}render(e,r){e.leafNode(this.tag,{type:r.type,val:r.value})}parseOpen(e){this.model={type:e.attributes.type,value:SO.toFloatValue(e.attributes.val)}}parseClose(e){return e!==this.tag}};kO.exports=Jv});var OO=y((dle,RO)=>{var CX=kt(),SX=ki(),kX=Kf(),ey=class extends CX{constructor(){super(),this.map={cfvo:this.cfvoXform=new kX,color:this.colorXform=new SX}}get tag(){return"dataBar"}render(e,r){e.openNode(this.tag),r.cfvo.forEach(i=>{this.cfvoXform.render(e,i)}),this.colorXform.render(e,r.color),e.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(e,r){switch(e){case"cfvo":this.model.cfvo.push(r.model);break;case"color":this.model.color=r.model;break}}};RO.exports=ey});var NO=y((ple,FO)=>{var RX=Z(),AO=kt(),ty=class extends RX{get tag(){return"x14:id"}render(e,r){e.leafNode(this.tag,null,r)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}},ry=class extends AO{constructor(){super(),this.map={"x14:id":this.idXform=new ty}}get tag(){return"ext"}render(e,r){e.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(e,r.x14Id),e.closeNode()}createNewModel(){return{}}onParserClose(e,r){this.model.x14Id=r.model}},iy=class extends AO{constructor(){super(),this.map={ext:new ry}}get tag(){return"extLst"}render(e,r){e.openNode(this.tag),this.map.ext.render(e,r),e.closeNode()}createNewModel(){return{}}onParserClose(e,r){Object.assign(this.model,r.model)}};FO.exports=iy});var qO=y((gle,DO)=>{var OX=Z(),ny=class extends OX{get tag(){return"formula"}render(e,r){e.leafNode(this.tag,null,r)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}};DO.exports=ny});var MO=y((mle,IO)=>{var AX=kt(),FX=ki(),NX=Kf(),sy=class extends AX{constructor(){super(),this.map={cfvo:this.cfvoXform=new NX,color:this.colorXform=new FX}}get tag(){return"colorScale"}render(e,r){e.openNode(this.tag),r.cfvo.forEach(i=>{this.cfvoXform.render(e,i)}),r.color.forEach(i=>{this.colorXform.render(e,i)}),e.closeNode()}createNewModel(e){return{cfvo:[],color:[]}}onParserClose(e,r){this.model[e].push(r.model)}};IO.exports=sy});var LO=y((vle,PO)=>{var Zs=Z(),DX=kt(),qX=Kf(),ay=class extends DX{constructor(){super(),this.map={cfvo:this.cfvoXform=new qX}}get tag(){return"iconSet"}render(e,r){e.openNode(this.tag,{iconSet:Zs.toStringAttribute(r.iconSet,"3TrafficLights"),reverse:Zs.toBoolAttribute(r.reverse,!1),showValue:Zs.toBoolAttribute(r.showValue,!0)}),r.cfvo.forEach(i=>{this.cfvoXform.render(e,i)}),e.closeNode()}createNewModel({attributes:e}){return{iconSet:Zs.toStringValue(e.iconSet,"3TrafficLights"),reverse:Zs.toBoolValue(e.reverse),showValue:Zs.toBoolValue(e.showValue),cfvo:[]}}onParserClose(e,r){this.model[e].push(r.model)}};PO.exports=ay});var WO=y((yle,jO)=>{var ir=Z(),IX=kt(),BO=Fr(),MX=OO(),PX=NO(),LX=qO(),BX=MO(),jX=LO(),WX={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},$X=t=>{if(t.formulae&&t.formulae[0])return t.formulae[0];let e=new BO(t.ref),{tl:r}=e;switch(t.operator){case"containsText":return`NOT(ISERROR(SEARCH("${t.text}",${r})))`;case"containsBlanks":return`LEN(TRIM(${r}))=0`;case"notContainsBlanks":return`LEN(TRIM(${r}))>0`;case"containsErrors":return`ISERROR(${r})`;case"notContainsErrors":return`NOT(ISERROR(${r}))`;default:return}},HX=t=>{if(t.formulae&&t.formulae[0])return t.formulae[0];let e=new BO(t.ref),{tl:r}=e;switch(t.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${r},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${r},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${r},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${r},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${r},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${r},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${r},1)=TODAY()-1`;case"today":return`FLOOR(${r},1)=TODAY()`;case"tomorrow":return`FLOOR(${r},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${r},1)<=6,FLOOR(${r},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${r})=MONTH(EDATE(TODAY(),0-1)),YEAR(${r})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${r})=MONTH(TODAY()),YEAR(${r})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${r})=MONTH(EDATE(TODAY(),0+1)),YEAR(${r})=YEAR(EDATE(TODAY(),0+1)))`;default:return}},UX=t=>{let{type:e,operator:r}=t;switch(e){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:e};default:return{type:e,operator:r}}},ol=class extends IX{constructor(){super(),this.map={dataBar:this.databarXform=new MX,extLst:this.extLstRefXform=new PX,formula:this.formulaXform=new LX,colorScale:this.colorScaleXform=new BX,iconSet:this.iconSetXform=new jX}}get tag(){return"cfRule"}static isPrimitive(e){return!(e.type==="iconSet"&&(e.custom||WX[e.iconSet]))}render(e,r){switch(r.type){case"expression":this.renderExpression(e,r);break;case"cellIs":this.renderCellIs(e,r);break;case"top10":this.renderTop10(e,r);break;case"aboveAverage":this.renderAboveAverage(e,r);break;case"dataBar":this.renderDataBar(e,r);break;case"colorScale":this.renderColorScale(e,r);break;case"iconSet":this.renderIconSet(e,r);break;case"containsText":this.renderText(e,r);break;case"timePeriod":this.renderTimePeriod(e,r);break}}renderExpression(e,r){e.openNode(this.tag,{type:"expression",dxfId:r.dxfId,priority:r.priority}),this.formulaXform.render(e,r.formulae[0]),e.closeNode()}renderCellIs(e,r){e.openNode(this.tag,{type:"cellIs",dxfId:r.dxfId,priority:r.priority,operator:r.operator}),r.formulae.forEach(i=>{this.formulaXform.render(e,i)}),e.closeNode()}renderTop10(e,r){e.leafNode(this.tag,{type:"top10",dxfId:r.dxfId,priority:r.priority,percent:ir.toBoolAttribute(r.percent,!1),bottom:ir.toBoolAttribute(r.bottom,!1),rank:ir.toIntValue(r.rank,10,!0)})}renderAboveAverage(e,r){e.leafNode(this.tag,{type:"aboveAverage",dxfId:r.dxfId,priority:r.priority,aboveAverage:ir.toBoolAttribute(r.aboveAverage,!0)})}renderDataBar(e,r){e.openNode(this.tag,{type:"dataBar",priority:r.priority}),this.databarXform.render(e,r),this.extLstRefXform.render(e,r),e.closeNode()}renderColorScale(e,r){e.openNode(this.tag,{type:"colorScale",priority:r.priority}),this.colorScaleXform.render(e,r),e.closeNode()}renderIconSet(e,r){!ol.isPrimitive(r)||(e.openNode(this.tag,{type:"iconSet",priority:r.priority}),this.iconSetXform.render(e,r),e.closeNode())}renderText(e,r){e.openNode(this.tag,{type:r.operator,dxfId:r.dxfId,priority:r.priority,operator:ir.toStringAttribute(r.operator,"containsText")});let i=$X(r);i&&this.formulaXform.render(e,i),e.closeNode()}renderTimePeriod(e,r){e.openNode(this.tag,{type:"timePeriod",dxfId:r.dxfId,priority:r.priority,timePeriod:r.timePeriod});let i=HX(r);i&&this.formulaXform.render(e,i),e.closeNode()}createNewModel({attributes:e}){return{...UX(e),dxfId:ir.toIntValue(e.dxfId),priority:ir.toIntValue(e.priority),timePeriod:e.timePeriod,percent:ir.toBoolValue(e.percent),bottom:ir.toBoolValue(e.bottom),rank:ir.toIntValue(e.rank),aboveAverage:ir.toBoolValue(e.aboveAverage)}}onParserClose(e,r){switch(e){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,r.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(r.model);break}}};jO.exports=ol});var HO=y((_le,$O)=>{var zX=kt(),oy=WO(),ly=class extends zX{constructor(){super(),this.map={cfRule:new oy}}get tag(){return"conditionalFormatting"}render(e,r){!r.rules.some(oy.isPrimitive)||(e.openNode(this.tag,{sqref:r.ref}),r.rules.forEach(i=>{oy.isPrimitive(i)&&(i.ref=r.ref,this.map.cfRule.render(e,i))}),e.closeNode())}createNewModel({attributes:e}){return{ref:e.sqref,rules:[]}}onParserClose(e,r){this.model.rules.push(r.model)}};$O.exports=ly});var fy=y((wle,UO)=>{var XX=Z(),VX=HO(),uy=class extends XX{constructor(){super(),this.cfXform=new VX}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(e,r){let i=e.reduce((n,s)=>Math.max(n,...s.rules.map(a=>a.priority||0)),1);e.forEach(n=>{n.rules.forEach(s=>{s.priority||(s.priority=i++),s.style&&(s.dxfId=r.styles.addDxfStyle(s.style))})})}render(e,r){r.forEach(i=>{this.cfXform.render(e,i)})}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(e),!0;default:return!1}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){return this.parser?this.parser.parseClose(e)?!0:(this.model.push(this.parser.model),this.parser=void 0,!1):!1}reconcile(e,r){e.forEach(i=>{i.rules.forEach(n=>{n.dxfId!==void 0&&(n.style=r.styles.getDxfStyle(n.dxfId),delete n.dxfId)})})}};UO.exports=uy});var XO=y((ble,zO)=>{function Qf(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}zO.exports={v1:Qf,v3:Qf,v4:Qf,v5:Qf}});var GO=y((xle,VO)=>{var GX=Z(),hy=class extends GX{get tag(){return"xm:f"}render(e,r){e.leafNode(this.tag,null,r)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}};VO.exports=hy});var dy=y((Tle,ZO)=>{var ZX=kt(),YX=GO(),cy=class extends ZX{constructor(){super(),this.map={"xm:f":this.fExtXform=new YX}}get tag(){return"x14:cfvo"}render(e,r){e.openNode(this.tag,{type:r.type}),r.value!==void 0&&this.fExtXform.render(e,r.value),e.closeNode()}createNewModel(e){return{type:e.attributes.type}}onParserClose(e,r){switch(e){case"xm:f":this.model.value=r.model?parseFloat(r.model):0;break}}};ZO.exports=cy});var KO=y((Ele,YO)=>{var dt=Z(),KX=kt(),Jf=ki(),QX=dy(),py=class extends KX{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new QX,"x14:borderColor":this.borderColorXform=new Jf("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new Jf("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new Jf("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new Jf("x14:axisColor")}}static isExt(e){return!e.gradient}get tag(){return"x14:dataBar"}render(e,r){e.openNode(this.tag,{minLength:dt.toIntAttribute(r.minLength,0,!0),maxLength:dt.toIntAttribute(r.maxLength,100,!0),border:dt.toBoolAttribute(r.border,!1),gradient:dt.toBoolAttribute(r.gradient,!0),negativeBarColorSameAsPositive:dt.toBoolAttribute(r.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:dt.toBoolAttribute(r.negativeBarBorderColorSameAsPositive,!0),axisPosition:dt.toAttribute(r.axisPosition,"auto"),direction:dt.toAttribute(r.direction,"leftToRight")}),r.cfvo.forEach(i=>{this.cfvoXform.render(e,i)}),this.borderColorXform.render(e,r.borderColor),this.negativeBorderColorXform.render(e,r.negativeBorderColor),this.negativeFillColorXform.render(e,r.negativeFillColor),this.axisColorXform.render(e,r.axisColor),e.closeNode()}createNewModel({attributes:e}){return{cfvo:[],minLength:dt.toIntValue(e.minLength,0),maxLength:dt.toIntValue(e.maxLength,100),border:dt.toBoolValue(e.border,!1),gradient:dt.toBoolValue(e.gradient,!0),negativeBarColorSameAsPositive:dt.toBoolValue(e.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:dt.toBoolValue(e.negativeBarBorderColorSameAsPositive,!0),axisPosition:dt.toStringValue(e.axisPosition,"auto"),direction:dt.toStringValue(e.direction,"leftToRight")}}onParserClose(e,r){let[,i]=e.split(":");switch(i){case"cfvo":this.model.cfvo.push(r.model);break;default:this.model[i]=r.model;break}}};YO.exports=py});var eA=y((Cle,JO)=>{var QO=Z(),gy=class extends QO{get tag(){return"x14:cfIcon"}render(e,r){e.leafNode(this.tag,{iconSet:r.iconSet,iconId:r.iconId})}parseOpen({attributes:e}){this.model={iconSet:e.iconSet,iconId:QO.toIntValue(e.iconId)}}parseClose(e){return e!==this.tag}};JO.exports=gy});var rA=y((Sle,tA)=>{var Sn=Z(),JX=kt(),e5=dy(),t5=eA(),my=class extends JX{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new e5,"x14:cfIcon":this.cfIconXform=new t5}}get tag(){return"x14:iconSet"}render(e,r){e.openNode(this.tag,{iconSet:Sn.toStringAttribute(r.iconSet),reverse:Sn.toBoolAttribute(r.reverse,!1),showValue:Sn.toBoolAttribute(r.showValue,!0),custom:Sn.toBoolAttribute(r.icons,!1)}),r.cfvo.forEach(i=>{this.cfvoXform.render(e,i)}),r.icons&&r.icons.forEach((i,n)=>{i.iconId=n,this.cfIconXform.render(e,i)}),e.closeNode()}createNewModel({attributes:e}){return{cfvo:[],iconSet:Sn.toStringValue(e.iconSet,"3TrafficLights"),reverse:Sn.toBoolValue(e.reverse,!1),showValue:Sn.toBoolValue(e.showValue,!0)}}onParserClose(e,r){let[,i]=e.split(":");switch(i){case"cfvo":this.model.cfvo.push(r.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(r.model);break;default:this.model[i]=r.model;break}}};tA.exports=my});var vy=y((kle,sA)=>{var{v4:iA}=XO(),r5=Z(),i5=kt(),nA=KO(),n5=rA(),s5={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},Ys=class extends i5{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new nA,"x14:iconSet":this.iconSetXform=new n5}}get tag(){return"x14:cfRule"}static isExt(e){return e.type==="dataBar"?nA.isExt(e):!!(e.type==="iconSet"&&(e.custom||s5[e.iconSet]))}prepare(e){Ys.isExt(e)&&(e.x14Id=`{${iA()}}`.toUpperCase())}render(e,r){if(!!Ys.isExt(r))switch(r.type){case"dataBar":this.renderDataBar(e,r);break;case"iconSet":this.renderIconSet(e,r);break}}renderDataBar(e,r){e.openNode(this.tag,{type:"dataBar",id:r.x14Id}),this.databarXform.render(e,r),e.closeNode()}renderIconSet(e,r){e.openNode(this.tag,{type:"iconSet",priority:r.priority,id:r.x14Id||`{${iA()}}`}),this.iconSetXform.render(e,r),e.closeNode()}createNewModel({attributes:e}){return{type:e.type,x14Id:e.id,priority:r5.toIntValue(e.priority)}}onParserClose(e,r){Object.assign(this.model,r.model)}};sA.exports=Ys});var oA=y((Rle,aA)=>{var a5=Z(),yy=class extends a5{get tag(){return"xm:sqref"}render(e,r){e.leafNode(this.tag,null,r)}parseOpen(){this.model=""}parseText(e){this.model+=e}parseClose(e){return e!==this.tag}};aA.exports=yy});var uA=y((Ole,lA)=>{var o5=kt(),l5=oA(),_y=vy(),wy=class extends o5{constructor(){super(),this.map={"xm:sqref":this.sqRef=new l5,"x14:cfRule":this.cfRule=new _y}}get tag(){return"x14:conditionalFormatting"}prepare(e,r){e.rules.forEach(i=>{this.cfRule.prepare(i,r)})}render(e,r){!r.rules.some(_y.isExt)||(e.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),r.rules.filter(_y.isExt).forEach(i=>this.cfRule.render(e,i)),this.sqRef.render(e,r.ref),e.closeNode())}createNewModel(){return{rules:[]}}onParserClose(e,r){switch(e){case"xm:sqref":this.model.ref=r.model;break;case"x14:cfRule":this.model.rules.push(r.model);break}}};lA.exports=wy});var hA=y((Ale,fA)=>{var u5=kt(),f5=vy(),h5=uA(),by=class extends u5{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new h5}}get tag(){return"x14:conditionalFormattings"}hasContent(e){return e.hasExtContent===void 0&&(e.hasExtContent=e.some(r=>r.rules.some(f5.isExt))),e.hasExtContent}prepare(e,r){e.forEach(i=>{this.cfXform.prepare(i,r)})}render(e,r){this.hasContent(r)&&(e.openNode(this.tag),r.forEach(i=>this.cfXform.render(e,i)),e.closeNode())}createNewModel(){return[]}onParserClose(e,r){this.model.push(r.model)}};fA.exports=by});var pA=y((Fle,dA)=>{var cA=kt(),c5=hA(),xy=class extends cA{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new c5}}get tag(){return"ext"}hasContent(e){return this.conditionalFormattings.hasContent(e.conditionalFormattings)}prepare(e,r){this.conditionalFormattings.prepare(e.conditionalFormattings,r)}render(e,r){e.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(e,r.conditionalFormattings),e.closeNode()}createNewModel(){return{}}onParserClose(e,r){this.model[e]=r.model}},Ty=class extends cA{constructor(){super(),this.map={ext:this.ext=new xy}}get tag(){return"extLst"}prepare(e,r){this.ext.prepare(e,r)}hasContent(e){return this.ext.hasContent(e)}render(e,r){!this.hasContent(r)||(e.openNode("extLst"),this.ext.render(e,r),e.closeNode())}createNewModel(){return{}}onParserClose(e,r){Object.assign(this.model,r.model)}};dA.exports=Ty});var mA=y((Nle,gA)=>{var d5=je(),p5=Me(),g5=nt(),Ur=Ai(),m5=UR(),v5=Z(),Ks=xn(),y5=mv(),_5=yv(),w5=KR(),b5=bv(),x5=eO(),T5=Cv(),E5=Ov(),C5=Fv(),S5=Dv(),k5=Iv(),R5=Pv(),O5=Bv(),A5=pO(),F5=$v(),N5=Uv(),D5=yO(),q5=wO(),I5=Zv(),M5=Kv(),P5=fy(),L5=pA(),B5=(t,e)=>{Object.keys(e).forEach(r=>{let i=t[r],n=e[r];i===void 0&&n!==void 0&&(t[r]=n)})},j5=(t,e)=>{if(!e||!e.length)return t;if(!t||!t.length)return e;let r={},i={};return t.forEach(n=>{r[n.ref]=n,n.rules.forEach(s=>{let{x14Id:a}=s;a&&(i[a]=s)})}),e.forEach(n=>{n.rules.forEach(s=>{let a=i[s.x14Id];a?B5(a,s):r[n.ref]?r[n.ref].rules.push(s):t.push({ref:n.ref,rules:[s]})})}),t},Qs=class extends v5{constructor(e){super();let{maxRows:r,maxCols:i}=e||{};this.map={sheetPr:new E5,dimension:new w5,sheetViews:new Ks({tag:"sheetViews",count:!1,childXform:new S5}),sheetFormatPr:new C5,cols:new Ks({tag:"cols",count:!1,childXform:new _5}),sheetData:new Ks({tag:"sheetData",count:!1,empty:!0,childXform:new y5({maxItems:i}),maxItems:r}),autoFilter:new F5,mergeCells:new Ks({tag:"mergeCells",count:!0,childXform:new x5}),rowBreaks:new I5,hyperlinks:new Ks({tag:"hyperlinks",count:!1,childXform:new b5}),pageMargins:new R5,dataValidations:new T5,pageSetup:new O5,headerFooter:new M5,printOptions:new A5,picture:new N5,drawing:new D5,sheetProtection:new k5,tableParts:new Ks({tag:"tableParts",count:!0,childXform:new q5}),conditionalFormatting:new P5,extLst:new L5}}prepare(e,r){r.merges=new m5,e.hyperlinks=r.hyperlinks=[],e.comments=r.comments=[],r.formulae={},r.siFormulae=0,this.map.cols.prepare(e.cols,r),this.map.sheetData.prepare(e.rows,r),this.map.conditionalFormatting.prepare(e.conditionalFormattings,r),e.mergeCells=r.merges.mergeCells;let i=e.rels=[];function n(o){return`rId${o.length+1}`}if(e.hyperlinks.forEach(o=>{let u=n(i);o.rId=u,i.push({Id:u,Type:Ur.Hyperlink,Target:o.target,TargetMode:"External"})}),e.comments.length>0){let o={Id:n(i),Type:Ur.Comments,Target:`../comments${e.id}.xml`};i.push(o);let u={Id:n(i),Type:Ur.VmlDrawing,Target:`../drawings/vmlDrawing${e.id}.vml`};i.push(u),e.comments.forEach(f=>{f.refAddress=p5.decodeAddress(f.ref)}),r.commentRefs.push({commentName:`comments${e.id}`,vmlDrawing:`vmlDrawing${e.id}`})}let s=[],a;e.media.forEach(o=>{if(o.type==="background"){let u=n(i);a=r.media[o.imageId],i.push({Id:u,Type:Ur.Image,Target:`../media/${a.name}.${a.extension}`}),e.background={rId:u},e.image=r.media[o.imageId]}else if(o.type==="image"){let{drawing:u}=e;a=r.media[o.imageId],u||(u=e.drawing={rId:n(i),name:`drawing${++r.drawingsCount}`,anchors:[],rels:[]},r.drawings.push(u),i.push({Id:u.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${u.name}.xml`}));let f=this.preImageId===o.imageId?s[o.imageId]:s[u.rels.length];f||(f=n(u.rels),s[u.rels.length]=f,u.rels.push({Id:f,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${a.name}.${a.extension}`}));let h={picture:{rId:f},range:o.range};if(o.hyperlinks&&o.hyperlinks.hyperlink){let g=n(u.rels);s[u.rels.length]=g,h.picture.hyperlinks={tooltip:o.hyperlinks.tooltip,rId:g},u.rels.push({Id:g,Type:Ur.Hyperlink,Target:o.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=o.imageId,u.anchors.push(h)}}),e.tables.forEach(o=>{let u=n(i);o.rId=u,i.push({Id:u,Type:Ur.Table,Target:`../tables/${o.target}`}),o.columns.forEach(f=>{let{style:h}=f;h&&(f.dxfId=r.styles.addDxfStyle(h))})}),this.map.extLst.prepare(e,r)}render(e,r){e.openXml(g5.StdDocAttributes),e.openNode("worksheet",Qs.WORKSHEET_ATTRIBUTES);let i=r.properties?{defaultRowHeight:r.properties.defaultRowHeight,dyDescent:r.properties.dyDescent,outlineLevelCol:r.properties.outlineLevelCol,outlineLevelRow:r.properties.outlineLevelRow}:void 0;r.properties&&r.properties.defaultColWidth&&(i.defaultColWidth=r.properties.defaultColWidth);let n={outlineProperties:r.properties&&r.properties.outlineProperties,tabColor:r.properties&&r.properties.tabColor,pageSetup:r.pageSetup&&r.pageSetup.fitToPage?{fitToPage:r.pageSetup.fitToPage}:void 0},s=r.pageSetup&&r.pageSetup.margins,a={showRowColHeaders:r.pageSetup&&r.pageSetup.showRowColHeaders,showGridLines:r.pageSetup&&r.pageSetup.showGridLines,horizontalCentered:r.pageSetup&&r.pageSetup.horizontalCentered,verticalCentered:r.pageSetup&&r.pageSetup.verticalCentered},o=r.sheetProtection;this.map.sheetPr.render(e,n),this.map.dimension.render(e,r.dimensions),this.map.sheetViews.render(e,r.views),this.map.sheetFormatPr.render(e,i),this.map.cols.render(e,r.cols),this.map.sheetData.render(e,r.rows),this.map.sheetProtection.render(e,o),this.map.autoFilter.render(e,r.autoFilter),this.map.mergeCells.render(e,r.mergeCells),this.map.conditionalFormatting.render(e,r.conditionalFormattings),this.map.dataValidations.render(e,r.dataValidations),this.map.hyperlinks.render(e,r.hyperlinks),this.map.printOptions.render(e,a),this.map.pageMargins.render(e,s),this.map.pageSetup.render(e,r.pageSetup),this.map.headerFooter.render(e,r.headerFooter),this.map.rowBreaks.render(e,r.rowBreaks),this.map.drawing.render(e,r.drawing),this.map.picture.render(e,r.background),this.map.tableParts.render(e,r.tables),this.map.extLst.render(e,r),r.rels&&r.rels.forEach(u=>{u.Type===Ur.VmlDrawing&&e.leafNode("legacyDrawing",{"r:id":u.Id})}),e.closeNode()}parseOpen(e){return this.parser?(this.parser.parseOpen(e),!0):e.name==="worksheet"?(d5.each(this.map,r=>{r.reset()}),!0):(this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e),!0)}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case"worksheet":{let r=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(r.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(r.outlineProperties=this.map.sheetPr.model.outlineProperties);let i={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},n=Object.assign(i,this.map.pageSetup.model,this.map.printOptions.model),s=j5(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:r,views:this.map.sheetViews.model,pageSetup:n,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:s},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(e,r){let i=(e.relationships||[]).reduce((s,a)=>{if(s[a.Id]=a,a.Type===Ur.Comments&&(e.comments=r.comments[a.Target].comments),a.Type===Ur.VmlDrawing&&e.comments&&e.comments.length){let o=r.vmlDrawings[a.Target].comments;e.comments.forEach((u,f)=>{u.note=Object.assign({},u.note,o[f])})}return s},{});if(r.commentsMap=(e.comments||[]).reduce((s,a)=>(a.ref&&(s[a.ref]=a),s),{}),r.hyperlinkMap=(e.hyperlinks||[]).reduce((s,a)=>(a.rId&&(s[a.address]=i[a.rId].Target),s),{}),r.formulae={},e.rows=e.rows&&e.rows.filter(Boolean)||[],e.rows.forEach(s=>{s.cells=s.cells&&s.cells.filter(Boolean)||[]}),this.map.cols.reconcile(e.cols,r),this.map.sheetData.reconcile(e.rows,r),this.map.conditionalFormatting.reconcile(e.conditionalFormattings,r),e.media=[],e.drawing){let a=i[e.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(a){let o=a[1];r.drawings[o].anchors.forEach(f=>{if(f.medium){let h={type:"image",imageId:f.medium.index,range:f.range,hyperlinks:f.picture.hyperlinks};e.media.push(h)}})}}let n=e.background&&i[e.background.rId];if(n){let s=n.Target.split("/media/")[1],a=r.mediaIndex&&r.mediaIndex[s];a!==void 0&&e.media.push({type:"background",imageId:a})}e.tables=(e.tables||[]).map(s=>{let a=i[s.rId];return r.tables[a.Target]}),delete e.relationships,delete e.hyperlinks,delete e.comments}};Qs.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"};gA.exports=Qs});var Cy=y((Dle,vA)=>{var W5=Z(),Ey=class extends W5{parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset(),this.model={range:{editAs:e.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}reconcilePicture(e,r){if(e&&e.rId){let n=r.rels[e.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(n){let s=n[1],a=r.mediaIndex[s];return r.media[a]}}}};vA.exports=Ey});var ky=y((qle,yA)=>{var $5=Z(),eh=Mf(),Sy=class extends $5{constructor(e){super(),this.tag=e.tag,this.map={"xdr:col":new eh({tag:"xdr:col",zero:!0}),"xdr:colOff":new eh({tag:"xdr:colOff",zero:!0}),"xdr:row":new eh({tag:"xdr:row",zero:!0}),"xdr:rowOff":new eh({tag:"xdr:rowOff",zero:!0})}}render(e,r){e.openNode(this.tag),this.map["xdr:col"].render(e,r.nativeCol),this.map["xdr:colOff"].render(e,r.nativeColOff),this.map["xdr:row"].render(e,r.nativeRow),this.map["xdr:rowOff"].render(e,r.nativeRowOff),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}};yA.exports=Sy});var wA=y((Ile,_A)=>{var H5=Z(),Ry=class extends H5{get tag(){return"a:blip"}render(e,r){e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":r.rId,cstate:"print"})}parseOpen(e){switch(e.name){case this.tag:return this.model={rId:e.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(e){switch(e){case this.tag:return!1;default:return!0}}};_A.exports=Ry});var xA=y((Mle,bA)=>{var U5=Z(),z5=wA(),Oy=class extends U5{constructor(){super(),this.map={"a:blip":new z5}}get tag(){return"xdr:blipFill"}render(e,r){e.openNode(this.tag),this.map["a:blip"].render(e,r),e.openNode("a:stretch"),e.leafNode("a:fillRect"),e.closeNode(),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}};bA.exports=Oy});var EA=y((Ple,TA)=>{var X5=Z(),Ay=class extends X5{get tag(){return"a:hlinkClick"}render(e,r){!(r.hyperlinks&&r.hyperlinks.rId)||e.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":r.hyperlinks.rId,tooltip:r.hyperlinks.tooltip})}parseOpen(e){switch(e.name){case this.tag:return this.model={hyperlinks:{rId:e.attributes["r:id"],tooltip:e.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}};TA.exports=Ay});var SA=y((Lle,CA)=>{var V5=Z(),Fy=class extends V5{get tag(){return"a:extLst"}render(e){e.openNode(this.tag),e.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),e.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),e.closeNode(),e.closeNode()}parseOpen(e){switch(e.name){case this.tag:return!0;default:return!0}}parseText(){}parseClose(e){switch(e){case this.tag:return!1;default:return!0}}};CA.exports=Fy});var RA=y((Ble,kA)=>{var G5=Z(),Z5=EA(),Y5=SA(),Ny=class extends G5{constructor(){super(),this.map={"a:hlinkClick":new Z5,"a:extLst":new Y5}}get tag(){return"xdr:cNvPr"}render(e,r){e.openNode(this.tag,{id:r.index,name:`Picture ${r.index}`}),this.map["a:hlinkClick"].render(e,r),this.map["a:extLst"].render(e,r),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}};kA.exports=Ny});var AA=y((jle,OA)=>{var K5=Z(),Dy=class extends K5{get tag(){return"xdr:cNvPicPr"}render(e){e.openNode(this.tag),e.leafNode("a:picLocks",{noChangeAspect:"1"}),e.closeNode()}parseOpen(e){switch(e.name){case this.tag:return!0;default:return!0}}parseText(){}parseClose(e){switch(e){case this.tag:return!1;default:return!0}}};OA.exports=Dy});var NA=y((Wle,FA)=>{var Q5=Z(),J5=RA(),eV=AA(),qy=class extends Q5{constructor(){super(),this.map={"xdr:cNvPr":new J5,"xdr:cNvPicPr":new eV}}get tag(){return"xdr:nvPicPr"}render(e,r){e.openNode(this.tag),this.map["xdr:cNvPr"].render(e,r),this.map["xdr:cNvPicPr"].render(e,r),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}};FA.exports=qy});var qA=y(($le,DA)=>{DA.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}});var My=y((Hle,IA)=>{var tV=Z(),rV=js(),iV=xA(),nV=NA(),sV=qA(),Iy=class extends tV{constructor(){super(),this.map={"xdr:nvPicPr":new nV,"xdr:blipFill":new iV,"xdr:spPr":new rV(sV)}}get tag(){return"xdr:pic"}prepare(e,r){e.index=r.index+1}render(e,r){e.openNode(this.tag),this.map["xdr:nvPicPr"].render(e,r),this.map["xdr:blipFill"].render(e,r),this.map["xdr:spPr"].render(e,r),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset();break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(){}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(e){case this.tag:return!1;default:return!0}}};IA.exports=Iy});var LA=y((Ule,PA)=>{var aV=Cy(),oV=js(),MA=ky(),lV=My(),Py=class extends aV{constructor(){super(),this.map={"xdr:from":new MA({tag:"xdr:from"}),"xdr:to":new MA({tag:"xdr:to"}),"xdr:pic":new lV,"xdr:clientData":new oV({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(e,r){this.map["xdr:pic"].prepare(e.picture,r)}render(e,r){e.openNode(this.tag,{editAs:r.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,r.range.tl),this.map["xdr:to"].render(e,r.range.br),this.map["xdr:pic"].render(e,r.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(e,r){e.medium=this.reconcilePicture(e.picture,r)}};PA.exports=Py});var jA=y((zle,BA)=>{var uV=Z(),th=9525,Ly=class extends uV{constructor(e){super(),this.tag=e.tag,this.map={}}render(e,r){e.openNode(this.tag);let i=Math.floor(r.width*th),n=Math.floor(r.height*th);e.addAttribute("cx",i),e.addAttribute("cy",n),e.closeNode()}parseOpen(e){return e.name===this.tag?(this.model={width:parseInt(e.attributes.cx||"0",10)/th,height:parseInt(e.attributes.cy||"0",10)/th},!0):!1}parseText(){}parseClose(){return!1}};BA.exports=Ly});var $A=y((Xle,WA)=>{var fV=Cy(),hV=js(),cV=ky(),dV=jA(),pV=My(),By=class extends fV{constructor(){super(),this.map={"xdr:from":new cV({tag:"xdr:from"}),"xdr:ext":new dV({tag:"xdr:ext"}),"xdr:pic":new pV,"xdr:clientData":new hV({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(e,r){this.map["xdr:pic"].prepare(e.picture,r)}render(e,r){e.openNode(this.tag,{editAs:r.range.editAs||"oneCell"}),this.map["xdr:from"].render(e,r.range.tl),this.map["xdr:ext"].render(e,r.range.ext),this.map["xdr:pic"].render(e,r.picture),this.map["xdr:clientData"].render(e,{}),e.closeNode()}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(e,r){e.medium=this.reconcilePicture(e.picture,r)}};WA.exports=By});var UA=y((Vle,HA)=>{var gV=Me(),mV=nt(),vV=Z(),yV=LA(),_V=$A();function wV(t){return(typeof t.range=="string"?gV.decode(t.range):t.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}var Js=class extends vV{constructor(){super(),this.map={"xdr:twoCellAnchor":new yV,"xdr:oneCellAnchor":new _V}}prepare(e){e.anchors.forEach((r,i)=>{r.anchorType=wV(r),this.map[r.anchorType].prepare(r,{index:i})})}get tag(){return"xdr:wsDr"}render(e,r){e.openXml(mV.StdDocAttributes),e.openNode(this.tag,Js.DRAWING_ATTRIBUTES),r.anchors.forEach(i=>{this.map[i.anchorType].render(e,i)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(e){case this.tag:return!1;default:return!0}}reconcile(e,r){e.anchors.forEach(i=>{i.br?this.map["xdr:twoCellAnchor"].reconcile(i,r):this.map["xdr:oneCellAnchor"].reconcile(i,r)})}};Js.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"};HA.exports=Js});var XA=y((Gle,zA)=>{var bV=Z(),jy=class extends bV{get tag(){return"filterColumn"}prepare(e,r){e.colId=r.index.toString()}render(e,r){return e.leafNode(this.tag,{colId:r.colId,hiddenButton:r.filterButton?"0":"1"}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:r}=e;return this.model={filterButton:r.hiddenButton==="0"},!0}return!1}parseText(){}parseClose(){return!1}};zA.exports=jy});var GA=y((Zle,VA)=>{var xV=Z(),TV=XA(),Wy=class extends xV{constructor(){super(),this.map={filterColumn:new TV}}get tag(){return"autoFilter"}prepare(e){e.columns.forEach((r,i)=>{this.map.filterColumn.prepare(r,{index:i})})}render(e,r){return e.openNode(this.tag,{ref:r.autoFilterRef}),r.columns.forEach(i=>{this.map.filterColumn.render(e,i)}),e.closeNode(),!0}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:return this.model={autoFilterRef:e.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[e.name],this.parser)return this.parseOpen(e),!0;throw new Error(`Unexpected xml node in parseOpen: ${JSON.stringify(e)}`)}}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(e){case this.tag:return!1;default:throw new Error(`Unexpected xml node in parseClose: ${e}`)}}};VA.exports=Wy});var YA=y((Yle,ZA)=>{var EV=Z(),$y=class extends EV{get tag(){return"tableColumn"}prepare(e,r){e.id=r.index+1}render(e,r){return e.leafNode(this.tag,{id:r.id.toString(),name:r.name,totalsRowLabel:r.totalsRowLabel,totalsRowFunction:r.totalsRowFunction,dxfId:r.dxfId}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:r}=e;return this.model={name:r.name,totalsRowLabel:r.totalsRowLabel,totalsRowFunction:r.totalsRowFunction,dxfId:r.dxfId},!0}return!1}parseText(){}parseClose(){return!1}};ZA.exports=$y});var QA=y((Kle,KA)=>{var CV=Z(),Hy=class extends CV{get tag(){return"tableStyleInfo"}render(e,r){return e.leafNode(this.tag,{name:r.theme?r.theme:void 0,showFirstColumn:r.showFirstColumn?"1":"0",showLastColumn:r.showLastColumn?"1":"0",showRowStripes:r.showRowStripes?"1":"0",showColumnStripes:r.showColumnStripes?"1":"0"}),!0}parseOpen(e){if(e.name===this.tag){let{attributes:r}=e;return this.model={theme:r.name?r.name:null,showFirstColumn:r.showFirstColumn==="1",showLastColumn:r.showLastColumn==="1",showRowStripes:r.showRowStripes==="1",showColumnStripes:r.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}};KA.exports=Hy});var eF=y((Qle,JA)=>{var SV=nt(),kV=Z(),RV=xn(),OV=GA(),AV=YA(),FV=QA(),ea=class extends kV{constructor(){super(),this.map={autoFilter:new OV,tableColumns:new RV({tag:"tableColumns",count:!0,empty:!0,childXform:new AV}),tableStyleInfo:new FV}}prepare(e,r){this.map.autoFilter.prepare(e),this.map.tableColumns.prepare(e.columns,r)}get tag(){return"table"}render(e,r){e.openXml(SV.StdDocAttributes),e.openNode(this.tag,{...ea.TABLE_ATTRIBUTES,id:r.id,name:r.name,displayName:r.displayName||r.name,ref:r.tableRef,totalsRowCount:r.totalsRow?"1":void 0,totalsRowShown:r.totalsRow?void 0:"1",headerRowCount:r.headerRow?"1":"0"}),this.map.autoFilter.render(e,r),this.map.tableColumns.render(e,r.columns),this.map.tableStyleInfo.render(e,r.style),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;let{name:r,attributes:i}=e;switch(r){case this.tag:this.reset(),this.model={name:i.name,displayName:i.displayName||i.name,tableRef:i.ref,totalsRow:i.totalsRowCount==="1",headerRow:i.headerRowCount==="1"};break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((r,i)=>{this.model.columns[i].filterButton=r.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(e,r){e.columns.forEach(i=>{i.dxfId!==void 0&&(i.style=r.styles.getDxfStyle(i.dxfId))})}};ea.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"};JA.exports=ea});var Uy=y((Jle,tF)=>{var NV=sl(),DV=qt(),qV=Z(),IV=tF.exports=function(t){this.model=t};DV.inherits(IV,qV,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new NV),this._richTextXform},render(t,e){e=e||this.model,t.openNode("comment",{ref:e.ref,authorId:0}),t.openNode("text"),e&&e.note&&e.note.texts&&e.note.texts.forEach(r=>{this.richTextXform.render(t,r)}),t.closeNode(),t.closeNode()},parseOpen(t){if(this.parser)return this.parser.parseOpen(t),!0;switch(t.name){case"comment":return this.model={type:"note",note:{texts:[]},...t.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(t),!0;default:return!1}},parseText(t){this.parser&&this.parser.parseText(t)},parseClose(t){switch(t){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(t),!0}}})});var nF=y((eue,iF)=>{var MV=nt(),PV=qt(),LV=Z(),BV=Uy(),rF=iF.exports=function(){this.map={comment:new BV}};PV.inherits(rF,LV,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(t,e){e=e||this.model,t.openXml(MV.StdDocAttributes),t.openNode("comments",rF.COMMENTS_ATTRIBUTES),t.openNode("authors"),t.leafNode("author",null,"Author"),t.closeNode(),t.openNode("commentList"),e.comments.forEach(r=>{this.map.comment.render(t,r)}),t.closeNode(),t.closeNode()},parseOpen(t){if(this.parser)return this.parser.parseOpen(t),!0;switch(t.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(t),!0;default:return!1}},parseText(t){this.parser&&this.parser.parseText(t)},parseClose(t){switch(t){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(t),!0}}})});var aF=y((tue,sF)=>{var jV=Z(),zy=class extends jV{get tag(){return"v:textbox"}conversionUnit(e,r,i){return`${parseFloat(e)*r.toFixed(2)}${i}`}reverseConversionUnit(e){return(e||"").split(",").map(r=>Number(parseFloat(this.conversionUnit(parseFloat(r),.1,"")).toFixed(2)))}render(e,r){let i={style:"mso-direction-alt:auto"};if(r&&r.note){let{inset:n}=r.note&&r.note.margins;Array.isArray(n)&&(n=n.map(s=>this.conversionUnit(s,10,"mm")).join(",")),n&&(i.inset=n)}e.openNode("v:textbox",i),e.leafNode("div",{style:"text-align:left"}),e.closeNode()}parseOpen(e){switch(e.name){case this.tag:return this.model={inset:this.reverseConversionUnit(e.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(e){switch(e){case this.tag:return!1;default:return!0}}};sF.exports=zy});var lF=y((rue,oF)=>{var WV=Z(),Xy=class extends WV{get tag(){return"x:Anchor"}getAnchorRect(e){let r=Math.floor(e.left),i=Math.floor((e.left-r)*68),n=Math.floor(e.top),s=Math.floor((e.top-n)*18),a=Math.floor(e.right),o=Math.floor((e.right-a)*68),u=Math.floor(e.bottom),f=Math.floor((e.bottom-u)*18);return[r,i,n,s,a,o,u,f]}getDefaultRect(e){let r=e.col,i=6,n=Math.max(e.row-2,0),s=14,a=r+2,o=2,u=n+4;return[r,i,n,s,a,o,u,16]}render(e,r){let i=r.anchor?this.getAnchorRect(r.anchor):this.getDefaultRect(r.refAddress);e.leafNode("x:Anchor",null,i.join(", "))}parseOpen(e){switch(e.name){case this.tag:return this.text="",!0;default:return!1}}parseText(e){this.text=e}parseClose(){return!1}};oF.exports=Xy});var fF=y((iue,uF)=>{var $V=Z(),Vy=class extends $V{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,r){e.leafNode(this.tag,null,r)}parseOpen(e){switch(e.name){case this.tag:return this.text="",!0;default:return!1}}parseText(e){this.text=e}parseClose(){return!1}};uF.exports=Vy});var cF=y((nue,hF)=>{var HV=Z(),Gy=class extends HV{constructor(e){super(),this._model=e}get tag(){return this._model&&this._model.tag}render(e,r,i){r===i[2]?e.leafNode(this.tag):this.tag==="x:SizeWithCells"&&r===i[1]&&e.leafNode(this.tag)}parseOpen(e){switch(e.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}};hF.exports=Gy});var mF=y((sue,gF)=>{var UV=Z(),zV=lF(),dF=fF(),pF=cF(),Zy=["twoCells","oneCells","absolute"],Yy=class extends UV{constructor(){super(),this.map={"x:Anchor":new zV,"x:Locked":new dF({tag:"x:Locked"}),"x:LockText":new dF({tag:"x:LockText"}),"x:SizeWithCells":new pF({tag:"x:SizeWithCells"}),"x:MoveWithCells":new pF({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(e,r){let{protection:i,editAs:n}=r.note;e.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(e,n,Zy),this.map["x:SizeWithCells"].render(e,n,Zy),this.map["x:Anchor"].render(e,r),this.map["x:Locked"].render(e,i.locked),e.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(e,i.lockText),e.leafNode("x:Row",null,r.refAddress.row-1),e.leafNode("x:Column",null,r.refAddress.col-1),e.closeNode()}parseOpen(e){switch(e.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){let e=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),r=Object.keys(e).length;this.model.editAs=Zy[r],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}};gF.exports=Yy});var Ky=y((aue,vF)=>{var XV=Z(),VV=aF(),GV=mF(),ta=class extends XV{constructor(){super(),this.map={"v:textbox":new VV,"x:ClientData":new GV}}get tag(){return"v:shape"}render(e,r,i){e.openNode("v:shape",ta.V_SHAPE_ATTRIBUTES(r,i)),e.leafNode("v:fill",{color2:"infoBackground [80]"}),e.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),e.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(e,r),this.map["x:ClientData"].render(e,r),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset(),this.model={margins:{insetmode:e.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.parser=void 0),!0;switch(e){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}};ta.V_SHAPE_ATTRIBUTES=(t,e)=>({id:`_x0000_s${1025+e}`,type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":t.note.margins&&t.note.margins.insetmode});vF.exports=ta});var _F=y((oue,yF)=>{var ZV=nt(),YV=Z(),KV=Ky(),ra=class extends YV{constructor(){super(),this.map={"v:shape":new KV}}get tag(){return"xml"}render(e,r){e.openXml(ZV.StdDocAttributes),e.openNode(this.tag,ra.DRAWING_ATTRIBUTES),e.openNode("o:shapelayout",{"v:ext":"edit"}),e.leafNode("o:idmap",{"v:ext":"edit",data:1}),e.closeNode(),e.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),e.leafNode("v:stroke",{joinstyle:"miter"}),e.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),e.closeNode(),r.comments.forEach((i,n)=>{this.map["v:shape"].render(e,i,n)}),e.closeNode()}parseOpen(e){if(this.parser)return this.parser.parseOpen(e),!0;switch(e.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[e.name],this.parser&&this.parser.parseOpen(e);break}return!0}parseText(e){this.parser&&this.parser.parseText(e)}parseClose(e){if(this.parser)return this.parser.parseClose(e)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(e){case this.tag:return!1;default:return!0}}reconcile(e,r){e.anchors.forEach(i=>{i.br?this.map["xdr:twoCellAnchor"].reconcile(i,r):this.map["xdr:oneCellAnchor"].reconcile(i,r)})}};ra.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"};yF.exports=ra});var Qy=y((lue,wF)=>{wF.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/> <a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/> <a:font script="Hans" typeface="\u5B8B\u4F53"/> <a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/> <a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/> <a:font script="Hans" typeface="\u5B8B\u4F53"/> <a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`});var a_=y((uue,CF)=>{var s_=require("fs"),QV=Tg(),{PassThrough:Jy}=Ko(),JV=GS(),e_=Qo(),e7=qt(),rh=nt(),{bufferToString:t7}=sm(),t_=zf(),bF=Zm(),r_=ev(),kn=Vf(),r7=rv(),xF=sv(),ih=Gf(),nh=mA(),i_=UA(),n_=eF(),TF=nF(),EF=_F(),i7=Qy();function n7(t,e){return new Promise((r,i)=>{s_.readFile(t,e,(n,s)=>{n?i(n):r(s)})})}var Xt=class{constructor(e){this.workbook=e}async readFile(e,r){if(!await e7.fs.exists(e))throw new Error(`File not found: ${e}`);let i=s_.createReadStream(e);try{let n=await this.read(i,r);return i.close(),n}catch(n){throw i.close(),n}}parseRels(e){return new kn().parseStream(e)}parseWorkbook(e){return new ih().parseStream(e)}parseSharedStrings(e){return new r_().parseStream(e)}reconcile(e,r){let i=new ih,n=new nh(r),s=new i_,a=new n_;i.reconcile(e);let o={media:e.media,mediaIndex:e.mediaIndex};Object.keys(e.drawings).forEach(h=>{let g=e.drawings[h],m=e.drawingRels[h];m&&(o.rels=m.reduce((c,d)=>(c[d.Id]=d,c),{}),(g.anchors||[]).forEach(c=>{let d=c.picture&&c.picture.hyperlinks;d&&o.rels[d.rId]&&(d.hyperlink=o.rels[d.rId].Target,delete d.rId)}),s.reconcile(g,o))});let u={styles:e.styles};Object.values(e.tables).forEach(h=>{a.reconcile(h,u)});let f={styles:e.styles,sharedStrings:e.sharedStrings,media:e.media,mediaIndex:e.mediaIndex,date1904:e.properties&&e.properties.date1904,drawings:e.drawings,comments:e.comments,tables:e.tables,vmlDrawings:e.vmlDrawings};e.worksheets.forEach(h=>{h.relationships=e.worksheetRels[h.sheetNo],n.reconcile(h,f)}),delete e.worksheetHash,delete e.worksheetRels,delete e.globalRels,delete e.sharedStrings,delete e.workbookRels,delete e.sheetDefs,delete e.styles,delete e.mediaIndex,delete e.drawings,delete e.drawingRels,delete e.vmlDrawings}async _processWorksheetEntry(e,r,i,n,s){let o=await new nh(n).parseStream(e);o.sheetNo=i,r.worksheetHash[s]=o,r.worksheets.push(o)}async _processCommentEntry(e,r,i){let s=await new TF().parseStream(e);r.comments[`../${i}.xml`]=s}async _processTableEntry(e,r,i){let s=await new n_().parseStream(e);r.tables[`../tables/${i}.xml`]=s}async _processWorksheetRelsEntry(e,r,i){let s=await new kn().parseStream(e);r.worksheetRels[i]=s}async _processMediaEntry(e,r,i){let n=i.lastIndexOf(".");if(n>=1){let s=i.substr(n+1),a=i.substr(0,n);await new Promise((o,u)=>{let f=new e_;f.on("finish",()=>{r.mediaIndex[i]=r.media.length,r.mediaIndex[a]=r.media.length;let h={type:"image",name:a,extension:s,buffer:f.toBuffer()};r.media.push(h),o()}),e.on("error",h=>{u(h)}),e.pipe(f)})}}async _processDrawingEntry(e,r,i){let s=await new i_().parseStream(e);r.drawings[i]=s}async _processDrawingRelsEntry(e,r,i){let s=await new kn().parseStream(e);r.drawingRels[i]=s}async _processVmlDrawingEntry(e,r,i){let s=await new EF().parseStream(e);r.vmlDrawings[`../drawings/${i}.vml`]=s}async _processThemeEntry(e,r,i){await new Promise((n,s)=>{let a=new e_;e.on("error",s),a.on("error",s),a.on("finish",()=>{r.themes[i]=a.read().toString(),n()}),e.pipe(a)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(e,r){!e[Symbol.asyncIterator]&&e.pipe&&(e=e.pipe(new Jy));let i=[];for await(let n of e)i.push(n);return this.load(Buffer.concat(i),r)}async load(e,r){let i;r&&r.base64?i=Buffer.from(e.toString(),"base64"):i=e;let n={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},s=await QV.loadAsync(i);for(let a of Object.values(s.files))if(!a.dir){let o=a.name;o[0]==="/"&&(o=o.substr(1));let u;if(o.match(/xl\/media\//)||o.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))u=new Jy,u.write(await a.async("nodebuffer"));else{u=new Jy({writableObjectMode:!0,readableObjectMode:!0});let f;process.browser?f=t7(await a.async("nodebuffer")):f=await a.async("string");let h=16*1024;for(let g=0;g<f.length;g+=h)u.write(f.substring(g,g+h))}switch(u.end(),o){case"_rels/.rels":n.globalRels=await this.parseRels(u);break;case"xl/workbook.xml":{let f=await this.parseWorkbook(u);n.sheets=f.sheets,n.definedNames=f.definedNames,n.views=f.views,n.properties=f.properties,n.calcProperties=f.calcProperties;break}case"xl/_rels/workbook.xml.rels":n.workbookRels=await this.parseRels(u);break;case"xl/sharedStrings.xml":n.sharedStrings=new r_,await n.sharedStrings.parseStream(u);break;case"xl/styles.xml":n.styles=new t_,await n.styles.parseStream(u);break;case"docProps/app.xml":{let h=await new xF().parseStream(u);n.company=h.company,n.manager=h.manager;break}case"docProps/core.xml":{let h=await new bF().parseStream(u);Object.assign(n,h);break}default:{let f=o.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(f){await this._processWorksheetEntry(u,n,f[1],r,o);break}if(f=o.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),f){await this._processWorksheetRelsEntry(u,n,f[1]);break}if(f=o.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),f){await this._processThemeEntry(u,n,f[1]);break}if(f=o.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),f){await this._processMediaEntry(u,n,f[1]);break}if(f=o.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),f){await this._processDrawingEntry(u,n,f[1]);break}if(f=o.match(/xl\/(comments\d+)[.]xml/),f){await this._processCommentEntry(u,n,f[1]);break}if(f=o.match(/xl\/tables\/(table\d+)[.]xml/),f){await this._processTableEntry(u,n,f[1]);break}if(f=o.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),f){await this._processDrawingRelsEntry(u,n,f[1]);break}if(f=o.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),f){await this._processVmlDrawingEntry(u,n,f[1]);break}}}}return this.reconcile(n,r),this.workbook.model=n,this.workbook}async addMedia(e,r){await Promise.all(r.media.map(async i=>{if(i.type==="image"){let n=`xl/media/${i.name}.${i.extension}`;if(i.filename){let s=await n7(i.filename);return e.append(s,{name:n})}if(i.buffer)return e.append(i.buffer,{name:n});if(i.base64){let s=i.base64,a=s.substring(s.indexOf(",")+1);return e.append(a,{name:n,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(e,r){let i=new i_,n=new kn;r.worksheets.forEach(s=>{let{drawing:a}=s;if(a){i.prepare(a,{});let o=i.toXml(a);e.append(o,{name:`xl/drawings/${a.name}.xml`}),o=n.toXml(a.rels),e.append(o,{name:`xl/drawings/_rels/${a.name}.xml.rels`})}})}addTables(e,r){let i=new n_;r.worksheets.forEach(n=>{let{tables:s}=n;s.forEach(a=>{i.prepare(a,{});let o=i.toXml(a);e.append(o,{name:`xl/tables/${a.target}`})})})}async addContentTypes(e,r){let n=new r7().toXml(r);e.append(n,{name:"[Content_Types].xml"})}async addApp(e,r){let n=new xF().toXml(r);e.append(n,{name:"docProps/app.xml"})}async addCore(e,r){let i=new bF;e.append(i.toXml(r),{name:"docProps/core.xml"})}async addThemes(e,r){let i=r.themes||{theme1:i7};Object.keys(i).forEach(n=>{let s=i[n],a=`xl/theme/${n}.xml`;e.append(s,{name:a})})}async addOfficeRels(e){let i=new kn().toXml([{Id:"rId1",Type:Xt.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:Xt.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:Xt.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);e.append(i,{name:"_rels/.rels"})}async addWorkbookRels(e,r){let i=1,n=[{Id:`rId${i++}`,Type:Xt.RelType.Styles,Target:"styles.xml"},{Id:`rId${i++}`,Type:Xt.RelType.Theme,Target:"theme/theme1.xml"}];r.sharedStrings.count&&n.push({Id:`rId${i++}`,Type:Xt.RelType.SharedStrings,Target:"sharedStrings.xml"}),r.worksheets.forEach(o=>{o.rId=`rId${i++}`,n.push({Id:o.rId,Type:Xt.RelType.Worksheet,Target:`worksheets/sheet${o.id}.xml`})});let a=new kn().toXml(n);e.append(a,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(e,r){r.sharedStrings&&r.sharedStrings.count&&e.append(r.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(e,r){let{xml:i}=r.styles;i&&e.append(i,{name:"xl/styles.xml"})}async addWorkbook(e,r){let i=new ih;e.append(i.toXml(r),{name:"xl/workbook.xml"})}async addWorksheets(e,r){let i=new nh,n=new kn,s=new TF,a=new EF;r.worksheets.forEach(o=>{let u=new rh;i.render(u,o),e.append(u.xml,{name:`xl/worksheets/sheet${o.id}.xml`}),o.rels&&o.rels.length&&(u=new rh,n.render(u,o.rels),e.append(u.xml,{name:`xl/worksheets/_rels/sheet${o.id}.xml.rels`})),o.comments.length>0&&(u=new rh,s.render(u,o),e.append(u.xml,{name:`xl/comments${o.id}.xml`}),u=new rh,a.render(u,o),e.append(u.xml,{name:`xl/drawings/vmlDrawing${o.id}.vml`}))})}_finalize(e){return new Promise((r,i)=>{e.on("finish",()=>{r(this)}),e.on("error",i),e.finalize()})}prepareModel(e,r){e.creator=e.creator||"ExcelJS",e.lastModifiedBy=e.lastModifiedBy||"ExcelJS",e.created=e.created||new Date,e.modified=e.modified||new Date,e.useSharedStrings=r.useSharedStrings!==void 0?r.useSharedStrings:!0,e.useStyles=r.useStyles!==void 0?r.useStyles:!0,e.sharedStrings=new r_,e.styles=e.useStyles?new t_(!0):new t_.Mock;let i=new ih,n=new nh;i.prepare(e);let s={sharedStrings:e.sharedStrings,styles:e.styles,date1904:e.properties.date1904,drawingsCount:0,media:e.media};s.drawings=e.drawings=[],s.commentRefs=e.commentRefs=[];let a=0;e.tables=[],e.worksheets.forEach(o=>{o.tables.forEach(u=>{a++,u.target=`table${a}.xml`,u.id=a,e.tables.push(u)}),n.prepare(o,s)})}async write(e,r){r=r||{};let{model:i}=this.workbook,n=new JV.ZipWriter(r.zip);return n.pipe(e),this.prepareModel(i,r),await this.addContentTypes(n,i),await this.addOfficeRels(n,i),await this.addWorkbookRels(n,i),await this.addWorksheets(n,i),await this.addSharedStrings(n,i),await this.addDrawings(n,i),await this.addTables(n,i),await Promise.all([this.addThemes(n,i),this.addStyles(n,i)]),await this.addMedia(n,i),await Promise.all([this.addApp(n,i),this.addCore(n,i)]),await this.addWorkbook(n,i),this._finalize(n)}writeFile(e,r){let i=s_.createWriteStream(e);return new Promise((n,s)=>{i.on("finish",()=>{n()}),i.on("error",a=>{s(a)}),this.write(i,r).then(()=>{i.end()})})}async writeBuffer(e){let r=new e_;return await this.write(r,e),r.read()}};Xt.RelType=Ai();CF.exports=Xt});var l_=y(sh=>{"use strict";Object.defineProperty(sh,"__esModule",{value:!0});sh.FormatterOptions=void 0;var o_=class{constructor(e={}){var r;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,e||{}),typeof e?.quoteHeaders>"u"&&(this.quoteHeaders=this.quoteColumns),e?.quote===!0?this.quote='"':e?.quote===!1&&(this.quote=""),typeof e?.escape!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((r=e.writeHeaders)!==null&&r!==void 0?r:!0),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}};sh.FormatterOptions=o_});var ah=y((hue,OF)=>{var s7="[object AsyncFunction]",a7="[object Function]",o7="[object GeneratorFunction]",l7="[object Null]",u7="[object Proxy]",f7="[object Undefined]",h7=typeof global=="object"&&global&&global.Object===Object&&global,c7=typeof self=="object"&&self&&self.Object===Object&&self,d7=h7||c7||Function("return this")(),kF=Object.prototype,p7=kF.hasOwnProperty,RF=kF.toString,SF=d7.Symbol,Rn=SF?SF.toStringTag:void 0;function g7(t){return t==null?t===void 0?f7:l7:Rn&&Rn in Object(t)?m7(t):v7(t)}function m7(t){var e=p7.call(t,Rn),r=t[Rn];try{t[Rn]=void 0;var i=!0}catch{}var n=RF.call(t);return i&&(e?t[Rn]=r:delete t[Rn]),n}function v7(t){return RF.call(t)}function y7(t){if(!_7(t))return!1;var e=g7(t);return e==a7||e==o7||e==s7||e==u7}function _7(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}OF.exports=y7});var fN=y((ll,na)=>{var w7=200,__="__lodash_hash_undefined__",ph=1,WF=2,$F=9007199254740991,oh="[object Arguments]",c_="[object Array]",b7="[object AsyncFunction]",HF="[object Boolean]",UF="[object Date]",zF="[object Error]",XF="[object Function]",x7="[object GeneratorFunction]",lh="[object Map]",VF="[object Number]",T7="[object Null]",ia="[object Object]",AF="[object Promise]",E7="[object Proxy]",GF="[object RegExp]",uh="[object Set]",ZF="[object String]",C7="[object Symbol]",S7="[object Undefined]",d_="[object WeakMap]",YF="[object ArrayBuffer]",fh="[object DataView]",k7="[object Float32Array]",R7="[object Float64Array]",O7="[object Int8Array]",A7="[object Int16Array]",F7="[object Int32Array]",N7="[object Uint8Array]",D7="[object Uint8ClampedArray]",q7="[object Uint16Array]",I7="[object Uint32Array]",M7=/[\\^$.*+?()[\]{}|]/g,P7=/^\[object .+?Constructor\]$/,L7=/^(?:0|[1-9]\d*)$/,Ae={};Ae[k7]=Ae[R7]=Ae[O7]=Ae[A7]=Ae[F7]=Ae[N7]=Ae[D7]=Ae[q7]=Ae[I7]=!0;Ae[oh]=Ae[c_]=Ae[YF]=Ae[HF]=Ae[fh]=Ae[UF]=Ae[zF]=Ae[XF]=Ae[lh]=Ae[VF]=Ae[ia]=Ae[GF]=Ae[uh]=Ae[ZF]=Ae[d_]=!1;var KF=typeof global=="object"&&global&&global.Object===Object&&global,B7=typeof self=="object"&&self&&self.Object===Object&&self,zr=KF||B7||Function("return this")(),QF=typeof ll=="object"&&ll&&!ll.nodeType&&ll,FF=QF&&typeof na=="object"&&na&&!na.nodeType&&na,JF=FF&&FF.exports===QF,u_=JF&&KF.process,NF=function(){try{return u_&&u_.binding&&u_.binding("util")}catch{}}(),DF=NF&&NF.isTypedArray;function j7(t,e){for(var r=-1,i=t==null?0:t.length,n=0,s=[];++r<i;){var a=t[r];e(a,r,t)&&(s[n++]=a)}return s}function W7(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}function $7(t,e){for(var r=-1,i=t==null?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}function H7(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}function U7(t){return function(e){return t(e)}}function z7(t,e){return t.has(e)}function X7(t,e){return t?.[e]}function V7(t){var e=-1,r=Array(t.size);return t.forEach(function(i,n){r[++e]=[n,i]}),r}function G7(t,e){return function(r){return t(e(r))}}function Z7(t){var e=-1,r=Array(t.size);return t.forEach(function(i){r[++e]=i}),r}var Y7=Array.prototype,K7=Function.prototype,gh=Object.prototype,f_=zr["__core-js_shared__"],eN=K7.toString,wr=gh.hasOwnProperty,qF=function(){var t=/[^.]+$/.exec(f_&&f_.keys&&f_.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),tN=gh.toString,Q7=RegExp("^"+eN.call(wr).replace(M7,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),IF=JF?zr.Buffer:void 0,hh=zr.Symbol,MF=zr.Uint8Array,rN=gh.propertyIsEnumerable,J7=Y7.splice,On=hh?hh.toStringTag:void 0,PF=Object.getOwnPropertySymbols,e9=IF?IF.isBuffer:void 0,t9=G7(Object.keys,Object),p_=sa(zr,"DataView"),ul=sa(zr,"Map"),g_=sa(zr,"Promise"),m_=sa(zr,"Set"),v_=sa(zr,"WeakMap"),fl=sa(Object,"create"),r9=Nn(p_),i9=Nn(ul),n9=Nn(g_),s9=Nn(m_),a9=Nn(v_),LF=hh?hh.prototype:void 0,h_=LF?LF.valueOf:void 0;function An(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function o9(){this.__data__=fl?fl(null):{},this.size=0}function l9(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function u9(t){var e=this.__data__;if(fl){var r=e[t];return r===__?void 0:r}return wr.call(e,t)?e[t]:void 0}function f9(t){var e=this.__data__;return fl?e[t]!==void 0:wr.call(e,t)}function h9(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=fl&&e===void 0?__:e,this}An.prototype.clear=o9;An.prototype.delete=l9;An.prototype.get=u9;An.prototype.has=f9;An.prototype.set=h9;function Xr(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function c9(){this.__data__=[],this.size=0}function d9(t){var e=this.__data__,r=mh(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():J7.call(e,r,1),--this.size,!0}function p9(t){var e=this.__data__,r=mh(e,t);return r<0?void 0:e[r][1]}function g9(t){return mh(this.__data__,t)>-1}function m9(t,e){var r=this.__data__,i=mh(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}Xr.prototype.clear=c9;Xr.prototype.delete=d9;Xr.prototype.get=p9;Xr.prototype.has=g9;Xr.prototype.set=m9;function Fn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function v9(){this.size=0,this.__data__={hash:new An,map:new(ul||Xr),string:new An}}function y9(t){var e=vh(this,t).delete(t);return this.size-=e?1:0,e}function _9(t){return vh(this,t).get(t)}function w9(t){return vh(this,t).has(t)}function b9(t,e){var r=vh(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}Fn.prototype.clear=v9;Fn.prototype.delete=y9;Fn.prototype.get=_9;Fn.prototype.has=w9;Fn.prototype.set=b9;function ch(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Fn;++e<r;)this.add(t[e])}function x9(t){return this.__data__.set(t,__),this}function T9(t){return this.__data__.has(t)}ch.prototype.add=ch.prototype.push=x9;ch.prototype.has=T9;function Di(t){var e=this.__data__=new Xr(t);this.size=e.size}function E9(){this.__data__=new Xr,this.size=0}function C9(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function S9(t){return this.__data__.get(t)}function k9(t){return this.__data__.has(t)}function R9(t,e){var r=this.__data__;if(r instanceof Xr){var i=r.__data__;if(!ul||i.length<w7-1)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new Fn(i)}return r.set(t,e),this.size=r.size,this}Di.prototype.clear=E9;Di.prototype.delete=C9;Di.prototype.get=S9;Di.prototype.has=k9;Di.prototype.set=R9;function O9(t,e){var r=dh(t),i=!r&&U9(t),n=!r&&!i&&y_(t),s=!r&&!i&&!n&&uN(t),a=r||i||n||s,o=a?H7(t.length,String):[],u=o.length;for(var f in t)(e||wr.call(t,f))&&!(a&&(f=="length"||n&&(f=="offset"||f=="parent")||s&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||B9(f,u)))&&o.push(f);return o}function mh(t,e){for(var r=t.length;r--;)if(sN(t[r][0],e))return r;return-1}function A9(t,e,r){var i=e(t);return dh(t)?i:W7(i,r(t))}function cl(t){return t==null?t===void 0?S7:T7:On&&On in Object(t)?P9(t):H9(t)}function BF(t){return hl(t)&&cl(t)==oh}function iN(t,e,r,i,n){return t===e?!0:t==null||e==null||!hl(t)&&!hl(e)?t!==t&&e!==e:F9(t,e,r,i,iN,n)}function F9(t,e,r,i,n,s){var a=dh(t),o=dh(e),u=a?c_:Ni(t),f=o?c_:Ni(e);u=u==oh?ia:u,f=f==oh?ia:f;var h=u==ia,g=f==ia,m=u==f;if(m&&y_(t)){if(!y_(e))return!1;a=!0,h=!1}if(m&&!h)return s||(s=new Di),a||uN(t)?nN(t,e,r,i,n,s):I9(t,e,u,r,i,n,s);if(!(r&ph)){var c=h&&wr.call(t,"__wrapped__"),d=g&&wr.call(e,"__wrapped__");if(c||d){var v=c?t.value():t,w=d?e.value():e;return s||(s=new Di),n(v,w,r,i,s)}}return m?(s||(s=new Di),M9(t,e,r,i,n,s)):!1}function N9(t){if(!lN(t)||W9(t))return!1;var e=aN(t)?Q7:P7;return e.test(Nn(t))}function D9(t){return hl(t)&&oN(t.length)&&!!Ae[cl(t)]}function q9(t){if(!$9(t))return t9(t);var e=[];for(var r in Object(t))wr.call(t,r)&&r!="constructor"&&e.push(r);return e}function nN(t,e,r,i,n,s){var a=r&ph,o=t.length,u=e.length;if(o!=u&&!(a&&u>o))return!1;var f=s.get(t);if(f&&s.get(e))return f==e;var h=-1,g=!0,m=r&WF?new ch:void 0;for(s.set(t,e),s.set(e,t);++h<o;){var c=t[h],d=e[h];if(i)var v=a?i(d,c,h,e,t,s):i(c,d,h,t,e,s);if(v!==void 0){if(v)continue;g=!1;break}if(m){if(!$7(e,function(w,b){if(!z7(m,b)&&(c===w||n(c,w,r,i,s)))return m.push(b)})){g=!1;break}}else if(!(c===d||n(c,d,r,i,s))){g=!1;break}}return s.delete(t),s.delete(e),g}function I9(t,e,r,i,n,s,a){switch(r){case fh:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case YF:return!(t.byteLength!=e.byteLength||!s(new MF(t),new MF(e)));case HF:case UF:case VF:return sN(+t,+e);case zF:return t.name==e.name&&t.message==e.message;case GF:case ZF:return t==e+"";case lh:var o=V7;case uh:var u=i&ph;if(o||(o=Z7),t.size!=e.size&&!u)return!1;var f=a.get(t);if(f)return f==e;i|=WF,a.set(t,e);var h=nN(o(t),o(e),i,n,s,a);return a.delete(t),h;case C7:if(h_)return h_.call(t)==h_.call(e)}return!1}function M9(t,e,r,i,n,s){var a=r&ph,o=jF(t),u=o.length,f=jF(e),h=f.length;if(u!=h&&!a)return!1;for(var g=u;g--;){var m=o[g];if(!(a?m in e:wr.call(e,m)))return!1}var c=s.get(t);if(c&&s.get(e))return c==e;var d=!0;s.set(t,e),s.set(e,t);for(var v=a;++g<u;){m=o[g];var w=t[m],b=e[m];if(i)var C=a?i(b,w,m,e,t,s):i(w,b,m,t,e,s);if(!(C===void 0?w===b||n(w,b,r,i,s):C)){d=!1;break}v||(v=m=="constructor")}if(d&&!v){var O=t.constructor,R=e.constructor;O!=R&&"constructor"in t&&"constructor"in e&&!(typeof O=="function"&&O instanceof O&&typeof R=="function"&&R instanceof R)&&(d=!1)}return s.delete(t),s.delete(e),d}function jF(t){return A9(t,V9,L9)}function vh(t,e){var r=t.__data__;return j9(e)?r[typeof e=="string"?"string":"hash"]:r.map}function sa(t,e){var r=X7(t,e);return N9(r)?r:void 0}function P9(t){var e=wr.call(t,On),r=t[On];try{t[On]=void 0;var i=!0}catch{}var n=tN.call(t);return i&&(e?t[On]=r:delete t[On]),n}var L9=PF?function(t){return t==null?[]:(t=Object(t),j7(PF(t),function(e){return rN.call(t,e)}))}:G9,Ni=cl;(p_&&Ni(new p_(new ArrayBuffer(1)))!=fh||ul&&Ni(new ul)!=lh||g_&&Ni(g_.resolve())!=AF||m_&&Ni(new m_)!=uh||v_&&Ni(new v_)!=d_)&&(Ni=function(t){var e=cl(t),r=e==ia?t.constructor:void 0,i=r?Nn(r):"";if(i)switch(i){case r9:return fh;case i9:return lh;case n9:return AF;case s9:return uh;case a9:return d_}return e});function B9(t,e){return e=e??$F,!!e&&(typeof t=="number"||L7.test(t))&&t>-1&&t%1==0&&t<e}function j9(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function W9(t){return!!qF&&qF in t}function $9(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||gh;return t===r}function H9(t){return tN.call(t)}function Nn(t){if(t!=null){try{return eN.call(t)}catch{}try{return t+""}catch{}}return""}function sN(t,e){return t===e||t!==t&&e!==e}var U9=BF(function(){return arguments}())?BF:function(t){return hl(t)&&wr.call(t,"callee")&&!rN.call(t,"callee")},dh=Array.isArray;function z9(t){return t!=null&&oN(t.length)&&!aN(t)}var y_=e9||Z9;function X9(t,e){return iN(t,e)}function aN(t){if(!lN(t))return!1;var e=cl(t);return e==XF||e==x7||e==b7||e==E7}function oN(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=$F}function lN(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function hl(t){return t!=null&&typeof t=="object"}var uN=DF?U7(DF):D9;function V9(t){return z9(t)?O9(t):q9(t)}function G9(){return[]}function Z9(){return!1}na.exports=X9});var cN=y((cue,hN)=>{var Y9="[object Boolean]",K9=Object.prototype,Q9=K9.toString;function J9(t){return t===!0||t===!1||eG(t)&&Q9.call(t)==Y9}function eG(t){return!!t&&typeof t=="object"}hN.exports=J9});var w_=y((due,dN)=>{function tG(t){return t==null}dN.exports=tG});var b_=y((pue,yN)=>{var rG=1/0,iG="[object Symbol]",vN=/[\\^$.*+?()[\]{}|]/g,nG=RegExp(vN.source),sG=typeof global=="object"&&global&&global.Object===Object&&global,aG=typeof self=="object"&&self&&self.Object===Object&&self,oG=sG||aG||Function("return this")(),lG=Object.prototype,uG=lG.toString,pN=oG.Symbol,gN=pN?pN.prototype:void 0,mN=gN?gN.toString:void 0;function fG(t){if(typeof t=="string")return t;if(cG(t))return mN?mN.call(t):"";var e=t+"";return e=="0"&&1/t==-rG?"-0":e}function hG(t){return!!t&&typeof t=="object"}function cG(t){return typeof t=="symbol"||hG(t)&&uG.call(t)==iG}function dG(t){return t==null?"":fG(t)}function pG(t){return t=dG(t),t&&nG.test(t)?t.replace(vN,"\\$&"):t}yN.exports=pG});var E_=y(aa=>{"use strict";var T_=aa&&aa.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(aa,"__esModule",{value:!0});aa.FieldFormatter=void 0;var gG=T_(cN()),mG=T_(w_()),vG=T_(b_()),x_=class{constructor(e){this._headers=null,this.formatterOptions=e,e.headers!==null&&(this.headers=e.headers),this.REPLACE_REGEXP=new RegExp(e.quote,"g");let r=`[${e.delimiter}${vG.default(e.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(r)}set headers(e){this._headers=e}shouldQuote(e,r){let i=r?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return gG.default(i)?i:Array.isArray(i)?i[e]:this._headers!==null?i[this._headers[e]]:!1}format(e,r,i){let n=`${mG.default(e)?"":e}`.replace(/\0/g,""),{formatterOptions:s}=this;return s.quote!==""&&n.indexOf(s.quote)!==-1?this.quoteField(n.replace(this.REPLACE_REGEXP,s.escapedQuote)):n.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(r,i)?this.quoteField(n):n}quoteField(e){let{quote:r}=this.formatterOptions;return`${r}${e}${r}`}};aa.FieldFormatter=x_});var C_=y(yh=>{"use strict";Object.defineProperty(yh,"__esModule",{value:!0});yh.isSyncTransform=void 0;yh.isSyncTransform=t=>t.length===1});var wN=y(oa=>{"use strict";var _N=oa&&oa.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(oa,"__esModule",{value:!0});oa.RowFormatter=void 0;var yG=_N(ah()),_G=_N(fN()),wG=E_(),bG=C_(),Vr=class{constructor(e){this.rowCount=0,this.formatterOptions=e,this.fieldFormatter=new wG.FieldFormatter(e),this.headers=e.headers,this.shouldWriteHeaders=e.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),e.transform&&(this.rowTransform=e.transform)}static isRowHashArray(e){return Array.isArray(e)?Array.isArray(e[0])&&e[0].length===2:!1}static isRowArray(e){return Array.isArray(e)&&!this.isRowHashArray(e)}static gatherHeaders(e){return Vr.isRowHashArray(e)?e.map(r=>r[0]):Array.isArray(e)?e:Object.keys(e)}static createTransform(e){return bG.isSyncTransform(e)?(r,i)=>{let n=null;try{n=e(r)}catch(s){return i(s)}return i(null,n)}:(r,i)=>{e(r,i)}}set rowTransform(e){if(!yG.default(e))throw new TypeError("The transform should be a function");this._rowTransform=Vr.createTransform(e)}format(e,r){this.callTransformer(e,(i,n)=>{if(i)return r(i);if(!e)return r(null);let s=[];if(n){let{shouldFormatColumns:a,headers:o}=this.checkHeaders(n);if(this.shouldWriteHeaders&&o&&!this.hasWrittenHeaders&&(s.push(this.formatColumns(o,!0)),this.hasWrittenHeaders=!0),a){let u=this.gatherColumns(n);s.push(this.formatColumns(u,!1))}}return r(null,s)})}finish(e){let r=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return e(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));r.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&r.push(this.formatterOptions.rowDelimiter),e(null,r)}checkHeaders(e){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};let r=Vr.gatherHeaders(e);return this.headers=r,this.fieldFormatter.headers=r,this.shouldWriteHeaders?{shouldFormatColumns:!_G.default(r,e),headers:r}:{shouldFormatColumns:!0,headers:null}}gatherColumns(e){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(e)?Vr.isRowHashArray(e)?this.headers.map((r,i)=>{let n=e[i];return n?n[1]:""}):Vr.isRowArray(e)&&!this.shouldWriteHeaders?e:this.headers.map((r,i)=>e[i]):this.headers.map(r=>e[r])}callTransformer(e,r){return this._rowTransform?this._rowTransform(e,r):r(null,e)}formatColumns(e,r){let i=e.map((s,a)=>this.fieldFormatter.format(s,a,r)).join(this.formatterOptions.delimiter),{rowCount:n}=this;return this.rowCount+=1,n?[this.formatterOptions.rowDelimiter,i].join(""):i}};oa.RowFormatter=Vr});var bN=y(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.FieldFormatter=la.RowFormatter=void 0;var xG=wN();Object.defineProperty(la,"RowFormatter",{enumerable:!0,get:function(){return xG.RowFormatter}});var TG=E_();Object.defineProperty(la,"FieldFormatter",{enumerable:!0,get:function(){return TG.FieldFormatter}})});var k_=y(_h=>{"use strict";Object.defineProperty(_h,"__esModule",{value:!0});_h.CsvFormatterStream=void 0;var EG=require("stream"),CG=bN(),S_=class extends EG.Transform{constructor(e){super({writableObjectMode:e.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=e,this.rowFormatter=new CG.RowFormatter(e),this.hasWrittenBOM=!e.writeBOM}transform(e){return this.rowFormatter.rowTransform=e,this}_transform(e,r,i){let n=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(e,(s,a)=>s?(n=!0,i(s)):(a&&a.forEach(o=>{this.push(Buffer.from(o,"utf8"))}),n=!0,i()))}catch(s){if(n)throw s;i(s)}}_flush(e){this.rowFormatter.finish((r,i)=>r?e(r):(i&&i.forEach(n=>{this.push(Buffer.from(n,"utf8"))}),e()))}};_h.CsvFormatterStream=S_});var TN=y(pe=>{"use strict";var xN=pe&&pe.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),SG=pe&&pe.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kG=pe&&pe.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&xN(e,t,r);return SG(e,t),e},RG=pe&&pe.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&xN(e,t,r)};Object.defineProperty(pe,"__esModule",{value:!0});pe.writeToPath=pe.writeToString=pe.writeToBuffer=pe.writeToStream=pe.write=pe.format=pe.FormatterOptions=pe.CsvFormatterStream=void 0;var OG=require("util"),AG=require("stream"),FG=kG(require("fs")),NG=l_(),DG=k_();RG(C_(),pe);var qG=k_();Object.defineProperty(pe,"CsvFormatterStream",{enumerable:!0,get:function(){return qG.CsvFormatterStream}});var IG=l_();Object.defineProperty(pe,"FormatterOptions",{enumerable:!0,get:function(){return IG.FormatterOptions}});pe.format=t=>new DG.CsvFormatterStream(new NG.FormatterOptions(t));pe.write=(t,e)=>{let r=pe.format(e),i=OG.promisify((n,s)=>{r.write(n,void 0,s)});return t.reduce((n,s)=>n.then(()=>i(s)),Promise.resolve()).then(()=>r.end()).catch(n=>{r.emit("error",n)}),r};pe.writeToStream=(t,e,r)=>pe.write(e,r).pipe(t);pe.writeToBuffer=(t,e={})=>{let r=[],i=new AG.Writable({write(n,s,a){r.push(n),a()}});return new Promise((n,s)=>{i.on("error",s).on("finish",()=>n(Buffer.concat(r))),pe.write(t,e).pipe(i)})};pe.writeToString=(t,e)=>pe.writeToBuffer(t,e).then(r=>r.toString());pe.writeToPath=(t,e,r)=>{let i=FG.createWriteStream(t,{encoding:"utf8"});return pe.write(e,r).pipe(i)}});var O_=y(ua=>{"use strict";var EN=ua&&ua.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ua,"__esModule",{value:!0});ua.ParserOptions=void 0;var MG=EN(b_()),PG=EN(w_()),R_=class{constructor(e){var r;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,e||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=MG.default(this.delimiter),this.escapeChar=(r=this.escape)!==null&&r!==void 0?r:this.quote,this.supportsComments=!PG.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}};ua.ParserOptions=R_});var A_=y(fa=>{"use strict";Object.defineProperty(fa,"__esModule",{value:!0});fa.isSyncValidate=fa.isSyncTransform=void 0;fa.isSyncTransform=t=>t.length===1;fa.isSyncValidate=t=>t.length===1});var kN=y(ca=>{"use strict";var LG=ca&&ca.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ca,"__esModule",{value:!0});ca.RowTransformerValidator=void 0;var CN=LG(ah()),SN=A_(),ha=class{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(e){return SN.isSyncTransform(e)?(r,i)=>{let n=null;try{n=e(r)}catch(s){return i(s)}return i(null,n)}:e}static createValidator(e){return SN.isSyncValidate(e)?(r,i)=>{i(null,{row:r,isValid:e(r)})}:(r,i)=>{e(r,(n,s,a)=>n?i(n):s?i(null,{row:r,isValid:s,reason:a}):i(null,{row:r,isValid:!1,reason:a}))}}set rowTransform(e){if(!CN.default(e))throw new TypeError("The transform should be a function");this._rowTransform=ha.createTransform(e)}set rowValidator(e){if(!CN.default(e))throw new TypeError("The validate should be a function");this._rowValidator=ha.createValidator(e)}transformAndValidate(e,r){return this.callTransformer(e,(i,n)=>i?r(i):n?this.callValidator(n,(s,a)=>s?r(s):a&&!a.isValid?r(null,{row:n,isValid:!1,reason:a.reason}):r(null,{row:n,isValid:!0})):r(null,{row:null,isValid:!0}))}callTransformer(e,r){return this._rowTransform?this._rowTransform(e,r):r(null,e)}callValidator(e,r){return this._rowValidator?this._rowValidator(e,r):r(null,{row:e,isValid:!0})}};ca.RowTransformerValidator=ha});var ON=y((Eue,RN)=>{function BG(t){return t===void 0}RN.exports=BG});var MN=y((Cue,IN)=>{var jG=200,D_="__lodash_hash_undefined__",WG=1/0,$G="[object Function]",HG="[object GeneratorFunction]",UG=/[\\^$.*+?()[\]{}|]/g,zG=/^\[object .+?Constructor\]$/,XG=typeof global=="object"&&global&&global.Object===Object&&global,VG=typeof self=="object"&&self&&self.Object===Object&&self,q_=XG||VG||Function("return this")();function GG(t,e){var r=t?t.length:0;return!!r&&KG(t,e,0)>-1}function ZG(t,e,r){for(var i=-1,n=t?t.length:0;++i<n;)if(r(e,t[i]))return!0;return!1}function YG(t,e,r,i){for(var n=t.length,s=r+(i?1:-1);i?s--:++s<n;)if(e(t[s],s,t))return s;return-1}function KG(t,e,r){if(e!==e)return YG(t,QG,r);for(var i=r-1,n=t.length;++i<n;)if(t[i]===e)return i;return-1}function QG(t){return t!==t}function JG(t,e){return t.has(e)}function eZ(t,e){return t?.[e]}function tZ(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function FN(t){var e=-1,r=Array(t.size);return t.forEach(function(i){r[++e]=i}),r}var rZ=Array.prototype,iZ=Function.prototype,NN=Object.prototype,F_=q_["__core-js_shared__"],AN=function(){var t=/[^.]+$/.exec(F_&&F_.keys&&F_.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),DN=iZ.toString,I_=NN.hasOwnProperty,nZ=NN.toString,sZ=RegExp("^"+DN.call(I_).replace(UG,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),aZ=rZ.splice,oZ=M_(q_,"Map"),N_=M_(q_,"Set"),dl=M_(Object,"create");function Dn(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function lZ(){this.__data__=dl?dl(null):{}}function uZ(t){return this.has(t)&&delete this.__data__[t]}function fZ(t){var e=this.__data__;if(dl){var r=e[t];return r===D_?void 0:r}return I_.call(e,t)?e[t]:void 0}function hZ(t){var e=this.__data__;return dl?e[t]!==void 0:I_.call(e,t)}function cZ(t,e){var r=this.__data__;return r[t]=dl&&e===void 0?D_:e,this}Dn.prototype.clear=lZ;Dn.prototype.delete=uZ;Dn.prototype.get=fZ;Dn.prototype.has=hZ;Dn.prototype.set=cZ;function da(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function dZ(){this.__data__=[]}function pZ(t){var e=this.__data__,r=bh(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():aZ.call(e,r,1),!0}function gZ(t){var e=this.__data__,r=bh(e,t);return r<0?void 0:e[r][1]}function mZ(t){return bh(this.__data__,t)>-1}function vZ(t,e){var r=this.__data__,i=bh(r,t);return i<0?r.push([t,e]):r[i][1]=e,this}da.prototype.clear=dZ;da.prototype.delete=pZ;da.prototype.get=gZ;da.prototype.has=mZ;da.prototype.set=vZ;function pa(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function yZ(){this.__data__={hash:new Dn,map:new(oZ||da),string:new Dn}}function _Z(t){return xh(this,t).delete(t)}function wZ(t){return xh(this,t).get(t)}function bZ(t){return xh(this,t).has(t)}function xZ(t,e){return xh(this,t).set(t,e),this}pa.prototype.clear=yZ;pa.prototype.delete=_Z;pa.prototype.get=wZ;pa.prototype.has=bZ;pa.prototype.set=xZ;function wh(t){var e=-1,r=t?t.length:0;for(this.__data__=new pa;++e<r;)this.add(t[e])}function TZ(t){return this.__data__.set(t,D_),this}function EZ(t){return this.__data__.has(t)}wh.prototype.add=wh.prototype.push=TZ;wh.prototype.has=EZ;function bh(t,e){for(var r=t.length;r--;)if(NZ(t[r][0],e))return r;return-1}function CZ(t){if(!qN(t)||OZ(t))return!1;var e=DZ(t)||tZ(t)?sZ:zG;return e.test(AZ(t))}function SZ(t,e,r){var i=-1,n=GG,s=t.length,a=!0,o=[],u=o;if(r)a=!1,n=ZG;else if(s>=jG){var f=e?null:kZ(t);if(f)return FN(f);a=!1,n=JG,u=new wh}else u=e?[]:o;e:for(;++i<s;){var h=t[i],g=e?e(h):h;if(h=r||h!==0?h:0,a&&g===g){for(var m=u.length;m--;)if(u[m]===g)continue e;e&&u.push(g),o.push(h)}else n(u,g,r)||(u!==o&&u.push(g),o.push(h))}return o}var kZ=N_&&1/FN(new N_([,-0]))[1]==WG?function(t){return new N_(t)}:qZ;function xh(t,e){var r=t.__data__;return RZ(e)?r[typeof e=="string"?"string":"hash"]:r.map}function M_(t,e){var r=eZ(t,e);return CZ(r)?r:void 0}function RZ(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function OZ(t){return!!AN&&AN in t}function AZ(t){if(t!=null){try{return DN.call(t)}catch{}try{return t+""}catch{}}return""}function FZ(t){return t&&t.length?SZ(t):[]}function NZ(t,e){return t===e||t!==t&&e!==e}function DZ(t){var e=qN(t)?nZ.call(t):"";return e==$G||e==HG}function qN(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function qZ(){}IN.exports=FZ});var gD=y((pl,ma)=>{var IZ=200,MZ="Expected a function",X_="__lodash_hash_undefined__",Ah=1,va=2,XN=1/0,VN=9007199254740991,Th="[object Arguments]",B_="[object Array]",GN="[object Boolean]",ZN="[object Date]",YN="[object Error]",KN="[object Function]",PZ="[object GeneratorFunction]",Eh="[object Map]",QN="[object Number]",ga="[object Object]",PN="[object Promise]",JN="[object RegExp]",Ch="[object Set]",eD="[object String]",tD="[object Symbol]",j_="[object WeakMap]",rD="[object ArrayBuffer]",Sh="[object DataView]",LZ="[object Float32Array]",BZ="[object Float64Array]",jZ="[object Int8Array]",WZ="[object Int16Array]",$Z="[object Int32Array]",HZ="[object Uint8Array]",UZ="[object Uint8ClampedArray]",zZ="[object Uint16Array]",XZ="[object Uint32Array]",VZ=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,GZ=/^\w*$/,ZZ=/^\./,YZ=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,KZ=/[\\^$.*+?()[\]{}|]/g,QZ=/\\(\\)?/g,JZ=/^\[object .+?Constructor\]$/,eY=/^(?:0|[1-9]\d*)$/,Fe={};Fe[LZ]=Fe[BZ]=Fe[jZ]=Fe[WZ]=Fe[$Z]=Fe[HZ]=Fe[UZ]=Fe[zZ]=Fe[XZ]=!0;Fe[Th]=Fe[B_]=Fe[rD]=Fe[GN]=Fe[Sh]=Fe[ZN]=Fe[YN]=Fe[KN]=Fe[Eh]=Fe[QN]=Fe[ga]=Fe[JN]=Fe[Ch]=Fe[eD]=Fe[j_]=!1;var iD=typeof global=="object"&&global&&global.Object===Object&&global,tY=typeof self=="object"&&self&&self.Object===Object&&self,Mi=iD||tY||Function("return this")(),nD=typeof pl=="object"&&pl&&!pl.nodeType&&pl,LN=nD&&typeof ma=="object"&&ma&&!ma.nodeType&&ma,rY=LN&&LN.exports===nD,BN=rY&&iD.process,jN=function(){try{return BN&&BN.binding("util")}catch{}}(),WN=jN&&jN.isTypedArray;function iY(t,e,r,i){for(var n=-1,s=t?t.length:0;++n<s;){var a=t[n];e(i,a,r(a),t)}return i}function nY(t,e){for(var r=-1,i=t?t.length:0;++r<i;)if(e(t[r],r,t))return!0;return!1}function sY(t){return function(e){return e?.[t]}}function aY(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}function oY(t){return function(e){return t(e)}}function lY(t,e){return t?.[e]}function W_(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function uY(t){var e=-1,r=Array(t.size);return t.forEach(function(i,n){r[++e]=[n,i]}),r}function fY(t,e){return function(r){return t(e(r))}}function hY(t){var e=-1,r=Array(t.size);return t.forEach(function(i){r[++e]=i}),r}var cY=Array.prototype,dY=Function.prototype,Fh=Object.prototype,P_=Mi["__core-js_shared__"],$N=function(){var t=/[^.]+$/.exec(P_&&P_.keys&&P_.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),sD=dY.toString,br=Fh.hasOwnProperty,ya=Fh.toString,pY=RegExp("^"+sD.call(br).replace(KZ,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),HN=Mi.Symbol,UN=Mi.Uint8Array,gY=Fh.propertyIsEnumerable,mY=cY.splice,vY=fY(Object.keys,Object),$_=_a(Mi,"DataView"),gl=_a(Mi,"Map"),H_=_a(Mi,"Promise"),U_=_a(Mi,"Set"),z_=_a(Mi,"WeakMap"),ml=_a(Object,"create"),yY=In($_),_Y=In(gl),wY=In(H_),bY=In(U_),xY=In(z_),kh=HN?HN.prototype:void 0,L_=kh?kh.valueOf:void 0,zN=kh?kh.toString:void 0;function qn(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function TY(){this.__data__=ml?ml(null):{}}function EY(t){return this.has(t)&&delete this.__data__[t]}function CY(t){var e=this.__data__;if(ml){var r=e[t];return r===X_?void 0:r}return br.call(e,t)?e[t]:void 0}function SY(t){var e=this.__data__;return ml?e[t]!==void 0:br.call(e,t)}function kY(t,e){var r=this.__data__;return r[t]=ml&&e===void 0?X_:e,this}qn.prototype.clear=TY;qn.prototype.delete=EY;qn.prototype.get=CY;qn.prototype.has=SY;qn.prototype.set=kY;function Zr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function RY(){this.__data__=[]}function OY(t){var e=this.__data__,r=Nh(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():mY.call(e,r,1),!0}function AY(t){var e=this.__data__,r=Nh(e,t);return r<0?void 0:e[r][1]}function FY(t){return Nh(this.__data__,t)>-1}function NY(t,e){var r=this.__data__,i=Nh(r,t);return i<0?r.push([t,e]):r[i][1]=e,this}Zr.prototype.clear=RY;Zr.prototype.delete=OY;Zr.prototype.get=AY;Zr.prototype.has=FY;Zr.prototype.set=NY;function Yr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function DY(){this.__data__={hash:new qn,map:new(gl||Zr),string:new qn}}function qY(t){return Dh(this,t).delete(t)}function IY(t){return Dh(this,t).get(t)}function MY(t){return Dh(this,t).has(t)}function PY(t,e){return Dh(this,t).set(t,e),this}Yr.prototype.clear=DY;Yr.prototype.delete=qY;Yr.prototype.get=IY;Yr.prototype.has=MY;Yr.prototype.set=PY;function Rh(t){var e=-1,r=t?t.length:0;for(this.__data__=new Yr;++e<r;)this.add(t[e])}function LY(t){return this.__data__.set(t,X_),this}function BY(t){return this.__data__.has(t)}Rh.prototype.add=Rh.prototype.push=LY;Rh.prototype.has=BY;function Gr(t){this.__data__=new Zr(t)}function jY(){this.__data__=new Zr}function WY(t){return this.__data__.delete(t)}function $Y(t){return this.__data__.get(t)}function HY(t){return this.__data__.has(t)}function UY(t,e){var r=this.__data__;if(r instanceof Zr){var i=r.__data__;if(!gl||i.length<IZ-1)return i.push([t,e]),this;r=this.__data__=new Yr(i)}return r.set(t,e),this}Gr.prototype.clear=jY;Gr.prototype.delete=WY;Gr.prototype.get=$Y;Gr.prototype.has=HY;Gr.prototype.set=UY;function zY(t,e){var r=Ii(t)||dD(t)?aY(t.length,String):[],i=r.length,n=!!i;for(var s in t)(e||br.call(t,s))&&!(n&&(s=="length"||uD(s,i)))&&r.push(s);return r}function Nh(t,e){for(var r=t.length;r--;)if(cD(t[r][0],e))return r;return-1}function XY(t,e,r,i){return VY(t,function(n,s,a){e(i,n,r(n),a)}),i}var VY=uK(ZY),GY=fK();function ZY(t,e){return t&&GY(t,e,Oh)}function aD(t,e){e=qh(e,t)?[e]:oD(e);for(var r=0,i=e.length;t!=null&&r<i;)t=t[Ih(e[r++])];return r&&r==i?t:void 0}function YY(t){return ya.call(t)}function KY(t,e){return t!=null&&e in Object(t)}function V_(t,e,r,i,n){return t===e?!0:t==null||e==null||!Mh(t)&&!Ph(e)?t!==t&&e!==e:QY(t,e,V_,r,i,n)}function QY(t,e,r,i,n,s){var a=Ii(t),o=Ii(e),u=B_,f=B_;a||(u=qi(t),u=u==Th?ga:u),o||(f=qi(e),f=f==Th?ga:f);var h=u==ga&&!W_(t),g=f==ga&&!W_(e),m=u==f;if(m&&!h)return s||(s=new Gr),a||bK(t)?lD(t,e,r,i,n,s):hK(t,e,u,r,i,n,s);if(!(n&va)){var c=h&&br.call(t,"__wrapped__"),d=g&&br.call(e,"__wrapped__");if(c||d){var v=c?t.value():t,w=d?e.value():e;return s||(s=new Gr),r(v,w,i,n,s)}}return m?(s||(s=new Gr),cK(t,e,r,i,n,s)):!1}function JY(t,e,r,i){var n=r.length,s=n,a=!i;if(t==null)return!s;for(t=Object(t);n--;){var o=r[n];if(a&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++n<s;){o=r[n];var u=o[0],f=t[u],h=o[1];if(a&&o[2]){if(f===void 0&&!(u in t))return!1}else{var g=new Gr;if(i)var m=i(f,h,u,t,e,g);if(!(m===void 0?V_(h,f,i,Ah|va,g):m))return!1}}return!0}function eK(t){if(!Mh(t)||mK(t))return!1;var e=pD(t)||W_(t)?pY:JZ;return e.test(In(t))}function tK(t){return Ph(t)&&Y_(t.length)&&!!Fe[ya.call(t)]}function rK(t){return typeof t=="function"?t:t==null?CK:typeof t=="object"?Ii(t)?sK(t[0],t[1]):nK(t):SK(t)}function iK(t){if(!vK(t))return vY(t);var e=[];for(var r in Object(t))br.call(t,r)&&r!="constructor"&&e.push(r);return e}function nK(t){var e=dK(t);return e.length==1&&e[0][2]?hD(e[0][0],e[0][1]):function(r){return r===t||JY(r,t,e)}}function sK(t,e){return qh(t)&&fD(e)?hD(Ih(t),e):function(r){var i=TK(r,t);return i===void 0&&i===e?EK(r,t):V_(e,i,void 0,Ah|va)}}function aK(t){return function(e){return aD(e,t)}}function oK(t){if(typeof t=="string")return t;if(K_(t))return zN?zN.call(t):"";var e=t+"";return e=="0"&&1/t==-XN?"-0":e}function oD(t){return Ii(t)?t:yK(t)}function lK(t,e){return function(r,i){var n=Ii(r)?iY:XY,s=e?e():{};return n(r,t,rK(i,2),s)}}function uK(t,e){return function(r,i){if(r==null)return r;if(!Z_(r))return t(r,i);for(var n=r.length,s=e?n:-1,a=Object(r);(e?s--:++s<n)&&i(a[s],s,a)!==!1;);return r}}function fK(t){return function(e,r,i){for(var n=-1,s=Object(e),a=i(e),o=a.length;o--;){var u=a[t?o:++n];if(r(s[u],u,s)===!1)break}return e}}function lD(t,e,r,i,n,s){var a=n&va,o=t.length,u=e.length;if(o!=u&&!(a&&u>o))return!1;var f=s.get(t);if(f&&s.get(e))return f==e;var h=-1,g=!0,m=n&Ah?new Rh:void 0;for(s.set(t,e),s.set(e,t);++h<o;){var c=t[h],d=e[h];if(i)var v=a?i(d,c,h,e,t,s):i(c,d,h,t,e,s);if(v!==void 0){if(v)continue;g=!1;break}if(m){if(!nY(e,function(w,b){if(!m.has(b)&&(c===w||r(c,w,i,n,s)))return m.add(b)})){g=!1;break}}else if(!(c===d||r(c,d,i,n,s))){g=!1;break}}return s.delete(t),s.delete(e),g}function hK(t,e,r,i,n,s,a){switch(r){case Sh:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case rD:return!(t.byteLength!=e.byteLength||!i(new UN(t),new UN(e)));case GN:case ZN:case QN:return cD(+t,+e);case YN:return t.name==e.name&&t.message==e.message;case JN:case eD:return t==e+"";case Eh:var o=uY;case Ch:var u=s&va;if(o||(o=hY),t.size!=e.size&&!u)return!1;var f=a.get(t);if(f)return f==e;s|=Ah,a.set(t,e);var h=lD(o(t),o(e),i,n,s,a);return a.delete(t),h;case tD:if(L_)return L_.call(t)==L_.call(e)}return!1}function cK(t,e,r,i,n,s){var a=n&va,o=Oh(t),u=o.length,f=Oh(e),h=f.length;if(u!=h&&!a)return!1;for(var g=u;g--;){var m=o[g];if(!(a?m in e:br.call(e,m)))return!1}var c=s.get(t);if(c&&s.get(e))return c==e;var d=!0;s.set(t,e),s.set(e,t);for(var v=a;++g<u;){m=o[g];var w=t[m],b=e[m];if(i)var C=a?i(b,w,m,e,t,s):i(w,b,m,t,e,s);if(!(C===void 0?w===b||r(w,b,i,n,s):C)){d=!1;break}v||(v=m=="constructor")}if(d&&!v){var O=t.constructor,R=e.constructor;O!=R&&"constructor"in t&&"constructor"in e&&!(typeof O=="function"&&O instanceof O&&typeof R=="function"&&R instanceof R)&&(d=!1)}return s.delete(t),s.delete(e),d}function Dh(t,e){var r=t.__data__;return gK(e)?r[typeof e=="string"?"string":"hash"]:r.map}function dK(t){for(var e=Oh(t),r=e.length;r--;){var i=e[r],n=t[i];e[r]=[i,n,fD(n)]}return e}function _a(t,e){var r=lY(t,e);return eK(r)?r:void 0}var qi=YY;($_&&qi(new $_(new ArrayBuffer(1)))!=Sh||gl&&qi(new gl)!=Eh||H_&&qi(H_.resolve())!=PN||U_&&qi(new U_)!=Ch||z_&&qi(new z_)!=j_)&&(qi=function(t){var e=ya.call(t),r=e==ga?t.constructor:void 0,i=r?In(r):void 0;if(i)switch(i){case yY:return Sh;case _Y:return Eh;case wY:return PN;case bY:return Ch;case xY:return j_}return e});function pK(t,e,r){e=qh(e,t)?[e]:oD(e);for(var i,n=-1,a=e.length;++n<a;){var s=Ih(e[n]);if(!(i=t!=null&&r(t,s)))break;t=t[s]}if(i)return i;var a=t?t.length:0;return!!a&&Y_(a)&&uD(s,a)&&(Ii(t)||dD(t))}function uD(t,e){return e=e??VN,!!e&&(typeof t=="number"||eY.test(t))&&t>-1&&t%1==0&&t<e}function qh(t,e){if(Ii(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||K_(t)?!0:GZ.test(t)||!VZ.test(t)||e!=null&&t in Object(e)}function gK(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function mK(t){return!!$N&&$N in t}function vK(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Fh;return t===r}function fD(t){return t===t&&!Mh(t)}function hD(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var yK=G_(function(t){t=xK(t);var e=[];return ZZ.test(t)&&e.push(""),t.replace(YZ,function(r,i,n,s){e.push(n?s.replace(QZ,"$1"):i||r)}),e});function Ih(t){if(typeof t=="string"||K_(t))return t;var e=t+"";return e=="0"&&1/t==-XN?"-0":e}function In(t){if(t!=null){try{return sD.call(t)}catch{}try{return t+""}catch{}}return""}var _K=lK(function(t,e,r){br.call(t,r)?t[r].push(e):t[r]=[e]});function G_(t,e){if(typeof t!="function"||e&&typeof e!="function")throw new TypeError(MZ);var r=function(){var i=arguments,n=e?e.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var a=t.apply(this,i);return r.cache=s.set(n,a),a};return r.cache=new(G_.Cache||Yr),r}G_.Cache=Yr;function cD(t,e){return t===e||t!==t&&e!==e}function dD(t){return wK(t)&&br.call(t,"callee")&&(!gY.call(t,"callee")||ya.call(t)==Th)}var Ii=Array.isArray;function Z_(t){return t!=null&&Y_(t.length)&&!pD(t)}function wK(t){return Ph(t)&&Z_(t)}function pD(t){var e=Mh(t)?ya.call(t):"";return e==KN||e==PZ}function Y_(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=VN}function Mh(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Ph(t){return!!t&&typeof t=="object"}function K_(t){return typeof t=="symbol"||Ph(t)&&ya.call(t)==tD}var bK=WN?oY(WN):tK;function xK(t){return t==null?"":oK(t)}function TK(t,e,r){var i=t==null?void 0:aD(t,e);return i===void 0?r:i}function EK(t,e){return t!=null&&pK(t,e,KY)}function Oh(t){return Z_(t)?zY(t):iK(t)}function CK(t){return t}function SK(t){return qh(t)?sY(Ih(t)):aK(t)}ma.exports=_K});var vD=y(wa=>{"use strict";var Lh=wa&&wa.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(wa,"__esModule",{value:!0});wa.HeaderTransformer=void 0;var mD=Lh(ON()),kK=Lh(ah()),RK=Lh(MN()),OK=Lh(gD()),Q_=class{constructor(e){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=e,e.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(e.headers)?this.setHeaders(e.headers):kK.default(e.headers)&&(this.headersTransform=e.headers)}transform(e,r){return this.shouldMapRow(e)?r(null,this.processRow(e)):r(null,{row:null,isValid:!0})}shouldMapRow(e){let{parserOptions:r}=this;if(!this.headersTransform&&r.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(e)){if(this.headersTransform)this.setHeaders(this.headersTransform(e));else if(this.shouldUseFirstRow)this.setHeaders(e);else return!0;return!1}return!0}processRow(e){if(!this.headers)return{row:e,isValid:!0};let{parserOptions:r}=this;if(!r.discardUnmappedColumns&&e.length>this.headersLength){if(!r.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${e.length}`);return{row:e,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${e.length}`}}return r.strictColumnHandling&&e.length<this.headersLength?{row:e,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${e.length}`}:{row:this.mapHeaders(e),isValid:!0}}mapHeaders(e){let r={},{headers:i,headersLength:n}=this;for(let s=0;s<n;s+=1){let a=i[s];if(!mD.default(a)){let o=e[s];mD.default(o)?r[a]="":r[a]=o}}return r}setHeaders(e){var r;let i=e.filter(n=>!!n);if(RK.default(i).length!==i.length){let n=OK.default(i),s=Object.keys(n).filter(a=>n[a].length>1);throw new Error(`Duplicate headers found ${JSON.stringify(s)}`)}this.headers=e,this.receivedHeaders=!0,this.headersLength=((r=this.headers)===null||r===void 0?void 0:r.length)||0}};wa.HeaderTransformer=Q_});var yD=y(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.HeaderTransformer=ba.RowTransformerValidator=void 0;var AK=kN();Object.defineProperty(ba,"RowTransformerValidator",{enumerable:!0,get:function(){return AK.RowTransformerValidator}});var FK=vD();Object.defineProperty(ba,"HeaderTransformer",{enumerable:!0,get:function(){return FK.HeaderTransformer}})});var Pi=y(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});Bh.Token=void 0;var J_=class{constructor(e){this.token=e.token,this.startCursor=e.startCursor,this.endCursor=e.endCursor}static isTokenRowDelimiter(e){let r=e.token;return r==="\r"||r===`
`||r===`\r
`}static isTokenCarriageReturn(e,r){return e.token===r.carriageReturn}static isTokenComment(e,r){return r.supportsComments&&!!e&&e.token===r.comment}static isTokenEscapeCharacter(e,r){return e.token===r.escapeChar}static isTokenQuote(e,r){return e.token===r.quote}static isTokenDelimiter(e,r){return e.token===r.delimiter}};Bh.Token=J_});var tw=y(jh=>{"use strict";Object.defineProperty(jh,"__esModule",{value:!0});jh.Scanner=void 0;var _D=Pi(),NK=/((?:\r\n)|\n|\r)/,ew=class{constructor(e){this.cursor=0,this.line=e.line,this.lineLength=this.line.length,this.parserOptions=e.parserOptions,this.hasMoreData=e.hasMoreData,this.cursor=e.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){let{lineFromCursor:e}=this,r=this.parserOptions.NEXT_TOKEN_REGEXP;if(e.search(r)===-1)return null;let i=r.exec(e);if(i==null)return null;let n=i[1],s=this.cursor+(i.index||0);return new _D.Token({token:n,startCursor:s,endCursor:s+n.length-1})}get nextCharacterToken(){let{cursor:e,lineLength:r}=this;return r<=e?null:new _D.Token({token:this.line[e],startCursor:e,endCursor:e})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){let e=NK.exec(this.lineFromCursor);return e?(this.cursor+=(e.index||0)+e[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(e){return this.cursor=e,this}advanceToToken(e){return this.cursor=e.startCursor,this}advancePastToken(e){return this.cursor=e.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}};jh.Scanner=ew});var $h=y(Wh=>{"use strict";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.ColumnFormatter=void 0;var rw=class{constructor(e){e.trim?this.format=r=>r.trim():e.ltrim?this.format=r=>r.trimLeft():e.rtrim?this.format=r=>r.trimRight():this.format=r=>r}};Wh.ColumnFormatter=rw});var nw=y(Hh=>{"use strict";Object.defineProperty(Hh,"__esModule",{value:!0});Hh.NonQuotedColumnParser=void 0;var DK=$h(),wD=Pi(),iw=class{constructor(e){this.parserOptions=e,this.columnFormatter=new DK.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;let{parserOptions:r}=this,i=[],n=e.nextCharacterToken;for(;n&&!(wD.Token.isTokenDelimiter(n,r)||wD.Token.isTokenRowDelimiter(n));n=e.nextCharacterToken)i.push(n.token),e.advancePastToken(n);return this.columnFormatter.format(i.join(""))}};Hh.NonQuotedColumnParser=iw});var aw=y(Uh=>{"use strict";Object.defineProperty(Uh,"__esModule",{value:!0});Uh.QuotedColumnParser=void 0;var qK=$h(),xa=Pi(),sw=class{constructor(e){this.parserOptions=e,this.columnFormatter=new qK.ColumnFormatter(e)}parse(e){if(!e.hasMoreCharacters)return null;let r=e.cursor,{foundClosingQuote:i,col:n}=this.gatherDataBetweenQuotes(e);if(!i){if(e.advanceTo(r),!e.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${e.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(e),n}gatherDataBetweenQuotes(e){let{parserOptions:r}=this,i=!1,n=!1,s=[],a=e.nextCharacterToken;for(;!n&&a!==null;a=e.nextCharacterToken){let o=xa.Token.isTokenQuote(a,r);if(!i&&o)i=!0;else if(i)if(xa.Token.isTokenEscapeCharacter(a,r)){e.advancePastToken(a);let u=e.nextCharacterToken;u!==null&&(xa.Token.isTokenQuote(u,r)||xa.Token.isTokenEscapeCharacter(u,r))?(s.push(u.token),a=u):o?n=!0:s.push(a.token)}else o?n=!0:s.push(a.token);e.advancePastToken(a)}return{col:this.columnFormatter.format(s.join("")),foundClosingQuote:n}}checkForMalformedColumn(e){let{parserOptions:r}=this,{nextNonSpaceToken:i}=e;if(i){let n=xa.Token.isTokenDelimiter(i,r),s=xa.Token.isTokenRowDelimiter(i);if(!(n||s)){let a=e.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${r.escapedDelimiter}' OR new line got: '${i.token}'. at '${a}`)}e.advanceToToken(i)}else e.hasMoreData||e.advancePastLine()}};Uh.QuotedColumnParser=sw});var bD=y(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.ColumnParser=void 0;var IK=nw(),MK=aw(),PK=Pi(),ow=class{constructor(e){this.parserOptions=e,this.quotedColumnParser=new MK.QuotedColumnParser(e),this.nonQuotedColumnParser=new IK.NonQuotedColumnParser(e)}parse(e){let{nextNonSpaceToken:r}=e;return r!==null&&PK.Token.isTokenQuote(r,this.parserOptions)?(e.advanceToToken(r),this.quotedColumnParser.parse(e)):this.nonQuotedColumnParser.parse(e)}};zh.ColumnParser=ow});var lw=y(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.ColumnFormatter=xr.QuotedColumnParser=xr.NonQuotedColumnParser=xr.ColumnParser=void 0;var LK=bD();Object.defineProperty(xr,"ColumnParser",{enumerable:!0,get:function(){return LK.ColumnParser}});var BK=nw();Object.defineProperty(xr,"NonQuotedColumnParser",{enumerable:!0,get:function(){return BK.NonQuotedColumnParser}});var jK=aw();Object.defineProperty(xr,"QuotedColumnParser",{enumerable:!0,get:function(){return jK.QuotedColumnParser}});var WK=$h();Object.defineProperty(xr,"ColumnFormatter",{enumerable:!0,get:function(){return WK.ColumnFormatter}})});var hw=y(Xh=>{"use strict";Object.defineProperty(Xh,"__esModule",{value:!0});Xh.RowParser=void 0;var $K=lw(),Ta=Pi(),uw="",fw=class{constructor(e){this.parserOptions=e,this.columnParser=new $K.ColumnParser(e)}static isEmptyRow(e){return e.join(uw).replace(/\s+/g,uw)===uw}parse(e){let{parserOptions:r}=this,{hasMoreData:i}=e,n=e,s=[],a=this.getStartToken(n,s);for(;a;){if(Ta.Token.isTokenRowDelimiter(a))return n.advancePastToken(a),!n.hasMoreCharacters&&Ta.Token.isTokenCarriageReturn(a,r)&&i?null:(n.truncateToCursor(),s);if(!this.shouldSkipColumnParse(n,a,s)){let o=this.columnParser.parse(n);if(o===null)return null;s.push(o)}a=n.nextNonSpaceToken}return i?null:(n.truncateToCursor(),s)}getStartToken(e,r){let i=e.nextNonSpaceToken;return i!==null&&Ta.Token.isTokenDelimiter(i,this.parserOptions)?(r.push(""),e.nextNonSpaceToken):i}shouldSkipColumnParse(e,r,i){let{parserOptions:n}=this;if(Ta.Token.isTokenDelimiter(r,n)){e.advancePastToken(r);let s=e.nextCharacterToken;if(!e.hasMoreCharacters||s!==null&&Ta.Token.isTokenRowDelimiter(s)||s!==null&&Ta.Token.isTokenDelimiter(s,n))return i.push(""),!0}return!1}};Xh.RowParser=fw});var TD=y(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.Parser=void 0;var HK=tw(),xD=hw(),UK=Pi(),vl=class{constructor(e){this.parserOptions=e,this.rowParser=new xD.RowParser(this.parserOptions)}static removeBOM(e){return e&&e.charCodeAt(0)===65279?e.slice(1):e}parse(e,r){let i=new HK.Scanner({line:vl.removeBOM(e),parserOptions:this.parserOptions,hasMoreData:r});return this.parserOptions.supportsComments?this.parseWithComments(i):this.parseWithoutComments(i)}parseWithoutComments(e){let r=[],i=!0;for(;i;)i=this.parseRow(e,r);return{line:e.line,rows:r}}parseWithComments(e){let{parserOptions:r}=this,i=[];for(let n=e.nextCharacterToken;n!==null;n=e.nextCharacterToken)if(UK.Token.isTokenComment(n,r)){if(e.advancePastLine()===null)return{line:e.lineFromCursor,rows:i};if(!e.hasMoreCharacters)return{line:e.lineFromCursor,rows:i};e.truncateToCursor()}else if(!this.parseRow(e,i))break;return{line:e.line,rows:i}}parseRow(e,r){if(!e.nextNonSpaceToken)return!1;let n=this.rowParser.parse(e);return n===null?!1:(this.parserOptions.ignoreEmpty&&xD.RowParser.isEmptyRow(n)||r.push(n),!0)}};Vh.Parser=vl});var ED=y(pt=>{"use strict";Object.defineProperty(pt,"__esModule",{value:!0});pt.QuotedColumnParser=pt.NonQuotedColumnParser=pt.ColumnParser=pt.Token=pt.Scanner=pt.RowParser=pt.Parser=void 0;var zK=TD();Object.defineProperty(pt,"Parser",{enumerable:!0,get:function(){return zK.Parser}});var XK=hw();Object.defineProperty(pt,"RowParser",{enumerable:!0,get:function(){return XK.RowParser}});var VK=tw();Object.defineProperty(pt,"Scanner",{enumerable:!0,get:function(){return VK.Scanner}});var GK=Pi();Object.defineProperty(pt,"Token",{enumerable:!0,get:function(){return GK.Token}});var cw=lw();Object.defineProperty(pt,"ColumnParser",{enumerable:!0,get:function(){return cw.ColumnParser}});Object.defineProperty(pt,"NonQuotedColumnParser",{enumerable:!0,get:function(){return cw.NonQuotedColumnParser}});Object.defineProperty(pt,"QuotedColumnParser",{enumerable:!0,get:function(){return cw.QuotedColumnParser}})});var dw=y(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});Gh.CsvParserStream=void 0;var ZK=require("string_decoder"),YK=require("stream"),CD=yD(),KK=ED(),Ea=class extends YK.Transform{constructor(e){super({objectMode:e.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=e,this.parser=new KK.Parser(e),this.headerTransformer=new CD.HeaderTransformer(e),this.decoder=new ZK.StringDecoder(e.encoding),this.rowTransformerValidator=new CD.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(e){return this.rowTransformerValidator.rowTransform=e,this}validate(e){return this.rowTransformerValidator.rowValidator=e,this}emit(e,...r){return e==="end"?(this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1):super.emit(e,...r)}_transform(e,r,i){if(this.hasHitRowLimit)return i();let n=Ea.wrapDoneCallback(i);try{let{lines:s}=this,a=s+this.decoder.write(e),o=this.parse(a,!0);return this.processRows(o,n)}catch(s){return n(s)}}_flush(e){let r=Ea.wrapDoneCallback(e);if(this.hasHitRowLimit)return r();try{let i=this.lines+this.decoder.end(),n=this.parse(i,!1);return this.processRows(n,r)}catch(i){return r(i)}}parse(e,r){if(!e)return[];let{line:i,rows:n}=this.parser.parse(e,r);return this.lines=i,n}processRows(e,r){let i=e.length,n=s=>{let a=f=>{if(f)return r(f);if(s%100===0){setImmediate(()=>n(s+1));return}return n(s+1)};if(this.checkAndEmitHeaders(),s>=i||this.hasHitRowLimit)return r();if(this.parsedLineCount+=1,this.shouldSkipLine)return a();let o=e[s];this.rowCount+=1,this.parsedRowCount+=1;let u=this.rowCount;return this.transformRow(o,(f,h)=>{if(f)return this.rowCount-=1,a(f);if(!h)return a(new Error("expected transform result"));if(!h.isValid)this.emit("data-invalid",h.row,u,h.reason);else if(h.row)return this.pushRow(h.row,a);return a()})};n(0)}transformRow(e,r){try{this.headerTransformer.transform(e,(i,n)=>i?r(i):n?n.isValid?n.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(n.row,r):this.skipRow(r):(this.rowCount-=1,this.parsedRowCount-=1,r(null,{row:null,isValid:!0})):this.shouldEmitRows?r(null,{isValid:!1,row:e}):this.skipRow(r):r(new Error("Expected result from header transform")))}catch(i){r(i)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(e){return this.rowCount-=1,e(null,{row:null,isValid:!0})}pushRow(e,r){try{this.parserOptions.objectMode?this.push(e):this.push(JSON.stringify(e)),r()}catch(i){r(i)}}static wrapDoneCallback(e){let r=!1;return(i,...n)=>{if(i){if(r)throw i;r=!0,e(i);return}e(...n)}}};Gh.CsvParserStream=Ea});var kD=y(Le=>{"use strict";var SD=Le&&Le.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),QK=Le&&Le.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),JK=Le&&Le.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&SD(e,t,r);return QK(e,t),e},eQ=Le&&Le.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&SD(e,t,r)};Object.defineProperty(Le,"__esModule",{value:!0});Le.parseString=Le.parseFile=Le.parseStream=Le.parse=Le.ParserOptions=Le.CsvParserStream=void 0;var tQ=JK(require("fs")),rQ=require("stream"),Zh=O_(),Yh=dw();eQ(A_(),Le);var iQ=dw();Object.defineProperty(Le,"CsvParserStream",{enumerable:!0,get:function(){return iQ.CsvParserStream}});var nQ=O_();Object.defineProperty(Le,"ParserOptions",{enumerable:!0,get:function(){return nQ.ParserOptions}});Le.parse=t=>new Yh.CsvParserStream(new Zh.ParserOptions(t));Le.parseStream=(t,e)=>t.pipe(new Yh.CsvParserStream(new Zh.ParserOptions(e)));Le.parseFile=(t,e={})=>tQ.createReadStream(t).pipe(new Yh.CsvParserStream(new Zh.ParserOptions(e)));Le.parseString=(t,e)=>{let r=new rQ.Readable;return r.push(t),r.push(null),r.pipe(new Yh.CsvParserStream(new Zh.ParserOptions(e)))}});var RD=y(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.CsvParserStream=we.ParserOptions=we.parseFile=we.parseStream=we.parseString=we.parse=we.FormatterOptions=we.CsvFormatterStream=we.writeToPath=we.writeToString=we.writeToBuffer=we.writeToStream=we.write=we.format=void 0;var Li=TN();Object.defineProperty(we,"format",{enumerable:!0,get:function(){return Li.format}});Object.defineProperty(we,"write",{enumerable:!0,get:function(){return Li.write}});Object.defineProperty(we,"writeToStream",{enumerable:!0,get:function(){return Li.writeToStream}});Object.defineProperty(we,"writeToBuffer",{enumerable:!0,get:function(){return Li.writeToBuffer}});Object.defineProperty(we,"writeToString",{enumerable:!0,get:function(){return Li.writeToString}});Object.defineProperty(we,"writeToPath",{enumerable:!0,get:function(){return Li.writeToPath}});Object.defineProperty(we,"CsvFormatterStream",{enumerable:!0,get:function(){return Li.CsvFormatterStream}});Object.defineProperty(we,"FormatterOptions",{enumerable:!0,get:function(){return Li.FormatterOptions}});var Ca=kD();Object.defineProperty(we,"parse",{enumerable:!0,get:function(){return Ca.parse}});Object.defineProperty(we,"parseString",{enumerable:!0,get:function(){return Ca.parseString}});Object.defineProperty(we,"parseStream",{enumerable:!0,get:function(){return Ca.parseStream}});Object.defineProperty(we,"parseFile",{enumerable:!0,get:function(){return Ca.parseFile}});Object.defineProperty(we,"ParserOptions",{enumerable:!0,get:function(){return Ca.ParserOptions}});Object.defineProperty(we,"CsvParserStream",{enumerable:!0,get:function(){return Ca.CsvParserStream}})});var OD=y((pw,gw)=>{(function(t,e){typeof pw=="object"&&typeof gw<"u"?gw.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs_plugin_customParseFormat=e()})(pw,function(){"use strict";var t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},e=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,i=/\d\d?/,n=/\d*[^-_:/,()\s\d]+/,s={},a=function(c){return(c=+c)+(c>68?1900:2e3)},o=function(c){return function(d){this[c]=+d}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(c){(this.zone||(this.zone={})).offset=function(d){if(!d||d==="Z")return 0;var v=d.match(/([+-]|\d\d)/g),w=60*v[1]+(+v[2]||0);return w===0?0:v[0]==="+"?-w:w}(c)}],f=function(c){var d=s[c];return d&&(d.indexOf?d:d.s.concat(d.f))},h=function(c,d){var v,w=s.meridiem;if(w){for(var b=1;b<=24;b+=1)if(c.indexOf(w(b,0,d))>-1){v=b>12;break}}else v=c===(d?"pm":"PM");return v},g={A:[n,function(c){this.afternoon=h(c,!1)}],a:[n,function(c){this.afternoon=h(c,!0)}],S:[/\d/,function(c){this.milliseconds=100*+c}],SS:[r,function(c){this.milliseconds=10*+c}],SSS:[/\d{3}/,function(c){this.milliseconds=+c}],s:[i,o("seconds")],ss:[i,o("seconds")],m:[i,o("minutes")],mm:[i,o("minutes")],H:[i,o("hours")],h:[i,o("hours")],HH:[i,o("hours")],hh:[i,o("hours")],D:[i,o("day")],DD:[r,o("day")],Do:[n,function(c){var d=s.ordinal,v=c.match(/\d+/);if(this.day=v[0],d)for(var w=1;w<=31;w+=1)d(w).replace(/\[|\]/g,"")===c&&(this.day=w)}],M:[i,o("month")],MM:[r,o("month")],MMM:[n,function(c){var d=f("months"),v=(f("monthsShort")||d.map(function(w){return w.slice(0,3)})).indexOf(c)+1;if(v<1)throw new Error;this.month=v%12||v}],MMMM:[n,function(c){var d=f("months").indexOf(c)+1;if(d<1)throw new Error;this.month=d%12||d}],Y:[/[+-]?\d+/,o("year")],YY:[r,function(c){this.year=a(c)}],YYYY:[/\d{4}/,o("year")],Z:u,ZZ:u};function m(c){var d,v;d=c,v=s&&s.formats;for(var w=(c=d.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(H,W,P){var G=P&&P.toUpperCase();return W||v[P]||t[P]||v[G].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(q,E,A){return E||A.slice(1)})})).match(e),b=w.length,C=0;C<b;C+=1){var O=w[C],R=g[O],M=R&&R[0],X=R&&R[1];w[C]=X?{regex:M,parser:X}:O.replace(/^\[|\]$/g,"")}return function(H){for(var W={},P=0,G=0;P<b;P+=1){var q=w[P];if(typeof q=="string")G+=q.length;else{var E=q.regex,A=q.parser,$=H.slice(G),B=E.exec($)[0];A.call(W,B),H=H.replace(B,"")}}return function(T){var k=T.afternoon;if(k!==void 0){var N=T.hours;k?N<12&&(T.hours+=12):N===12&&(T.hours=0),delete T.afternoon}}(W),W}}return function(c,d,v){v.p.customParseFormat=!0,c&&c.parseTwoDigitYear&&(a=c.parseTwoDigitYear);var w=d.prototype,b=w.parse;w.parse=function(C){var O=C.date,R=C.utc,M=C.args;this.$u=R;var X=M[1];if(typeof X=="string"){var H=M[2]===!0,W=M[3]===!0,P=H||W,G=M[2];W&&(G=M[2]),s=this.$locale(),!H&&G&&(s=v.Ls[G]),this.$d=function($,B,T){try{if(["x","X"].indexOf(B)>-1)return new Date((B==="X"?1e3:1)*$);var k=m(B)($),N=k.year,j=k.month,V=k.day,Y=k.hours,J=k.minutes,te=k.seconds,Ce=k.milliseconds,xe=k.zone,he=new Date,ae=V||(N||j?1:he.getDate()),Se=N||he.getFullYear(),tt=0;N&&!j||(tt=j>0?j-1:he.getMonth());var mt=Y||0,ar=J||0,Rr=te||0,oi=Ce||0;return xe?new Date(Date.UTC(Se,tt,ae,mt,ar,Rr,oi+60*xe.offset*1e3)):T?new Date(Date.UTC(Se,tt,ae,mt,ar,Rr,oi)):new Date(Se,tt,ae,mt,ar,Rr,oi)}catch{return new Date("")}}(O,X,R),this.init(),G&&G!==!0&&(this.$L=this.locale(G).$L),P&&O!=this.format(X)&&(this.$d=new Date("")),s={}}else if(X instanceof Array)for(var q=X.length,E=1;E<=q;E+=1){M[1]=X[E-1];var A=v.apply(this,M);if(A.isValid()){this.$d=A.$d,this.$L=A.$L,this.init();break}E===q&&(this.$d=new Date(""))}else b.call(this,C)}}})});var AD=y((mw,vw)=>{(function(t,e){typeof mw=="object"&&typeof vw<"u"?vw.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs_plugin_utc=e()})(mw,function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(i,n,s){var a=n.prototype;s.utc=function(c){var d={date:c,utc:!0,args:arguments};return new n(d)},a.utc=function(c){var d=s(this.toDate(),{locale:this.$L,utc:!0});return c?d.add(this.utcOffset(),t):d},a.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var o=a.parse;a.parse=function(c){c.utc&&(this.$u=!0),this.$utils().u(c.$offset)||(this.$offset=c.$offset),o.call(this,c)};var u=a.init;a.init=function(){if(this.$u){var c=this.$d;this.$y=c.getUTCFullYear(),this.$M=c.getUTCMonth(),this.$D=c.getUTCDate(),this.$W=c.getUTCDay(),this.$H=c.getUTCHours(),this.$m=c.getUTCMinutes(),this.$s=c.getUTCSeconds(),this.$ms=c.getUTCMilliseconds()}else u.call(this)};var f=a.utcOffset;a.utcOffset=function(c,d){var v=this.$utils().u;if(v(c))return this.$u?0:v(this.$offset)?f.call(this):this.$offset;if(typeof c=="string"&&(c=function(O){O===void 0&&(O="");var R=O.match(e);if(!R)return null;var M=(""+R[0]).match(r)||["-",0,0],X=M[0],H=60*+M[1]+ +M[2];return H===0?0:X==="+"?H:-H}(c),c===null))return this;var w=Math.abs(c)<=16?60*c:c,b=this;if(d)return b.$offset=w,b.$u=c===0,b;if(c!==0){var C=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(b=this.local().add(w+C,t)).$offset=w,b.$x.$localOffset=C}else b=this.utc();return b};var h=a.format;a.format=function(c){var d=c||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,d)},a.valueOf=function(){var c=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*c},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var g=a.toDate;a.toDate=function(c){return c==="s"&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var m=a.diff;a.diff=function(c,d,v){if(c&&this.$u===c.$u)return m.call(this,c,d,v);var w=this.local(),b=s(c).local();return m.call(w,b,d,v)}}})});var FD=y((yw,_w)=>{(function(t,e){typeof yw=="object"&&typeof _w<"u"?_w.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).dayjs=e()})(yw,function(){"use strict";var t=1e3,e=6e4,r=36e5,i="millisecond",n="second",s="minute",a="hour",o="day",u="week",f="month",h="quarter",g="year",m="date",c="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(q){var E=["th","st","nd","rd"],A=q%100;return"["+q+(E[(A-20)%10]||E[A]||E[0])+"]"}},b=function(q,E,A){var $=String(q);return!$||$.length>=E?q:""+Array(E+1-$.length).join(A)+q},C={s:b,z:function(q){var E=-q.utcOffset(),A=Math.abs(E),$=Math.floor(A/60),B=A%60;return(E<=0?"+":"-")+b($,2,"0")+":"+b(B,2,"0")},m:function q(E,A){if(E.date()<A.date())return-q(A,E);var $=12*(A.year()-E.year())+(A.month()-E.month()),B=E.clone().add($,f),T=A-B<0,k=E.clone().add($+(T?-1:1),f);return+(-($+(A-B)/(T?B-k:k-B))||0)},a:function(q){return q<0?Math.ceil(q)||0:Math.floor(q)},p:function(q){return{M:f,y:g,w:u,d:o,D:m,h:a,m:s,s:n,ms:i,Q:h}[q]||String(q||"").toLowerCase().replace(/s$/,"")},u:function(q){return q===void 0}},O="en",R={};R[O]=w;var M=function(q){return q instanceof P},X=function q(E,A,$){var B;if(!E)return O;if(typeof E=="string"){var T=E.toLowerCase();R[T]&&(B=T),A&&(R[T]=A,B=T);var k=E.split("-");if(!B&&k.length>1)return q(k[0])}else{var N=E.name;R[N]=E,B=N}return!$&&B&&(O=B),B||!$&&O},H=function(q,E){if(M(q))return q.clone();var A=typeof E=="object"?E:{};return A.date=q,A.args=arguments,new P(A)},W=C;W.l=X,W.i=M,W.w=function(q,E){return H(q,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var P=function(){function q(A){this.$L=X(A.locale,null,!0),this.parse(A)}var E=q.prototype;return E.parse=function(A){this.$d=function($){var B=$.date,T=$.utc;if(B===null)return new Date(NaN);if(W.u(B))return new Date;if(B instanceof Date)return new Date(B);if(typeof B=="string"&&!/Z$/i.test(B)){var k=B.match(d);if(k){var N=k[2]-1||0,j=(k[7]||"0").substring(0,3);return T?new Date(Date.UTC(k[1],N,k[3]||1,k[4]||0,k[5]||0,k[6]||0,j)):new Date(k[1],N,k[3]||1,k[4]||0,k[5]||0,k[6]||0,j)}}return new Date(B)}(A),this.$x=A.x||{},this.init()},E.init=function(){var A=this.$d;this.$y=A.getFullYear(),this.$M=A.getMonth(),this.$D=A.getDate(),this.$W=A.getDay(),this.$H=A.getHours(),this.$m=A.getMinutes(),this.$s=A.getSeconds(),this.$ms=A.getMilliseconds()},E.$utils=function(){return W},E.isValid=function(){return this.$d.toString()!==c},E.isSame=function(A,$){var B=H(A);return this.startOf($)<=B&&B<=this.endOf($)},E.isAfter=function(A,$){return H(A)<this.startOf($)},E.isBefore=function(A,$){return this.endOf($)<H(A)},E.$g=function(A,$,B){return W.u(A)?this[$]:this.set(B,A)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(A,$){var B=this,T=!!W.u($)||$,k=W.p(A),N=function(he,ae){var Se=W.w(B.$u?Date.UTC(B.$y,ae,he):new Date(B.$y,ae,he),B);return T?Se:Se.endOf(o)},j=function(he,ae){return W.w(B.toDate()[he].apply(B.toDate("s"),(T?[0,0,0,0]:[23,59,59,999]).slice(ae)),B)},V=this.$W,Y=this.$M,J=this.$D,te="set"+(this.$u?"UTC":"");switch(k){case g:return T?N(1,0):N(31,11);case f:return T?N(1,Y):N(0,Y+1);case u:var Ce=this.$locale().weekStart||0,xe=(V<Ce?V+7:V)-Ce;return N(T?J-xe:J+(6-xe),Y);case o:case m:return j(te+"Hours",0);case a:return j(te+"Minutes",1);case s:return j(te+"Seconds",2);case n:return j(te+"Milliseconds",3);default:return this.clone()}},E.endOf=function(A){return this.startOf(A,!1)},E.$set=function(A,$){var B,T=W.p(A),k="set"+(this.$u?"UTC":""),N=(B={},B[o]=k+"Date",B[m]=k+"Date",B[f]=k+"Month",B[g]=k+"FullYear",B[a]=k+"Hours",B[s]=k+"Minutes",B[n]=k+"Seconds",B[i]=k+"Milliseconds",B)[T],j=T===o?this.$D+($-this.$W):$;if(T===f||T===g){var V=this.clone().set(m,1);V.$d[N](j),V.init(),this.$d=V.set(m,Math.min(this.$D,V.daysInMonth())).$d}else N&&this.$d[N](j);return this.init(),this},E.set=function(A,$){return this.clone().$set(A,$)},E.get=function(A){return this[W.p(A)]()},E.add=function(A,$){var B,T=this;A=Number(A);var k=W.p($),N=function(Y){var J=H(T);return W.w(J.date(J.date()+Math.round(Y*A)),T)};if(k===f)return this.set(f,this.$M+A);if(k===g)return this.set(g,this.$y+A);if(k===o)return N(1);if(k===u)return N(7);var j=(B={},B[s]=e,B[a]=r,B[n]=t,B)[k]||1,V=this.$d.getTime()+A*j;return W.w(V,this)},E.subtract=function(A,$){return this.add(-1*A,$)},E.format=function(A){var $=this,B=this.$locale();if(!this.isValid())return B.invalidDate||c;var T=A||"YYYY-MM-DDTHH:mm:ssZ",k=W.z(this),N=this.$H,j=this.$m,V=this.$M,Y=B.weekdays,J=B.months,te=function(ae,Se,tt,mt){return ae&&(ae[Se]||ae($,T))||tt[Se].slice(0,mt)},Ce=function(ae){return W.s(N%12||12,ae,"0")},xe=B.meridiem||function(ae,Se,tt){var mt=ae<12?"AM":"PM";return tt?mt.toLowerCase():mt},he={YY:String(this.$y).slice(-2),YYYY:this.$y,M:V+1,MM:W.s(V+1,2,"0"),MMM:te(B.monthsShort,V,J,3),MMMM:te(J,V),D:this.$D,DD:W.s(this.$D,2,"0"),d:String(this.$W),dd:te(B.weekdaysMin,this.$W,Y,2),ddd:te(B.weekdaysShort,this.$W,Y,3),dddd:Y[this.$W],H:String(N),HH:W.s(N,2,"0"),h:Ce(1),hh:Ce(2),a:xe(N,j,!0),A:xe(N,j,!1),m:String(j),mm:W.s(j,2,"0"),s:String(this.$s),ss:W.s(this.$s,2,"0"),SSS:W.s(this.$ms,3,"0"),Z:k};return T.replace(v,function(ae,Se){return Se||he[ae]||k.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(A,$,B){var T,k=W.p($),N=H(A),j=(N.utcOffset()-this.utcOffset())*e,V=this-N,Y=W.m(this,N);return Y=(T={},T[g]=Y/12,T[f]=Y,T[h]=Y/3,T[u]=(V-j)/6048e5,T[o]=(V-j)/864e5,T[a]=V/r,T[s]=V/e,T[n]=V/t,T)[k]||V,B?Y:W.a(Y)},E.daysInMonth=function(){return this.endOf(f).$D},E.$locale=function(){return R[this.$L]},E.locale=function(A,$){if(!A)return this.$L;var B=this.clone(),T=X(A,$,!0);return T&&(B.$L=T),B},E.clone=function(){return W.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},q}(),G=P.prototype;return H.prototype=G,[["$ms",i],["$s",n],["$m",s],["$H",a],["$W",o],["$M",f],["$y",g],["$D",m]].forEach(function(q){G[q[1]]=function(E){return this.$g(E,q[0],q[1])}}),H.extend=function(q,E){return q.$i||(q(E,P,H),q.$i=!0),H},H.locale=X,H.isDayjs=M,H.unix=function(q){return H(1e3*q)},H.en=R[O],H.Ls=R,H.p={},H})});var ID=y((Wue,qD)=>{var ND=require("fs"),DD=RD(),sQ=OD(),aQ=AD(),yl=FD().extend(sQ).extend(aQ),oQ=Qo(),{fs:{exists:lQ}}=qt(),uQ={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}},ww=class{constructor(e){this.workbook=e,this.worksheet=null}async readFile(e,r){if(r=r||{},!await lQ(e))throw new Error(`File not found: ${e}`);let i=ND.createReadStream(e),n=await this.read(i,r);return i.close(),n}read(e,r){return r=r||{},new Promise((i,n)=>{let s=this.workbook.addWorksheet(r.sheetName),a=r.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],o=r.map||function(f){if(f==="")return null;let h=Number(f);if(!Number.isNaN(h)&&h!==1/0)return h;let g=a.reduce((c,d)=>{if(c)return c;let v=yl(f,d,!0);return v.isValid()?v:null},null);if(g)return new Date(g.valueOf());let m=uQ[f];return m!==void 0?m:f},u=DD.parse(r.parserOptions).on("data",f=>{s.addRow(f.map(o))}).on("end",()=>{u.emit("worksheet",s)});u.on("worksheet",i).on("error",n),e.pipe(u)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(e,r){return new Promise((i,n)=>{r=r||{};let s=this.workbook.getWorksheet(r.sheetName||r.sheetId),a=DD.format(r.formatterOptions);e.on("finish",()=>{i()}),a.on("error",n),a.pipe(e);let{dateFormat:o,dateUTC:u}=r,f=r.map||(m=>{if(m){if(m.text||m.hyperlink)return m.hyperlink||m.text||"";if(m.formula||m.result)return m.result||"";if(m instanceof Date)return o?u?yl.utc(m).format(o):yl(m).format(o):u?yl.utc(m).format():yl(m).format();if(m.error)return m.error;if(typeof m=="object")return JSON.stringify(m)}return m}),h=r.includeEmptyRows===void 0||r.includeEmptyRows,g=1;s&&s.eachRow((m,c)=>{if(h)for(;g++<c-1;)a.write([]);let{values:d}=m;d.shift(),a.write(d.map(f)),g=c}),a.end()})}writeFile(e,r){r=r||{};let i={encoding:r.encoding||"utf8"},n=ND.createWriteStream(e,i);return this.write(n,r)}async writeBuffer(e){let r=new oQ;return await this.write(r,e),r.read()}};qD.exports=ww});var LD=y(($ue,PD)=>{"use strict";var MD=bx(),fQ=Nd(),hQ=a_(),cQ=ID(),bw=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new fQ}get xlsx(){return this._xlsx||(this._xlsx=new hQ(this)),this._xlsx}get csv(){return this._csv||(this._csv=new cQ(this)),this._csv}get nextId(){for(let e=1;e<this._worksheets.length;e++)if(!this._worksheets[e])return e;return this._worksheets.length||1}addWorksheet(e,r){let i=this.nextId;if(e&&e.length>31&&console.warn(`Worksheet name ${e} exceeds 31 chars. This will be truncated`),/[*?:/\\[\]]/.test(e))throw new Error(`Worksheet name ${e} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(e))throw new Error(`The first or last character of worksheet name cannot be a single quotation mark: ${e}`);if(e=(e||`sheet${i}`).substring(0,31),this._worksheets.find(o=>o&&o.name.toLowerCase()===e.toLowerCase()))throw new Error(`Worksheet name already exists: ${e}`);r&&(typeof r=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),r={properties:{tabColor:{argb:r}}}):(r.argb||r.theme||r.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),r={properties:{tabColor:r}}));let n=this._worksheets.reduce((o,u)=>(u&&u.orderNo)>o?u.orderNo:o,0),s=Object.assign({},r,{id:i,name:e,orderNo:n+1,workbook:this}),a=new MD(s);return this._worksheets[i]=a,a}removeWorksheetEx(e){delete this._worksheets[e.id]}removeWorksheet(e){let r=this.getWorksheet(e);r&&r.destroy()}getWorksheet(e){if(e===void 0)return this._worksheets.find(Boolean);if(typeof e=="number")return this._worksheets[e];if(typeof e=="string")return this._worksheets.find(r=>r&&r.name===e)}get worksheets(){return this._worksheets.slice(1).sort((e,r)=>e.orderNo-r.orderNo).filter(Boolean)}eachSheet(e){this.worksheets.forEach(r=>{e(r,r.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(e){let r=this.media.length;return this.media.push(Object.assign({},e,{type:"image"})),r}getImage(e){return this.media[e]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(e=>e.model),sheets:this.worksheets.map(e=>e.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(e){this.creator=e.creator,this.lastModifiedBy=e.lastModifiedBy,this.lastPrinted=e.lastPrinted,this.created=e.created,this.modified=e.modified,this.company=e.company,this.manager=e.manager,this.title=e.title,this.subject=e.subject,this.keywords=e.keywords,this.category=e.category,this.description=e.description,this.language=e.language,this.revision=e.revision,this.contentStatus=e.contentStatus,this.properties=e.properties,this.calcProperties=e.calcProperties,this._worksheets=[],e.worksheets.forEach(r=>{let{id:i,name:n,state:s}=r,a=e.sheets&&e.sheets.findIndex(u=>u.id===i),o=this._worksheets[i]=new MD({id:i,name:n,orderNo:a,state:s,workbook:this});o.model=r}),this._definedNames.model=e.definedNames,this.views=e.views,this._themes=e.themes,this.media=e.media||[]}};PD.exports=bw});var jD=y((Hue,BD)=>{"use strict";var dQ=a_(),xw=class{constructor(e){this.model=e}get xlsx(){return this._xlsx||(this._xlsx=new dQ(this)),this._xlsx}};BD.exports=xw});var $D=y((Uue,WD)=>{var Tw=class{constructor(){this._values=[],this._totalRefs=0,this._hash=Object.create(null)}get count(){return this._values.length}get values(){return this._values}get totalRefs(){return this._totalRefs}getString(e){return this._values[e]}add(e){let r=this._hash[e];return r===void 0&&(r=this._hash[e]=this._values.length,this._values.push(e)),this._totalRefs++,r}};WD.exports=Tw});var UD=y((zue,HD)=>{var pQ=qt(),gQ=Ai(),Ew=class{constructor(e){this.writer=e}push(e){this.writer.addHyperlink(e)}},Cw=class{constructor(e){this.id=e.id,this.count=0,this._hyperlinks=[],this._workbook=e.workbook}get stream(){return this._stream||(this._stream=this._workbook._openStream(`/xl/worksheets/_rels/sheet${this.id}.xml.rels`)),this._stream}get length(){return this._hyperlinks.length}each(e){return this._hyperlinks.forEach(e)}get hyperlinksProxy(){return this._hyperlinksProxy||(this._hyperlinksProxy=new Ew(this))}addHyperlink(e){let r={Target:e.target,Type:gQ.Hyperlink,TargetMode:"External"},i=this._writeRelationship(r);this._hyperlinks.push({rId:i,address:e.address})}addMedia(e){return this._writeRelationship(e)}addRelationship(e){return this._writeRelationship(e)}commit(){this.count&&(this._writeClose(),this.stream.end())}_writeOpen(){this.stream.write(`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
       <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">`)}_writeRelationship(e){this.count||this._writeOpen();let r=`rId${++this.count}`;return e.TargetMode?this.stream.write(`<Relationship Id="${r}" Type="${e.Type}" Target="${pQ.xmlEncode(e.Target)}" TargetMode="${e.TargetMode}"/>`):this.stream.write(`<Relationship Id="${r}" Type="${e.Type}" Target="${e.Target}"/>`),r}_writeClose(){this.stream.write("</Relationships>")}};HD.exports=Cw});var GD=y((Xue,VD)=>{var zD=nt(),XD=Ai(),mQ=Me(),vQ=Uy(),yQ=Ky(),Sw=class{constructor(e,r,i){this.id=i.id,this.count=0,this._worksheet=e,this._workbook=i.workbook,this._sheetRelsWriter=r}get commentsStream(){return this._commentsStream||(this._commentsStream=this._workbook._openStream(`/xl/comments${this.id}.xml`)),this._commentsStream}get vmlStream(){return this._vmlStream||(this._vmlStream=this._workbook._openStream(`xl/drawings/vmlDrawing${this.id}.vml`)),this._vmlStream}_addRelationships(){let e={Type:XD.Comments,Target:`../comments${this.id}.xml`};this._sheetRelsWriter.addRelationship(e);let r={Type:XD.VmlDrawing,Target:`../drawings/vmlDrawing${this.id}.vml`};this.vmlRelId=this._sheetRelsWriter.addRelationship(r)}_addCommentRefs(){this._workbook.commentRefs.push({commentName:`comments${this.id}`,vmlDrawing:`vmlDrawing${this.id}`})}_writeOpen(){this.commentsStream.write('<?xml version="1.0" encoding="UTF-8" standalone="yes"?><comments xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><authors><author>Author</author></authors><commentList>'),this.vmlStream.write('<?xml version="1.0" encoding="UTF-8"?><xml xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:x="urn:schemas-microsoft-com:office:excel"><o:shapelayout v:ext="edit"><o:idmap v:ext="edit" data="1" /></o:shapelayout><v:shapetype id="_x0000_t202" coordsize="21600,21600" o:spt="202" path="m,l,21600r21600,l21600,xe"><v:stroke joinstyle="miter" /><v:path gradientshapeok="t" o:connecttype="rect" /></v:shapetype>')}_writeComment(e,r){let i=new vQ,n=new zD;i.render(n,e),this.commentsStream.write(n.xml);let s=new yQ,a=new zD;s.render(a,e,r),this.vmlStream.write(a.xml)}_writeClose(){this.commentsStream.write("</commentList></comments>"),this.vmlStream.write("</xml>")}addComments(e){e&&e.length&&(this.startedData||(this._worksheet.comments=[],this._writeOpen(),this._addRelationships(),this._addCommentRefs(),this.startedData=!0),e.forEach(r=>{r.refAddress=mQ.decodeAddress(r.ref)}),e.forEach(r=>{this._writeComment(r,this.count),this.count+=1}))}commit(){this.count&&(this._writeClose(),this.commentsStream.end(),this.vmlStream.end())}};VD.exports=Sw});var JD=y((Vue,QD)=>{var _Q=je(),wQ=Ai(),kw=Me(),ZD=kd(),YD=Fr(),bQ=Qg(),KD=du(),Rw=pu(),xQ=UD(),TQ=GD(),EQ=Cd(),Ke=new bQ,Ow=xn(),CQ=Cv(),SQ=Ov(),kQ=Fv(),RQ=yv(),OQ=mv(),AQ=bv(),FQ=Dv(),NQ=Iv(),DQ=Pv(),qQ=Bv(),IQ=$v(),MQ=Uv(),PQ=fy(),LQ=Kv(),BQ=Zv(),Qe={dataValidations:new CQ,sheetProperties:new SQ,sheetFormatProperties:new kQ,columns:new Ow({tag:"cols",length:!1,childXform:new RQ}),row:new OQ,hyperlinks:new Ow({tag:"hyperlinks",length:!1,childXform:new AQ}),sheetViews:new Ow({tag:"sheetViews",length:!1,childXform:new FQ}),sheetProtection:new NQ,pageMargins:new DQ,pageSeteup:new qQ,autoFilter:new IQ,picture:new MQ,conditionalFormattings:new PQ,headerFooter:new LQ,rowBreaks:new BQ},Aw=class{constructor(e){this.id=e.id,this.name=e.name||`Sheet${this.id}`,this.state=e.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges=[],this._merges.add=function(){},this._sheetRelsWriter=new xQ(e),this._sheetCommentsWriter=new TQ(this,this._sheetRelsWriter,e),this._dimensions=new YD,this._rowZero=1,this.committed=!1,this.dataValidations=new EQ,this._formulae={},this._siFormulae=0,this.conditionalFormatting=[],this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},e.properties),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},e.headerFooter),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!!(e.pageSetup&&(e.pageSetup.fitToWidth||e.pageSetup.fitToHeight)&&!e.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},e.pageSetup),this.useSharedStrings=e.useSharedStrings||!1,this._workbook=e.workbook,this.hasComments=!1,this._views=e.views||[],this.autoFilter=e.autoFilter||null,this._media=[],this.sheetProtection=null,this._writeOpenWorksheet(),this.startedData=!1}get workbook(){return this._workbook}get stream(){return this._stream||(this._stream=this._workbook._openStream(`/xl/worksheets/sheet${this.id}.xml`),this._stream.pause()),this._stream}destroy(){throw new Error("Invalid Operation: destroy")}commit(){this.committed||(this._rows.forEach(e=>{e&&this._writeRow(e)}),this._rows=null,this.startedData||this._writeOpenSheetData(),this._writeCloseSheetData(),this._writeAutoFilter(),this._writeMergeCells(),this._writeHyperlinks(),this._writeConditionalFormatting(),this._writeDataValidations(),this._writeSheetProtection(),this._writePageMargins(),this._writePageSetup(),this._writeBackground(),this._writeHeaderFooter(),this._writeRowBreaks(),this._writeLegacyData(),this._writeCloseWorksheet(),this.stream.end(),this._sheetCommentsWriter.commit(),this._sheetRelsWriter.commit(),this.committed=!0)}get dimensions(){return this._dimensions}get views(){return this._views}get columns(){return this._columns}set columns(e){this._headerRowCount=e.reduce((n,s)=>{let a=s.header&&1||s.headers&&s.headers.length||0;return Math.max(n,a)},0);let r=1,i=this._columns=[];e.forEach(n=>{let s=new Rw(this,r++,!1);i.push(s),s.defn=n})}getColumnKey(e){return this._keys[e]}setColumnKey(e,r){this._keys[e]=r}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){_Q.each(this._keys,e)}getColumn(e){if(typeof e=="string"){let r=this._keys[e];if(r)return r;e=kw.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let r=this._columns.length+1;for(;r<=e;)this._columns.push(new Rw(this,r++))}return this._columns[e-1]}get _nextRow(){return this._rowZero+this._rows.length}eachRow(e,r){if(r||(r=e,e=void 0),e&&e.includeEmpty){let i=this._nextRow;for(let n=this._rowZero;n<i;n++)r(this.getRow(n),n)}else this._rows.forEach(i=>{i.hasValues&&r(i,i.number)})}_commitRow(e){let r=!1;for(;this._rows.length&&!r;){let i=this._rows.shift();this._rowZero++,i&&(this._writeRow(i),r=i.number===e.number,this._rowZero=i.number+1)}}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(e){let r=e-this._rowZero;return this._rows[r]}getRow(e){let r=e-this._rowZero;if(r<0)throw new Error("Out of bounds: this row has been committed");let i=this._rows[r];return i||(this._rows[r]=i=new KD(this,e)),i}addRow(e){let r=new KD(this,this._nextRow);return this._rows[r.number-this._rowZero]=r,r.values=e,r}findCell(e,r){let i=kw.getAddress(e,r),n=this.findRow(i.row);return n?n.findCell(i.column):void 0}getCell(e,r){let i=kw.getAddress(e,r);return this.getRow(i.row).getCellEx(i)}mergeCells(...e){let r=new YD(e);this._merges.forEach(n=>{if(n.intersects(r))throw new Error("Cannot merge already merged cells")});let i=this.getCell(r.top,r.left);for(let n=r.top;n<=r.bottom;n++)for(let s=r.left;s<=r.right;s++)(n>r.top||s>r.left)&&this.getCell(n,s).merge(i);this._merges.push(r)}addConditionalFormatting(e){this.conditionalFormatting.push(e)}removeConditionalFormatting(e){typeof e=="number"?this.conditionalFormatting.splice(e,1):e instanceof Function?this.conditionalFormatting=this.conditionalFormatting.filter(e):this.conditionalFormatting=[]}addBackgroundImage(e){this._background={imageId:e}}getBackgroundImageId(){return this._background&&this._background.imageId}protect(e,r){return new Promise(i=>{this.sheetProtection={sheet:!0},r&&"spinCount"in r&&(r.spinCount=Number.isFinite(r.spinCount)?Math.round(Math.max(0,r.spinCount)):1e5),e&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=ZD.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=r&&"spinCount"in r?r.spinCount:1e5,this.sheetProtection.hashValue=ZD.convertPasswordToHash(e,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),r&&(this.sheetProtection=Object.assign(this.sheetProtection,r),!e&&"spinCount"in r&&delete this.sheetProtection.spinCount),i()})}unprotect(){this.sheetProtection=null}_write(e){Ke.reset(),Ke.addText(e),this.stream.write(Ke)}_writeSheetProperties(e,r,i){let n={outlineProperties:r&&r.outlineProperties,tabColor:r&&r.tabColor,pageSetup:i&&i.fitToPage?{fitToPage:i.fitToPage}:void 0};e.addText(Qe.sheetProperties.toXml(n))}_writeSheetFormatProperties(e,r){let i=r?{defaultRowHeight:r.defaultRowHeight,dyDescent:r.dyDescent,outlineLevelCol:r.outlineLevelCol,outlineLevelRow:r.outlineLevelRow}:void 0;r.defaultColWidth&&(i.defaultColWidth=r.defaultColWidth),e.addText(Qe.sheetFormatProperties.toXml(i))}_writeOpenWorksheet(){Ke.reset(),Ke.addText('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'),Ke.addText('<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'),this._writeSheetProperties(Ke,this.properties,this.pageSetup),Ke.addText(Qe.sheetViews.toXml(this.views)),this._writeSheetFormatProperties(Ke,this.properties),this.stream.write(Ke)}_writeColumns(){let e=Rw.toModel(this.columns);e&&(Qe.columns.prepare(e,{styles:this._workbook.styles}),this.stream.write(Qe.columns.toXml(e)))}_writeOpenSheetData(){this._write("<sheetData>")}_writeRow(e){if(this.startedData||(this._writeColumns(),this._writeOpenSheetData(),this.startedData=!0),e.hasValues||e.height){let{model:r}=e,i={styles:this._workbook.styles,sharedStrings:this.useSharedStrings?this._workbook.sharedStrings:void 0,hyperlinks:this._sheetRelsWriter.hyperlinksProxy,merges:this._merges,formulae:this._formulae,siFormulae:this._siFormulae,comments:[]};Qe.row.prepare(r,i),this.stream.write(Qe.row.toXml(r)),i.comments.length&&(this.hasComments=!0,this._sheetCommentsWriter.addComments(i.comments))}}_writeCloseSheetData(){this._write("</sheetData>")}_writeMergeCells(){this._merges.length&&(Ke.reset(),Ke.addText(`<mergeCells count="${this._merges.length}">`),this._merges.forEach(e=>{Ke.addText(`<mergeCell ref="${e}"/>`)}),Ke.addText("</mergeCells>"),this.stream.write(Ke))}_writeHyperlinks(){this.stream.write(Qe.hyperlinks.toXml(this._sheetRelsWriter._hyperlinks))}_writeConditionalFormatting(){let e={styles:this._workbook.styles};Qe.conditionalFormattings.prepare(this.conditionalFormatting,e),this.stream.write(Qe.conditionalFormattings.toXml(this.conditionalFormatting))}_writeRowBreaks(){this.stream.write(Qe.rowBreaks.toXml(this.rowBreaks))}_writeDataValidations(){this.stream.write(Qe.dataValidations.toXml(this.dataValidations.model))}_writeSheetProtection(){this.stream.write(Qe.sheetProtection.toXml(this.sheetProtection))}_writePageMargins(){this.stream.write(Qe.pageMargins.toXml(this.pageSetup.margins))}_writePageSetup(){this.stream.write(Qe.pageSeteup.toXml(this.pageSetup))}_writeHeaderFooter(){this.stream.write(Qe.headerFooter.toXml(this.headerFooter))}_writeAutoFilter(){this.stream.write(Qe.autoFilter.toXml(this.autoFilter))}_writeBackground(){if(this._background){if(this._background.imageId!==void 0){let e=this._workbook.getImage(this._background.imageId),r=this._sheetRelsWriter.addMedia({Target:`../media/${e.name}`,Type:wQ.Image});this._background={...this._background,rId:r}}this.stream.write(Qe.picture.toXml({rId:this._background.rId}))}}_writeLegacyData(){this.hasComments&&(Ke.reset(),Ke.addText(`<legacyDrawing r:id="${this._sheetCommentsWriter.vmlRelId}"/>`),this.stream.write(Ke))}_writeDimensions(){}_writeCloseWorksheet(){this._write("</worksheet>")}};QD.exports=Aw});var nq=y((Gue,iq)=>{var jQ=require("fs"),WQ=require("archiver"),eq=Qo(),Mn=Ai(),tq=zf(),$Q=$D(),HQ=Nd(),UQ=Zm(),rq=Vf(),zQ=rv(),XQ=sv(),VQ=Gf(),GQ=ev(),ZQ=JD(),YQ=Qy(),Fw=class{constructor(e){e=e||{},this.created=e.created||new Date,this.modified=e.modified||this.created,this.creator=e.creator||"ExcelJS",this.lastModifiedBy=e.lastModifiedBy||"ExcelJS",this.lastPrinted=e.lastPrinted,this.useSharedStrings=e.useSharedStrings||!1,this.sharedStrings=new $Q,this.styles=e.useStyles?new tq(!0):new tq.Mock(!0),this._definedNames=new HQ,this._worksheets=[],this.views=[],this.zipOptions=e.zip,this.media=[],this.commentRefs=[],this.zip=WQ("zip",this.zipOptions),e.stream?this.stream=e.stream:e.filename?this.stream=jQ.createWriteStream(e.filename):this.stream=new eq,this.zip.pipe(this.stream),this.promise=Promise.all([this.addThemes(),this.addOfficeRels()])}get definedNames(){return this._definedNames}_openStream(e){let r=new eq({bufSize:65536,batch:!0});return this.zip.append(r,{name:e}),r.on("finish",()=>{r.emit("zipped")}),r}_commitWorksheets(){let e=function(i){return i.committed?Promise.resolve():new Promise(n=>{i.stream.on("zipped",()=>{n()}),i.commit()})},r=this._worksheets.map(e);return r.length?Promise.all(r):Promise.resolve()}async commit(){return await this.promise,await this.addMedia(),await this._commitWorksheets(),await Promise.all([this.addContentTypes(),this.addApp(),this.addCore(),this.addSharedStrings(),this.addStyles(),this.addWorkbookRels()]),await this.addWorkbook(),this._finalize()}get nextId(){let e;for(e=1;e<this._worksheets.length;e++)if(!this._worksheets[e])return e;return this._worksheets.length||1}addImage(e){let r=this.media.length,i=Object.assign({},e,{type:"image",name:`image${r}.${e.extension}`});return this.media.push(i),r}getImage(e){return this.media[e]}addWorksheet(e,r){r=r||{};let i=r.useSharedStrings!==void 0?r.useSharedStrings:this.useSharedStrings;r.tabColor&&(console.trace("tabColor option has moved to { properties: tabColor: {...} }"),r.properties=Object.assign({tabColor:r.tabColor},r.properties));let n=this.nextId;e=e||`sheet${n}`;let s=new ZQ({id:n,name:e,workbook:this,useSharedStrings:i,properties:r.properties,state:r.state,pageSetup:r.pageSetup,views:r.views,autoFilter:r.autoFilter,headerFooter:r.headerFooter});return this._worksheets[n]=s,s}getWorksheet(e){if(e===void 0)return this._worksheets.find(()=>!0);if(typeof e=="number")return this._worksheets[e];if(typeof e=="string")return this._worksheets.find(r=>r&&r.name===e)}addStyles(){return new Promise(e=>{this.zip.append(this.styles.xml,{name:"xl/styles.xml"}),e()})}addThemes(){return new Promise(e=>{this.zip.append(YQ,{name:"xl/theme/theme1.xml"}),e()})}addOfficeRels(){return new Promise(e=>{let i=new rq().toXml([{Id:"rId1",Type:Mn.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:Mn.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:Mn.ExtenderProperties,Target:"docProps/app.xml"}]);this.zip.append(i,{name:"/_rels/.rels"}),e()})}addContentTypes(){return new Promise(e=>{let r={worksheets:this._worksheets.filter(Boolean),sharedStrings:this.sharedStrings,commentRefs:this.commentRefs,media:this.media},n=new zQ().toXml(r);this.zip.append(n,{name:"[Content_Types].xml"}),e()})}addMedia(){return Promise.all(this.media.map(e=>{if(e.type==="image"){let r=`xl/media/${e.name}`;if(e.filename)return this.zip.file(e.filename,{name:r});if(e.buffer)return this.zip.append(e.buffer,{name:r});if(e.base64){let i=e.base64,n=i.substring(i.indexOf(",")+1);return this.zip.append(n,{name:r,base64:!0})}}throw new Error("Unsupported media")}))}addApp(){return new Promise(e=>{let r={worksheets:this._worksheets.filter(Boolean)},n=new XQ().toXml(r);this.zip.append(n,{name:"docProps/app.xml"}),e()})}addCore(){return new Promise(e=>{let i=new UQ().toXml(this);this.zip.append(i,{name:"docProps/core.xml"}),e()})}addSharedStrings(){return this.sharedStrings.count?new Promise(e=>{let i=new GQ().toXml(this.sharedStrings);this.zip.append(i,{name:"/xl/sharedStrings.xml"}),e()}):Promise.resolve()}addWorkbookRels(){let e=1,r=[{Id:`rId${e++}`,Type:Mn.Styles,Target:"styles.xml"},{Id:`rId${e++}`,Type:Mn.Theme,Target:"theme/theme1.xml"}];return this.sharedStrings.count&&r.push({Id:`rId${e++}`,Type:Mn.SharedStrings,Target:"sharedStrings.xml"}),this._worksheets.forEach(i=>{i&&(i.rId=`rId${e++}`,r.push({Id:i.rId,Type:Mn.Worksheet,Target:`worksheets/sheet${i.id}.xml`}))}),new Promise(i=>{let s=new rq().toXml(r);this.zip.append(s,{name:"/xl/_rels/workbook.xml.rels"}),i()})}addWorkbook(){let{zip:e}=this,r={worksheets:this._worksheets.filter(Boolean),definedNames:this._definedNames.model,views:this.views,properties:{},calcProperties:{}};return new Promise(i=>{let n=new VQ;n.prepare(r),e.append(n.toXml(r),{name:"/xl/workbook.xml"}),i()})}_finalize(){return new Promise((e,r)=>{this.stream.on("error",r),this.stream.on("finish",()=>{e(this)}),this.zip.on("error",r),this.zip.finalize()})}};iq.exports=Fw});var aq=y((Zue,sq)=>{"use strict";var Nw=require("events").listenerCount;Nw=Nw||function(t,e){var r=t&&t._events&&t._events[e];return Array.isArray(r)?r.length:typeof r=="function"?1:0};sq.exports=Nw});var lq=y((Yue,oq)=>{oq.exports=function(e){var r=process&&process.version?process.version:"v5.0.0",i=r.split(".")[0].replace("v","");return i<6?new Buffer(e):Buffer.from(e)}});var fq=y(()=>{"use strict";var _l=lq();Buffer.prototype.indexOf||(Buffer.prototype.indexOf=function(t,e){e=e||0,typeof t=="string"||t instanceof String?t=_l(t):(typeof t=="number"||t instanceof Number)&&(t=_l([t]));for(var r=t.length,i=e;i<=this.length-r;i++){for(var n=!1,s=0;s<r;s++)if(this[i+s]!=t[s]){n=!0;break}if(!n)return i}return-1});function uq(t,e){typeof t=="string"||t instanceof String?t=_l(t):(typeof t=="number"||t instanceof Number)&&(t=_l([t]));var r=t.length;e=e||this.length-r;for(var i=e;i>=0;i--){for(var n=!1,s=0;s<r;s++)if(this[i+s]!=t[s]){n=!0;break}if(!n)return i}return-1}Buffer.prototype.lastIndexOf?_l("ABC").lastIndexOf("ABC")===-1&&(Buffer.prototype.lastIndexOf=uq):Buffer.prototype.lastIndexOf=uq});var pq=y((Jue,dq)=>{dq.exports=gt;function gt(t){if(!(this instanceof gt))return new gt(t);this.value=t}gt.prototype.get=function(t){for(var e=this.value,r=0;r<t.length;r++){var i=t[r];if(!Object.hasOwnProperty.call(e,i)){e=void 0;break}e=e[i]}return e};gt.prototype.set=function(t,e){for(var r=this.value,i=0;i<t.length-1;i++){var n=t[i];Object.hasOwnProperty.call(r,n)||(r[n]={}),r=r[n]}return r[t[i]]=e,e};gt.prototype.map=function(t){return hq(this.value,t,!0)};gt.prototype.forEach=function(t){return this.value=hq(this.value,t,!1),this.value};gt.prototype.reduce=function(t,e){var r=arguments.length===1,i=r?this.value:e;return this.forEach(function(n){(!this.isRoot||!r)&&(i=t.call(this,i,n))}),i};gt.prototype.deepEqual=function(t){if(arguments.length!==1)throw new Error("deepEqual requires exactly one object to compare against");var e=!0,r=t;return this.forEach(function(i){var n=function(){e=!1}.bind(this);if(!this.isRoot){if(typeof r!="object")return n();r=r[this.key]}var s=r;this.post(function(){r=s});var a=function(g){return Object.prototype.toString.call(g)};if(this.circular)gt(t).get(this.circular.path)!==s&&n();else if(typeof s!=typeof i)n();else if(s===null||i===null||s===void 0||i===void 0)s!==i&&n();else if(s.__proto__!==i.__proto__)n();else if(s!==i){if(typeof s=="function")s instanceof RegExp?s.toString()!=i.toString()&&n():s!==i&&n();else if(typeof s=="object")if(a(i)==="[object Arguments]"||a(s)==="[object Arguments]")a(s)!==a(i)&&n();else if(s instanceof Date||i instanceof Date)(!(s instanceof Date)||!(i instanceof Date)||s.getTime()!==i.getTime())&&n();else{var o=Object.keys(s),u=Object.keys(i);if(o.length!==u.length)return n();for(var f=0;f<o.length;f++){var h=o[f];Object.hasOwnProperty.call(i,h)||n()}}}}),e};gt.prototype.paths=function(){var t=[];return this.forEach(function(e){t.push(this.path)}),t};gt.prototype.nodes=function(){var t=[];return this.forEach(function(e){t.push(this.node)}),t};gt.prototype.clone=function(){var t=[],e=[];return function r(i){for(var n=0;n<t.length;n++)if(t[n]===i)return e[n];if(typeof i=="object"&&i!==null){var s=cq(i);return t.push(i),e.push(s),Object.keys(i).forEach(function(a){s[a]=r(i[a])}),t.pop(),e.pop(),s}else return i}(this.value)};function hq(t,e,r){var i=[],n=[],s=!0;return function a(o){var u=r?cq(o):o,f={},h={node:u,node_:o,path:[].concat(i),parent:n.slice(-1)[0],key:i.slice(-1)[0],isRoot:i.length===0,level:i.length,circular:null,update:function(d){h.isRoot||(h.parent.node[h.key]=d),h.node=d},delete:function(){delete h.parent.node[h.key]},remove:function(){Array.isArray(h.parent.node)?h.parent.node.splice(h.key,1):delete h.parent.node[h.key]},before:function(d){f.before=d},after:function(d){f.after=d},pre:function(d){f.pre=d},post:function(d){f.post=d},stop:function(){s=!1}};if(!s)return h;if(typeof u=="object"&&u!==null){h.isLeaf=Object.keys(u).length==0;for(var g=0;g<n.length;g++)if(n[g].node_===o){h.circular=n[g];break}}else h.isLeaf=!0;h.notLeaf=!h.isLeaf,h.notRoot=!h.isRoot;var m=e.call(h,h.node);if(m!==void 0&&h.update&&h.update(m),f.before&&f.before.call(h,h.node),typeof h.node=="object"&&h.node!==null&&!h.circular){n.push(h);var c=Object.keys(h.node);c.forEach(function(d,v){i.push(d),f.pre&&f.pre.call(h,h.node[d],d);var w=a(h.node[d]);r&&Object.hasOwnProperty.call(h.node,d)&&(h.node[d]=w.node),w.isLast=v==c.length-1,w.isFirst=v==0,f.post&&f.post.call(h,w),i.pop()}),n.pop()}return f.after&&f.after.call(h,h.node),h}(t).node}Object.keys(gt.prototype).forEach(function(t){gt[t]=function(e){var r=[].slice.call(arguments,1),i=gt(e);return i[t].apply(i,r)}});function cq(t){if(typeof t=="object"&&t!==null){var e;return Array.isArray(t)?e=[]:t instanceof Date?e=new Date(t):t instanceof Boolean?e=new Boolean(t):t instanceof Number?e=new Number(t):t instanceof String?e=new String(t):e=Object.create(Object.getPrototypeOf(t)),Object.keys(t).forEach(function(r){e[r]=t[r]}),e}else return t}});var mq=y((efe,gq)=>{var KQ=pq(),QQ=require("events").EventEmitter;gq.exports=Sa;function Sa(t){var e=Sa.saw(t,{}),r=t.call(e.handlers,e);return r!==void 0&&(e.handlers=r),e.record(),e.chain()}Sa.light=function(e){var r=Sa.saw(e,{}),i=e.call(r.handlers,r);return i!==void 0&&(r.handlers=i),r.chain()};Sa.saw=function(t,e){var r=new QQ;return r.handlers=e,r.actions=[],r.chain=function(){var i=KQ(r.handlers).map(function(n){if(this.isRoot)return n;var s=this.path;typeof n=="function"&&this.update(function(){return r.actions.push({path:s,args:[].slice.call(arguments)}),i})});return process.nextTick(function(){r.emit("begin"),r.next()}),i},r.pop=function(){return r.actions.shift()},r.next=function(){var i=r.pop();if(!i)r.emit("end");else if(!i.trap){var n=r.handlers;i.path.forEach(function(s){n=n[s]}),n.apply(r.handlers,i.args)}},r.nest=function(i){var n=[].slice.call(arguments,1),s=!0;if(typeof i=="boolean"){var s=i;i=n.shift()}var a=Sa.saw(t,{}),o=t.call(a.handlers,a);o!==void 0&&(a.handlers=o),typeof r.step<"u"&&a.record(),i.apply(a.chain(),n),s!==!1&&a.on("end",r.next)},r.record=function(){JQ(r)},["trap","down","jump"].forEach(function(i){r[i]=function(){throw new Error("To use the trap, down and jump features, please call record() first to start recording actions.")}}),r};function JQ(t){t.step=0,t.pop=function(){return t.actions[t.step++]},t.trap=function(e,r){var i=Array.isArray(e)?e:[e];t.actions.push({path:i,step:t.step,cb:r,trap:!0})},t.down=function(e){var r=(Array.isArray(e)?e:[e]).join("/"),i=t.actions.slice(t.step).map(function(s){return s.trap&&s.step<=t.step?!1:s.path.join("/")==r}).indexOf(!0);i>=0?t.step+=i:t.step=t.actions.length;var n=t.actions[t.step-1];n&&n.trap?(t.step=n.step,n.cb()):t.next()},t.jump=function(e){t.step=e,t.next()}}});var yq=y((tfe,vq)=>{vq.exports=bt;function bt(t){if(!(this instanceof bt))return new bt(t);this.buffers=t||[],this.length=this.buffers.reduce(function(e,r){return e+r.length},0)}bt.prototype.push=function(){for(var t=0;t<arguments.length;t++)if(!Buffer.isBuffer(arguments[t]))throw new TypeError("Tried to push a non-buffer");for(var t=0;t<arguments.length;t++){var e=arguments[t];this.buffers.push(e),this.length+=e.length}return this.length};bt.prototype.unshift=function(){for(var t=0;t<arguments.length;t++)if(!Buffer.isBuffer(arguments[t]))throw new TypeError("Tried to unshift a non-buffer");for(var t=0;t<arguments.length;t++){var e=arguments[t];this.buffers.unshift(e),this.length+=e.length}return this.length};bt.prototype.copy=function(t,e,r,i){return this.slice(r,i).copy(t,e,0,i-r)};bt.prototype.splice=function(t,e){var r=this.buffers,i=t>=0?t:this.length-t,n=[].slice.call(arguments,2);e===void 0?e=this.length-i:e>this.length-i&&(e=this.length-i);for(var t=0;t<n.length;t++)this.length+=n[t].length;for(var s=new bt,a=0,o=0,u=0;u<r.length&&o+r[u].length<i;u++)o+=r[u].length;if(i-o>0){var f=i-o;if(f+e<r[u].length){s.push(r[u].slice(f,f+e));for(var h=r[u],g=new Buffer(f),t=0;t<f;t++)g[t]=h[t];for(var m=new Buffer(h.length-f-e),t=f+e;t<h.length;t++)m[t-e-f]=h[t];if(n.length>0){var c=n.slice();c.unshift(g),c.push(m),r.splice.apply(r,[u,1].concat(c)),u+=c.length,n=[]}else r.splice(u,1,g,m),u+=2}else s.push(r[u].slice(f)),r[u]=r[u].slice(0,f),u++}for(n.length>0&&(r.splice.apply(r,[u,0].concat(n)),u+=n.length);s.length<e;){var d=r[u],v=d.length,w=Math.min(v,e-s.length);w===v?(s.push(d),r.splice(u,1)):(s.push(d.slice(0,w)),r[u]=r[u].slice(w))}return this.length-=s.length,s};bt.prototype.slice=function(t,e){var r=this.buffers;e===void 0&&(e=this.length),t===void 0&&(t=0),e>this.length&&(e=this.length);for(var i=0,n=0;n<r.length&&i+r[n].length<=t;n++)i+=r[n].length;for(var s=new Buffer(e-t),a=0,o=n;a<e-t&&o<r.length;o++){var u=r[o].length,f=a===0?t-i:0,h=a+u>=e-t?Math.min(f+(e-t)-a,u):u;r[o].copy(s,a,f,h),a+=h-f}return s};bt.prototype.pos=function(t){if(t<0||t>=this.length)throw new Error("oob");for(var e=t,r=0,i=null;;){if(i=this.buffers[r],e<i.length)return{buf:r,offset:e};e-=i.length,r++}};bt.prototype.get=function(e){var r=this.pos(e);return this.buffers[r.buf].get(r.offset)};bt.prototype.set=function(e,r){var i=this.pos(e);return this.buffers[i.buf].set(i.offset,r)};bt.prototype.indexOf=function(t,e){if(typeof t=="string")t=new Buffer(t);else if(!(t instanceof Buffer))throw new Error("Invalid type for a search string");if(!t.length)return 0;if(!this.length)return-1;var r=0,i=0,n=0,s,a=0;if(e){var o=this.pos(e);r=o.buf,i=o.offset,a=e}for(;;){for(;i>=this.buffers[r].length;)if(i=0,r++,r>=this.buffers.length)return-1;var u=this.buffers[r][i];if(u==t[n]){if(n==0&&(s={i:r,j:i,pos:a}),n++,n==t.length)return s.pos}else n!=0&&(r=s.i,i=s.j,a=s.pos,n=0);i++,a++}};bt.prototype.toBuffer=function(){return this.slice()};bt.prototype.toString=function(t,e,r){return this.slice(e,r).toString(t)}});var wq=y((rfe,_q)=>{_q.exports=function(t){function e(i,n){var s=r.store,a=i.split(".");a.slice(0,-1).forEach(function(u){s[u]===void 0&&(s[u]={}),s=s[u]});var o=a[a.length-1];return arguments.length==1?s[o]:s[o]=n}var r={get:function(i){return e(i)},set:function(i,n){return e(i,n)},store:t||{}};return r}});var wl=y((Pn,Cq)=>{var eJ=mq(),bq=require("events").EventEmitter,tJ=yq(),Kh=wq(),rJ=require("stream").Stream;Pn=Cq.exports=function(t,e){if(Buffer.isBuffer(t))return Pn.parse(t);var r=Pn.stream();return t&&t.pipe?t.pipe(r):t&&(t.on(e||"data",function(i){r.write(i)}),t.on("end",function(){r.end()})),r};Pn.stream=function(t){if(t)return Pn.apply(null,arguments);var e=null;function r(g,m,c){e={bytes:g,skip:c,cb:function(d){e=null,m(d)}},n()}var i=null;function n(){if(!e){h&&(f=!0);return}if(typeof e=="function")e();else{var g=i+e.bytes;if(o.length>=g){var m;i==null?(m=o.splice(0,g),e.skip||(m=m.slice())):(e.skip||(m=o.slice(i,g)),i=g),e.skip?e.cb():e.cb(m)}}}function s(g){function m(){f||g.next()}var c=Eq(function(d,v){return function(w){r(d,function(b){u.set(w,v(b)),m()})}});return c.tap=function(d){g.nest(d,u.store)},c.into=function(d,v){u.get(d)||u.set(d,{});var w=u;u=Kh(w.get(d)),g.nest(function(){v.apply(this,arguments),this.tap(function(){u=w})},u.store)},c.flush=function(){u.store={},m()},c.loop=function(d){var v=!1;g.nest(!1,function w(){this.vars=u.store,d.call(this,function(){v=!0,m()},u.store),this.tap(function(){v?g.next():w.call(this)}.bind(this))},u.store)},c.buffer=function(d,v){typeof v=="string"&&(v=u.get(v)),r(v,function(w){u.set(d,w),m()})},c.skip=function(d){typeof d=="string"&&(d=u.get(d)),r(d,function(){m()})},c.scan=function(v,w){if(typeof w=="string")w=new Buffer(w);else if(!Buffer.isBuffer(w))throw new Error("search must be a Buffer or a string");var b=0;e=function(){var C=o.indexOf(w,i+b),O=C-i-b;C!==-1?(e=null,i!=null?(u.set(v,o.slice(i,i+b+O)),i+=b+O+w.length):(u.set(v,o.slice(0,b+O)),o.splice(0,b+O+w.length)),m(),n()):O=Math.max(o.length-w.length-i-b,0),b+=O},n()},c.peek=function(d){i=0,g.nest(function(){d.call(this,u.store),this.tap(function(){i=null})})},c}var a=eJ.light(s);a.writable=!0;var o=tJ();a.write=function(g){o.push(g),n()};var u=Kh(),f=!1,h=!1;return a.end=function(){h=!0},a.pipe=rJ.prototype.pipe,Object.getOwnPropertyNames(bq.prototype).forEach(function(g){a[g]=bq.prototype[g]}),a};Pn.parse=function(e){var r=Eq(function(s,a){return function(o){if(i+s<=e.length){var u=e.slice(i,i+s);i+=s,n.set(o,a(u))}else n.set(o,null);return r}}),i=0,n=Kh();return r.vars=n.store,r.tap=function(s){return s.call(r,n.store),r},r.into=function(s,a){n.get(s)||n.set(s,{});var o=n;return n=Kh(o.get(s)),a.call(r,n.store),n=o,r},r.loop=function(s){for(var a=!1,o=function(){a=!0};a===!1;)s.call(r,o,n.store);return r},r.buffer=function(s,a){typeof a=="string"&&(a=n.get(a));var o=e.slice(i,Math.min(e.length,i+a));return i+=a,n.set(s,o),r},r.skip=function(s){return typeof s=="string"&&(s=n.get(s)),i+=s,r},r.scan=function(s,a){if(typeof a=="string")a=new Buffer(a);else if(!Buffer.isBuffer(a))throw new Error("search must be a Buffer or a string");n.set(s,null);for(var o=0;o+i<=e.length-a.length+1;o++){for(var u=0;u<a.length&&e[i+o+u]===a[u];u++);if(u===a.length)break}return n.set(s,e.slice(i,i+o)),i+=o+a.length,r},r.peek=function(s){var a=i;return s.call(r,n.store),i=a,r},r.flush=function(){return n.store={},r},r.eof=function(){return i>=e.length},r};function xq(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(256,r)*t[r];return e}function Tq(t){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(256,t.length-r-1)*t[r];return e}function iJ(t){var e=Tq(t);return(t[0]&128)==128&&(e-=Math.pow(256,t.length)),e}function nJ(t){var e=xq(t);return(t[t.length-1]&128)==128&&(e-=Math.pow(256,t.length)),e}function Eq(t){var e={};return[1,2,4,8].forEach(function(r){var i=r*8;e["word"+i+"le"]=e["word"+i+"lu"]=t(r,xq),e["word"+i+"ls"]=t(r,nJ),e["word"+i+"be"]=e["word"+i+"bu"]=t(r,Tq),e["word"+i+"bs"]=t(r,iJ)}),e.word8=e.word8u=e.word8be,e.word8s=e.word8bs,e}});var Ln=y((ife,Iw)=>{var Dw=function(){"use strict";return this===void 0}();Dw?Iw.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:Dw,propertyIsWritable:function(t,e){var r=Object.getOwnPropertyDescriptor(t,e);return!!(!r||r.writable||r.set)}}:(Sq={}.hasOwnProperty,kq={}.toString,Rq={}.constructor.prototype,qw=function(t){var e=[];for(var r in t)Sq.call(t,r)&&e.push(r);return e},Oq=function(t,e){return{value:t[e]}},Aq=function(t,e,r){return t[e]=r.value,t},Fq=function(t){return t},Nq=function(t){try{return Object(t).constructor.prototype}catch{return Rq}},Dq=function(t){try{return kq.call(t)==="[object Array]"}catch{return!1}},Iw.exports={isArray:Dq,keys:qw,names:qw,defineProperty:Aq,getDescriptor:Oq,freeze:Fq,getPrototypeOf:Nq,isES5:Dw,propertyIsWritable:function(){return!0}});var Sq,kq,Rq,qw,Oq,Aq,Fq,Nq,Dq});var Te=y((exports,module)=>{"use strict";var es5=Ln(),canEvaluate=typeof navigator>"u",errorObj={e:{}},tryCatchTarget,globalObject=typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:exports!==void 0?exports:null;function tryCatcher(){try{var t=tryCatchTarget;return tryCatchTarget=null,t.apply(this,arguments)}catch(e){return errorObj.e=e,errorObj}}function tryCatch(t){return tryCatchTarget=t,tryCatcher}var inherits=function(t,e){var r={}.hasOwnProperty;function i(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&n.charAt(n.length-1)!=="$"&&(this[n+"$"]=e.prototype[n])}return i.prototype=e.prototype,t.prototype=new i,t.prototype};function isPrimitive(t){return t==null||t===!0||t===!1||typeof t=="string"||typeof t=="number"}function isObject(t){return typeof t=="function"||typeof t=="object"&&t!==null}function maybeWrapAsError(t){return isPrimitive(t)?new Error(safeToString(t)):t}function withAppended(t,e){var r=t.length,i=new Array(r+1),n;for(n=0;n<r;++n)i[n]=t[n];return i[n]=e,i}function getDataPropertyOrDefault(t,e,r){if(es5.isES5){var i=Object.getOwnPropertyDescriptor(t,e);if(i!=null)return i.get==null&&i.set==null?i.value:r}else return{}.hasOwnProperty.call(t,e)?t[e]:void 0}function notEnumerableProp(t,e,r){if(isPrimitive(t))return t;var i={value:r,configurable:!0,enumerable:!1,writable:!0};return es5.defineProperty(t,e,i),t}function thrower(t){throw t}var inheritedDataKeys=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(n){for(var s=0;s<t.length;++s)if(t[s]===n)return!0;return!1};if(es5.isES5){var r=Object.getOwnPropertyNames;return function(n){for(var s=[],a=Object.create(null);n!=null&&!e(n);){var o;try{o=r(n)}catch{return s}for(var u=0;u<o.length;++u){var f=o[u];if(!a[f]){a[f]=!0;var h=Object.getOwnPropertyDescriptor(n,f);h!=null&&h.get==null&&h.set==null&&s.push(f)}}n=es5.getPrototypeOf(n)}return s}}else{var i={}.hasOwnProperty;return function(n){if(e(n))return[];var s=[];e:for(var a in n)if(i.call(n,a))s.push(a);else{for(var o=0;o<t.length;++o)if(i.call(t[o],a))continue e;s.push(a)}return s}}}(),thisAssignmentPattern=/this\s*\.\s*\S+\s*=/;function isClass(t){try{if(typeof t=="function"){var e=es5.names(t.prototype),r=es5.isES5&&e.length>1,i=e.length>0&&!(e.length===1&&e[0]==="constructor"),n=thisAssignmentPattern.test(t+"")&&es5.names(t).length>0;if(r||i||n)return!0}return!1}catch{return!1}}function toFastProperties(obj){function FakeConstructor(){}FakeConstructor.prototype=obj;for(var l=8;l--;)new FakeConstructor;return obj}var rident=/^[a-z$_][a-z$_0-9]*$/i;function isIdentifier(t){return rident.test(t)}function filledRange(t,e,r){for(var i=new Array(t),n=0;n<t;++n)i[n]=e+n+r;return i}function safeToString(t){try{return t+""}catch{return"[no string representation]"}}function isError(t){return t!==null&&typeof t=="object"&&typeof t.message=="string"&&typeof t.name=="string"}function markAsOriginatingFromRejection(t){try{notEnumerableProp(t,"isOperational",!0)}catch{}}function originatesFromRejection(t){return t==null?!1:t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0}function canAttachTrace(t){return isError(t)&&es5.propertyIsWritable(t,"stack")}var ensureErrorObject=function(){return"stack"in new Error?function(t){return canAttachTrace(t)?t:new Error(safeToString(t))}:function(t){if(canAttachTrace(t))return t;try{throw new Error(safeToString(t))}catch(e){return e}}}();function classString(t){return{}.toString.call(t)}function copyDescriptors(t,e,r){for(var i=es5.names(t),n=0;n<i.length;++n){var s=i[n];if(r(s))try{es5.defineProperty(e,s,es5.getDescriptor(t,s))}catch{}}}var asArray=function(t){return es5.isArray(t)?t:null};typeof Symbol<"u"&&Symbol.iterator&&(ArrayFrom=typeof Array.from=="function"?function(t){return Array.from(t)}:function(t){for(var e=[],r=t[Symbol.iterator](),i;!(i=r.next()).done;)e.push(i.value);return e},asArray=function(t){return es5.isArray(t)?t:t!=null&&typeof t[Symbol.iterator]=="function"?ArrayFrom(t):null});var ArrayFrom,isNode=typeof process<"u"&&classString(process).toLowerCase()==="[object process]",hasEnvVariables=typeof process<"u"&&typeof process.env<"u";function env(t){return hasEnvVariables?process.env[t]:void 0}function getNativePromise(){if(typeof Promise=="function")try{var t=new Promise(function(){});if({}.toString.call(t)==="[object Promise]")return Promise}catch{}}function domainBind(t,e){return t.bind(e)}var ret={isClass,isIdentifier,inheritedDataKeys,getDataPropertyOrDefault,thrower,isArray:es5.isArray,asArray,notEnumerableProp,isPrimitive,isObject,isError,canEvaluate,errorObj,tryCatch,inherits,withAppended,maybeWrapAsError,toFastProperties,filledRange,toString:safeToString,canAttachTrace,ensureErrorObject,originatesFromRejection,markAsOriginatingFromRejection,classString,copyDescriptors,hasDevTools:typeof chrome<"u"&&chrome&&typeof chrome.loadTimes=="function",isNode,hasEnvVariables,env,global:globalObject,getNativePromise,domainBind};ret.isRecentNode=ret.isNode&&function(){var t=process.versions.node.split(".").map(Number);return t[0]===0&&t[1]>10||t[0]>0}();ret.isNode&&ret.toFastProperties(process);try{throw new Error}catch(t){ret.lastLineError=t}module.exports=ret});var Lq=y((nfe,Pq)=>{"use strict";var Pw=Te(),Bn,sJ=function(){throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)},Mw=Pw.getNativePromise();Pw.isNode&&typeof MutationObserver>"u"?(qq=global.setImmediate,Iq=process.nextTick,Bn=Pw.isRecentNode?function(t){qq.call(global,t)}:function(t){Iq.call(process,t)}):typeof Mw=="function"&&typeof Mw.resolve=="function"?(Mq=Mw.resolve(),Bn=function(t){Mq.then(t)}):typeof MutationObserver<"u"&&!(typeof window<"u"&&window.navigator&&(window.navigator.standalone||window.cordova))?Bn=function(){var t=document.createElement("div"),e={attributes:!0},r=!1,i=document.createElement("div"),n=new MutationObserver(function(){t.classList.toggle("foo"),r=!1});n.observe(i,e);var s=function(){r||(r=!0,i.classList.toggle("foo"))};return function(o){var u=new MutationObserver(function(){u.disconnect(),o()});u.observe(t,e),s()}}():typeof setImmediate<"u"?Bn=function(t){setImmediate(t)}:typeof setTimeout<"u"?Bn=function(t){setTimeout(t,0)}:Bn=sJ;var qq,Iq,Mq;Pq.exports=Bn});var jq=y((sfe,Bq)=>{"use strict";function aJ(t,e,r,i,n){for(var s=0;s<n;++s)r[s+i]=t[s+e],t[s+e]=void 0}function Bi(t){this._capacity=t,this._length=0,this._front=0}Bi.prototype._willBeOverCapacity=function(t){return this._capacity<t};Bi.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var r=this._front+e&this._capacity-1;this[r]=t,this._length=e+1};Bi.prototype.push=function(t,e,r){var i=this.length()+3;if(this._willBeOverCapacity(i)){this._pushOne(t),this._pushOne(e),this._pushOne(r);return}var n=this._front+i-3;this._checkCapacity(i);var s=this._capacity-1;this[n+0&s]=t,this[n+1&s]=e,this[n+2&s]=r,this._length=i};Bi.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e};Bi.prototype.length=function(){return this._length};Bi.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)};Bi.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var r=this._front,i=this._length,n=r+i&e-1;aJ(this,0,this,e,n)};Bq.exports=Bi});var Vq=y((afe,Lw)=>{"use strict";var zq;try{throw new Error}catch(t){zq=t}var oJ=Lq(),Wq=jq(),Xq=Te();function Je(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new Wq(16),this._normalQueue=new Wq(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=oJ}Je.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e};Je.prototype.hasCustomScheduler=function(){return this._customScheduler};Je.prototype.enableTrampoline=function(){this._trampolineEnabled=!0};Je.prototype.disableTrampolineIfNecessary=function(){Xq.hasDevTools&&(this._trampolineEnabled=!1)};Je.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues};Je.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+`
`),process.exit(2)):this.throwLater(t)};Je.prototype.throwLater=function(t,e){if(arguments.length===1&&(e=t,t=function(){throw e}),typeof setTimeout<"u")setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch{throw new Error(`No async scheduler available

    See http://goo.gl/MqrFmX
`)}};function $q(t,e,r){this._lateQueue.push(t,e,r),this._queueTick()}function Hq(t,e,r){this._normalQueue.push(t,e,r),this._queueTick()}function Uq(t){this._normalQueue._pushOne(t),this._queueTick()}Xq.hasDevTools?(Je.prototype.invokeLater=function(t,e,r){this._trampolineEnabled?$q.call(this,t,e,r):this._schedule(function(){setTimeout(function(){t.call(e,r)},100)})},Je.prototype.invoke=function(t,e,r){this._trampolineEnabled?Hq.call(this,t,e,r):this._schedule(function(){t.call(e,r)})},Je.prototype.settlePromises=function(t){this._trampolineEnabled?Uq.call(this,t):this._schedule(function(){t._settlePromises()})}):(Je.prototype.invokeLater=$q,Je.prototype.invoke=Hq,Je.prototype.settlePromises=Uq);Je.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if(typeof e!="function"){e._settlePromises();continue}var r=t.shift(),i=t.shift();e.call(r,i)}};Je.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)};Je.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))};Je.prototype._reset=function(){this._isTickUsed=!1};Lw.exports=Je;Lw.exports.firstLineError=zq});var Kr=y((ofe,Yq)=>{"use strict";var Ww=Ln(),lJ=Ww.freeze,Gq=Te(),Zq=Gq.inherits,Ra=Gq.notEnumerableProp;function Oa(t,e){function r(i){if(!(this instanceof r))return new r(i);Ra(this,"message",typeof i=="string"?i:e),Ra(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return Zq(r,Error),r}var Bw,jw,uJ=Oa("Warning","warning"),fJ=Oa("CancellationError","cancellation error"),hJ=Oa("TimeoutError","timeout error"),xl=Oa("AggregateError","aggregate error");try{Bw=TypeError,jw=RangeError}catch{Bw=Oa("TypeError","type error"),jw=Oa("RangeError","range error")}var Qh="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" ");for(ka=0;ka<Qh.length;++ka)typeof Array.prototype[Qh[ka]]=="function"&&(xl.prototype[Qh[ka]]=Array.prototype[Qh[ka]]);var ka;Ww.defineProperty(xl.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0});xl.prototype.isOperational=!0;var Jh=0;xl.prototype.toString=function(){var t=Array(Jh*4+1).join(" "),e=`
`+t+`AggregateError of:
`;Jh++,t=Array(Jh*4+1).join(" ");for(var r=0;r<this.length;++r){for(var i=this[r]===this?"[Circular AggregateError]":this[r]+"",n=i.split(`
`),s=0;s<n.length;++s)n[s]=t+n[s];i=n.join(`
`),e+=i+`
`}return Jh--,e};function bl(t){if(!(this instanceof bl))return new bl(t);Ra(this,"name","OperationalError"),Ra(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(Ra(this,"message",t.message),Ra(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}Zq(bl,Error);var jn=Error.__BluebirdErrorTypes__;jn||(jn=lJ({CancellationError:fJ,TimeoutError:hJ,OperationalError:bl,RejectionError:bl,AggregateError:xl}),Ww.defineProperty(Error,"__BluebirdErrorTypes__",{value:jn,writable:!1,enumerable:!1,configurable:!1}));Yq.exports={Error,TypeError:Bw,RangeError:jw,CancellationError:jn.CancellationError,OperationalError:jn.OperationalError,TimeoutError:jn.TimeoutError,AggregateError:jn.AggregateError,Warning:uJ}});var Qq=y((lfe,Kq)=>{"use strict";Kq.exports=function(t,e){var r=Te(),i=r.errorObj,n=r.isObject;function s(g,m){if(n(g)){if(g instanceof t)return g;var c=o(g);if(c===i){m&&m._pushContext();var d=t.reject(c.e);return m&&m._popContext(),d}else if(typeof c=="function"){if(f(g)){var d=new t(e);return g._then(d._fulfill,d._reject,void 0,d,null),d}return h(g,c,m)}}return g}function a(g){return g.then}function o(g){try{return a(g)}catch(m){return i.e=m,i}}var u={}.hasOwnProperty;function f(g){try{return u.call(g,"_promise0")}catch{return!1}}function h(g,m,c){var d=new t(e),v=d;c&&c._pushContext(),d._captureStackTrace(),c&&c._popContext();var w=!0,b=r.tryCatch(m).call(g,C,O);w=!1,d&&b===i&&(d._rejectCallback(b.e,!0,!0),d=null);function C(R){!d||(d._resolveCallback(R),d=null)}function O(R){!d||(d._rejectCallback(R,w,!0),d=null)}return v}return s}});var eI=y((ufe,Jq)=>{"use strict";Jq.exports=function(t,e,r,i,n){var s=Te(),a=s.isArray;function o(f){switch(f){case-2:return[];case-3:return{}}}function u(f){var h=this._promise=new t(e);f instanceof t&&h._propagateFrom(f,3),h._setOnCancel(this),this._values=f,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.inherits(u,n),u.prototype.length=function(){return this._length},u.prototype.promise=function(){return this._promise},u.prototype._init=function f(h,g){var m=r(this._values,this._promise);if(m instanceof t){m=m._target();var c=m._bitField;if(this._values=m,(c&50397184)===0)return this._promise._setAsyncGuaranteed(),m._then(f,this._reject,void 0,this,g);if((c&33554432)!==0)m=m._value();else return(c&16777216)!==0?this._reject(m._reason()):this._cancel()}if(m=s.asArray(m),m===null){var d=i("expecting an array or an iterable object but got "+s.classString(m)).reason();this._promise._rejectCallback(d,!1);return}if(m.length===0){g===-5?this._resolveEmptyArray():this._resolve(o(g));return}this._iterate(m)},u.prototype._iterate=function(f){var h=this.getActualLength(f.length);this._length=h,this._values=this.shouldCopyValues()?new Array(h):this._values;for(var g=this._promise,m=!1,c=null,d=0;d<h;++d){var v=r(f[d],g);v instanceof t?(v=v._target(),c=v._bitField):c=null,m?c!==null&&v.suppressUnhandledRejections():c!==null?(c&50397184)===0?(v._proxy(this,d),this._values[d]=v):(c&33554432)!==0?m=this._promiseFulfilled(v._value(),d):(c&16777216)!==0?m=this._promiseRejected(v._reason(),d):m=this._promiseCancelled(d):m=this._promiseFulfilled(v,d)}m||g._setAsyncGuaranteed()},u.prototype._isResolved=function(){return this._values===null},u.prototype._resolve=function(f){this._values=null,this._promise._fulfill(f)},u.prototype._cancel=function(){this._isResolved()||!this._promise._isCancellable()||(this._values=null,this._promise._cancel())},u.prototype._reject=function(f){this._values=null,this._promise._rejectCallback(f,!1)},u.prototype._promiseFulfilled=function(f,h){this._values[h]=f;var g=++this._totalResolved;return g>=this._length?(this._resolve(this._values),!0):!1},u.prototype._promiseCancelled=function(){return this._cancel(),!0},u.prototype._promiseRejected=function(f){return this._totalResolved++,this._reject(f),!0},u.prototype._resultCancelled=function(){if(!this._isResolved()){var f=this._values;if(this._cancel(),f instanceof t)f.cancel();else for(var h=0;h<f.length;++h)f[h]instanceof t&&f[h].cancel()}},u.prototype.shouldCopyValues=function(){return!0},u.prototype.getActualLength=function(f){return f},u}});var rI=y((ffe,tI)=>{"use strict";tI.exports=function(t){var e=!1,r=[];t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){};function i(){this._trace=new i.CapturedTrace(s())}i.prototype._pushContext=function(){this._trace!==void 0&&(this._trace._promiseCreated=null,r.push(this._trace))},i.prototype._popContext=function(){if(this._trace!==void 0){var a=r.pop(),o=a._promiseCreated;return a._promiseCreated=null,o}return null};function n(){if(e)return new i}function s(){var a=r.length-1;if(a>=0)return r[a]}return i.CapturedTrace=null,i.create=n,i.deactivateLongStackTraces=function(){},i.activateLongStackTraces=function(){var a=t.prototype._pushContext,o=t.prototype._popContext,u=t._peekContext,f=t.prototype._peekContext,h=t.prototype._promiseCreated;i.deactivateLongStackTraces=function(){t.prototype._pushContext=a,t.prototype._popContext=o,t._peekContext=u,t.prototype._peekContext=f,t.prototype._promiseCreated=h,e=!1},e=!0,t.prototype._pushContext=i.prototype._pushContext,t.prototype._popContext=i.prototype._popContext,t._peekContext=t.prototype._peekContext=s,t.prototype._promiseCreated=function(){var g=this._peekContext();g&&g._promiseCreated==null&&(g._promiseCreated=this)}},i}});var nI=y((hfe,iI)=>{"use strict";iI.exports=function(t,e){var r=t._getDomain,i=t._async,n=Kr().Warning,s=Te(),a=s.canAttachTrace,o,u,f=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,h=/\((?:timers\.js):\d+:\d+\)/,g=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,m=null,c=null,d=!1,v,w=!!(s.env("BLUEBIRD_DEBUG")!=0&&(s.env("BLUEBIRD_DEBUG")||s.env("NODE_ENV")==="development")),b=!!(s.env("BLUEBIRD_WARNINGS")!=0&&(w||s.env("BLUEBIRD_WARNINGS"))),C=!!(s.env("BLUEBIRD_LONG_STACK_TRACES")!=0&&(w||s.env("BLUEBIRD_LONG_STACK_TRACES"))),O=s.env("BLUEBIRD_W_FORGOTTEN_RETURN")!=0&&(b||!!s.env("BLUEBIRD_W_FORGOTTEN_RETURN"));t.prototype.suppressUnhandledRejections=function(){var D=this._target();D._bitField=D._bitField&-1048577|524288},t.prototype._ensurePossibleRejectionHandled=function(){(this._bitField&524288)===0&&(this._setRejectionIsUnhandled(),i.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){Rr("rejectionHandled",o,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=this._bitField|268435456},t.prototype._returnedNonUndefined=function(){return(this._bitField&268435456)!==0},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var D=this._settledValue();this._setUnhandledRejectionIsNotified(),Rr("unhandledRejection",u,D,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|262144},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},t.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&262144)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|1048576},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(this._bitField&1048576)>0},t.prototype._warn=function(D,p,_){return Ce(D,p,_||this)},t.onPossiblyUnhandledRejection=function(D){var p=r();u=typeof D=="function"?p===null?D:s.domainBind(p,D):void 0},t.onUnhandledRejectionHandled=function(D){var p=r();o=typeof D=="function"?p===null?D:s.domainBind(p,D):void 0};var R=function(){};t.longStackTraces=function(){if(i.haveItemsQueued()&&!Q.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);if(!Q.longStackTraces&&Ja()){var D=t.prototype._captureStackTrace,p=t.prototype._attachExtraTrace;Q.longStackTraces=!0,R=function(){if(i.haveItemsQueued()&&!Q.longStackTraces)throw new Error(`cannot enable long stack traces after promises have been created

    See http://goo.gl/MqrFmX
`);t.prototype._captureStackTrace=D,t.prototype._attachExtraTrace=p,e.deactivateLongStackTraces(),i.enableTrampoline(),Q.longStackTraces=!1},t.prototype._captureStackTrace=V,t.prototype._attachExtraTrace=Y,e.activateLongStackTraces(),i.disableTrampolineIfNecessary()}},t.hasLongStackTraces=function(){return Q.longStackTraces&&Ja()};var M=function(){try{if(typeof CustomEvent=="function"){var D=new CustomEvent("CustomEvent");return s.global.dispatchEvent(D),function(p,_){var x=new CustomEvent(p.toLowerCase(),{detail:_,cancelable:!0});return!s.global.dispatchEvent(x)}}else if(typeof Event=="function"){var D=new Event("CustomEvent");return s.global.dispatchEvent(D),function(_,x){var S=new Event(_.toLowerCase(),{cancelable:!0});return S.detail=x,!s.global.dispatchEvent(S)}}else{var D=document.createEvent("CustomEvent");return D.initCustomEvent("testingtheevent",!1,!0,{}),s.global.dispatchEvent(D),function(_,x){var S=document.createEvent("CustomEvent");return S.initCustomEvent(_.toLowerCase(),!1,!0,x),!s.global.dispatchEvent(S)}}}catch{}return function(){return!1}}(),X=function(){return s.isNode?function(){return process.emit.apply(process,arguments)}:s.global?function(D){var p="on"+D.toLowerCase(),_=s.global[p];return _?(_.apply(s.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}();function H(D,p){return{promise:p}}var W={promiseCreated:H,promiseFulfilled:H,promiseRejected:H,promiseResolved:H,promiseCancelled:H,promiseChained:function(D,p,_){return{promise:p,child:_}},warning:function(D,p){return{warning:p}},unhandledRejection:function(D,p,_){return{reason:p,promise:_}},rejectionHandled:H},P=function(D){var p=!1;try{p=X.apply(null,arguments)}catch(x){i.throwLater(x),p=!0}var _=!1;try{_=M(D,W[D].apply(null,arguments))}catch(x){i.throwLater(x),_=!0}return _||p};t.config=function(D){if(D=Object(D),"longStackTraces"in D&&(D.longStackTraces?t.longStackTraces():!D.longStackTraces&&t.hasLongStackTraces()&&R()),"warnings"in D){var p=D.warnings;Q.warnings=!!p,O=Q.warnings,s.isObject(p)&&"wForgottenReturn"in p&&(O=!!p.wForgottenReturn)}if("cancellation"in D&&D.cancellation&&!Q.cancellation){if(i.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=B,t.prototype._propagateFrom=T,t.prototype._onCancel=A,t.prototype._setOnCancel=$,t.prototype._attachCancellationCallback=E,t.prototype._execute=q,N=T,Q.cancellation=!0}return"monitoring"in D&&(D.monitoring&&!Q.monitoring?(Q.monitoring=!0,t.prototype._fireEvent=P):!D.monitoring&&Q.monitoring&&(Q.monitoring=!1,t.prototype._fireEvent=G)),t};function G(){return!1}t.prototype._fireEvent=G,t.prototype._execute=function(D,p,_){try{D(p,_)}catch(x){return x}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(D){},t.prototype._attachCancellationCallback=function(D){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(D,p){};function q(D,p,_){var x=this;try{D(p,_,function(S){if(typeof S!="function")throw new TypeError("onCancel must be a function, got: "+s.toString(S));x._attachCancellationCallback(S)})}catch(S){return S}}function E(D){if(!this._isCancellable())return this;var p=this._onCancel();p!==void 0?s.isArray(p)?p.push(D):this._setOnCancel([p,D]):this._setOnCancel(D)}function A(){return this._onCancelField}function $(D){this._onCancelField=D}function B(){this._cancellationParent=void 0,this._onCancelField=void 0}function T(D,p){if((p&1)!==0){this._cancellationParent=D;var _=D._branchesRemainingToCancel;_===void 0&&(_=0),D._branchesRemainingToCancel=_+1}(p&2)!==0&&D._isBound()&&this._setBoundTo(D._boundTo)}function k(D,p){(p&2)!==0&&D._isBound()&&this._setBoundTo(D._boundTo)}var N=k;function j(){var D=this._boundTo;return D!==void 0&&D instanceof t?D.isFulfilled()?D.value():void 0:D}function V(){this._trace=new or(this._peekContext())}function Y(D,p){if(a(D)){var _=this._trace;if(_!==void 0&&p&&(_=_._parent),_!==void 0)_.attachExtraTrace(D);else if(!D.__stackCleaned__){var x=mt(D);s.notEnumerableProp(D,"stack",x.message+`
`+x.stack.join(`
`)),s.notEnumerableProp(D,"__stackCleaned__",!0)}}}function J(D,p,_,x,S){if(D===void 0&&p!==null&&O){if(S!==void 0&&S._returnedNonUndefined()||(x._bitField&65535)===0)return;_&&(_=_+" ");var I="",F="";if(p._trace){for(var L=p._trace.stack.split(`
`),U=Se(L),z=U.length-1;z>=0;--z){var ee=U[z];if(!h.test(ee)){var ie=ee.match(g);ie&&(I="at "+ie[1]+":"+ie[2]+":"+ie[3]+" ");break}}if(U.length>0){for(var ne=U[0],z=0;z<L.length;++z)if(L[z]===ne){z>0&&(F=`
`+L[z-1]);break}}}var ce="a promise was created in a "+_+"handler "+I+"but was not returned from it, see http://goo.gl/rRqMUw"+F;x._warn(ce,!0,p)}}function te(D,p){var _=D+" is deprecated and will be removed in a future version.";return p&&(_+=" Use "+p+" instead."),Ce(_)}function Ce(D,p,_){if(!!Q.warnings){var x=new n(D),S;if(p)_._attachExtraTrace(x);else if(Q.longStackTraces&&(S=t._peekContext()))S.attachExtraTrace(x);else{var I=mt(x);x.stack=I.message+`
`+I.stack.join(`
`)}P("warning",x)||ar(x,"",!0)}}function xe(D,p){for(var _=0;_<p.length-1;++_)p[_].push("From previous event:"),p[_]=p[_].join(`
`);return _<p.length&&(p[_]=p[_].join(`
`)),D+`
`+p.join(`
`)}function he(D){for(var p=0;p<D.length;++p)(D[p].length===0||p+1<D.length&&D[p][0]===D[p+1][0])&&(D.splice(p,1),p--)}function ae(D){for(var p=D[0],_=1;_<D.length;++_){for(var x=D[_],S=p.length-1,I=p[S],F=-1,L=x.length-1;L>=0;--L)if(x[L]===I){F=L;break}for(var L=F;L>=0;--L){var U=x[L];if(p[S]===U)p.pop(),S--;else break}p=x}}function Se(D){for(var p=[],_=0;_<D.length;++_){var x=D[_],S=x==="    (No stack trace)"||m.test(x),I=S&&rs(x);S&&!I&&(d&&x.charAt(0)!==" "&&(x="    "+x),p.push(x))}return p}function tt(D){for(var p=D.stack.replace(/\s+$/g,"").split(`
`),_=0;_<p.length;++_){var x=p[_];if(x==="    (No stack trace)"||m.test(x))break}return _>0&&D.name!="SyntaxError"&&(p=p.slice(_)),p}function mt(D){var p=D.stack,_=D.toString();return p=typeof p=="string"&&p.length>0?tt(D):["    (No stack trace)"],{message:_,stack:D.name=="SyntaxError"?p:Se(p)}}function ar(D,p,_){if(typeof console<"u"){var x;if(s.isObject(D)){var S=D.stack;x=p+c(S,D)}else x=p+String(D);typeof v=="function"?v(x,_):(typeof console.log=="function"||typeof console.log=="object")&&console.log(x)}}function Rr(D,p,_,x){var S=!1;try{typeof p=="function"&&(S=!0,D==="rejectionHandled"?p(x):p(_,x))}catch(I){i.throwLater(I)}D==="unhandledRejection"?!P(D,_,x)&&!S&&ar(_,"Unhandled rejection "):P(D,x)}function oi(D){var p;if(typeof D=="function")p="[function "+(D.name||"anonymous")+"]";else{p=D&&typeof D.toString=="function"?D.toString():s.toString(D);var _=/\[object [a-zA-Z0-9$_]+\]/;if(_.test(p))try{var x=JSON.stringify(D);p=x}catch{}p.length===0&&(p="(empty array)")}return"(<"+lu(p)+">, no stack trace)"}function lu(D){var p=41;return D.length<p?D:D.substr(0,p-3)+"..."}function Ja(){return typeof fu=="function"}var rs=function(){return!1},nd=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function Or(D){var p=D.match(nd);if(p)return{fileName:p[1],line:parseInt(p[2],10)}}function uu(D,p){if(!!Ja()){for(var _=D.stack.split(`
`),x=p.stack.split(`
`),S=-1,I=-1,F,L,U=0;U<_.length;++U){var z=Or(_[U]);if(z){F=z.fileName,S=z.line;break}}for(var U=0;U<x.length;++U){var z=Or(x[U]);if(z){L=z.fileName,I=z.line;break}}S<0||I<0||!F||!L||F!==L||S>=I||(rs=function(ee){if(f.test(ee))return!0;var ie=Or(ee);return!!(ie&&ie.fileName===F&&S<=ie.line&&ie.line<=I)})}}function or(D){this._parent=D,this._promisesCreated=0;var p=this._length=1+(D===void 0?0:D._length);fu(this,or),p>32&&this.uncycle()}s.inherits(or,Error),e.CapturedTrace=or,or.prototype.uncycle=function(){var D=this._length;if(!(D<2)){for(var p=[],_={},x=0,S=this;S!==void 0;++x)p.push(S),S=S._parent;D=this._length=x;for(var x=D-1;x>=0;--x){var I=p[x].stack;_[I]===void 0&&(_[I]=x)}for(var x=0;x<D;++x){var F=p[x].stack,L=_[F];if(L!==void 0&&L!==x){L>0&&(p[L-1]._parent=void 0,p[L-1]._length=1),p[x]._parent=void 0,p[x]._length=1;var U=x>0?p[x-1]:this;L<D-1?(U._parent=p[L+1],U._parent.uncycle(),U._length=U._parent._length+1):(U._parent=void 0,U._length=1);for(var z=U._length+1,ee=x-2;ee>=0;--ee)p[ee]._length=z,z++;return}}}},or.prototype.attachExtraTrace=function(D){if(!D.__stackCleaned__){this.uncycle();for(var p=mt(D),_=p.message,x=[p.stack],S=this;S!==void 0;)x.push(Se(S.stack.split(`
`))),S=S._parent;ae(x),he(x),s.notEnumerableProp(D,"stack",xe(_,x)),s.notEnumerableProp(D,"__stackCleaned__",!0)}};var fu=function(){var p=/^\s*at\s*/,_=function(F,L){return typeof F=="string"?F:L.name!==void 0&&L.message!==void 0?L.toString():oi(L)};if(typeof Error.stackTraceLimit=="number"&&typeof Error.captureStackTrace=="function"){Error.stackTraceLimit+=6,m=p,c=_;var x=Error.captureStackTrace;return rs=function(F){return f.test(F)},function(F,L){Error.stackTraceLimit+=6,x(F,L),Error.stackTraceLimit-=6}}var S=new Error;if(typeof S.stack=="string"&&S.stack.split(`
`)[0].indexOf("stackDetection@")>=0)return m=/@/,c=_,d=!0,function(L){L.stack=new Error().stack};var I;try{throw new Error}catch(F){I="stack"in F}return!("stack"in S)&&I&&typeof Error.stackTraceLimit=="number"?(m=p,c=_,function(L){Error.stackTraceLimit+=6;try{throw new Error}catch(U){L.stack=U.stack}Error.stackTraceLimit-=6}):(c=function(F,L){return typeof F=="string"?F:(typeof L=="object"||typeof L=="function")&&L.name!==void 0&&L.message!==void 0?L.toString():oi(L)},null)}([]);typeof console<"u"&&typeof console.warn<"u"&&(v=function(D){console.warn(D)},s.isNode&&process.stderr.isTTY?v=function(D,p){var _=p?"\x1B[33m":"\x1B[31m";console.warn(_+D+`\x1B[0m
`)}:!s.isNode&&typeof new Error().stack=="string"&&(v=function(D,p){console.warn("%c"+D,p?"color: darkorange":"color: red")}));var Q={warnings:b,longStackTraces:!1,cancellation:!1,monitoring:!1};return C&&t.longStackTraces(),{longStackTraces:function(){return Q.longStackTraces},warnings:function(){return Q.warnings},cancellation:function(){return Q.cancellation},monitoring:function(){return Q.monitoring},propagateFromFunction:function(){return N},boundValueFunction:function(){return j},checkForgottenReturns:J,setBounds:uu,warn:Ce,deprecated:te,CapturedTrace:or,fireDomEvent:M,fireGlobalEvent:X}}});var aI=y((cfe,sI)=>{"use strict";sI.exports=function(t,e){var r=Te(),i=t.CancellationError,n=r.errorObj;function s(g,m,c){this.promise=g,this.type=m,this.handler=c,this.called=!1,this.cancelPromise=null}s.prototype.isFinallyHandler=function(){return this.type===0};function a(g){this.finallyHandler=g}a.prototype._resultCancelled=function(){o(this.finallyHandler)};function o(g,m){return g.cancelPromise!=null?(arguments.length>1?g.cancelPromise._reject(m):g.cancelPromise._cancel(),g.cancelPromise=null,!0):!1}function u(){return h.call(this,this.promise._target()._settledValue())}function f(g){if(!o(this,g))return n.e=g,n}function h(g){var m=this.promise,c=this.handler;if(!this.called){this.called=!0;var d=this.isFinallyHandler()?c.call(m._boundValue()):c.call(m._boundValue(),g);if(d!==void 0){m._setReturnedNonUndefined();var v=e(d,m);if(v instanceof t){if(this.cancelPromise!=null)if(v._isCancelled()){var w=new i("late cancellation observer");return m._attachExtraTrace(w),n.e=w,n}else v.isPending()&&v._attachCancellationCallback(new a(this));return v._then(u,f,void 0,this,void 0)}}}return m.isRejected()?(o(this),n.e=g,n):(o(this),g)}return t.prototype._passThrough=function(g,m,c,d){return typeof g!="function"?this.then():this._then(c,d,void 0,new s(this,m,g),void 0)},t.prototype.lastly=t.prototype.finally=function(g){return this._passThrough(g,0,h,h)},t.prototype.tap=function(g){return this._passThrough(g,1,h)},s}});var lI=y((dfe,oI)=>{"use strict";oI.exports=function(t){var e=Te(),r=Ln().keys,i=e.tryCatch,n=e.errorObj;function s(a,o,u){return function(f){var h=u._boundValue();e:for(var g=0;g<a.length;++g){var m=a[g];if(m===Error||m!=null&&m.prototype instanceof Error){if(f instanceof m)return i(o).call(h,f)}else if(typeof m=="function"){var c=i(m).call(h,f);if(c===n)return c;if(c)return i(o).call(h,f)}else if(e.isObject(f)){for(var d=r(m),v=0;v<d.length;++v){var w=d[v];if(m[w]!=f[w])continue e}return i(o).call(h,f)}}return t}}return s}});var $w=y((pfe,hI)=>{"use strict";var uI=Te(),cJ=uI.maybeWrapAsError,dJ=Kr(),pJ=dJ.OperationalError,fI=Ln();function gJ(t){return t instanceof Error&&fI.getPrototypeOf(t)===Error.prototype}var mJ=/^(?:name|message|stack|cause)$/;function vJ(t){var e;if(gJ(t)){e=new pJ(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var r=fI.keys(t),i=0;i<r.length;++i){var n=r[i];mJ.test(n)||(e[n]=t[n])}return e}return uI.markAsOriginatingFromRejection(t),t}function yJ(t,e){return function(r,i){if(t!==null){if(r){var n=vJ(cJ(r));t._attachExtraTrace(n),t._reject(n)}else if(!e)t._fulfill(i);else{for(var s=arguments.length,a=new Array(Math.max(s-1,0)),o=1;o<s;++o)a[o-1]=arguments[o];t._fulfill(a)}t=null}}}hI.exports=yJ});var dI=y((gfe,cI)=>{"use strict";cI.exports=function(t,e,r,i,n){var s=Te(),a=s.tryCatch;t.method=function(o){if(typeof o!="function")throw new t.TypeError("expecting a function but got "+s.classString(o));return function(){var u=new t(e);u._captureStackTrace(),u._pushContext();var f=a(o).apply(this,arguments),h=u._popContext();return n.checkForgottenReturns(f,h,"Promise.method",u),u._resolveFromSyncValue(f),u}},t.attempt=t.try=function(o){if(typeof o!="function")return i("expecting a function but got "+s.classString(o));var u=new t(e);u._captureStackTrace(),u._pushContext();var f;if(arguments.length>1){n.deprecated("calling Promise.try with more than 1 argument");var h=arguments[1],g=arguments[2];f=s.isArray(h)?a(o).apply(g,h):a(o).call(g,h)}else f=a(o)();var m=u._popContext();return n.checkForgottenReturns(f,m,"Promise.try",u),u._resolveFromSyncValue(f),u},t.prototype._resolveFromSyncValue=function(o){o===s.errorObj?this._rejectCallback(o.e,!1):this._resolveCallback(o,!0)}}});var gI=y((mfe,pI)=>{"use strict";pI.exports=function(t,e,r,i){var n=!1,s=function(f,h){this._reject(h)},a=function(f,h){h.promiseRejectionQueued=!0,h.bindingPromise._then(s,s,null,this,f)},o=function(f,h){(this._bitField&50397184)===0&&this._resolveCallback(h.target)},u=function(f,h){h.promiseRejectionQueued||this._reject(f)};t.prototype.bind=function(f){n||(n=!0,t.prototype._propagateFrom=i.propagateFromFunction(),t.prototype._boundValue=i.boundValueFunction());var h=r(f),g=new t(e);g._propagateFrom(this,1);var m=this._target();if(g._setBoundTo(h),h instanceof t){var c={promiseRejectionQueued:!1,promise:g,target:m,bindingPromise:h};m._then(e,a,void 0,g,c),h._then(o,u,void 0,g,c),g._setOnCancel(h)}else g._resolveCallback(m);return g},t.prototype._setBoundTo=function(f){f!==void 0?(this._bitField=this._bitField|2097152,this._boundTo=f):this._bitField=this._bitField&-2097153},t.prototype._isBound=function(){return(this._bitField&2097152)===2097152},t.bind=function(f,h){return t.resolve(h).bind(f)}}});var vI=y((vfe,mI)=>{"use strict";mI.exports=function(t,e,r,i){var n=Te(),s=n.tryCatch,a=n.errorObj,o=t._async;t.prototype.break=t.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var u=this,f=u;u._isCancellable();){if(!u._cancelBy(f)){f._isFollowing()?f._followee().cancel():f._cancelBranched();break}var h=u._cancellationParent;if(h==null||!h._isCancellable()){u._isFollowing()?u._followee().cancel():u._cancelBranched();break}else u._isFollowing()&&u._followee().cancel(),u._setWillBeCancelled(),f=u,u=h}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return this._branchesRemainingToCancel===void 0||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(u){return u===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){!this._isCancellable()||(this._setCancelled(),o.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(u,f){if(n.isArray(u))for(var h=0;h<u.length;++h)this._doInvokeOnCancel(u[h],f);else if(u!==void 0)if(typeof u=="function"){if(!f){var g=s(u).call(this._boundValue());g===a&&(this._attachExtraTrace(g.e),o.throwLater(g.e))}}else u._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var u=this._onCancel();this._unsetOnCancel(),o.invoke(this._doInvokeOnCancel,this,u)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}});var _I=y((yfe,yI)=>{"use strict";yI.exports=function(t){function e(){return this.value}function r(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(i){return i instanceof t&&i.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:i},void 0)},t.prototype.throw=t.prototype.thenThrow=function(i){return this._then(r,void 0,void 0,{reason:i},void 0)},t.prototype.catchThrow=function(i){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:i},void 0);var n=arguments[1],s=function(){throw n};return this.caught(i,s)},t.prototype.catchReturn=function(i){if(arguments.length<=1)return i instanceof t&&i.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:i},void 0);var n=arguments[1];n instanceof t&&n.suppressUnhandledRejections();var s=function(){return n};return this.caught(i,s)}}});var bI=y((_fe,wI)=>{"use strict";wI.exports=function(t){function e(u){u!==void 0?(u=u._target(),this._bitField=u._bitField,this._settledValueField=u._isFateSealed()?u._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var r=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError(`cannot get fulfillment value of a non-fulfilled promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},i=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError(`cannot get rejection reason of a non-rejected promise

    See http://goo.gl/MqrFmX
`);return this._settledValue()},n=e.prototype.isFulfilled=function(){return(this._bitField&33554432)!==0},s=e.prototype.isRejected=function(){return(this._bitField&16777216)!==0},a=e.prototype.isPending=function(){return(this._bitField&50397184)===0},o=e.prototype.isResolved=function(){return(this._bitField&50331648)!==0};e.prototype.isCancelled=function(){return(this._bitField&8454144)!==0},t.prototype.__isCancelled=function(){return(this._bitField&65536)===65536},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return(this._target()._bitField&8454144)!==0},t.prototype.isPending=function(){return a.call(this._target())},t.prototype.isRejected=function(){return s.call(this._target())},t.prototype.isFulfilled=function(){return n.call(this._target())},t.prototype.isResolved=function(){return o.call(this._target())},t.prototype.value=function(){return r.call(this._target())},t.prototype.reason=function(){var u=this._target();return u._unsetRejectionIsUnhandled(),i.call(u)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}});var TI=y((wfe,xI)=>{"use strict";xI.exports=function(t,e,r,i,n,s){var a=Te(),o=a.canEvaluate,u=a.tryCatch,f=a.errorObj,h;if(o){for(var g=function(C){return new Function("value","holder",`                             
            'use strict';                                                    
            holder.pIndex = value;                                           
            holder.checkFulfillment(this);                                   
            `.replace(/Index/g,C))},m=function(C){return new Function("promise","holder",`                           
            'use strict';                                                    
            holder.pIndex = promise;                                         
            `.replace(/Index/g,C))},c=function(C){for(var O=new Array(C),R=0;R<O.length;++R)O[R]="this.p"+(R+1);var M=O.join(" = ")+" = null;",X=`var promise;
`+O.map(function(G){return`                                                         
                promise = `+G+`;                                      
                if (promise instanceof Promise) {                            
                    promise.cancel();                                        
                }                                                            
            `}).join(`
`),H=O.join(", "),W="Holder$"+C,P=`return function(tryCatch, errorObj, Promise, async) {    
            'use strict';                                                    
            function [TheName](fn) {                                         
                [TheProperties]                                              
                this.fn = fn;                                                
                this.asyncNeeded = true;                                     
                this.now = 0;                                                
            }                                                                
                                                                             
            [TheName].prototype._callFunction = function(promise) {          
                promise._pushContext();                                      
                var ret = tryCatch(this.fn)([ThePassedArguments]);           
                promise._popContext();                                       
                if (ret === errorObj) {                                      
                    promise._rejectCallback(ret.e, false);                   
                } else {                                                     
                    promise._resolveCallback(ret);                           
                }                                                            
            };                                                               
                                                                             
            [TheName].prototype.checkFulfillment = function(promise) {       
                var now = ++this.now;                                        
                if (now === [TheTotal]) {                                    
                    if (this.asyncNeeded) {                                  
                        async.invoke(this._callFunction, this, promise);     
                    } else {                                                 
                        this._callFunction(promise);                         
                    }                                                        
                                                                             
                }                                                            
            };                                                               
                                                                             
            [TheName].prototype._resultCancelled = function() {              
                [CancellationCode]                                           
            };                                                               
                                                                             
            return [TheName];                                                
        }(tryCatch, errorObj, Promise, async);                               
        `;return P=P.replace(/\[TheName\]/g,W).replace(/\[TheTotal\]/g,C).replace(/\[ThePassedArguments\]/g,H).replace(/\[TheProperties\]/g,M).replace(/\[CancellationCode\]/g,X),new Function("tryCatch","errorObj","Promise","async",P)(u,f,t,n)},d=[],v=[],w=[],b=0;b<8;++b)d.push(c(b+1)),v.push(g(b+1)),w.push(m(b+1));h=function(C){this._reject(C)}}t.join=function(){var C=arguments.length-1,O;if(C>0&&typeof arguments[C]=="function"&&(O=arguments[C],C<=8&&o)){var $=new t(i);$._captureStackTrace();for(var R=d[C-1],M=new R(O),X=v,H=0;H<C;++H){var W=r(arguments[H],$);if(W instanceof t){W=W._target();var P=W._bitField;(P&50397184)===0?(W._then(X[H],h,void 0,$,M),w[H](W,M),M.asyncNeeded=!1):(P&33554432)!==0?X[H].call($,W._value(),M):(P&16777216)!==0?$._reject(W._reason()):$._cancel()}else X[H].call($,W,M)}if(!$._isFateSealed()){if(M.asyncNeeded){var G=s();G!==null&&(M.fn=a.domainBind(G,M.fn))}$._setAsyncGuaranteed(),$._setOnCancel(M)}return $}for(var q=arguments.length,E=new Array(q),A=0;A<q;++A)E[A]=arguments[A];O&&E.pop();var $=new e(E).promise();return O!==void 0?$.spread(O):$}}});var CI=y((bfe,EI)=>{"use strict";EI.exports=function(t,e,r,i,n,s){var a=t._getDomain,o=Te(),u=o.tryCatch,f=o.errorObj,h=t._async;function g(c,d,v,w){this.constructor$(c),this._promise._captureStackTrace();var b=a();this._callback=b===null?d:o.domainBind(b,d),this._preservedValues=w===n?new Array(this.length()):null,this._limit=v,this._inFlight=0,this._queue=[],h.invoke(this._asyncInit,this,void 0)}o.inherits(g,e),g.prototype._asyncInit=function(){this._init$(void 0,-2)},g.prototype._init=function(){},g.prototype._promiseFulfilled=function(c,d){var v=this._values,w=this.length(),b=this._preservedValues,C=this._limit;if(d<0){if(d=d*-1-1,v[d]=c,C>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(C>=1&&this._inFlight>=C)return v[d]=c,this._queue.push(d),!1;b!==null&&(b[d]=c);var O=this._promise,R=this._callback,M=O._boundValue();O._pushContext();var X=u(R).call(M,c,d,w),H=O._popContext();if(s.checkForgottenReturns(X,H,b!==null?"Promise.filter":"Promise.map",O),X===f)return this._reject(X.e),!0;var W=i(X,this._promise);if(W instanceof t){W=W._target();var P=W._bitField;if((P&50397184)===0)return C>=1&&this._inFlight++,v[d]=W,W._proxy(this,(d+1)*-1),!1;if((P&33554432)!==0)X=W._value();else return(P&16777216)!==0?(this._reject(W._reason()),!0):(this._cancel(),!0)}v[d]=X}var G=++this._totalResolved;return G>=w?(b!==null?this._filter(v,b):this._resolve(v),!0):!1},g.prototype._drainQueue=function(){for(var c=this._queue,d=this._limit,v=this._values;c.length>0&&this._inFlight<d;){if(this._isResolved())return;var w=c.pop();this._promiseFulfilled(v[w],w)}},g.prototype._filter=function(c,d){for(var v=d.length,w=new Array(v),b=0,C=0;C<v;++C)c[C]&&(w[b++]=d[C]);w.length=b,this._resolve(w)},g.prototype.preservedValues=function(){return this._preservedValues};function m(c,d,v,w){if(typeof d!="function")return r("expecting a function but got "+o.classString(d));var b=0;if(v!==void 0)if(typeof v=="object"&&v!==null){if(typeof v.concurrency!="number")return t.reject(new TypeError("'concurrency' must be a number but it is "+o.classString(v.concurrency)));b=v.concurrency}else return t.reject(new TypeError("options argument must be an object but it is "+o.classString(v)));return b=typeof b=="number"&&isFinite(b)&&b>=1?b:0,new g(c,d,b,w).promise()}t.prototype.map=function(c,d){return m(this,c,d,null)},t.map=function(c,d,v,w){return m(c,d,v,w)}}});var kI=y((xfe,SI)=>{"use strict";var Hw=Object.create;Hw&&(Uw=Hw(null),zw=Hw(null),Uw[" size"]=zw[" size"]=0);var Uw,zw;SI.exports=function(t){var e=Te(),r=e.canEvaluate,i=e.isIdentifier,n,s,a=function(c){return new Function("ensureMethod",`                                    
        return function(obj) {                                               
            'use strict'                                                     
            var len = this.length;                                           
            ensureMethod(obj, 'methodName');                                 
            switch(len) {                                                    
                case 1: return obj.methodName(this[0]);                      
                case 2: return obj.methodName(this[0], this[1]);             
                case 3: return obj.methodName(this[0], this[1], this[2]);    
                case 0: return obj.methodName();                             
                default:                                                     
                    return obj.methodName.apply(obj, this);                  
            }                                                                
        };                                                                   
        `.replace(/methodName/g,c))(f)},o=function(c){return new Function("obj",`                                             
        'use strict';                                                        
        return obj.propertyName;                                             
        `.replace("propertyName",c))},u=function(c,d,v){var w=v[c];if(typeof w!="function"){if(!i(c))return null;if(w=d(c),v[c]=w,v[" size"]++,v[" size"]>512){for(var b=Object.keys(v),C=0;C<256;++C)delete v[b[C]];v[" size"]=b.length-256}}return w};n=function(c){return u(c,a,Uw)},s=function(c){return u(c,o,zw)};function f(c,d){var v;if(c!=null&&(v=c[d]),typeof v!="function"){var w="Object "+e.classString(c)+" has no method '"+e.toString(d)+"'";throw new t.TypeError(w)}return v}function h(c){var d=this.pop(),v=f(c,d);return v.apply(c,this)}t.prototype.call=function(c){for(var d=arguments.length,v=new Array(Math.max(d-1,0)),w=1;w<d;++w)v[w-1]=arguments[w];if(r){var b=n(c);if(b!==null)return this._then(b,void 0,void 0,v,void 0)}return v.push(c),this._then(h,void 0,void 0,v,void 0)};function g(c){return c[this]}function m(c){var d=+this;return d<0&&(d=Math.max(0,d+c.length)),c[d]}t.prototype.get=function(c){var d=typeof c=="number",v;if(d)v=m;else if(r){var w=s(c);v=w!==null?w:g}else v=g;return this._then(v,void 0,void 0,c,void 0)}}});var OI=y((Tfe,RI)=>{"use strict";RI.exports=function(t,e,r,i,n,s){var a=Te(),o=Kr().TypeError,u=Te().inherits,f=a.errorObj,h=a.tryCatch,g={};function m(O){setTimeout(function(){throw O},0)}function c(O){var R=r(O);return R!==O&&typeof O._isDisposable=="function"&&typeof O._getDisposer=="function"&&O._isDisposable()&&R._setDisposable(O._getDisposer()),R}function d(O,R){var M=0,X=O.length,H=new t(n);function W(){if(M>=X)return H._fulfill();var P=c(O[M++]);if(P instanceof t&&P._isDisposable()){try{P=r(P._getDisposer().tryDispose(R),O.promise)}catch(G){return m(G)}if(P instanceof t)return P._then(W,m,null,null,null)}W()}return W(),H}function v(O,R,M){this._data=O,this._promise=R,this._context=M}v.prototype.data=function(){return this._data},v.prototype.promise=function(){return this._promise},v.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():g},v.prototype.tryDispose=function(O){var R=this.resource(),M=this._context;M!==void 0&&M._pushContext();var X=R!==g?this.doDispose(R,O):null;return M!==void 0&&M._popContext(),this._promise._unsetDisposable(),this._data=null,X},v.isDisposer=function(O){return O!=null&&typeof O.resource=="function"&&typeof O.tryDispose=="function"};function w(O,R,M){this.constructor$(O,R,M)}u(w,v),w.prototype.doDispose=function(O,R){var M=this.data();return M.call(O,O,R)};function b(O){return v.isDisposer(O)?(this.resources[this.index]._setDisposable(O),O.promise()):O}function C(O){this.length=O,this.promise=null,this[O-1]=null}C.prototype._resultCancelled=function(){for(var O=this.length,R=0;R<O;++R){var M=this[R];M instanceof t&&M.cancel()}},t.using=function(){var O=arguments.length;if(O<2)return e("you must pass at least 2 arguments to Promise.using");var R=arguments[O-1];if(typeof R!="function")return e("expecting a function but got "+a.classString(R));var M,X=!0;O===2&&Array.isArray(arguments[0])?(M=arguments[0],O=M.length,X=!1):(M=arguments,O--);for(var H=new C(O),W=0;W<O;++W){var P=M[W];if(v.isDisposer(P)){var G=P;P=P.promise(),P._setDisposable(G)}else{var q=r(P);q instanceof t&&(P=q._then(b,null,null,{resources:H,index:W},void 0))}H[W]=P}for(var E=new Array(H.length),W=0;W<E.length;++W)E[W]=t.resolve(H[W]).reflect();var A=t.all(E).then(function(B){for(var T=0;T<B.length;++T){var k=B[T];if(k.isRejected())return f.e=k.error(),f;if(!k.isFulfilled()){A.cancel();return}B[T]=k.value()}$._pushContext(),R=h(R);var N=X?R.apply(void 0,B):R(B),j=$._popContext();return s.checkForgottenReturns(N,j,"Promise.using",$),N}),$=A.lastly(function(){var B=new t.PromiseInspection(A);return d(H,B)});return H.promise=$,$._setOnCancel(H),$},t.prototype._setDisposable=function(O){this._bitField=this._bitField|131072,this._disposer=O},t.prototype._isDisposable=function(){return(this._bitField&131072)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},t.prototype.disposer=function(O){if(typeof O=="function")return new w(O,this,i());throw new o}}});var FI=y((Efe,AI)=>{"use strict";AI.exports=function(t,e,r){var i=Te(),n=t.TimeoutError;function s(g){this.handle=g}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(g){return o(+this).thenReturn(g)},o=t.delay=function(g,m){var c,d;return m!==void 0?(c=t.resolve(m)._then(a,null,null,g,void 0),r.cancellation()&&m instanceof t&&c._setOnCancel(m)):(c=new t(e),d=setTimeout(function(){c._fulfill()},+g),r.cancellation()&&c._setOnCancel(new s(d)),c._captureStackTrace()),c._setAsyncGuaranteed(),c};t.prototype.delay=function(g){return o(g,this)};var u=function(g,m,c){var d;typeof m!="string"?m instanceof Error?d=m:d=new n("operation timed out"):d=new n(m),i.markAsOriginatingFromRejection(d),g._attachExtraTrace(d),g._reject(d),c?.cancel()};function f(g){return clearTimeout(this.handle),g}function h(g){throw clearTimeout(this.handle),g}t.prototype.timeout=function(g,m){g=+g;var c,d,v=new s(setTimeout(function(){c.isPending()&&u(c,m,d)},g));return r.cancellation()?(d=this.then(),c=d._then(f,h,void 0,v,void 0),c._setOnCancel(v)):c=this._then(f,h,void 0,v,void 0),c}}});var DI=y((Cfe,NI)=>{"use strict";NI.exports=function(t,e,r,i,n,s){var a=Kr(),o=a.TypeError,u=Te(),f=u.errorObj,h=u.tryCatch,g=[];function m(d,v,w){for(var b=0;b<v.length;++b){w._pushContext();var C=h(v[b])(d);if(w._popContext(),C===f){w._pushContext();var O=t.reject(f.e);return w._popContext(),O}var R=i(C,w);if(R instanceof t)return R}return null}function c(d,v,w,b){if(s.cancellation()){var C=new t(r),O=this._finallyPromise=new t(r);this._promise=C.lastly(function(){return O}),C._captureStackTrace(),C._setOnCancel(this)}else{var R=this._promise=new t(r);R._captureStackTrace()}this._stack=b,this._generatorFunction=d,this._receiver=v,this._generator=void 0,this._yieldHandlers=typeof w=="function"?[w].concat(g):g,this._yieldedPromise=null,this._cancellationPhase=!1}u.inherits(c,n),c.prototype._isResolved=function(){return this._promise===null},c.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&this._finallyPromise!==null&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},c.prototype._promiseCancelled=function(){if(!this._isResolved()){var d=typeof this._generator.return<"u",v;if(d)this._promise._pushContext(),v=h(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var w=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=w,this._promise._attachExtraTrace(w),this._promise._pushContext(),v=h(this._generator.throw).call(this._generator,w),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(v)}},c.prototype._promiseFulfilled=function(d){this._yieldedPromise=null,this._promise._pushContext();var v=h(this._generator.next).call(this._generator,d);this._promise._popContext(),this._continue(v)},c.prototype._promiseRejected=function(d){this._yieldedPromise=null,this._promise._attachExtraTrace(d),this._promise._pushContext();var v=h(this._generator.throw).call(this._generator,d);this._promise._popContext(),this._continue(v)},c.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var d=this._yieldedPromise;this._yieldedPromise=null,d.cancel()}},c.prototype.promise=function(){return this._promise},c.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},c.prototype._continue=function(d){var v=this._promise;if(d===f)return this._cleanup(),this._cancellationPhase?v.cancel():v._rejectCallback(d.e,!1);var w=d.value;if(d.done===!0)return this._cleanup(),this._cancellationPhase?v.cancel():v._resolveCallback(w);var b=i(w,this._promise);if(!(b instanceof t)&&(b=m(b,this._yieldHandlers,this._promise),b===null)){this._promiseRejected(new o(`A value %s was yielded that could not be treated as a promise

    See http://goo.gl/MqrFmX

`.replace("%s",w)+`From coroutine:
`+this._stack.split(`
`).slice(1,-7).join(`
`)));return}b=b._target();var C=b._bitField;(C&50397184)===0?(this._yieldedPromise=b,b._proxy(this,null)):(C&33554432)!==0?t._async.invoke(this._promiseFulfilled,this,b._value()):(C&16777216)!==0?t._async.invoke(this._promiseRejected,this,b._reason()):this._promiseCancelled()},t.coroutine=function(d,v){if(typeof d!="function")throw new o(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var w=Object(v).yieldHandler,b=c,C=new Error().stack;return function(){var O=d.apply(this,arguments),R=new b(void 0,void 0,w,C),M=R.promise();return R._generator=O,R._promiseFulfilled(void 0),M}},t.coroutine.addYieldHandler=function(d){if(typeof d!="function")throw new o("expecting a function but got "+u.classString(d));g.push(d)},t.spawn=function(d){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),typeof d!="function")return e(`generatorFunction must be a function

    See http://goo.gl/MqrFmX
`);var v=new c(d,this),w=v.promise();return v._run(t.spawn),w}}});var II=y((Sfe,qI)=>{"use strict";qI.exports=function(t){var e=Te(),r=t._async,i=e.tryCatch,n=e.errorObj;function s(u,f){var h=this;if(!e.isArray(u))return a.call(h,u,f);var g=i(f).apply(h._boundValue(),[null].concat(u));g===n&&r.throwLater(g.e)}function a(u,f){var h=this,g=h._boundValue(),m=u===void 0?i(f).call(g,null):i(f).call(g,null,u);m===n&&r.throwLater(m.e)}function o(u,f){var h=this;if(!u){var g=new Error(u+"");g.cause=u,u=g}var m=i(f).call(h._boundValue(),u);m===n&&r.throwLater(m.e)}t.prototype.asCallback=t.prototype.nodeify=function(u,f){if(typeof u=="function"){var h=a;f!==void 0&&Object(f).spread&&(h=s),this._then(h,o,void 0,this,u)}return this}}});var PI=y((kfe,MI)=>{"use strict";MI.exports=function(t,e){var r={},i=Te(),n=$w(),s=i.withAppended,a=i.maybeWrapAsError,o=i.canEvaluate,u=Kr().TypeError,f="Async",h={__isPromisified__:!0},g=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],m=new RegExp("^(?:"+g.join("|")+")$"),c=function(A){return i.isIdentifier(A)&&A.charAt(0)!=="_"&&A!=="constructor"};function d(A){return!m.test(A)}function v(A){try{return A.__isPromisified__===!0}catch{return!1}}function w(A,$,B){var T=i.getDataPropertyOrDefault(A,$+B,h);return T?v(T):!1}function b(A,$,B){for(var T=0;T<A.length;T+=2){var k=A[T];if(B.test(k)){for(var N=k.replace(B,""),j=0;j<A.length;j+=2)if(A[j]===N)throw new u(`Cannot promisify an API that has normal methods with '%s'-suffix

    See http://goo.gl/MqrFmX
`.replace("%s",$))}}}function C(A,$,B,T){for(var k=i.inheritedDataKeys(A),N=[],j=0;j<k.length;++j){var V=k[j],Y=A[V],J=T===c?!0:c(V,Y,A);typeof Y=="function"&&!v(Y)&&!w(A,V,$)&&T(V,Y,A,J)&&N.push(V,Y)}return b(N,$,B),N}var O=function(A){return A.replace(/([$])/,"\\$")},R,M=function(A){for(var $=[A],B=Math.max(0,A-1-3),T=A-1;T>=B;--T)$.push(T);for(var T=A+1;T<=3;++T)$.push(T);return $},X=function(A){return i.filledRange(A,"_arg","")},H=function(A){return i.filledRange(Math.max(A,3),"_arg","")},W=function(A){return typeof A.length=="number"?Math.max(Math.min(A.length,1024),0):0};R=function(A,$,B,T,k,N){var j=Math.max(0,W(T)-1),V=M(j),Y=typeof A=="string"||$===r;function J(he){var ae=X(he).join(", "),Se=he>0?", ":"",tt;return Y?tt=`ret = callback.call(this, {{args}}, nodeback); break;
`:tt=$===void 0?`ret = callback({{args}}, nodeback); break;
`:`ret = callback.call(receiver, {{args}}, nodeback); break;
`,tt.replace("{{args}}",ae).replace(", ",Se)}function te(){for(var he="",ae=0;ae<V.length;++ae)he+="case "+V[ae]+":"+J(V[ae]);return he+=`                                                             
        default:                                                             
            var args = new Array(len + 1);                                   
            var i = 0;                                                       
            for (var i = 0; i < len; ++i) {                                  
               args[i] = arguments[i];                                       
            }                                                                
            args[i] = nodeback;                                              
            [CodeForCall]                                                    
            break;                                                           
        `.replace("[CodeForCall]",Y?`ret = callback.apply(this, args);
`:`ret = callback.apply(receiver, args);
`),he}var Ce=typeof A=="string"?"this != null ? this['"+A+"'] : fn":"fn",xe=`'use strict';                                                
        var ret = function (Parameters) {                                    
            'use strict';                                                    
            var len = arguments.length;                                      
            var promise = new Promise(INTERNAL);                             
            promise._captureStackTrace();                                    
            var nodeback = nodebackForPromise(promise, `+N+`);   
            var ret;                                                         
            var callback = tryCatch([GetFunctionCode]);                      
            switch(len) {                                                    
                [CodeForSwitchCase]                                          
            }                                                                
            if (ret === errorObj) {                                          
                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);
            }                                                                
            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     
            return promise;                                                  
        };                                                                   
        notEnumerableProp(ret, '__isPromisified__', true);                   
        return ret;                                                          
    `.replace("[CodeForSwitchCase]",te()).replace("[GetFunctionCode]",Ce);return xe=xe.replace("Parameters",H(j)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",xe)(t,T,$,s,a,n,i.tryCatch,i.errorObj,i.notEnumerableProp,e)};function P(A,$,B,T,k,N){var j=function(){return this}(),V=A;typeof V=="string"&&(A=T);function Y(){var J=$;$===r&&(J=this);var te=new t(e);te._captureStackTrace();var Ce=typeof V=="string"&&this!==j?this[V]:A,xe=n(te,N);try{Ce.apply(J,s(arguments,xe))}catch(he){te._rejectCallback(a(he),!0,!0)}return te._isFateSealed()||te._setAsyncGuaranteed(),te}return i.notEnumerableProp(Y,"__isPromisified__",!0),Y}var G=o?R:P;function q(A,$,B,T,k){for(var N=new RegExp(O($)+"$"),j=C(A,$,N,B),V=0,Y=j.length;V<Y;V+=2){var J=j[V],te=j[V+1],Ce=J+$;if(T===G)A[Ce]=G(J,r,J,te,$,k);else{var xe=T(te,function(){return G(J,r,J,te,$,k)});i.notEnumerableProp(xe,"__isPromisified__",!0),A[Ce]=xe}}return i.toFastProperties(A),A}function E(A,$,B){return G(A,$,void 0,A,null,B)}t.promisify=function(A,$){if(typeof A!="function")throw new u("expecting a function but got "+i.classString(A));if(v(A))return A;$=Object($);var B=$.context===void 0?r:$.context,T=!!$.multiArgs,k=E(A,B,T);return i.copyDescriptors(A,k,d),k},t.promisifyAll=function(A,$){if(typeof A!="function"&&typeof A!="object")throw new u(`the target of promisifyAll must be an object or a function

    See http://goo.gl/MqrFmX
`);$=Object($);var B=!!$.multiArgs,T=$.suffix;typeof T!="string"&&(T=f);var k=$.filter;typeof k!="function"&&(k=c);var N=$.promisifier;if(typeof N!="function"&&(N=G),!i.isIdentifier(T))throw new RangeError(`suffix must be a valid identifier

    See http://goo.gl/MqrFmX
`);for(var j=i.inheritedDataKeys(A),V=0;V<j.length;++V){var Y=A[j[V]];j[V]!=="constructor"&&i.isClass(Y)&&(q(Y.prototype,T,k,N,B),q(Y,T,k,N,B))}return q(A,T,k,N,B)}}});var BI=y((Rfe,LI)=>{"use strict";LI.exports=function(t,e,r,i){var n=Te(),s=n.isObject,a=Ln(),o;typeof Map=="function"&&(o=Map);var u=function(){var m=0,c=0;function d(v,w){this[m]=v,this[m+c]=w,m++}return function(w){c=w.size,m=0;var b=new Array(w.size*2);return w.forEach(d,b),b}}(),f=function(m){for(var c=new o,d=m.length/2|0,v=0;v<d;++v){var w=m[d+v],b=m[v];c.set(w,b)}return c};function h(m){var c=!1,d;if(o!==void 0&&m instanceof o)d=u(m),c=!0;else{var v=a.keys(m),w=v.length;d=new Array(w*2);for(var b=0;b<w;++b){var C=v[b];d[b]=m[C],d[b+w]=C}}this.constructor$(d),this._isMap=c,this._init$(void 0,-3)}n.inherits(h,e),h.prototype._init=function(){},h.prototype._promiseFulfilled=function(m,c){this._values[c]=m;var d=++this._totalResolved;if(d>=this._length){var v;if(this._isMap)v=f(this._values);else{v={};for(var w=this.length(),b=0,C=this.length();b<C;++b)v[this._values[b+w]]=this._values[b]}return this._resolve(v),!0}return!1},h.prototype.shouldCopyValues=function(){return!1},h.prototype.getActualLength=function(m){return m>>1};function g(m){var c,d=r(m);if(s(d))d instanceof t?c=d._then(t.props,void 0,void 0,void 0,void 0):c=new h(d).promise();else return i(`cannot await properties of a non-object

    See http://goo.gl/MqrFmX
`);return d instanceof t&&c._propagateFrom(d,2),c}t.prototype.props=function(){return g(this)},t.props=function(m){return g(m)}}});var WI=y((Ofe,jI)=>{"use strict";jI.exports=function(t,e,r,i){var n=Te(),s=function(o){return o.then(function(u){return a(u,o)})};function a(o,u){var f=r(o);if(f instanceof t)return s(f);if(o=n.asArray(o),o===null)return i("expecting an array or an iterable object but got "+n.classString(o));var h=new t(e);u!==void 0&&h._propagateFrom(u,3);for(var g=h._fulfill,m=h._reject,c=0,d=o.length;c<d;++c){var v=o[c];v===void 0&&!(c in o)||t.cast(v)._then(g,m,void 0,h,null)}return h}t.race=function(o){return a(o,void 0)},t.prototype.race=function(){return a(this,void 0)}}});var HI=y((Afe,$I)=>{"use strict";$I.exports=function(t,e,r,i,n,s){var a=t._getDomain,o=Te(),u=o.tryCatch;function f(d,v,w,b){this.constructor$(d);var C=a();this._fn=C===null?v:o.domainBind(C,v),w!==void 0&&(w=t.resolve(w),w._attachCancellationCallback(this)),this._initialValue=w,this._currentCancellable=null,b===n?this._eachValues=Array(this._length):b===0?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}o.inherits(f,e),f.prototype._gotAccum=function(d){this._eachValues!==void 0&&this._eachValues!==null&&d!==n&&this._eachValues.push(d)},f.prototype._eachComplete=function(d){return this._eachValues!==null&&this._eachValues.push(d),this._eachValues},f.prototype._init=function(){},f.prototype._resolveEmptyArray=function(){this._resolve(this._eachValues!==void 0?this._eachValues:this._initialValue)},f.prototype.shouldCopyValues=function(){return!1},f.prototype._resolve=function(d){this._promise._resolveCallback(d),this._values=null},f.prototype._resultCancelled=function(d){if(d===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},f.prototype._iterate=function(d){this._values=d;var v,w,b=d.length;if(this._initialValue!==void 0?(v=this._initialValue,w=0):(v=t.resolve(d[0]),w=1),this._currentCancellable=v,!v.isRejected())for(;w<b;++w){var C={accum:null,value:d[w],index:w,length:b,array:this};v=v._then(m,void 0,void 0,C,void 0)}this._eachValues!==void 0&&(v=v._then(this._eachComplete,void 0,void 0,this,void 0)),v._then(h,h,void 0,v,this)},t.prototype.reduce=function(d,v){return g(this,d,v,null)},t.reduce=function(d,v,w,b){return g(d,v,w,b)};function h(d,v){this.isFulfilled()?v._resolve(d):v._reject(d)}function g(d,v,w,b){if(typeof v!="function")return r("expecting a function but got "+o.classString(v));var C=new f(d,v,w,b);return C.promise()}function m(d){this.accum=d,this.array._gotAccum(d);var v=i(this.value,this.array._promise);return v instanceof t?(this.array._currentCancellable=v,v._then(c,void 0,void 0,this,void 0)):c.call(this,v)}function c(d){var v=this.array,w=v._promise,b=u(v._fn);w._pushContext();var C;v._eachValues!==void 0?C=b.call(w._boundValue(),d,this.index,this.length):C=b.call(w._boundValue(),this.accum,d,this.index,this.length),C instanceof t&&(v._currentCancellable=C);var O=w._popContext();return s.checkForgottenReturns(C,O,v._eachValues!==void 0?"Promise.each":"Promise.reduce",w),C}}});var zI=y((Ffe,UI)=>{"use strict";UI.exports=function(t,e,r){var i=t.PromiseInspection,n=Te();function s(a){this.constructor$(a)}n.inherits(s,e),s.prototype._promiseResolved=function(a,o){this._values[a]=o;var u=++this._totalResolved;return u>=this._length?(this._resolve(this._values),!0):!1},s.prototype._promiseFulfilled=function(a,o){var u=new i;return u._bitField=33554432,u._settledValueField=a,this._promiseResolved(o,u)},s.prototype._promiseRejected=function(a,o){var u=new i;return u._bitField=16777216,u._settledValueField=a,this._promiseResolved(o,u)},t.settle=function(a){return r.deprecated(".settle()",".reflect()"),new s(a).promise()},t.prototype.settle=function(){return t.settle(this)}}});var VI=y((Nfe,XI)=>{"use strict";XI.exports=function(t,e,r){var i=Te(),n=Kr().RangeError,s=Kr().AggregateError,a=i.isArray,o={};function u(h){this.constructor$(h),this._howMany=0,this._unwrap=!1,this._initialized=!1}i.inherits(u,e),u.prototype._init=function(){if(!!this._initialized){if(this._howMany===0){this._resolve([]);return}this._init$(void 0,-5);var h=a(this._values);!this._isResolved()&&h&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},u.prototype.init=function(){this._initialized=!0,this._init()},u.prototype.setUnwrap=function(){this._unwrap=!0},u.prototype.howMany=function(){return this._howMany},u.prototype.setHowMany=function(h){this._howMany=h},u.prototype._promiseFulfilled=function(h){return this._addFulfilled(h),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},u.prototype._promiseRejected=function(h){return this._addRejected(h),this._checkOutcome()},u.prototype._promiseCancelled=function(){return this._values instanceof t||this._values==null?this._cancel():(this._addRejected(o),this._checkOutcome())},u.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var h=new s,g=this.length();g<this._values.length;++g)this._values[g]!==o&&h.push(this._values[g]);return h.length>0?this._reject(h):this._cancel(),!0}return!1},u.prototype._fulfilled=function(){return this._totalResolved},u.prototype._rejected=function(){return this._values.length-this.length()},u.prototype._addRejected=function(h){this._values.push(h)},u.prototype._addFulfilled=function(h){this._values[this._totalResolved++]=h},u.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},u.prototype._getRangeError=function(h){var g="Input array must contain at least "+this._howMany+" items but contains only "+h+" items";return new n(g)},u.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};function f(h,g){if((g|0)!==g||g<0)return r(`expecting a positive integer

    See http://goo.gl/MqrFmX
`);var m=new u(h),c=m.promise();return m.setHowMany(g),m.init(),c}t.some=function(h,g){return f(h,g)},t.prototype.some=function(h){return f(this,h)},t._SomePromiseArray=u}});var ZI=y((Dfe,GI)=>{"use strict";GI.exports=function(t,e){var r=t.map;t.prototype.filter=function(i,n){return r(this,i,n,e)},t.filter=function(i,n,s){return r(i,n,s,e)}}});var KI=y((qfe,YI)=>{"use strict";YI.exports=function(t,e){var r=t.reduce,i=t.all;function n(){return i(this)}function s(a,o){return r(a,o,e,e)}t.prototype.each=function(a){return r(this,a,e,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(a){return r(this,a,e,e)},t.each=function(a,o){return r(a,o,e,0)._then(n,void 0,void 0,a,void 0)},t.mapSeries=s}});var JI=y((Ife,QI)=>{"use strict";QI.exports=function(t){var e=t._SomePromiseArray;function r(i){var n=new e(i),s=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),s}t.any=function(i){return r(i)},t.prototype.any=function(){return r(this)}}});var eM=y((Mfe,Xw)=>{"use strict";Xw.exports=function(){var t=function(){return new g(`circular promise resolution chain

    See http://goo.gl/MqrFmX
`)},e=function(){return new E.PromiseInspection(this._target())},r=function(T){return E.reject(new g(T))};function i(){}var n={},s=Te(),a;s.isNode?a=function(){var T=process.domain;return T===void 0&&(T=null),T}:a=function(){return null},s.notEnumerableProp(E,"_getDomain",a);var o=Ln(),u=Vq(),f=new u;o.defineProperty(E,"_async",{value:f});var h=Kr(),g=E.TypeError=h.TypeError;E.RangeError=h.RangeError;var m=E.CancellationError=h.CancellationError;E.TimeoutError=h.TimeoutError,E.OperationalError=h.OperationalError,E.RejectionError=h.OperationalError,E.AggregateError=h.AggregateError;var c=function(){},d={},v={},w=Qq()(E,c),b=eI()(E,c,w,r,i),C=rI()(E),O=C.create,R=nI()(E,C),M=R.CapturedTrace,X=aI()(E,w),H=lI()(v),W=$w(),P=s.errorObj,G=s.tryCatch;function q(T,k){if(typeof k!="function")throw new g("expecting a function but got "+s.classString(k));if(T.constructor!==E)throw new g(`the promise constructor cannot be invoked directly

    See http://goo.gl/MqrFmX
`)}function E(T){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,T!==c&&(q(this,T),this._resolveFromExecutor(T)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}E.prototype.toString=function(){return"[object Promise]"},E.prototype.caught=E.prototype.catch=function(T){var k=arguments.length;if(k>1){var N=new Array(k-1),j=0,V;for(V=0;V<k-1;++V){var Y=arguments[V];if(s.isObject(Y))N[j++]=Y;else return r("expecting an object but got A catch statement predicate "+s.classString(Y))}return N.length=j,T=arguments[V],this.then(void 0,H(N,T,this))}return this.then(void 0,T)},E.prototype.reflect=function(){return this._then(e,e,void 0,this,void 0)},E.prototype.then=function(T,k){if(R.warnings()&&arguments.length>0&&typeof T!="function"&&typeof k!="function"){var N=".then() only accepts functions but was passed: "+s.classString(T);arguments.length>1&&(N+=", "+s.classString(k)),this._warn(N)}return this._then(T,k,void 0,void 0,void 0)},E.prototype.done=function(T,k){var N=this._then(T,k,void 0,void 0,void 0);N._setIsFinal()},E.prototype.spread=function(T){return typeof T!="function"?r("expecting a function but got "+s.classString(T)):this.all()._then(T,void 0,void 0,d,void 0)},E.prototype.toJSON=function(){var T={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(T.fulfillmentValue=this.value(),T.isFulfilled=!0):this.isRejected()&&(T.rejectionReason=this.reason(),T.isRejected=!0),T},E.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new b(this).promise()},E.prototype.error=function(T){return this.caught(s.originatesFromRejection,T)},E.getNewLibraryCopy=Xw.exports,E.is=function(T){return T instanceof E},E.fromNode=E.fromCallback=function(T){var k=new E(c);k._captureStackTrace();var N=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,j=G(T)(W(k,N));return j===P&&k._rejectCallback(j.e,!0),k._isFateSealed()||k._setAsyncGuaranteed(),k},E.all=function(T){return new b(T).promise()},E.cast=function(T){var k=w(T);return k instanceof E||(k=new E(c),k._captureStackTrace(),k._setFulfilled(),k._rejectionHandler0=T),k},E.resolve=E.fulfilled=E.cast,E.reject=E.rejected=function(T){var k=new E(c);return k._captureStackTrace(),k._rejectCallback(T,!0),k},E.setScheduler=function(T){if(typeof T!="function")throw new g("expecting a function but got "+s.classString(T));return f.setScheduler(T)},E.prototype._then=function(T,k,N,j,V){var Y=V!==void 0,J=Y?V:new E(c),te=this._target(),Ce=te._bitField;Y||(J._propagateFrom(this,3),J._captureStackTrace(),j===void 0&&(this._bitField&2097152)!==0&&((Ce&50397184)!==0?j=this._boundValue():j=te===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,J));var xe=a();if((Ce&50397184)!==0){var he,ae,Se=te._settlePromiseCtx;(Ce&33554432)!==0?(ae=te._rejectionHandler0,he=T):(Ce&16777216)!==0?(ae=te._fulfillmentHandler0,he=k,te._unsetRejectionIsUnhandled()):(Se=te._settlePromiseLateCancellationObserver,ae=new m("late cancellation observer"),te._attachExtraTrace(ae),he=k),f.invoke(Se,te,{handler:xe===null?he:typeof he=="function"&&s.domainBind(xe,he),promise:J,receiver:j,value:ae})}else te._addCallbacks(T,k,J,j,xe);return J},E.prototype._length=function(){return this._bitField&65535},E.prototype._isFateSealed=function(){return(this._bitField&117506048)!==0},E.prototype._isFollowing=function(){return(this._bitField&67108864)===67108864},E.prototype._setLength=function(T){this._bitField=this._bitField&-65536|T&65535},E.prototype._setFulfilled=function(){this._bitField=this._bitField|33554432,this._fireEvent("promiseFulfilled",this)},E.prototype._setRejected=function(){this._bitField=this._bitField|16777216,this._fireEvent("promiseRejected",this)},E.prototype._setFollowing=function(){this._bitField=this._bitField|67108864,this._fireEvent("promiseResolved",this)},E.prototype._setIsFinal=function(){this._bitField=this._bitField|4194304},E.prototype._isFinal=function(){return(this._bitField&4194304)>0},E.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},E.prototype._setCancelled=function(){this._bitField=this._bitField|65536,this._fireEvent("promiseCancelled",this)},E.prototype._setWillBeCancelled=function(){this._bitField=this._bitField|8388608},E.prototype._setAsyncGuaranteed=function(){f.hasCustomScheduler()||(this._bitField=this._bitField|134217728)},E.prototype._receiverAt=function(T){var k=T===0?this._receiver0:this[T*4-4+3];if(k!==n)return k===void 0&&this._isBound()?this._boundValue():k},E.prototype._promiseAt=function(T){return this[T*4-4+2]},E.prototype._fulfillmentHandlerAt=function(T){return this[T*4-4+0]},E.prototype._rejectionHandlerAt=function(T){return this[T*4-4+1]},E.prototype._boundValue=function(){},E.prototype._migrateCallback0=function(T){var k=T._bitField,N=T._fulfillmentHandler0,j=T._rejectionHandler0,V=T._promise0,Y=T._receiverAt(0);Y===void 0&&(Y=n),this._addCallbacks(N,j,V,Y,null)},E.prototype._migrateCallbackAt=function(T,k){var N=T._fulfillmentHandlerAt(k),j=T._rejectionHandlerAt(k),V=T._promiseAt(k),Y=T._receiverAt(k);Y===void 0&&(Y=n),this._addCallbacks(N,j,V,Y,null)},E.prototype._addCallbacks=function(T,k,N,j,V){var Y=this._length();if(Y>=65535-4&&(Y=0,this._setLength(0)),Y===0)this._promise0=N,this._receiver0=j,typeof T=="function"&&(this._fulfillmentHandler0=V===null?T:s.domainBind(V,T)),typeof k=="function"&&(this._rejectionHandler0=V===null?k:s.domainBind(V,k));else{var J=Y*4-4;this[J+2]=N,this[J+3]=j,typeof T=="function"&&(this[J+0]=V===null?T:s.domainBind(V,T)),typeof k=="function"&&(this[J+1]=V===null?k:s.domainBind(V,k))}return this._setLength(Y+1),Y},E.prototype._proxy=function(T,k){this._addCallbacks(void 0,void 0,k,T,null)},E.prototype._resolveCallback=function(T,k){if((this._bitField&117506048)===0){if(T===this)return this._rejectCallback(t(),!1);var N=w(T,this);if(!(N instanceof E))return this._fulfill(T);k&&this._propagateFrom(N,2);var j=N._target();if(j===this){this._reject(t());return}var V=j._bitField;if((V&50397184)===0){var Y=this._length();Y>0&&j._migrateCallback0(this);for(var J=1;J<Y;++J)j._migrateCallbackAt(this,J);this._setFollowing(),this._setLength(0),this._setFollowee(j)}else if((V&33554432)!==0)this._fulfill(j._value());else if((V&16777216)!==0)this._reject(j._reason());else{var te=new m("late cancellation observer");j._attachExtraTrace(te),this._reject(te)}}},E.prototype._rejectCallback=function(T,k,N){var j=s.ensureErrorObject(T),V=j===T;if(!V&&!N&&R.warnings()){var Y="a promise was rejected with a non-error: "+s.classString(T);this._warn(Y,!0)}this._attachExtraTrace(j,k?V:!1),this._reject(T)},E.prototype._resolveFromExecutor=function(T){var k=this;this._captureStackTrace(),this._pushContext();var N=!0,j=this._execute(T,function(V){k._resolveCallback(V)},function(V){k._rejectCallback(V,N)});N=!1,this._popContext(),j!==void 0&&k._rejectCallback(j,!0)},E.prototype._settlePromiseFromHandler=function(T,k,N,j){var V=j._bitField;if((V&65536)===0){j._pushContext();var Y;k===d?!N||typeof N.length!="number"?(Y=P,Y.e=new g("cannot .spread() a non-array: "+s.classString(N))):Y=G(T).apply(this._boundValue(),N):Y=G(T).call(k,N);var J=j._popContext();V=j._bitField,(V&65536)===0&&(Y===v?j._reject(N):Y===P?j._rejectCallback(Y.e,!1):(R.checkForgottenReturns(Y,J,"",j,this),j._resolveCallback(Y)))}},E.prototype._target=function(){for(var T=this;T._isFollowing();)T=T._followee();return T},E.prototype._followee=function(){return this._rejectionHandler0},E.prototype._setFollowee=function(T){this._rejectionHandler0=T},E.prototype._settlePromise=function(T,k,N,j){var V=T instanceof E,Y=this._bitField,J=(Y&134217728)!==0;(Y&65536)!==0?(V&&T._invokeInternalOnCancel(),N instanceof X&&N.isFinallyHandler()?(N.cancelPromise=T,G(k).call(N,j)===P&&T._reject(P.e)):k===e?T._fulfill(e.call(N)):N instanceof i?N._promiseCancelled(T):V||T instanceof b?T._cancel():N.cancel()):typeof k=="function"?V?(J&&T._setAsyncGuaranteed(),this._settlePromiseFromHandler(k,N,j,T)):k.call(N,j,T):N instanceof i?N._isResolved()||((Y&33554432)!==0?N._promiseFulfilled(j,T):N._promiseRejected(j,T)):V&&(J&&T._setAsyncGuaranteed(),(Y&33554432)!==0?T._fulfill(j):T._reject(j))},E.prototype._settlePromiseLateCancellationObserver=function(T){var k=T.handler,N=T.promise,j=T.receiver,V=T.value;typeof k=="function"?N instanceof E?this._settlePromiseFromHandler(k,j,V,N):k.call(j,V,N):N instanceof E&&N._reject(V)},E.prototype._settlePromiseCtx=function(T){this._settlePromise(T.promise,T.handler,T.receiver,T.value)},E.prototype._settlePromise0=function(T,k,N){var j=this._promise0,V=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(j,T,V,k)},E.prototype._clearCallbackDataAtIndex=function(T){var k=T*4-4;this[k+2]=this[k+3]=this[k+0]=this[k+1]=void 0},E.prototype._fulfill=function(T){var k=this._bitField;if(!((k&117506048)>>>16)){if(T===this){var N=t();return this._attachExtraTrace(N),this._reject(N)}this._setFulfilled(),this._rejectionHandler0=T,(k&65535)>0&&((k&134217728)!==0?this._settlePromises():f.settlePromises(this))}},E.prototype._reject=function(T){var k=this._bitField;if(!((k&117506048)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=T,this._isFinal())return f.fatalError(T,s.isNode);(k&65535)>0?f.settlePromises(this):this._ensurePossibleRejectionHandled()}},E.prototype._fulfillPromises=function(T,k){for(var N=1;N<T;N++){var j=this._fulfillmentHandlerAt(N),V=this._promiseAt(N),Y=this._receiverAt(N);this._clearCallbackDataAtIndex(N),this._settlePromise(V,j,Y,k)}},E.prototype._rejectPromises=function(T,k){for(var N=1;N<T;N++){var j=this._rejectionHandlerAt(N),V=this._promiseAt(N),Y=this._receiverAt(N);this._clearCallbackDataAtIndex(N),this._settlePromise(V,j,Y,k)}},E.prototype._settlePromises=function(){var T=this._bitField,k=T&65535;if(k>0){if((T&16842752)!==0){var N=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,N,T),this._rejectPromises(k,N)}else{var j=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,j,T),this._fulfillPromises(k,j)}this._setLength(0)}this._clearCancellationData()},E.prototype._settledValue=function(){var T=this._bitField;if((T&33554432)!==0)return this._rejectionHandler0;if((T&16777216)!==0)return this._fulfillmentHandler0};function A(T){this.promise._resolveCallback(T)}function $(T){this.promise._rejectCallback(T,!1)}E.defer=E.pending=function(){R.deprecated("Promise.defer","new Promise");var T=new E(c);return{promise:T,resolve:A,reject:$}},s.notEnumerableProp(E,"_makeSelfResolutionError",t),dI()(E,c,w,r,R),gI()(E,c,w,R),vI()(E,b,r,R),_I()(E),bI()(E),TI()(E,b,w,c,f,a),E.Promise=E,E.version="3.4.7",CI()(E,b,r,w,c,R),kI()(E),OI()(E,r,w,O,c,R),FI()(E,c,R),DI()(E,r,c,w,i,R),II()(E),PI()(E,c),BI()(E,b,w,r),WI()(E,c,w,r),HI()(E,b,r,w,c,R),zI()(E,b,R),VI()(E,b,r),ZI()(E,c),KI()(E,c),JI()(E),s.toFastProperties(E),s.toFastProperties(E.prototype);function B(T){var k=new E(c);k._fulfillmentHandler0=T,k._rejectionHandler0=T,k._promise0=T,k._receiver0=T}return B({a:1}),B({b:2}),B({c:3}),B(1),B(function(){}),B(void 0),B(!1),B(new E(c)),R.setBounds(u.firstLineError,s.lastLineError),E}});var ji=y((Pfe,rM)=>{"use strict";var tM;typeof Promise<"u"&&(tM=Promise);function _J(){try{Promise===ec&&(Promise=tM)}catch{}return ec}var ec=eM()();ec.noConflict=_J;rM.exports=ec});var Fa=y((Lfe,iM)=>{var Aa=require("buffer").Buffer;Aa.from===void 0&&(Aa.from=function(t,e,r){return new Aa(t,e,r)},Aa.alloc=Aa.from);iM.exports=Aa});var Vw=y((Bfe,nM)=>{nM.exports=require("stream")});var Tl=y((Gw,aM)=>{var tc=require("buffer"),Qr=tc.Buffer;function sM(t,e){for(var r in t)e[r]=t[r]}Qr.from&&Qr.alloc&&Qr.allocUnsafe&&Qr.allocUnsafeSlow?aM.exports=tc:(sM(tc,Gw),Gw.Buffer=Na);function Na(t,e,r){return Qr(t,e,r)}sM(Qr,Na);Na.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Qr(t,e,r)};Na.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=Qr(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};Na.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Qr(t)};Na.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return tc.SlowBuffer(t)}});var lM=y((jfe,Zw)=>{"use strict";function wJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var oM=Tl().Buffer,El=require("util");function bJ(t,e,r){t.copy(e,r)}Zw.exports=function(){function t(){wJ(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(r){var i={data:r,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length},t.prototype.unshift=function(r){var i={data:r,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length},t.prototype.shift=function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(r){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=r+i.data;return n},t.prototype.concat=function(r){if(this.length===0)return oM.alloc(0);for(var i=oM.allocUnsafe(r>>>0),n=this.head,s=0;n;)bJ(n.data,i,s),s+=n.data.length,n=n.next;return i},t}();El&&El.inspect&&El.inspect.custom&&(Zw.exports.prototype[El.inspect.custom]=function(){var t=El.inspect({length:this.length});return this.constructor.name+" "+t})});var Yw=y((Wfe,uM)=>{"use strict";var rc=At();function xJ(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,rc.nextTick(ic,this,t)):rc.nextTick(ic,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted||(r._writableState.errorEmitted=!0,rc.nextTick(ic,r,s)):rc.nextTick(ic,r,s):e&&e(s)}),this)}function TJ(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function ic(t,e){t.emit("error",e)}uM.exports={destroy:xJ,undestroy:TJ}});var Qw=y(($fe,vM)=>{"use strict";var Wn=At();vM.exports=ze;function hM(t){var e=this;this.next=null,this.entry=null,this.finish=function(){WJ(e,t)}}var EJ=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:Wn.nextTick,Da;ze.WritableState=Sl;var cM=Object.create(ht());cM.inherits=le();var CJ={deprecate:lo()},dM=Vw(),sc=Tl().Buffer,SJ=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function kJ(t){return sc.from(t)}function RJ(t){return sc.isBuffer(t)||t instanceof SJ}var pM=Yw();cM.inherits(ze,dM);function OJ(){}function Sl(t,e){Da=Da||$n(),t=t||{};var r=e instanceof Da;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,n=t.writableHighWaterMark,s=this.objectMode?16:16*1024;i||i===0?this.highWaterMark=i:r&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=t.decodeStrings===!1;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(o){MJ(e,o)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new hM(this)}Sl.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(Sl.prototype,"buffer",{get:CJ.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var nc;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(nc=Function.prototype[Symbol.hasInstance],Object.defineProperty(ze,Symbol.hasInstance,{value:function(t){return nc.call(this,t)?!0:this!==ze?!1:t&&t._writableState instanceof Sl}})):nc=function(t){return t instanceof this};function ze(t){if(Da=Da||$n(),!nc.call(ze,this)&&!(this instanceof Da))return new ze(t);this._writableState=new Sl(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),dM.call(this)}ze.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function AJ(t,e){var r=new Error("write after end");t.emit("error",r),Wn.nextTick(e,r)}function FJ(t,e,r,i){var n=!0,s=!1;return r===null?s=new TypeError("May not write null values to stream"):typeof r!="string"&&r!==void 0&&!e.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),Wn.nextTick(i,s),n=!1),n}ze.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&RJ(t);return s&&!sc.isBuffer(t)&&(t=kJ(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof r!="function"&&(r=OJ),i.ended?AJ(this,r):(s||FJ(this,i,t,r))&&(i.pendingcb++,n=DJ(this,i,s,t,e,r)),n};ze.prototype.cork=function(){var t=this._writableState;t.corked++};ze.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&gM(this,t))};ze.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function NJ(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=sc.from(e,r)),e}Object.defineProperty(ze.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function DJ(t,e,r,i,n,s){if(!r){var a=NJ(e,i,n);i!==a&&(r=!0,n="buffer",i=a)}var o=e.objectMode?1:i.length;e.length+=o;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var f=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},f?f.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Kw(t,e,!1,o,i,n,s);return u}function Kw(t,e,r,i,n,s,a){e.writelen=i,e.writecb=a,e.writing=!0,e.sync=!0,r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function qJ(t,e,r,i,n){--e.pendingcb,r?(Wn.nextTick(n,i),Wn.nextTick(Cl,t,e),t._writableState.errorEmitted=!0,t.emit("error",i)):(n(i),t._writableState.errorEmitted=!0,t.emit("error",i),Cl(t,e))}function IJ(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function MJ(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if(IJ(r),e)qJ(t,r,i,e,n);else{var s=mM(r);!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&gM(t,r),i?EJ(fM,t,r,s,n):fM(t,r,s,n)}}function fM(t,e,r,i){r||PJ(t,e),e.pendingcb--,i(),Cl(t,e)}function PJ(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function gM(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var a=0,o=!0;r;)n[a]=r,r.isBuf||(o=!1),r=r.next,a+=1;n.allBuffers=o,Kw(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new hM(e),e.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,f=r.encoding,h=r.callback,g=e.objectMode?1:u.length;if(Kw(t,e,!1,g,u,f,h),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}ze.prototype._write=function(t,e,r){r(new Error("_write() is not implemented"))};ze.prototype._writev=null;ze.prototype.end=function(t,e,r){var i=this._writableState;typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||jJ(this,i,r)};function mM(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function LJ(t,e){t._final(function(r){e.pendingcb--,r&&t.emit("error",r),e.prefinished=!0,t.emit("prefinish"),Cl(t,e)})}function BJ(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,Wn.nextTick(LJ,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function Cl(t,e){var r=mM(e);return r&&(BJ(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),r}function jJ(t,e,r){e.ending=!0,Cl(t,e),r&&(e.finished?Wn.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function WJ(t,e,r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}Object.defineProperty(ze.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){!this._writableState||(this._writableState.destroyed=t)}});ze.prototype.destroy=pM.destroy;ze.prototype._undestroy=pM.undestroy;ze.prototype._destroy=function(t,e){this.end(),e(t)}});var $n=y((Hfe,bM)=>{"use strict";var yM=At(),$J=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};bM.exports=Jr;var _M=Object.create(ht());_M.inherits=le();var wM=t0(),e0=Qw();_M.inherits(Jr,wM);for(Jw=$J(e0.prototype),ac=0;ac<Jw.length;ac++)oc=Jw[ac],Jr.prototype[oc]||(Jr.prototype[oc]=e0.prototype[oc]);var Jw,oc,ac;function Jr(t){if(!(this instanceof Jr))return new Jr(t);wM.call(this,t),e0.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",HJ)}Object.defineProperty(Jr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function HJ(){this.allowHalfOpen||this._writableState.ended||yM.nextTick(UJ,this)}function UJ(t){t.end()}Object.defineProperty(Jr.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});Jr.prototype._destroy=function(t,e){this.push(null),this.end(),yM.nextTick(e,t)}});var n0=y(TM=>{"use strict";var i0=Tl().Buffer,xM=i0.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function zJ(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function XJ(t){var e=zJ(t);if(typeof e!="string"&&(i0.isEncoding===xM||!xM(t)))throw new Error("Unknown encoding: "+t);return e||t}TM.StringDecoder=kl;function kl(t){this.encoding=XJ(t);var e;switch(this.encoding){case"utf16le":this.text=QJ,this.end=JJ,e=4;break;case"utf8":this.fillLast=ZJ,e=4;break;case"base64":this.text=eee,this.end=tee,e=3;break;default:this.write=ree,this.end=iee;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i0.allocUnsafe(e)}kl.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};kl.prototype.end=KJ;kl.prototype.text=YJ;kl.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function r0(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function VJ(t,e,r){var i=e.length-1;if(i<r)return 0;var n=r0(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||n===-2?0:(n=r0(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||n===-2?0:(n=r0(e[i]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function GJ(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function ZJ(t){var e=this.lastTotal-this.lastNeed,r=GJ(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function YJ(t,e){var r=VJ(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function KJ(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function QJ(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function JJ(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function eee(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function tee(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function ree(t){return t.toString(this.encoding)}function iee(t){return t&&t.length?this.write(t):""}});var t0=y((Xfe,IM)=>{"use strict";var Ia=At();IM.exports=Ne;var nee=_u(),Rl;Ne.ReadableState=AM;var zfe=require("events").EventEmitter,kM=function(t,e){return t.listeners(e).length},u0=Vw(),Ol=Tl().Buffer,see=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function aee(t){return Ol.from(t)}function oee(t){return Ol.isBuffer(t)||t instanceof see}var RM=Object.create(ht());RM.inherits=le();var s0=require("util"),me=void 0;s0&&s0.debuglog?me=s0.debuglog("stream"):me=function(){};var lee=lM(),OM=Yw(),qa;RM.inherits(Ne,u0);var a0=["error","close","destroy","pause","resume"];function uee(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):nee(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function AM(t,e){Rl=Rl||$n(),t=t||{};var r=e instanceof Rl;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,n=t.readableHighWaterMark,s=this.objectMode?16:16*1024;i||i===0?this.highWaterMark=i:r&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new lee,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(qa||(qa=n0().StringDecoder),this.decoder=new qa(t.encoding),this.encoding=t.encoding)}function Ne(t){if(Rl=Rl||$n(),!(this instanceof Ne))return new Ne(t);this._readableState=new AM(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),u0.call(this)}Object.defineProperty(Ne.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){!this._readableState||(this._readableState.destroyed=t)}});Ne.prototype.destroy=OM.destroy;Ne.prototype._undestroy=OM.undestroy;Ne.prototype._destroy=function(t,e){this.push(null),e(t)};Ne.prototype.push=function(t,e){var r=this._readableState,i;return r.objectMode?i=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=Ol.from(t,e),e=""),i=!0),FM(this,t,e,!1,i)};Ne.prototype.unshift=function(t){return FM(this,t,null,!0,!1)};function FM(t,e,r,i,n){var s=t._readableState;if(e===null)s.reading=!1,dee(t,s);else{var a;n||(a=fee(s,e)),a?t.emit("error",a):s.objectMode||e&&e.length>0?(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==Ol.prototype&&(e=aee(e)),i?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):o0(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?o0(t,s,e,!1):NM(t,s)):o0(t,s,e,!1))):i||(s.reading=!1)}return hee(s)}function o0(t,e,r,i){e.flowing&&e.length===0&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&lc(t)),NM(t,e)}function fee(t,e){var r;return!oee(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new TypeError("Invalid non-string/buffer chunk")),r}function hee(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}Ne.prototype.isPaused=function(){return this._readableState.flowing===!1};Ne.prototype.setEncoding=function(t){return qa||(qa=n0().StringDecoder),this._readableState.decoder=new qa(t),this._readableState.encoding=t,this};var EM=8388608;function cee(t){return t>=EM?t=EM:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function CM(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=cee(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Ne.prototype.read=function(t){me("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return me("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?l0(this):lc(this),null;if(t=CM(t,e),t===0&&e.ended)return e.length===0&&l0(this),null;var i=e.needReadable;me("need readable",i),(e.length===0||e.length-t<e.highWaterMark)&&(i=!0,me("length less than watermark",i)),e.ended||e.reading?(i=!1,me("reading or ended",i)):i&&(me("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=CM(r,e)));var n;return t>0?n=DM(t,e):n=null,n===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&l0(this)),n!==null&&this.emit("data",n),n};function dee(t,e){if(!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,lc(t)}}function lc(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(me("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?Ia.nextTick(SM,t):SM(t))}function SM(t){me("emit readable"),t.emit("readable"),f0(t)}function NM(t,e){e.readingMore||(e.readingMore=!0,Ia.nextTick(pee,t,e))}function pee(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(me("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}Ne.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};Ne.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,me("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=n?o:w;i.endEmitted?Ia.nextTick(s):r.once("end",s),t.on("unpipe",a);function a(b,C){me("onunpipe"),b===r&&C&&C.hasUnpiped===!1&&(C.hasUnpiped=!0,h())}function o(){me("onend"),t.end()}var u=gee(r);t.on("drain",u);var f=!1;function h(){me("cleanup"),t.removeListener("close",d),t.removeListener("finish",v),t.removeListener("drain",u),t.removeListener("error",c),t.removeListener("unpipe",a),r.removeListener("end",o),r.removeListener("end",w),r.removeListener("data",m),f=!0,i.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&u()}var g=!1;r.on("data",m);function m(b){me("ondata"),g=!1;var C=t.write(b);C===!1&&!g&&((i.pipesCount===1&&i.pipes===t||i.pipesCount>1&&qM(i.pipes,t)!==-1)&&!f&&(me("false write response, pause",i.awaitDrain),i.awaitDrain++,g=!0),r.pause())}function c(b){me("onerror",b),w(),t.removeListener("error",c),kM(t,"error")===0&&t.emit("error",b)}uee(t,"error",c);function d(){t.removeListener("finish",v),w()}t.once("close",d);function v(){me("onfinish"),t.removeListener("close",d),w()}t.once("finish",v);function w(){me("unpipe"),r.unpipe(t)}return t.emit("pipe",r),i.flowing||(me("pipe resume"),r.resume()),t};function gee(t){return function(){var e=t._readableState;me("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&kM(t,"data")&&(e.flowing=!0,f0(t))}}Ne.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=qM(e.pipes,t);return a===-1?this:(e.pipes.splice(a,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Ne.prototype.on=function(t,e){var r=u0.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var i=this._readableState;!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&lc(this):Ia.nextTick(mee,this))}return r};Ne.prototype.addListener=Ne.prototype.on;function mee(t){me("readable nexttick read 0"),t.read(0)}Ne.prototype.resume=function(){var t=this._readableState;return t.flowing||(me("resume"),t.flowing=!0,vee(this,t)),this};function vee(t,e){e.resumeScheduled||(e.resumeScheduled=!0,Ia.nextTick(yee,t,e))}function yee(t,e){e.reading||(me("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),f0(t),e.flowing&&!e.reading&&t.read(0)}Ne.prototype.pause=function(){return me("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(me("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function f0(t){var e=t._readableState;for(me("flow",e.flowing);e.flowing&&t.read()!==null;);}Ne.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;t.on("end",function(){if(me("wrapped end"),r.decoder&&!r.ended){var a=r.decoder.end();a&&a.length&&e.push(a)}e.push(null)}),t.on("data",function(a){if(me("wrapped data"),r.decoder&&(a=r.decoder.write(a)),!(r.objectMode&&a==null)&&!(!r.objectMode&&(!a||!a.length))){var o=e.push(a);o||(i=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(a){return function(){return t[a].apply(t,arguments)}}(n));for(var s=0;s<a0.length;s++)t.on(a0[s],this.emit.bind(this,a0[s]));return this._read=function(a){me("wrapped _read",a),i&&(i=!1,t.resume())},this};Object.defineProperty(Ne.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Ne._fromList=DM;function DM(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.head.data:r=e.buffer.concat(e.length),e.buffer.clear()):r=_ee(t,e.buffer,e.decoder),r}function _ee(t,e,r){var i;return t<e.head.data.length?(i=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?i=e.shift():i=r?wee(t,e):bee(t,e),i}function wee(t,e){var r=e.head,i=1,n=r.data;for(t-=n.length;r=r.next;){var s=r.data,a=t>s.length?s.length:t;if(a===s.length?n+=s:n+=s.slice(0,t),t-=a,t===0){a===s.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=s.slice(a));break}++i}return e.length-=i,n}function bee(t,e){var r=Ol.allocUnsafe(t),i=e.head,n=1;for(i.data.copy(r),t-=i.data.length;i=i.next;){var s=i.data,a=t>s.length?s.length:t;if(s.copy(r,r.length-t,0,a),t-=a,t===0){a===s.length?(++n,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=s.slice(a));break}++n}return e.length-=n,r}function l0(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,Ia.nextTick(xee,e,t))}function xee(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function qM(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}});var h0=y((Vfe,LM)=>{"use strict";LM.exports=ei;var uc=$n(),PM=Object.create(ht());PM.inherits=le();PM.inherits(ei,uc);function Tee(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,e!=null&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function ei(t){if(!(this instanceof ei))return new ei(t);uc.call(this,t),this._transformState={afterTransform:Tee.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",Eee)}function Eee(){var t=this;typeof this._flush=="function"?this._flush(function(e,r){MM(t,e,r)}):MM(this,null,null)}ei.prototype.push=function(t,e){return this._transformState.needTransform=!1,uc.prototype.push.call(this,t,e)};ei.prototype._transform=function(t,e,r){throw new Error("_transform() is not implemented")};ei.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};ei.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};ei.prototype._destroy=function(t,e){var r=this;uc.prototype._destroy.call(this,t,function(i){e(i),r.emit("close")})};function MM(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var $M=y((Gfe,WM)=>{"use strict";WM.exports=Al;var BM=h0(),jM=Object.create(ht());jM.inherits=le();jM.inherits(Al,BM);function Al(t){if(!(this instanceof Al))return new Al(t);BM.call(this,t)}Al.prototype._transform=function(t,e,r){r(null,t)}});var ti=y((at,fc)=>{var Tr=require("stream");process.env.READABLE_STREAM==="disable"&&Tr?(fc.exports=Tr,at=fc.exports=Tr.Readable,at.Readable=Tr.Readable,at.Writable=Tr.Writable,at.Duplex=Tr.Duplex,at.Transform=Tr.Transform,at.PassThrough=Tr.PassThrough,at.Stream=Tr):(at=fc.exports=t0(),at.Stream=Tr||at,at.Readable=at,at.Writable=Qw(),at.Duplex=$n(),at.Transform=h0(),at.PassThrough=$M())});var cc=y((Zfe,HM)=>{var Hn=require("stream"),c0=ji(),Cee=require("util"),hc=Fa(),See="function";(!Hn.Writable||!Hn.Writable.prototype.destroy)&&(Hn=ti());function Wi(){if(!(this instanceof Wi))return new Wi;Hn.Duplex.call(this,{decodeStrings:!1,objectMode:!0}),this.buffer=hc.from("");var t=this;t.on("finish",function(){t.finished=!0,t.emit("chunk",!1)})}Cee.inherits(Wi,Hn.Duplex);Wi.prototype._write=function(t,e,r){this.buffer=hc.concat([this.buffer,t]),this.cb=r,this.emit("chunk")};Wi.prototype.stream=function(t,e){var r=Hn.PassThrough(),i,n=this;function s(){if(typeof n.cb===See){var o=n.cb;return n.cb=void 0,o()}}function a(){var o;if(n.buffer&&n.buffer.length){if(typeof t=="number")o=n.buffer.slice(0,t),n.buffer=n.buffer.slice(t),t-=o.length,i=!t;else{var u=n.buffer.indexOf(t);if(u!==-1)n.match=u,e&&(u=u+t.length),o=n.buffer.slice(0,u),n.buffer=n.buffer.slice(u),i=!0;else{var f=n.buffer.length-t.length;f<=0?s():(o=n.buffer.slice(0,f),n.buffer=n.buffer.slice(f))}}o&&r.write(o,function(){(n.buffer.length===0||t.length&&n.buffer.length<=t.length)&&s()})}if(i)n.removeListener("chunk",a),r.end();else if(n.finished){n.removeListener("chunk",a),n.emit("error",new Error("FILE_ENDED"));return}}return n.on("chunk",a),a(),r};Wi.prototype.pull=function(t,e){if(t===0)return c0.resolve("");if(!isNaN(t)&&this.buffer.length>t){var r=this.buffer.slice(0,t);return this.buffer=this.buffer.slice(t),c0.resolve(r)}var i=hc.from(""),n=this,s=Hn.Transform();s._transform=function(u,f,h){i=hc.concat([i,u]),h()};var a,o;return new c0(function(u,f){if(a=f,o=function(h){n.__emittedError=h,f(h)},n.finished)return f(new Error("FILE_ENDED"));n.once("error",o),n.stream(t,e).on("error",f).pipe(s).on("finish",function(){u(i)}).on("error",f)}).finally(function(){n.removeListener("error",a),n.removeListener("error",o)})};Wi.prototype._read=function(){};HM.exports=Wi});var zM=y((Yfe,UM)=>{var Fl=require("stream"),kee=require("util");(!Fl.Writable||!Fl.Writable.prototype.destroy)&&(Fl=ti());function Nl(){if(!(this instanceof Nl))return new Nl;Fl.Transform.call(this)}kee.inherits(Nl,Fl.Transform);Nl.prototype._transform=function(t,e,r){r()};UM.exports=Nl});var pc=y((Kfe,XM)=>{var Ree=ji(),dc=require("stream"),Oee=Fa();(!dc.Writable||!dc.Writable.prototype.destroy)&&(dc=ti());XM.exports=function(t){return new Ree(function(e,r){var i=[],n=dc.Transform().on("finish",function(){e(Oee.concat(i))}).on("error",r);n._transform=function(s,a,o){i.push(s),o()},t.on("error",r).pipe(n)})}});var gc=y((Qfe,VM)=>{var Aee=wl();VM.exports=function(t,e){for(var r;!r&&t&&t.length;){var i=Aee.parse(t).word16lu("signature").word16lu("partsize").word64lu("uncompressedSize").word64lu("compressedSize").word64lu("offset").word64lu("disknum").vars;i.signature===1?r=i:t=t.slice(i.partsize+4)}return r=r||{},e.compressedSize===4294967295&&(e.compressedSize=r.compressedSize),e.uncompressedSize===4294967295&&(e.uncompressedSize=r.uncompressedSize),e.offsetToLocalFileHeader===4294967295&&(e.offsetToLocalFileHeader=r.offset),r}});var mc=y((Jfe,GM)=>{GM.exports=function(e,r){let i=e&31,n=e>>5&15,s=(e>>9&127)+1980,a=r?(r&31)*2:0,o=r?r>>5&63:0,u=r?r>>11:0;return new Date(Date.UTC(s,n-1,i,u,o,a))}});var vc=y((ehe,QM)=>{var Fee=require("util"),Nee=require("zlib"),Dl=require("stream"),ql=wl(),d0=ji(),ZM=cc(),Dee=zM(),qee=pc(),Iee=gc(),YM=Fa(),Mee=mc();(!Dl.Writable||!Dl.Writable.prototype.destroy)&&(Dl=ti());var KM=YM.alloc(4);KM.writeUInt32LE(101010256,0);function nr(t){if(!(this instanceof nr))return new nr(t);var e=this;e._opts=t||{verbose:!1},ZM.call(e,e._opts),e.on("finish",function(){e.emit("end"),e.emit("close")}),e._readRecord().catch(function(r){(!e.__emittedError||e.__emittedError!==r)&&e.emit("error",r)})}Fee.inherits(nr,ZM);nr.prototype._readRecord=function(){var t=this;return t.pull(4).then(function(e){if(e.length!==0){var r=e.readUInt32LE(0);if(r===875721283)return t._readCrxHeader();if(r===67324752)return t._readFile();if(r===33639248)return t.reachedCD=!0,t._readCentralDirectoryFileHeader();if(r===101010256)return t._readEndOfCentralDirectoryRecord();if(t.reachedCD){var i=!0;return t.pull(KM,i).then(function(){return t._readEndOfCentralDirectoryRecord()})}else t.emit("error",new Error("invalid signature: 0x"+r.toString(16)))}})};nr.prototype._readCrxHeader=function(){var t=this;return t.pull(12).then(function(e){return t.crxHeader=ql.parse(e).word32lu("version").word32lu("pubKeyLength").word32lu("signatureLength").vars,t.pull(t.crxHeader.pubKeyLength+t.crxHeader.signatureLength)}).then(function(e){return t.crxHeader.publicKey=e.slice(0,t.crxHeader.pubKeyLength),t.crxHeader.signature=e.slice(t.crxHeader.pubKeyLength),t.emit("crx-header",t.crxHeader),t._readRecord()})};nr.prototype._readFile=function(){var t=this;return t.pull(26).then(function(e){var r=ql.parse(e).word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;return r.lastModifiedDateTime=Mee(r.lastModifiedDate,r.lastModifiedTime),t.crxHeader&&(r.crxHeader=t.crxHeader),t.pull(r.fileNameLength).then(function(i){var n=i.toString("utf8"),s=Dl.PassThrough(),a=!1;return s.autodrain=function(){a=!0;var o=s.pipe(Dee());return o.promise=function(){return new d0(function(u,f){o.on("finish",u),o.on("error",f)})},o},s.buffer=function(){return qee(s)},s.path=n,s.props={},s.props.path=n,s.props.pathBuffer=i,s.props.flags={isUnicode:(r.flags&2048)!=0},s.type=r.uncompressedSize===0&&/[\/\\]$/.test(n)?"Directory":"File",t._opts.verbose&&(s.type==="Directory"?console.log("   creating:",n):s.type==="File"&&(r.compressionMethod===0?console.log(" extracting:",n):console.log("  inflating:",n))),t.pull(r.extraFieldLength).then(function(o){var u=Iee(o,r);s.vars=r,s.extra=u,t._opts.forceStream?t.push(s):(t.emit("entry",s),(t._readableState.pipesCount||t._readableState.pipes&&t._readableState.pipes.length)&&t.push(s)),t._opts.verbose&&console.log({filename:n,vars:r,extra:u});var f=!(r.flags&8)||r.compressedSize>0,h;s.__autodraining=a;var g=r.compressionMethod&&!a?Nee.createInflateRaw():Dl.PassThrough();return f?(s.size=r.uncompressedSize,h=r.compressedSize):(h=YM.alloc(4),h.writeUInt32LE(134695760,0)),new d0(function(m,c){t.stream(h).pipe(g).on("error",function(d){t.emit("error",d)}).pipe(s).on("finish",function(){return f?t._readRecord().then(m).catch(c):t._processDataDescriptor(s).then(m).catch(c)})})})})})};nr.prototype._processDataDescriptor=function(t){var e=this;return e.pull(16).then(function(r){var i=ql.parse(r).word32lu("dataDescriptorSignature").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").vars;return t.size=i.uncompressedSize,e._readRecord()})};nr.prototype._readCentralDirectoryFileHeader=function(){var t=this;return t.pull(42).then(function(e){var r=ql.parse(e).word16lu("versionMadeBy").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumber").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("offsetToLocalFileHeader").vars;return t.pull(r.fileNameLength).then(function(i){return r.fileName=i.toString("utf8"),t.pull(r.extraFieldLength)}).then(function(i){return t.pull(r.fileCommentLength)}).then(function(i){return t._readRecord()})})};nr.prototype._readEndOfCentralDirectoryRecord=function(){var t=this;return t.pull(18).then(function(e){var r=ql.parse(e).word16lu("diskNumber").word16lu("diskStart").word16lu("numberOfRecordsOnDisk").word16lu("numberOfRecords").word32lu("sizeOfCentralDirectory").word32lu("offsetToStartOfCentralDirectory").word16lu("commentLength").vars;return t.pull(r.commentLength).then(function(i){i=i.toString("utf8"),t.end(),t.push(null)})})};nr.prototype.promise=function(){var t=this;return new d0(function(e,r){t.on("finish",e),t.on("error",r)})};QM.exports=nr});var p0=y((the,JM)=>{JM.exports=require("stream")});var Il=y((g0,t2)=>{var yc=require("buffer"),ri=yc.Buffer;function e2(t,e){for(var r in t)e[r]=t[r]}ri.from&&ri.alloc&&ri.allocUnsafe&&ri.allocUnsafeSlow?t2.exports=yc:(e2(yc,g0),g0.Buffer=Ma);function Ma(t,e,r){return ri(t,e,r)}e2(ri,Ma);Ma.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return ri(t,e,r)};Ma.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var i=ri(t);return e!==void 0?typeof r=="string"?i.fill(e,r):i.fill(e):i.fill(0),i};Ma.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return ri(t)};Ma.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return yc.SlowBuffer(t)}});var i2=y((rhe,m0)=>{"use strict";function Pee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r2=Il().Buffer,Ml=require("util");function Lee(t,e,r){t.copy(e,r)}m0.exports=function(){function t(){Pee(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(r){var i={data:r,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length},t.prototype.unshift=function(r){var i={data:r,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length},t.prototype.shift=function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(r){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=r+i.data;return n},t.prototype.concat=function(r){if(this.length===0)return r2.alloc(0);for(var i=r2.allocUnsafe(r>>>0),n=this.head,s=0;n;)Lee(n.data,i,s),s+=n.data.length,n=n.next;return i},t}();Ml&&Ml.inspect&&Ml.inspect.custom&&(m0.exports.prototype[Ml.inspect.custom]=function(){var t=Ml.inspect({length:this.length});return this.constructor.name+" "+t})});var v0=y((ihe,n2)=>{"use strict";var _c=At();function Bee(t,e){var r=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,_c.nextTick(wc,this,t)):_c.nextTick(wc,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?r._writableState?r._writableState.errorEmitted||(r._writableState.errorEmitted=!0,_c.nextTick(wc,r,s)):_c.nextTick(wc,r,s):e&&e(s)}),this)}function jee(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function wc(t,e){t.emit("error",e)}n2.exports={destroy:Bee,undestroy:jee}});var _0=y((nhe,c2)=>{"use strict";var Un=At();c2.exports=Xe;function a2(t){var e=this;this.next=null,this.entry=null,this.finish=function(){nte(e,t)}}var Wee=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:Un.nextTick,Pa;Xe.WritableState=Ll;var o2=Object.create(ht());o2.inherits=le();var $ee={deprecate:lo()},l2=p0(),xc=Il().Buffer,Hee=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Uee(t){return xc.from(t)}function zee(t){return xc.isBuffer(t)||t instanceof Hee}var u2=v0();o2.inherits(Xe,l2);function Xee(){}function Ll(t,e){Pa=Pa||zn(),t=t||{};var r=e instanceof Pa;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,n=t.writableHighWaterMark,s=this.objectMode?16:16*1024;i||i===0?this.highWaterMark=i:r&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=t.decodeStrings===!1;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(o){Jee(e,o)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a2(this)}Ll.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(Ll.prototype,"buffer",{get:$ee.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var bc;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(bc=Function.prototype[Symbol.hasInstance],Object.defineProperty(Xe,Symbol.hasInstance,{value:function(t){return bc.call(this,t)?!0:this!==Xe?!1:t&&t._writableState instanceof Ll}})):bc=function(t){return t instanceof this};function Xe(t){if(Pa=Pa||zn(),!bc.call(Xe,this)&&!(this instanceof Pa))return new Xe(t);this._writableState=new Ll(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),l2.call(this)}Xe.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function Vee(t,e){var r=new Error("write after end");t.emit("error",r),Un.nextTick(e,r)}function Gee(t,e,r,i){var n=!0,s=!1;return r===null?s=new TypeError("May not write null values to stream"):typeof r!="string"&&r!==void 0&&!e.objectMode&&(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),Un.nextTick(i,s),n=!1),n}Xe.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&zee(t);return s&&!xc.isBuffer(t)&&(t=Uee(t)),typeof e=="function"&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof r!="function"&&(r=Xee),i.ended?Vee(this,r):(s||Gee(this,i,t,r))&&(i.pendingcb++,n=Yee(this,i,s,t,e,r)),n};Xe.prototype.cork=function(){var t=this._writableState;t.corked++};Xe.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&f2(this,t))};Xe.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function Zee(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=xc.from(e,r)),e}Object.defineProperty(Xe.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Yee(t,e,r,i,n,s){if(!r){var a=Zee(e,i,n);i!==a&&(r=!0,n="buffer",i=a)}var o=e.objectMode?1:i.length;e.length+=o;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var f=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},f?f.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else y0(t,e,!1,o,i,n,s);return u}function y0(t,e,r,i,n,s,a){e.writelen=i,e.writecb=a,e.writing=!0,e.sync=!0,r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function Kee(t,e,r,i,n){--e.pendingcb,r?(Un.nextTick(n,i),Un.nextTick(Pl,t,e),t._writableState.errorEmitted=!0,t.emit("error",i)):(n(i),t._writableState.errorEmitted=!0,t.emit("error",i),Pl(t,e))}function Qee(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function Jee(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if(Qee(r),e)Kee(t,r,i,e,n);else{var s=h2(r);!s&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&f2(t,r),i?Wee(s2,t,r,s,n):s2(t,r,s,n)}}function s2(t,e,r,i){r||ete(t,e),e.pendingcb--,i(),Pl(t,e)}function ete(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function f2(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=r;for(var a=0,o=!0;r;)n[a]=r,r.isBuf||(o=!1),r=r.next,a+=1;n.allBuffers=o,y0(t,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new a2(e),e.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,f=r.encoding,h=r.callback,g=e.objectMode?1:u.length;if(y0(t,e,!1,g,u,f,h),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Xe.prototype._write=function(t,e,r){r(new Error("_write() is not implemented"))};Xe.prototype._writev=null;Xe.prototype.end=function(t,e,r){var i=this._writableState;typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||ite(this,i,r)};function h2(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function tte(t,e){t._final(function(r){e.pendingcb--,r&&t.emit("error",r),e.prefinished=!0,t.emit("prefinish"),Pl(t,e)})}function rte(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,Un.nextTick(tte,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function Pl(t,e){var r=h2(e);return r&&(rte(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),r}function ite(t,e,r){e.ending=!0,Pl(t,e),r&&(e.finished?Un.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function nte(t,e,r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}Object.defineProperty(Xe.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){!this._writableState||(this._writableState.destroyed=t)}});Xe.prototype.destroy=u2.destroy;Xe.prototype._undestroy=u2.undestroy;Xe.prototype._destroy=function(t,e){this.end(),e(t)}});var zn=y((she,m2)=>{"use strict";var d2=At(),ste=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};m2.exports=ii;var p2=Object.create(ht());p2.inherits=le();var g2=x0(),b0=_0();p2.inherits(ii,g2);for(w0=ste(b0.prototype),Tc=0;Tc<w0.length;Tc++)Ec=w0[Tc],ii.prototype[Ec]||(ii.prototype[Ec]=b0.prototype[Ec]);var w0,Ec,Tc;function ii(t){if(!(this instanceof ii))return new ii(t);g2.call(this,t),b0.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",ate)}Object.defineProperty(ii.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ate(){this.allowHalfOpen||this._writableState.ended||d2.nextTick(ote,this)}function ote(t){t.end()}Object.defineProperty(ii.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});ii.prototype._destroy=function(t,e){this.push(null),this.end(),d2.nextTick(e,t)}});var C0=y(y2=>{"use strict";var E0=Il().Buffer,v2=E0.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function lte(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function ute(t){var e=lte(t);if(typeof e!="string"&&(E0.isEncoding===v2||!v2(t)))throw new Error("Unknown encoding: "+t);return e||t}y2.StringDecoder=Bl;function Bl(t){this.encoding=ute(t);var e;switch(this.encoding){case"utf16le":this.text=gte,this.end=mte,e=4;break;case"utf8":this.fillLast=cte,e=4;break;case"base64":this.text=vte,this.end=yte,e=3;break;default:this.write=_te,this.end=wte;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=E0.allocUnsafe(e)}Bl.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};Bl.prototype.end=pte;Bl.prototype.text=dte;Bl.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function T0(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function fte(t,e,r){var i=e.length-1;if(i<r)return 0;var n=T0(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||n===-2?0:(n=T0(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||n===-2?0:(n=T0(e[i]),n>=0?(n>0&&(n===2?n=0:t.lastNeed=n-3),n):0))}function hte(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function cte(t){var e=this.lastTotal-this.lastNeed,r=hte(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function dte(t,e){var r=fte(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function pte(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function gte(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function mte(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function vte(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function yte(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function _te(t){return t.toString(this.encoding)}function wte(t){return t&&t.length?this.write(t):""}});var x0=y((lhe,A2)=>{"use strict";var Ba=At();A2.exports=De;var bte=_u(),jl;De.ReadableState=C2;var ohe=require("events").EventEmitter,x2=function(t,e){return t.listeners(e).length},A0=p0(),Wl=Il().Buffer,xte=(typeof global<"u"?global:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Tte(t){return Wl.from(t)}function Ete(t){return Wl.isBuffer(t)||t instanceof xte}var T2=Object.create(ht());T2.inherits=le();var S0=require("util"),ve=void 0;S0&&S0.debuglog?ve=S0.debuglog("stream"):ve=function(){};var Cte=i2(),E2=v0(),La;T2.inherits(De,A0);var k0=["error","close","destroy","pause","resume"];function Ste(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):bte(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function C2(t,e){jl=jl||zn(),t=t||{};var r=e instanceof jl;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,n=t.readableHighWaterMark,s=this.objectMode?16:16*1024;i||i===0?this.highWaterMark=i:r&&(n||n===0)?this.highWaterMark=n:this.highWaterMark=s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new Cte,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(La||(La=C0().StringDecoder),this.decoder=new La(t.encoding),this.encoding=t.encoding)}function De(t){if(jl=jl||zn(),!(this instanceof De))return new De(t);this._readableState=new C2(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),A0.call(this)}Object.defineProperty(De.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){!this._readableState||(this._readableState.destroyed=t)}});De.prototype.destroy=E2.destroy;De.prototype._undestroy=E2.undestroy;De.prototype._destroy=function(t,e){this.push(null),e(t)};De.prototype.push=function(t,e){var r=this._readableState,i;return r.objectMode?i=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=Wl.from(t,e),e=""),i=!0),S2(this,t,e,!1,i)};De.prototype.unshift=function(t){return S2(this,t,null,!0,!1)};function S2(t,e,r,i,n){var s=t._readableState;if(e===null)s.reading=!1,Ate(t,s);else{var a;n||(a=kte(s,e)),a?t.emit("error",a):s.objectMode||e&&e.length>0?(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==Wl.prototype&&(e=Tte(e)),i?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):R0(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(e=s.decoder.write(e),s.objectMode||e.length!==0?R0(t,s,e,!1):k2(t,s)):R0(t,s,e,!1))):i||(s.reading=!1)}return Rte(s)}function R0(t,e,r,i){e.flowing&&e.length===0&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&Cc(t)),k2(t,e)}function kte(t,e){var r;return!Ete(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new TypeError("Invalid non-string/buffer chunk")),r}function Rte(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}De.prototype.isPaused=function(){return this._readableState.flowing===!1};De.prototype.setEncoding=function(t){return La||(La=C0().StringDecoder),this._readableState.decoder=new La(t),this._readableState.encoding=t,this};var _2=8388608;function Ote(t){return t>=_2?t=_2:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function w2(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=Ote(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}De.prototype.read=function(t){ve("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return ve("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?O0(this):Cc(this),null;if(t=w2(t,e),t===0&&e.ended)return e.length===0&&O0(this),null;var i=e.needReadable;ve("need readable",i),(e.length===0||e.length-t<e.highWaterMark)&&(i=!0,ve("length less than watermark",i)),e.ended||e.reading?(i=!1,ve("reading or ended",i)):i&&(ve("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=w2(r,e)));var n;return t>0?n=R2(t,e):n=null,n===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&O0(this)),n!==null&&this.emit("data",n),n};function Ate(t,e){if(!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,Cc(t)}}function Cc(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(ve("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?Ba.nextTick(b2,t):b2(t))}function b2(t){ve("emit readable"),t.emit("readable"),F0(t)}function k2(t,e){e.readingMore||(e.readingMore=!0,Ba.nextTick(Fte,t,e))}function Fte(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(ve("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}De.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};De.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,ve("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,s=n?o:w;i.endEmitted?Ba.nextTick(s):r.once("end",s),t.on("unpipe",a);function a(b,C){ve("onunpipe"),b===r&&C&&C.hasUnpiped===!1&&(C.hasUnpiped=!0,h())}function o(){ve("onend"),t.end()}var u=Nte(r);t.on("drain",u);var f=!1;function h(){ve("cleanup"),t.removeListener("close",d),t.removeListener("finish",v),t.removeListener("drain",u),t.removeListener("error",c),t.removeListener("unpipe",a),r.removeListener("end",o),r.removeListener("end",w),r.removeListener("data",m),f=!0,i.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&u()}var g=!1;r.on("data",m);function m(b){ve("ondata"),g=!1;var C=t.write(b);C===!1&&!g&&((i.pipesCount===1&&i.pipes===t||i.pipesCount>1&&O2(i.pipes,t)!==-1)&&!f&&(ve("false write response, pause",i.awaitDrain),i.awaitDrain++,g=!0),r.pause())}function c(b){ve("onerror",b),w(),t.removeListener("error",c),x2(t,"error")===0&&t.emit("error",b)}Ste(t,"error",c);function d(){t.removeListener("finish",v),w()}t.once("close",d);function v(){ve("onfinish"),t.removeListener("close",d),w()}t.once("finish",v);function w(){ve("unpipe"),r.unpipe(t)}return t.emit("pipe",r),i.flowing||(ve("pipe resume"),r.resume()),t};function Nte(t){return function(){var e=t._readableState;ve("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&x2(t,"data")&&(e.flowing=!0,F0(t))}}De.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var a=O2(e.pipes,t);return a===-1?this:(e.pipes.splice(a,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};De.prototype.on=function(t,e){var r=A0.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var i=this._readableState;!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&Cc(this):Ba.nextTick(Dte,this))}return r};De.prototype.addListener=De.prototype.on;function Dte(t){ve("readable nexttick read 0"),t.read(0)}De.prototype.resume=function(){var t=this._readableState;return t.flowing||(ve("resume"),t.flowing=!0,qte(this,t)),this};function qte(t,e){e.resumeScheduled||(e.resumeScheduled=!0,Ba.nextTick(Ite,t,e))}function Ite(t,e){e.reading||(ve("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),F0(t),e.flowing&&!e.reading&&t.read(0)}De.prototype.pause=function(){return ve("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(ve("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function F0(t){var e=t._readableState;for(ve("flow",e.flowing);e.flowing&&t.read()!==null;);}De.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;t.on("end",function(){if(ve("wrapped end"),r.decoder&&!r.ended){var a=r.decoder.end();a&&a.length&&e.push(a)}e.push(null)}),t.on("data",function(a){if(ve("wrapped data"),r.decoder&&(a=r.decoder.write(a)),!(r.objectMode&&a==null)&&!(!r.objectMode&&(!a||!a.length))){var o=e.push(a);o||(i=!0,t.pause())}});for(var n in t)this[n]===void 0&&typeof t[n]=="function"&&(this[n]=function(a){return function(){return t[a].apply(t,arguments)}}(n));for(var s=0;s<k0.length;s++)t.on(k0[s],this.emit.bind(this,k0[s]));return this._read=function(a){ve("wrapped _read",a),i&&(i=!1,t.resume())},this};Object.defineProperty(De.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});De._fromList=R2;function R2(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.head.data:r=e.buffer.concat(e.length),e.buffer.clear()):r=Mte(t,e.buffer,e.decoder),r}function Mte(t,e,r){var i;return t<e.head.data.length?(i=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?i=e.shift():i=r?Pte(t,e):Lte(t,e),i}function Pte(t,e){var r=e.head,i=1,n=r.data;for(t-=n.length;r=r.next;){var s=r.data,a=t>s.length?s.length:t;if(a===s.length?n+=s:n+=s.slice(0,t),t-=a,t===0){a===s.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=s.slice(a));break}++i}return e.length-=i,n}function Lte(t,e){var r=Wl.allocUnsafe(t),i=e.head,n=1;for(i.data.copy(r),t-=i.data.length;i=i.next;){var s=i.data,a=t>s.length?s.length:t;if(s.copy(r,r.length-t,0,a),t-=a,t===0){a===s.length?(++n,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=s.slice(a));break}++n}return e.length-=n,r}function O0(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,Ba.nextTick(Bte,e,t))}function Bte(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function O2(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}});var N0=y((uhe,D2)=>{"use strict";D2.exports=ni;var Sc=zn(),N2=Object.create(ht());N2.inherits=le();N2.inherits(ni,Sc);function jte(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,e!=null&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function ni(t){if(!(this instanceof ni))return new ni(t);Sc.call(this,t),this._transformState={afterTransform:jte.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",Wte)}function Wte(){var t=this;typeof this._flush=="function"?this._flush(function(e,r){F2(t,e,r)}):F2(this,null,null)}ni.prototype.push=function(t,e){return this._transformState.needTransform=!1,Sc.prototype.push.call(this,t,e)};ni.prototype._transform=function(t,e,r){throw new Error("_transform() is not implemented")};ni.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};ni.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};ni.prototype._destroy=function(t,e){var r=this;Sc.prototype._destroy.call(this,t,function(i){e(i),r.emit("close")})};function F2(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var P2=y((fhe,M2)=>{"use strict";M2.exports=$l;var q2=N0(),I2=Object.create(ht());I2.inherits=le();I2.inherits($l,q2);function $l(t){if(!(this instanceof $l))return new $l(t);q2.call(this,t)}$l.prototype._transform=function(t,e,r){r(null,t)}});var L2=y((ot,kc)=>{var Er=require("stream");process.env.READABLE_STREAM==="disable"&&Er?(kc.exports=Er,ot=kc.exports=Er.Readable,ot.Readable=Er.Readable,ot.Writable=Er.Writable,ot.Duplex=Er.Duplex,ot.Transform=Er.Transform,ot.PassThrough=Er.PassThrough,ot.Stream=Er):(ot=kc.exports=x0(),ot.Stream=Er||ot,ot.Readable=ot,ot.Writable=_0(),ot.Duplex=zn(),ot.Transform=N0(),ot.PassThrough=P2())});var I0=y((hhe,q0)=>{"use strict";var D0=L2();function ja(t,e,r){typeof r>"u"&&(r=e,e=t,t=null),D0.Duplex.call(this,t),typeof r.read!="function"&&(r=new D0.Readable(t).wrap(r)),this._writable=e,this._readable=r,this._waiting=!1;var i=this;e.once("finish",function(){i.end()}),this.once("finish",function(){e.end()}),r.on("readable",function(){i._waiting&&(i._waiting=!1,i._read())}),r.once("end",function(){i.push(null)}),(!t||typeof t.bubbleErrors>"u"||t.bubbleErrors)&&(e.on("error",function(n){i.emit("error",n)}),r.on("error",function(n){i.emit("error",n)}))}ja.prototype=Object.create(D0.Duplex.prototype,{constructor:{value:ja}});ja.prototype._write=function(e,r,i){this._writable.write(e,r,i)};ja.prototype._read=function(){for(var e,r=0;(e=this._readable.read())!==null;)this.push(e),r++;r===0&&(this._waiting=!0)};q0.exports=function(e,r,i){return new ja(e,r,i)};q0.exports.DuplexWrapper=ja});var j2=y((che,B2)=>{var Wa=require("stream"),$te=vc(),Hte=I0(),Ute=pc();(!Wa.Writable||!Wa.Writable.prototype.destroy)&&(Wa=ti());function zte(t,e){var r=Wa.PassThrough({objectMode:!0}),i=Wa.PassThrough(),n=Wa.Transform({objectMode:!0}),s=t instanceof RegExp?t:t&&new RegExp(t),a;n._transform=function(u,f,h){if(a||s&&!s.exec(u.path))return u.autodrain(),h();a=!0,o.emit("entry",u),u.on("error",function(g){i.emit("error",g)}),u.pipe(i).on("error",function(g){h(g)}).on("finish",function(g){h(null,g)})},r.pipe($te(e)).on("error",function(u){i.emit("error",u)}).pipe(n).on("error",Object).on("finish",function(){a?i.end():i.emit("error",new Error("PATTERN_NOT_FOUND"))});var o=Hte(r,i);return o.buffer=function(){return Ute(i)},o}B2.exports=zte});var Rc=y((dhe,$2)=>{$2.exports=$i;var M0=require("stream").Stream,Xte=le();function $i(){M0.call(this)}Xte($i,M0);$i.prototype.on=function(t,e){return t==="ready"&&this.ready?process.nextTick(e.bind(this)):M0.prototype.on.call(this,t,e),this};$i.prototype.abort=function(){this._aborted=!0,this.emit("abort")};$i.prototype.destroy=function(){};$i.prototype.warn=function(t,e){var r=this,i=W2(t,e,r);r.listeners("warn")?r.emit("warn",i):console.error(`%s %s
path = %s
syscall = %s
fstream_type = %s
fstream_path = %s
fstream_unc_path = %s
fstream_class = %s
fstream_stack =
%s
`,e||"UNKNOWN",i.stack,i.path,i.syscall,i.fstream_type,i.fstream_path,i.fstream_unc_path,i.fstream_class,i.fstream_stack.join(`
`))};$i.prototype.info=function(t,e){this.emit("info",t,e)};$i.prototype.error=function(t,e,r){var i=W2(t,e,this);if(r)throw i;this.emit("error",i)};function W2(t,e,r){return t instanceof Error||(t=new Error(t)),t.code=t.code||e,t.path=t.path||r.path,t.fstream_type=t.fstream_type||r.type,t.fstream_path=t.fstream_path||r.path,r._path!==r.path&&(t.fstream_unc_path=t.fstream_unc_path||r._path),r.linkpath&&(t.fstream_linkpath=t.fstream_linkpath||r.linkpath),t.fstream_class=t.fstream_class||r.constructor.name,t.fstream_stack=t.fstream_stack||new Error().stack.split(/\n/).slice(3).map(function(i){return i.replace(/^ {4}at /,"")}),t}});var U2=y((phe,H2)=>{var Hi=require("constants"),Vte=process.cwd,Oc=null,Gte=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Oc||(Oc=Vte.call(process)),Oc};try{process.cwd()}catch{}typeof process.chdir=="function"&&(P0=process.chdir,process.chdir=function(t){Oc=null,P0.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,P0));var P0;H2.exports=Zte;function Zte(t){Hi.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||r(t),t.chown=s(t.chown),t.fchown=s(t.fchown),t.lchown=s(t.lchown),t.chmod=i(t.chmod),t.fchmod=i(t.fchmod),t.lchmod=i(t.lchmod),t.chownSync=a(t.chownSync),t.fchownSync=a(t.fchownSync),t.lchownSync=a(t.lchownSync),t.chmodSync=n(t.chmodSync),t.fchmodSync=n(t.fchmodSync),t.lchmodSync=n(t.lchmodSync),t.stat=o(t.stat),t.fstat=o(t.fstat),t.lstat=o(t.lstat),t.statSync=u(t.statSync),t.fstatSync=u(t.fstatSync),t.lstatSync=u(t.lstatSync),t.chmod&&!t.lchmod&&(t.lchmod=function(h,g,m){m&&process.nextTick(m)},t.lchmodSync=function(){}),t.chown&&!t.lchown&&(t.lchown=function(h,g,m,c){c&&process.nextTick(c)},t.lchownSync=function(){}),Gte==="win32"&&(t.rename=typeof t.rename!="function"?t.rename:function(h){function g(m,c,d){var v=Date.now(),w=0;h(m,c,function b(C){if(C&&(C.code==="EACCES"||C.code==="EPERM"||C.code==="EBUSY")&&Date.now()-v<6e4){setTimeout(function(){t.stat(c,function(O,R){O&&O.code==="ENOENT"?h(m,c,b):d(C)})},w),w<100&&(w+=10);return}d&&d(C)})}return Object.setPrototypeOf&&Object.setPrototypeOf(g,h),g}(t.rename)),t.read=typeof t.read!="function"?t.read:function(h){function g(m,c,d,v,w,b){var C;if(b&&typeof b=="function"){var O=0;C=function(R,M,X){if(R&&R.code==="EAGAIN"&&O<10)return O++,h.call(t,m,c,d,v,w,C);b.apply(this,arguments)}}return h.call(t,m,c,d,v,w,C)}return Object.setPrototypeOf&&Object.setPrototypeOf(g,h),g}(t.read),t.readSync=typeof t.readSync!="function"?t.readSync:function(h){return function(g,m,c,d,v){for(var w=0;;)try{return h.call(t,g,m,c,d,v)}catch(b){if(b.code==="EAGAIN"&&w<10){w++;continue}throw b}}}(t.readSync);function e(h){h.lchmod=function(g,m,c){h.open(g,Hi.O_WRONLY|Hi.O_SYMLINK,m,function(d,v){if(d){c&&c(d);return}h.fchmod(v,m,function(w){h.close(v,function(b){c&&c(w||b)})})})},h.lchmodSync=function(g,m){var c=h.openSync(g,Hi.O_WRONLY|Hi.O_SYMLINK,m),d=!0,v;try{v=h.fchmodSync(c,m),d=!1}finally{if(d)try{h.closeSync(c)}catch{}else h.closeSync(c)}return v}}function r(h){Hi.hasOwnProperty("O_SYMLINK")&&h.futimes?(h.lutimes=function(g,m,c,d){h.open(g,Hi.O_SYMLINK,function(v,w){if(v){d&&d(v);return}h.futimes(w,m,c,function(b){h.close(w,function(C){d&&d(b||C)})})})},h.lutimesSync=function(g,m,c){var d=h.openSync(g,Hi.O_SYMLINK),v,w=!0;try{v=h.futimesSync(d,m,c),w=!1}finally{if(w)try{h.closeSync(d)}catch{}else h.closeSync(d)}return v}):h.futimes&&(h.lutimes=function(g,m,c,d){d&&process.nextTick(d)},h.lutimesSync=function(){})}function i(h){return h&&function(g,m,c){return h.call(t,g,m,function(d){f(d)&&(d=null),c&&c.apply(this,arguments)})}}function n(h){return h&&function(g,m){try{return h.call(t,g,m)}catch(c){if(!f(c))throw c}}}function s(h){return h&&function(g,m,c,d){return h.call(t,g,m,c,function(v){f(v)&&(v=null),d&&d.apply(this,arguments)})}}function a(h){return h&&function(g,m,c){try{return h.call(t,g,m,c)}catch(d){if(!f(d))throw d}}}function o(h){return h&&function(g,m,c){typeof m=="function"&&(c=m,m=null);function d(v,w){w&&(w.uid<0&&(w.uid+=4294967296),w.gid<0&&(w.gid+=4294967296)),c&&c.apply(this,arguments)}return m?h.call(t,g,m,d):h.call(t,g,d)}}function u(h){return h&&function(g,m){var c=m?h.call(t,g,m):h.call(t,g);return c&&(c.uid<0&&(c.uid+=4294967296),c.gid<0&&(c.gid+=4294967296)),c}}function f(h){if(!h||h.code==="ENOSYS")return!0;var g=!process.getuid||process.getuid()!==0;return!!(g&&(h.code==="EINVAL"||h.code==="EPERM"))}}});var V2=y((ghe,X2)=>{var z2=require("stream").Stream;X2.exports=Yte;function Yte(t){return{ReadStream:e,WriteStream:r};function e(i,n){if(!(this instanceof e))return new e(i,n);z2.call(this);var s=this;this.path=i,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,n=n||{};for(var a=Object.keys(n),o=0,u=a.length;o<u;o++){var f=a[o];this[f]=n[f]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}t.open(this.path,this.flags,this.mode,function(h,g){if(h){s.emit("error",h),s.readable=!1;return}s.fd=g,s.emit("open",g),s._read()})}function r(i,n){if(!(this instanceof r))return new r(i,n);z2.call(this),this.path=i,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var s=Object.keys(n),a=0,o=s.length;a<o;a++){var u=s[a];this[u]=n[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var Z2=y((mhe,G2)=>{"use strict";G2.exports=Qte;var Kte=Object.getPrototypeOf||function(t){return t.__proto__};function Qte(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:Kte(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}});var Cr=y((vhe,j0)=>{var Be=require("fs"),Jte=U2(),ere=V2(),tre=Z2(),Ac=require("util"),lt,Nc;typeof Symbol=="function"&&typeof Symbol.for=="function"?(lt=Symbol.for("graceful-fs.queue"),Nc=Symbol.for("graceful-fs.previous")):(lt="___graceful-fs.queue",Nc="___graceful-fs.previous");function rre(){}function Q2(t,e){Object.defineProperty(t,lt,{get:function(){return e}})}var Xn=rre;Ac.debuglog?Xn=Ac.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Xn=function(){var t=Ac.format.apply(Ac,arguments);t="GFS4: "+t.split(/\n/).join(`
GFS4: `),console.error(t)});Be[lt]||(Y2=global[lt]||[],Q2(Be,Y2),Be.close=function(t){function e(r,i){return t.call(Be,r,function(n){n||K2(),typeof i=="function"&&i.apply(this,arguments)})}return Object.defineProperty(e,Nc,{value:t}),e}(Be.close),Be.closeSync=function(t){function e(r){t.apply(Be,arguments),K2()}return Object.defineProperty(e,Nc,{value:t}),e}(Be.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Xn(Be[lt]),require("assert").equal(Be[lt].length,0)}));var Y2;global[lt]||Q2(global,Be[lt]);j0.exports=L0(tre(Be));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!Be.__patched&&(j0.exports=L0(Be),Be.__patched=!0);function L0(t){Jte(t),t.gracefulify=L0,t.createReadStream=M,t.createWriteStream=X;var e=t.readFile;t.readFile=r;function r(P,G,q){return typeof G=="function"&&(q=G,G=null),E(P,G,q);function E(A,$,B,T){return e(A,$,function(k){k&&(k.code==="EMFILE"||k.code==="ENFILE")?$a([E,[A,$,B],k,T||Date.now(),Date.now()]):typeof B=="function"&&B.apply(this,arguments)})}}var i=t.writeFile;t.writeFile=n;function n(P,G,q,E){return typeof q=="function"&&(E=q,q=null),A(P,G,q,E);function A($,B,T,k,N){return i($,B,T,function(j){j&&(j.code==="EMFILE"||j.code==="ENFILE")?$a([A,[$,B,T,k],j,N||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}var s=t.appendFile;s&&(t.appendFile=a);function a(P,G,q,E){return typeof q=="function"&&(E=q,q=null),A(P,G,q,E);function A($,B,T,k,N){return s($,B,T,function(j){j&&(j.code==="EMFILE"||j.code==="ENFILE")?$a([A,[$,B,T,k],j,N||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}var o=t.copyFile;o&&(t.copyFile=u);function u(P,G,q,E){return typeof q=="function"&&(E=q,q=0),A(P,G,q,E);function A($,B,T,k,N){return o($,B,T,function(j){j&&(j.code==="EMFILE"||j.code==="ENFILE")?$a([A,[$,B,T,k],j,N||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}var f=t.readdir;t.readdir=g;var h=/^v[0-5]\./;function g(P,G,q){typeof G=="function"&&(q=G,G=null);var E=h.test(process.version)?function(B,T,k,N){return f(B,A(B,T,k,N))}:function(B,T,k,N){return f(B,T,A(B,T,k,N))};return E(P,G,q);function A($,B,T,k){return function(N,j){N&&(N.code==="EMFILE"||N.code==="ENFILE")?$a([E,[$,B,T],N,k||Date.now(),Date.now()]):(j&&j.sort&&j.sort(),typeof T=="function"&&T.call(this,N,j))}}}if(process.version.substr(0,4)==="v0.8"){var m=ere(t);b=m.ReadStream,O=m.WriteStream}var c=t.ReadStream;c&&(b.prototype=Object.create(c.prototype),b.prototype.open=C);var d=t.WriteStream;d&&(O.prototype=Object.create(d.prototype),O.prototype.open=R),Object.defineProperty(t,"ReadStream",{get:function(){return b},set:function(P){b=P},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return O},set:function(P){O=P},enumerable:!0,configurable:!0});var v=b;Object.defineProperty(t,"FileReadStream",{get:function(){return v},set:function(P){v=P},enumerable:!0,configurable:!0});var w=O;Object.defineProperty(t,"FileWriteStream",{get:function(){return w},set:function(P){w=P},enumerable:!0,configurable:!0});function b(P,G){return this instanceof b?(c.apply(this,arguments),this):b.apply(Object.create(b.prototype),arguments)}function C(){var P=this;W(P.path,P.flags,P.mode,function(G,q){G?(P.autoClose&&P.destroy(),P.emit("error",G)):(P.fd=q,P.emit("open",q),P.read())})}function O(P,G){return this instanceof O?(d.apply(this,arguments),this):O.apply(Object.create(O.prototype),arguments)}function R(){var P=this;W(P.path,P.flags,P.mode,function(G,q){G?(P.destroy(),P.emit("error",G)):(P.fd=q,P.emit("open",q))})}function M(P,G){return new t.ReadStream(P,G)}function X(P,G){return new t.WriteStream(P,G)}var H=t.open;t.open=W;function W(P,G,q,E){return typeof q=="function"&&(E=q,q=null),A(P,G,q,E);function A($,B,T,k,N){return H($,B,T,function(j,V){j&&(j.code==="EMFILE"||j.code==="ENFILE")?$a([A,[$,B,T,k],j,N||Date.now(),Date.now()]):typeof k=="function"&&k.apply(this,arguments)})}}return t}function $a(t){Xn("ENQUEUE",t[0].name,t[1]),Be[lt].push(t),B0()}var Fc;function K2(){for(var t=Date.now(),e=0;e<Be[lt].length;++e)Be[lt][e].length>2&&(Be[lt][e][3]=t,Be[lt][e][4]=t);B0()}function B0(){if(clearTimeout(Fc),Fc=void 0,Be[lt].length!==0){var t=Be[lt].shift(),e=t[0],r=t[1],i=t[2],n=t[3],s=t[4];if(n===void 0)Xn("RETRY",e.name,r),e.apply(null,r);else if(Date.now()-n>=6e4){Xn("TIMEOUT",e.name,r);var a=r.pop();typeof a=="function"&&a.call(null,i)}else{var o=Date.now()-s,u=Math.max(s-n,1),f=Math.min(u*1.2,100);o>=f?(Xn("RETRY",e.name,r),e.apply(null,r.concat([n]))):Be[lt].push(t)}Fc===void 0&&(Fc=setTimeout(B0,0))}}});var Hl=y((yhe,J2)=>{J2.exports=ire;function ire(t){var e=["Directory","File","SymbolicLink","Link","BlockDevice","CharacterDevice","FIFO","Socket"],r;if(t.type&&e.indexOf(t.type)!==-1)return t[t.type]=!0,t.type;for(var i=0,n=e.length;i<n;i++){r=e[i];var s=t[r]||t["is"+r];if(typeof s=="function"&&(s=s.call(t)),s)return t[r]=!0,t.type=r,r}return null}});var $0=y((_he,eP)=>{eP.exports=Ul;var nre=Cr(),sre=le(),W0=Vn();sre(Ul,W0);function Ul(t){var e=this;if(!(e instanceof Ul))throw new Error("LinkReader must be called as constructor.");if(!(t.type==="Link"&&t.Link||t.type==="SymbolicLink"&&t.SymbolicLink))throw new Error("Non-link type "+t.type);W0.call(e,t)}Ul.prototype._stat=function(t){var e=this;nre.readlink(e._path,function(r,i){if(r)return e.error(r);e.linkpath=e.props.linkpath=i,e.emit("linkpath",i),W0.prototype._stat.call(e,t)})};Ul.prototype._read=function(){var t=this;t._paused||t._ended||(t.emit("end"),t.emit("close"),t._ended=!0)}});var U0=y((whe,iP)=>{iP.exports=Sr;var rP=Cr(),are=le(),zl=require("path"),H0=Vn(),tP=require("assert").ok;are(Sr,H0);function Sr(t){var e=this;if(!(e instanceof Sr))throw new Error("DirReader must be called as constructor.");if(t.type!=="Directory"||!t.Directory)throw new Error("Non-directory type "+t.type);e.entries=null,e._index=-1,e._paused=!1,e._length=-1,t.sort&&(this.sort=t.sort),H0.call(this,t)}Sr.prototype._getEntries=function(){var t=this;t._gotEntries||(t._gotEntries=!0,rP.readdir(t._path,function(e,r){if(e)return t.error(e);t.entries=r,t.emit("entries",r),t._paused?t.once("resume",i):i();function i(){t._length=t.entries.length,typeof t.sort=="function"&&(t.entries=t.entries.sort(t.sort.bind(t))),t._read()}}))};Sr.prototype._read=function(){var t=this;if(!t.entries)return t._getEntries();if(!(t._paused||t._currentEntry||t._aborted)){if(t._index++,t._index>=t.entries.length){t._ended||(t._ended=!0,t.emit("end"),t.emit("close"));return}var e=zl.resolve(t._path,t.entries[t._index]);tP(e!==t._path),tP(t.entries[t._index]),t._currentEntry=e,rP[t.props.follow?"stat":"lstat"](e,function(r,i){if(r)return t.error(r);var n=t._proxy||t;i.path=e,i.basename=zl.basename(e),i.dirname=zl.dirname(e);var s=t.getChildProps.call(n,i);s.path=e,s.basename=zl.basename(e),s.dirname=zl.dirname(e);var a=H0(s,i);t._currentEntry=a,a.on("pause",function(f){!t._paused&&!a._disowned&&t.pause(f)}),a.on("resume",function(f){t._paused&&!a._disowned&&t.resume(f)}),a.on("stat",function(f){t.emit("_entryStat",a,f),!a._aborted&&(a._paused?a.once("resume",function(){t.emit("entryStat",a,f)}):t.emit("entryStat",a,f))}),a.on("ready",function f(){if(t._paused)return a.pause(t),t.once("resume",f);a.type==="Socket"?t.emit("socket",a):t.emitEntry(a)});var o=!1;a.on("close",u),a.on("disown",u);function u(){o||(o=!0,t.emit("childEnd",a),t.emit("entryEnd",a),t._currentEntry=null,t._paused||t._read())}a.on("error",function(f){a._swallowErrors?(t.warn(f),a.emit("end"),a.emit("close")):t.emit("error",f)}),["child","childEnd","warn"].forEach(function(f){a.on(f,t.emit.bind(t,f))})})}};Sr.prototype.disown=function(t){t.emit("beforeDisown"),t._disowned=!0,t.parent=t.root=null,t===this._currentEntry&&(this._currentEntry=null),t.emit("disown")};Sr.prototype.getChildProps=function(){return{depth:this.depth+1,root:this.root||this,parent:this,follow:this.follow,filter:this.filter,sort:this.props.sort,hardlinks:this.props.hardlinks}};Sr.prototype.pause=function(t){var e=this;e._paused||(t=t||e,e._paused=!0,e._currentEntry&&e._currentEntry.pause&&e._currentEntry.pause(t),e.emit("pause",t))};Sr.prototype.resume=function(t){var e=this;!e._paused||(t=t||e,e._paused=!1,e.emit("resume",t),!e._paused&&(e._currentEntry?e._currentEntry.resume&&e._currentEntry.resume(t):e._read()))};Sr.prototype.emitEntry=function(t){this.emit("entry",t),this.emit("child",t)}});var z0=y((bhe,oP)=>{oP.exports=Gn;var ore=Cr(),lre=le(),nP=Vn(),sP={EOF:!0},aP={CLOSE:!0};lre(Gn,nP);function Gn(t){var e=this;if(!(e instanceof Gn))throw new Error("FileReader must be called as constructor.");if(!(t.type==="Link"&&t.Link||t.type==="File"&&t.File))throw new Error("Non-file type "+t.type);e._buffer=[],e._bytesEmitted=0,nP.call(e,t)}Gn.prototype._getStream=function(){var t=this,e=t._stream=ore.createReadStream(t._path,t.props);t.props.blksize&&(e.bufferSize=t.props.blksize),e.on("open",t.emit.bind(t,"open")),e.on("data",function(r){if(t._bytesEmitted+=r.length,r.length)t._paused||t._buffer.length?(t._buffer.push(r),t._read()):t.emit("data",r);else return}),e.on("end",function(){t._paused||t._buffer.length?(t._buffer.push(sP),t._read()):t.emit("end"),t._bytesEmitted!==t.props.size&&t.error(`Didn't get expected byte count
expect: `+t.props.size+`
actual: `+t._bytesEmitted)}),e.on("close",function(){t._paused||t._buffer.length?(t._buffer.push(aP),t._read()):t.emit("close")}),e.on("error",function(r){t.emit("error",r)}),t._read()};Gn.prototype._read=function(){var t=this;if(!t._paused){if(!t._stream)return t._getStream();if(t._buffer.length){for(var e=t._buffer,r=0,i=e.length;r<i;r++){var n=e[r];if(n===sP?t.emit("end"):n===aP?t.emit("close"):t.emit("data",n),t._paused){t._buffer=e.slice(r);return}}t._buffer.length=0}}};Gn.prototype.pause=function(t){var e=this;e._paused||(t=t||e,e._paused=!0,e._stream&&e._stream.pause(),e.emit("pause",t))};Gn.prototype.resume=function(t){var e=this;!e._paused||(t=t||e,e.emit("resume",t),e._paused=!1,e._stream&&e._stream.resume(),e._read())}});var fP=y((xhe,uP)=>{uP.exports=Dc;var ure=le(),lP=Vn();ure(Dc,lP);function Dc(t){var e=this;if(!(e instanceof Dc))throw new Error("SocketReader must be called as constructor.");if(!(t.type==="Socket"&&t.Socket))throw new Error("Non-socket type "+t.type);lP.call(e,t)}Dc.prototype._read=function(){var t=this;t._paused||t._ended||(t.emit("end"),t.emit("close"),t._ended=!0)}});var V0=y((The,hP)=>{hP.exports=Zn;var X0=Vn(),fre=Hl(),hre=le(),cre=Cr();hre(Zn,X0);function Zn(t){var e=this;if(!(e instanceof Zn))throw new Error("ProxyReader must be called as constructor.");e.props=t,e._buffer=[],e.ready=!1,X0.call(e,t)}Zn.prototype._stat=function(){var t=this,e=t.props,r=e.follow?"stat":"lstat";cre[r](e.path,function(i,n){var s;i||!n?s="File":s=fre(n),e[s]=!0,e.type=t.type=s,t._old=n,t._addProxy(X0(e,n))})};Zn.prototype._addProxy=function(t){var e=this;if(e._proxyTarget)return e.error("proxy already set");e._proxyTarget=t,t._proxy=e,["error","data","end","close","linkpath","entry","entryEnd","child","childEnd","warn","stat"].forEach(function(i){t.on(i,e.emit.bind(e,i))}),e.emit("proxy",t),t.on("ready",function(){e.ready=!0,e.emit("ready")});var r=e._buffer;e._buffer.length=0,r.forEach(function(i){t[i[0]].apply(t,i[1])})};Zn.prototype.pause=function(){return this._proxyTarget?this._proxyTarget.pause():!1};Zn.prototype.resume=function(){return this._proxyTarget?this._proxyTarget.resume():!1}});var Vn=y((Ehe,pP)=>{pP.exports=sr;var dre=Cr(),pre=require("stream").Stream,gre=le(),G0=require("path"),Z0=Hl(),qc=sr.hardLinks={},cP=Rc();gre(sr,cP);var dP=$0();function sr(t,e){var r=this;if(!(r instanceof sr))return new sr(t,e);typeof t=="string"&&(t={path:t});var i,n;switch(t.type&&typeof t.type=="function"?(i=t.type,n=i):(i=Z0(t),n=sr),e&&!i&&(i=Z0(e),t[i]=!0,t.type=i),i){case"Directory":n=U0();break;case"Link":case"File":n=z0();break;case"SymbolicLink":n=dP;break;case"Socket":n=fP();break;case null:n=V0();break}if(!(r instanceof n))return new n(t);cP.call(r),t.path||r.error("Must provide a path",null,!0),r.readable=!0,r.writable=!1,r.type=i,r.props=t,r.depth=t.depth=t.depth||0,r.parent=t.parent||null,r.root=t.root||t.parent&&t.parent.root||r,r._path=r.path=G0.resolve(t.path),process.platform==="win32"&&(r.path=r._path=r.path.replace(/\?/g,"_"),r._path.length>=260&&(r._swallowErrors=!0,r._path="\\\\?\\"+r.path.replace(/\//g,"\\"))),r.basename=t.basename=G0.basename(r.path),r.dirname=t.dirname=G0.dirname(r.path),t.parent=t.root=null,r.size=t.size,r.filter=typeof t.filter=="function"?t.filter:null,t.sort==="alpha"&&(t.sort=mre),r._stat(e)}function mre(t,e){return t===e?0:t.toLowerCase()>e.toLowerCase()?1:t.toLowerCase()<e.toLowerCase()?-1:t>e?1:-1}sr.prototype._stat=function(t){var e=this,r=e.props,i=r.follow?"stat":"lstat";t?process.nextTick(n.bind(null,null,t)):dre[i](e._path,n);function n(s,a){if(s)return e.error(s);if(Object.keys(a).forEach(function(c){r[c]=a[c]}),e.size!==void 0&&r.size!==e.size)return e.error("incorrect size");e.size=r.size;var o=Z0(r),u=r.hardlinks!==!1;if(u&&o!=="Directory"&&r.nlink&&r.nlink>1){var f=r.dev+":"+r.ino;qc[f]===e._path||!qc[f]?qc[f]=e._path:(o=e.type=e.props.type="Link",e.Link=e.props.Link=!0,e.linkpath=e.props.linkpath=qc[f],e._stat=e._read=dP.prototype._read)}if(e.type&&e.type!==o&&e.error("Unexpected type: "+o),e.filter){var h=e._proxy||e;if(!e.filter.call(h,h,r)){e._disowned||(e.abort(),e.emit("end"),e.emit("close"));return}}var g=["_stat","stat","ready"],m=0;(function c(){if(e._aborted){e.emit("end"),e.emit("close");return}if(e._paused&&e.type!=="Directory"){e.once("resume",c);return}var d=g[m++];if(!d)return e._read();e.emit(d,r),c()})()}};sr.prototype.pipe=function(t){var e=this;return typeof t.add=="function"&&e.on("entry",function(r){var i=t.add(r);i===!1&&e.pause()}),pre.prototype.pipe.apply(this,arguments)};sr.prototype.pause=function(t){this._paused=!0,t=t||this,this.emit("pause",t),this._stream&&this._stream.pause(t)};sr.prototype.resume=function(t){this._paused=!1,t=t||this,this.emit("resume",t),this._stream&&this._stream.resume(t),this._read()};sr.prototype._read=function(){this.error("Cannot read unknown type: "+this.type)}});var gP=y(Y0=>{var Yn=require("path"),zi=process.platform==="win32",Ui=require("fs"),vre=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function yre(){var t;if(vre){var e=new Error;t=r}else t=i;return t;function r(n){n&&(e.message=n.message,n=e,i(n))}function i(n){if(n){if(process.throwDeprecation)throw n;if(!process.noDeprecation){var s="fs: missing callback "+(n.stack||n.message);process.traceDeprecation?console.trace(s):console.error(s)}}}}function _re(t){return typeof t=="function"?t:yre()}var Che=Yn.normalize;zi?si=/(.*?)(?:[\/\\]+|$)/g:si=/(.*?)(?:[\/]+|$)/g;var si;zi?Xl=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:Xl=/^[\/]*/;var Xl;Y0.realpathSync=function(e,r){if(e=Yn.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return r[e];var i=e,n={},s={},a,o,u,f;h();function h(){var w=Xl.exec(e);a=w[0].length,o=w[0],u=w[0],f="",zi&&!s[u]&&(Ui.lstatSync(u),s[u]=!0)}for(;a<e.length;){si.lastIndex=a;var g=si.exec(e);if(f=o,o+=g[0],u=f+g[1],a=si.lastIndex,!(s[u]||r&&r[u]===u)){var m;if(r&&Object.prototype.hasOwnProperty.call(r,u))m=r[u];else{var c=Ui.lstatSync(u);if(!c.isSymbolicLink()){s[u]=!0,r&&(r[u]=u);continue}var d=null;if(!zi){var v=c.dev.toString(32)+":"+c.ino.toString(32);n.hasOwnProperty(v)&&(d=n[v])}d===null&&(Ui.statSync(u),d=Ui.readlinkSync(u)),m=Yn.resolve(f,d),r&&(r[u]=m),zi||(n[v]=d)}e=Yn.resolve(m,e.slice(a)),h()}}return r&&(r[i]=e),e};Y0.realpath=function(e,r,i){if(typeof i!="function"&&(i=_re(r),r=null),e=Yn.resolve(e),r&&Object.prototype.hasOwnProperty.call(r,e))return process.nextTick(i.bind(null,null,r[e]));var n=e,s={},a={},o,u,f,h;g();function g(){var w=Xl.exec(e);o=w[0].length,u=w[0],f=w[0],h="",zi&&!a[f]?Ui.lstat(f,function(b){if(b)return i(b);a[f]=!0,m()}):process.nextTick(m)}function m(){if(o>=e.length)return r&&(r[n]=e),i(null,e);si.lastIndex=o;var w=si.exec(e);return h=u,u+=w[0],f=h+w[1],o=si.lastIndex,a[f]||r&&r[f]===f?process.nextTick(m):r&&Object.prototype.hasOwnProperty.call(r,f)?v(r[f]):Ui.lstat(f,c)}function c(w,b){if(w)return i(w);if(!b.isSymbolicLink())return a[f]=!0,r&&(r[f]=f),process.nextTick(m);if(!zi){var C=b.dev.toString(32)+":"+b.ino.toString(32);if(s.hasOwnProperty(C))return d(null,s[C],f)}Ui.stat(f,function(O){if(O)return i(O);Ui.readlink(f,function(R,M){zi||(s[C]=M),d(R,M)})})}function d(w,b,C){if(w)return i(w);var O=Yn.resolve(h,b);r&&(r[C]=O),v(O)}function v(w){e=Yn.resolve(w,e.slice(o)),g()}}});var eb=y((khe,_P)=>{_P.exports=Xi;Xi.realpath=Xi;Xi.sync=J0;Xi.realpathSync=J0;Xi.monkeypatch=bre;Xi.unmonkeypatch=xre;var Ha=require("fs"),K0=Ha.realpath,Q0=Ha.realpathSync,wre=process.version,mP=/^v[0-5]\./.test(wre),vP=gP();function yP(t){return t&&t.syscall==="realpath"&&(t.code==="ELOOP"||t.code==="ENOMEM"||t.code==="ENAMETOOLONG")}function Xi(t,e,r){if(mP)return K0(t,e,r);typeof e=="function"&&(r=e,e=null),K0(t,e,function(i,n){yP(i)?vP.realpath(t,e,r):r(i,n)})}function J0(t,e){if(mP)return Q0(t,e);try{return Q0(t,e)}catch(r){if(yP(r))return vP.realpathSync(t,e);throw r}}function bre(){Ha.realpath=Xi,Ha.realpathSync=J0}function xre(){Ha.realpath=K0,Ha.realpathSync=Q0}});var bP=y((Rhe,wP)=>{wP.exports=function(t,e){for(var r=[],i=0;i<t.length;i++){var n=e(t[i],i);Tre(n)?r.push.apply(r,n):r.push(n)}return r};var Tre=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"}});var SP=y((Ohe,CP)=>{"use strict";CP.exports=TP;function TP(t,e,r){t instanceof RegExp&&(t=xP(t,r)),e instanceof RegExp&&(e=xP(e,r));var i=EP(t,e,r);return i&&{start:i[0],end:i[1],pre:r.slice(0,i[0]),body:r.slice(i[0]+t.length,i[1]),post:r.slice(i[1]+e.length)}}function xP(t,e){var r=e.match(t);return r?r[0]:null}TP.range=EP;function EP(t,e,r){var i,n,s,a,o,u=r.indexOf(t),f=r.indexOf(e,u+1),h=u;if(u>=0&&f>0){if(t===e)return[u,f];for(i=[],s=r.length;h>=0&&!o;)h==u?(i.push(h),u=r.indexOf(t,h+1)):i.length==1?o=[i.pop(),f]:(n=i.pop(),n<s&&(s=n,a=f),f=r.indexOf(e,h+1)),h=u<f&&u>=0?u:f;i.length&&(o=[s,a])}return o}});var qP=y((Ahe,DP)=>{var Ere=bP(),kP=SP();DP.exports=kre;var RP="\0SLASH"+Math.random()+"\0",OP="\0OPEN"+Math.random()+"\0",rb="\0CLOSE"+Math.random()+"\0",AP="\0COMMA"+Math.random()+"\0",FP="\0PERIOD"+Math.random()+"\0";function tb(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function Cre(t){return t.split("\\\\").join(RP).split("\\{").join(OP).split("\\}").join(rb).split("\\,").join(AP).split("\\.").join(FP)}function Sre(t){return t.split(RP).join("\\").split(OP).join("{").split(rb).join("}").split(AP).join(",").split(FP).join(".")}function NP(t){if(!t)return[""];var e=[],r=kP("{","}",t);if(!r)return t.split(",");var i=r.pre,n=r.body,s=r.post,a=i.split(",");a[a.length-1]+="{"+n+"}";var o=NP(s);return s.length&&(a[a.length-1]+=o.shift(),a.push.apply(a,o)),e.push.apply(e,a),e}function kre(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),Ua(Cre(t),!0).map(Sre)):[]}function Rre(t){return"{"+t+"}"}function Ore(t){return/^-?0\d/.test(t)}function Are(t,e){return t<=e}function Fre(t,e){return t>=e}function Ua(t,e){var r=[],i=kP("{","}",t);if(!i||/\$$/.test(i.pre))return[t];var n=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(i.body),s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(i.body),a=n||s,o=i.body.indexOf(",")>=0;if(!a&&!o)return i.post.match(/,.*\}/)?(t=i.pre+"{"+i.body+rb+i.post,Ua(t)):[t];var u;if(a)u=i.body.split(/\.\./);else if(u=NP(i.body),u.length===1&&(u=Ua(u[0],!1).map(Rre),u.length===1)){var h=i.post.length?Ua(i.post,!1):[""];return h.map(function(q){return i.pre+u[0]+q})}var f=i.pre,h=i.post.length?Ua(i.post,!1):[""],g;if(a){var m=tb(u[0]),c=tb(u[1]),d=Math.max(u[0].length,u[1].length),v=u.length==3?Math.abs(tb(u[2])):1,w=Are,b=c<m;b&&(v*=-1,w=Fre);var C=u.some(Ore);g=[];for(var O=m;w(O,c);O+=v){var R;if(s)R=String.fromCharCode(O),R==="\\"&&(R="");else if(R=String(O),C){var M=d-R.length;if(M>0){var X=new Array(M+1).join("0");O<0?R="-"+X+R.slice(1):R=X+R}}g.push(R)}}else g=Ere(u,function(G){return Ua(G,!1)});for(var H=0;H<g.length;H++)for(var W=0;W<h.length;W++){var P=f+g[H]+h[W];(!e||a||P)&&r.push(P)}return r}});var Pc=y((Fhe,BP)=>{BP.exports=Mt;Mt.Minimatch=ut;var Vl=function(){try{return require("path")}catch{}}()||{sep:"/"};Mt.sep=Vl.sep;var sb=Mt.GLOBSTAR=ut.GLOBSTAR={},Nre=qP(),IP={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},ib="[^/]",nb=ib+"*?",Dre="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",qre="(?:(?!(?:\\/|^)\\.).)*?",MP=Ire("().*{}+?[]^$\\!");function Ire(t){return t.split("").reduce(function(e,r){return e[r]=!0,e},{})}var PP=/\/+/;Mt.filter=Mre;function Mre(t,e){return e=e||{},function(r,i,n){return Mt(r,t,e)}}function Vi(t,e){e=e||{};var r={};return Object.keys(t).forEach(function(i){r[i]=t[i]}),Object.keys(e).forEach(function(i){r[i]=e[i]}),r}Mt.defaults=function(t){if(!t||typeof t!="object"||!Object.keys(t).length)return Mt;var e=Mt,r=function(n,s,a){return e(n,s,Vi(t,a))};return r.Minimatch=function(n,s){return new e.Minimatch(n,Vi(t,s))},r.Minimatch.defaults=function(n){return e.defaults(Vi(t,n)).Minimatch},r.filter=function(n,s){return e.filter(n,Vi(t,s))},r.defaults=function(n){return e.defaults(Vi(t,n))},r.makeRe=function(n,s){return e.makeRe(n,Vi(t,s))},r.braceExpand=function(n,s){return e.braceExpand(n,Vi(t,s))},r.match=function(i,n,s){return e.match(i,n,Vi(t,s))},r};ut.defaults=function(t){return Mt.defaults(t).Minimatch};function Mt(t,e,r){return Mc(e),r||(r={}),!r.nocomment&&e.charAt(0)==="#"?!1:new ut(e,r).match(t)}function ut(t,e){if(!(this instanceof ut))return new ut(t,e);Mc(t),e||(e={}),t=t.trim(),!e.allowWindowsEscape&&Vl.sep!=="/"&&(t=t.split(Vl.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}ut.prototype.debug=function(){};ut.prototype.make=Pre;function Pre(){var t=this.pattern,e=this.options;if(!e.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,r),r=this.globParts=r.map(function(i){return i.split(PP)}),this.debug(this.pattern,r),r=r.map(function(i,n,s){return i.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(i){return i.indexOf(!1)===-1}),this.debug(this.pattern,r),this.set=r}ut.prototype.parseNegate=Lre;function Lre(){var t=this.pattern,e=!1,r=this.options,i=0;if(!r.nonegate){for(var n=0,s=t.length;n<s&&t.charAt(n)==="!";n++)e=!e,i++;i&&(this.pattern=t.substr(i)),this.negate=e}}Mt.braceExpand=function(t,e){return LP(t,e)};ut.prototype.braceExpand=LP;function LP(t,e){return e||(this instanceof ut?e=this.options:e={}),t=typeof t>"u"?this.pattern:t,Mc(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:Nre(t)}var Bre=1024*64,Mc=function(t){if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>Bre)throw new TypeError("pattern is too long")};ut.prototype.parse=jre;var Ic={};function jre(t,e){Mc(t);var r=this.options;if(t==="**")if(r.noglobstar)t="*";else return sb;if(t==="")return"";var i="",n=!!r.nocase,s=!1,a=[],o=[],u,f=!1,h=-1,g=-1,m=t.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",c=this;function d(){if(u){switch(u){case"*":i+=nb,n=!0;break;case"?":i+=ib,n=!0;break;default:i+="\\"+u;break}c.debug("clearStateChar %j %j",u,i),u=!1}}for(var v=0,w=t.length,b;v<w&&(b=t.charAt(v));v++){if(this.debug("%s	%s %s %j",t,v,i,b),s&&MP[b]){i+="\\"+b,s=!1;continue}switch(b){case"/":return!1;case"\\":d(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",t,v,i,b),f){this.debug("  in class"),b==="!"&&v===g+1&&(b="^"),i+=b;continue}c.debug("call clearStateChar %j",u),d(),u=b,r.noext&&d();continue;case"(":if(f){i+="(";continue}if(!u){i+="\\(";continue}a.push({type:u,start:v-1,reStart:i.length,open:IP[u].open,close:IP[u].close}),i+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,i),u=!1;continue;case")":if(f||!a.length){i+="\\)";continue}d(),n=!0;var C=a.pop();i+=C.close,C.type==="!"&&o.push(C),C.reEnd=i.length;continue;case"|":if(f||!a.length||s){i+="\\|",s=!1;continue}d(),i+="|";continue;case"[":if(d(),f){i+="\\"+b;continue}f=!0,g=v,h=i.length,i+=b;continue;case"]":if(v===g+1||!f){i+="\\"+b,s=!1;continue}var O=t.substring(g+1,v);try{RegExp("["+O+"]")}catch{var R=this.parse(O,Ic);i=i.substr(0,h)+"\\["+R[0]+"\\]",n=n||R[1],f=!1;continue}n=!0,f=!1,i+=b;continue;default:d(),s?s=!1:MP[b]&&!(b==="^"&&f)&&(i+="\\"),i+=b}}for(f&&(O=t.substr(g+1),R=this.parse(O,Ic),i=i.substr(0,h)+"\\["+R[0],n=n||R[1]),C=a.pop();C;C=a.pop()){var M=i.slice(C.reStart+C.open.length);this.debug("setting tail",i,C),M=M.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(V,Y,J){return J||(J="\\"),Y+Y+J+"|"}),this.debug(`tail=%j
   %s`,M,M,C,i);var X=C.type==="*"?nb:C.type==="?"?ib:"\\"+C.type;n=!0,i=i.slice(0,C.reStart)+X+"\\("+M}d(),s&&(i+="\\\\");var H=!1;switch(i.charAt(0)){case"[":case".":case"(":H=!0}for(var W=o.length-1;W>-1;W--){var P=o[W],G=i.slice(0,P.reStart),q=i.slice(P.reStart,P.reEnd-8),E=i.slice(P.reEnd-8,P.reEnd),A=i.slice(P.reEnd);E+=A;var $=G.split("(").length-1,B=A;for(v=0;v<$;v++)B=B.replace(/\)[+*?]?/,"");A=B;var T="";A===""&&e!==Ic&&(T="$");var k=G+q+A+T+E;i=k}if(i!==""&&n&&(i="(?=.)"+i),H&&(i=m+i),e===Ic)return[i,n];if(!n)return $re(t);var N=r.nocase?"i":"";try{var j=new RegExp("^"+i+"$",N)}catch{return new RegExp("$.")}return j._glob=t,j._src=i,j}Mt.makeRe=function(t,e){return new ut(t,e||{}).makeRe()};ut.prototype.makeRe=Wre;function Wre(){if(this.regexp||this.regexp===!1)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?nb:e.dot?Dre:qre,i=e.nocase?"i":"",n=t.map(function(s){return s.map(function(a){return a===sb?r:typeof a=="string"?Hre(a):a._src}).join("\\/")}).join("|");n="^(?:"+n+")$",this.negate&&(n="^(?!"+n+").*$");try{this.regexp=new RegExp(n,i)}catch{this.regexp=!1}return this.regexp}Mt.match=function(t,e,r){r=r||{};var i=new ut(e,r);return t=t.filter(function(n){return i.match(n)}),i.options.nonull&&!t.length&&t.push(e),t};ut.prototype.match=function(e,r){if(typeof r>"u"&&(r=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;var i=this.options;Vl.sep!=="/"&&(e=e.split(Vl.sep).join("/")),e=e.split(PP),this.debug(this.pattern,"split",e);var n=this.set;this.debug(this.pattern,"set",n);var s,a;for(a=e.length-1;a>=0&&(s=e[a],!s);a--);for(a=0;a<n.length;a++){var o=n[a],u=e;i.matchBase&&o.length===1&&(u=[s]);var f=this.matchOne(u,o,r);if(f)return i.flipNegate?!0:!this.negate}return i.flipNegate?!1:this.negate};ut.prototype.matchOne=function(t,e,r){var i=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var n=0,s=0,a=t.length,o=e.length;n<a&&s<o;n++,s++){this.debug("matchOne loop");var u=e[s],f=t[n];if(this.debug(e,u,f),u===!1)return!1;if(u===sb){this.debug("GLOBSTAR",[e,u,f]);var h=n,g=s+1;if(g===o){for(this.debug("** at the end");n<a;n++)if(t[n]==="."||t[n]===".."||!i.dot&&t[n].charAt(0)===".")return!1;return!0}for(;h<a;){var m=t[h];if(this.debug(`
globstar while`,t,h,e,g,m),this.matchOne(t.slice(h),e.slice(g),r))return this.debug("globstar found match!",h,a,m),!0;if(m==="."||m===".."||!i.dot&&m.charAt(0)==="."){this.debug("dot detected!",t,h,e,g);break}this.debug("globstar swallow a segment, and continue"),h++}return!!(r&&(this.debug(`
>>> no match, partial?`,t,h,e,g),h===a))}var c;if(typeof u=="string"?(c=f===u,this.debug("string match",u,f,c)):(c=f.match(u),this.debug("pattern match",u,f,c)),!c)return!1}if(n===a&&s===o)return!0;if(n===a)return r;if(s===o)return n===a-1&&t[n]==="";throw new Error("wtf?")};function $re(t){return t.replace(/\\(.)/g,"$1")}function Hre(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var Bc=y((Nhe,Lc)=>{"use strict";function jP(t){return t.charAt(0)==="/"}function WP(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,r=e.exec(t),i=r[1]||"",n=Boolean(i&&i.charAt(1)!==":");return Boolean(r[2]||n)}Lc.exports=process.platform==="win32"?WP:jP;Lc.exports.posix=jP;Lc.exports.win32=WP});var ob=y(Gi=>{Gi.setopts=Zre;Gi.ownProp=$P;Gi.makeAbs=Gl;Gi.finish=Yre;Gi.mark=Kre;Gi.isIgnored=UP;Gi.childrenIgnored=Qre;function $P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Ure=require("fs"),za=require("path"),zre=Pc(),HP=Bc(),ab=zre.Minimatch;function Xre(t,e){return t.localeCompare(e,"en")}function Vre(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(Gre))}function Gre(t){var e=null;if(t.slice(-3)==="/**"){var r=t.replace(/(\/\*\*)+$/,"");e=new ab(r,{dot:!0})}return{matcher:new ab(t,{dot:!0}),gmatcher:e}}function Zre(t,e,r){if(r||(r={}),r.matchBase&&e.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=r.strict!==!1,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.fs=r.fs||Ure,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),Vre(t,r),t.changedCwd=!1;var i=process.cwd();$P(r,"cwd")?(t.cwd=za.resolve(r.cwd),t.changedCwd=t.cwd!==i):t.cwd=i,t.root=r.root||za.resolve(t.cwd,"/"),t.root=za.resolve(t.root),process.platform==="win32"&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=HP(t.cwd)?t.cwd:Gl(t,t.cwd),process.platform==="win32"&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,r.allowWindowsEscape=!1,t.minimatch=new ab(e,r),t.options=t.minimatch.options}function Yre(t){for(var e=t.nounique,r=e?[]:Object.create(null),i=0,n=t.matches.length;i<n;i++){var s=t.matches[i];if(!s||Object.keys(s).length===0){if(t.nonull){var a=t.minimatch.globSet[i];e?r.push(a):r[a]=!0}}else{var o=Object.keys(s);e?r.push.apply(r,o):o.forEach(function(u){r[u]=!0})}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(Xre)),t.mark){for(var i=0;i<r.length;i++)r[i]=t._mark(r[i]);t.nodir&&(r=r.filter(function(u){var f=!/\/$/.test(u),h=t.cache[u]||t.cache[Gl(t,u)];return f&&h&&(f=h!=="DIR"&&!Array.isArray(h)),f}))}t.ignore.length&&(r=r.filter(function(u){return!UP(t,u)})),t.found=r}function Kre(t,e){var r=Gl(t,e),i=t.cache[r],n=e;if(i){var s=i==="DIR"||Array.isArray(i),a=e.slice(-1)==="/";if(s&&!a?n+="/":!s&&a&&(n=n.slice(0,-1)),n!==e){var o=Gl(t,n);t.statCache[o]=t.statCache[r],t.cache[o]=t.cache[r]}}return n}function Gl(t,e){var r=e;return e.charAt(0)==="/"?r=za.join(t.root,e):HP(e)||e===""?r=e:t.changedCwd?r=za.resolve(t.cwd,e):r=za.resolve(e),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function UP(t,e){return t.ignore.length?t.ignore.some(function(r){return r.matcher.match(e)||!!(r.gmatcher&&r.gmatcher.match(e))}):!1}function Qre(t,e){return t.ignore.length?t.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(e))}):!1}});var ZP=y((Phe,GP)=>{GP.exports=VP;VP.GlobSync=Ze;var Jre=eb(),zP=Pc(),qhe=zP.Minimatch,Ihe=Wc().Glob,Mhe=require("util"),lb=require("path"),XP=require("assert"),jc=Bc(),Kn=ob(),eie=Kn.setopts,ub=Kn.ownProp,tie=Kn.childrenIgnored,rie=Kn.isIgnored;function VP(t,e){if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new Ze(t,e).found}function Ze(t,e){if(!t)throw new Error("must provide pattern");if(typeof e=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof Ze))return new Ze(t,e);if(eie(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var i=0;i<r;i++)this._process(this.minimatch.set[i],i,!1);this._finish()}Ze.prototype._finish=function(){if(XP.ok(this instanceof Ze),this.realpath){var t=this;this.matches.forEach(function(e,r){var i=t.matches[r]=Object.create(null);for(var n in e)try{n=t._makeAbs(n);var s=Jre.realpathSync(n,t.realpathCache);i[s]=!0}catch(a){if(a.syscall==="stat")i[t._makeAbs(n)]=!0;else throw a}})}Kn.finish(this)};Ze.prototype._process=function(t,e,r){XP.ok(this instanceof Ze);for(var i=0;typeof t[i]=="string";)i++;var n;switch(i){case t.length:this._processSimple(t.join("/"),e);return;case 0:n=null;break;default:n=t.slice(0,i).join("/");break}var s=t.slice(i),a;n===null?a=".":((jc(n)||jc(t.map(function(f){return typeof f=="string"?f:"[*]"}).join("/")))&&(!n||!jc(n))&&(n="/"+n),a=n);var o=this._makeAbs(a);if(!tie(this,a)){var u=s[0]===zP.GLOBSTAR;u?this._processGlobStar(n,a,o,s,e,r):this._processReaddir(n,a,o,s,e,r)}};Ze.prototype._processReaddir=function(t,e,r,i,n,s){var a=this._readdir(r,s);if(!!a){for(var o=i[0],u=!!this.minimatch.negate,f=o._glob,h=this.dot||f.charAt(0)===".",g=[],m=0;m<a.length;m++){var c=a[m];if(c.charAt(0)!=="."||h){var d;u&&!t?d=!c.match(o):d=c.match(o),d&&g.push(c)}}var v=g.length;if(v!==0){if(i.length===1&&!this.mark&&!this.stat){this.matches[n]||(this.matches[n]=Object.create(null));for(var m=0;m<v;m++){var c=g[m];t&&(t.slice(-1)!=="/"?c=t+"/"+c:c=t+c),c.charAt(0)==="/"&&!this.nomount&&(c=lb.join(this.root,c)),this._emitMatch(n,c)}return}i.shift();for(var m=0;m<v;m++){var c=g[m],w;t?w=[t,c]:w=[c],this._process(w.concat(i),n,s)}}}};Ze.prototype._emitMatch=function(t,e){if(!rie(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var i=this.cache[r];if(i==="DIR"||Array.isArray(i))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}};Ze.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r,i;try{r=this.fs.lstatSync(t)}catch(s){if(s.code==="ENOENT")return null}var n=r&&r.isSymbolicLink();return this.symlinks[t]=n,!n&&r&&!r.isDirectory()?this.cache[t]="FILE":e=this._readdir(t,!1),e};Ze.prototype._readdir=function(t,e){var r;if(e&&!ub(this.symlinks,t))return this._readdirInGlobStar(t);if(ub(this.cache,t)){var i=this.cache[t];if(!i||i==="FILE")return null;if(Array.isArray(i))return i}try{return this._readdirEntries(t,this.fs.readdirSync(t))}catch(n){return this._readdirError(t,n),null}};Ze.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var i=e[r];t==="/"?i=t+i:i=t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,e};Ze.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);throw i.path=this.cwd,i.code=e.code,i}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e);break}};Ze.prototype._processGlobStar=function(t,e,r,i,n,s){var a=this._readdir(r,s);if(!!a){var o=i.slice(1),u=t?[t]:[],f=u.concat(o);this._process(f,n,!1);var h=a.length,g=this.symlinks[r];if(!(g&&s))for(var m=0;m<h;m++){var c=a[m];if(!(c.charAt(0)==="."&&!this.dot)){var d=u.concat(a[m],o);this._process(d,n,!0);var v=u.concat(a[m],i);this._process(v,n,!0)}}}};Ze.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),!!r){if(t&&jc(t)&&!this.nomount){var i=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=lb.join(this.root,t):(t=lb.resolve(this.root,t),i&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}};Ze.prototype._stat=function(t){var e=this._makeAbs(t),r=t.slice(-1)==="/";if(t.length>this.maxLength)return!1;if(!this.stat&&ub(this.cache,e)){var a=this.cache[e];if(Array.isArray(a)&&(a="DIR"),!r||a==="DIR")return a;if(r&&a==="FILE")return!1}var i,n=this.statCache[e];if(!n){var s;try{s=this.fs.lstatSync(e)}catch(o){if(o&&(o.code==="ENOENT"||o.code==="ENOTDIR"))return this.statCache[e]=!1,!1}if(s&&s.isSymbolicLink())try{n=this.fs.statSync(e)}catch{n=s}else n=s}this.statCache[e]=n;var a=!0;return n&&(a=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,r&&a==="FILE"?!1:a};Ze.prototype._mark=function(t){return Kn.mark(this,t)};Ze.prototype._makeAbs=function(t){return Kn.makeAbs(this,t)}});var fb=y((Lhe,KP)=>{KP.exports=YP;function YP(t,e){if(t&&e)return YP(t)(e);if(typeof t!="function")throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(i){r[i]=t[i]}),r;function r(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];var s=t.apply(this,i),a=i[i.length-1];return typeof s=="function"&&s!==a&&Object.keys(a).forEach(function(o){s[o]=a[o]}),s}}});var cb=y((Bhe,hb)=>{var QP=fb();hb.exports=QP($c);hb.exports.strict=QP(JP);$c.proto=$c(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return $c(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return JP(this)},configurable:!0})});function $c(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function JP(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}});var tL=y((jhe,eL)=>{var iie=fb(),Zl=Object.create(null),nie=cb();eL.exports=iie(sie);function sie(t,e){return Zl[t]?(Zl[t].push(e),null):(Zl[t]=[e],aie(t))}function aie(t){return nie(function e(){var r=Zl[t],i=r.length,n=oie(arguments);try{for(var s=0;s<i;s++)r[s].apply(null,n)}finally{r.length>i?(r.splice(0,i),process.nextTick(function(){e.apply(null,n)})):delete Zl[t]}})}function oie(t){for(var e=t.length,r=[],i=0;i<e;i++)r[i]=t[i];return r}});var Wc=y((Hhe,iL)=>{iL.exports=Qn;var lie=eb(),rL=Pc(),Whe=rL.Minimatch,uie=le(),fie=require("events").EventEmitter,db=require("path"),pb=require("assert"),Yl=Bc(),mb=ZP(),Jn=ob(),hie=Jn.setopts,gb=Jn.ownProp,vb=tL(),$he=require("util"),cie=Jn.childrenIgnored,die=Jn.isIgnored,pie=cb();function Qn(t,e,r){if(typeof e=="function"&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return mb(t,e)}return new be(t,e,r)}Qn.sync=mb;var gie=Qn.GlobSync=mb.GlobSync;Qn.glob=Qn;function mie(t,e){if(e===null||typeof e!="object")return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t}Qn.hasMagic=function(t,e){var r=mie({},e);r.noprocess=!0;var i=new be(t,r),n=i.minimatch.set;if(!t)return!1;if(n.length>1)return!0;for(var s=0;s<n[0].length;s++)if(typeof n[0][s]!="string")return!0;return!1};Qn.Glob=be;uie(be,fie);function be(t,e,r){if(typeof e=="function"&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new gie(t,e)}if(!(this instanceof be))return new be(t,e,r);hie(this,t,e),this._didRealPath=!1;var i=this.minimatch.set.length;this.matches=new Array(i),typeof r=="function"&&(r=pie(r),this.on("error",r),this.on("end",function(u){r(null,u)}));var n=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(i===0)return o();for(var s=!0,a=0;a<i;a++)this._process(this.minimatch.set[a],a,!1,o);s=!1;function o(){--n._processing,n._processing<=0&&(s?process.nextTick(function(){n._finish()}):n._finish())}}be.prototype._finish=function(){if(pb(this instanceof be),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();Jn.finish(this),this.emit("end",this.found)}};be.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var t=this.matches.length;if(t===0)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,i);function i(){--t===0&&e._finish()}};be.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var i=Object.keys(r),n=this,s=i.length;if(s===0)return e();var a=this.matches[t]=Object.create(null);i.forEach(function(o,u){o=n._makeAbs(o),lie.realpath(o,n.realpathCache,function(f,h){f?f.syscall==="stat"?a[o]=!0:n.emit("error",f):a[h]=!0,--s===0&&(n.matches[t]=a,e())})})};be.prototype._mark=function(t){return Jn.mark(this,t)};be.prototype._makeAbs=function(t){return Jn.makeAbs(this,t)};be.prototype.abort=function(){this.aborted=!0,this.emit("abort")};be.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};be.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var i=this._processQueue.slice(0);this._processQueue.length=0;for(var e=0;e<i.length;e++){var n=i[e];this._processing--,this._process(n[0],n[1],n[2],n[3])}}}};be.prototype._process=function(t,e,r,i){if(pb(this instanceof be),pb(typeof i=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([t,e,r,i]);return}for(var n=0;typeof t[n]=="string";)n++;var s;switch(n){case t.length:this._processSimple(t.join("/"),e,i);return;case 0:s=null;break;default:s=t.slice(0,n).join("/");break}var a=t.slice(n),o;s===null?o=".":((Yl(s)||Yl(t.map(function(h){return typeof h=="string"?h:"[*]"}).join("/")))&&(!s||!Yl(s))&&(s="/"+s),o=s);var u=this._makeAbs(o);if(cie(this,o))return i();var f=a[0]===rL.GLOBSTAR;f?this._processGlobStar(s,o,u,a,e,r,i):this._processReaddir(s,o,u,a,e,r,i)}};be.prototype._processReaddir=function(t,e,r,i,n,s,a){var o=this;this._readdir(r,s,function(u,f){return o._processReaddir2(t,e,r,i,n,s,f,a)})};be.prototype._processReaddir2=function(t,e,r,i,n,s,a,o){if(!a)return o();for(var u=i[0],f=!!this.minimatch.negate,h=u._glob,g=this.dot||h.charAt(0)===".",m=[],c=0;c<a.length;c++){var d=a[c];if(d.charAt(0)!=="."||g){var v;f&&!t?v=!d.match(u):v=d.match(u),v&&m.push(d)}}var w=m.length;if(w===0)return o();if(i.length===1&&!this.mark&&!this.stat){this.matches[n]||(this.matches[n]=Object.create(null));for(var c=0;c<w;c++){var d=m[c];t&&(t!=="/"?d=t+"/"+d:d=t+d),d.charAt(0)==="/"&&!this.nomount&&(d=db.join(this.root,d)),this._emitMatch(n,d)}return o()}i.shift();for(var c=0;c<w;c++){var d=m[c],b;t&&(t!=="/"?d=t+"/"+d:d=t+d),this._process([d].concat(i),n,s,o)}o()};be.prototype._emitMatch=function(t,e){if(!this.aborted&&!die(this,e)){if(this.paused){this._emitQueue.push([t,e]);return}var r=Yl(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var i=this.cache[r];if(i==="DIR"||Array.isArray(i))return}this.matches[t][e]=!0;var n=this.statCache[r];n&&this.emit("stat",e,n),this.emit("match",e)}}};be.prototype._readdirInGlobStar=function(t,e){if(this.aborted)return;if(this.follow)return this._readdir(t,!1,e);var r="lstat\0"+t,i=this,n=vb(r,s);n&&i.fs.lstat(t,n);function s(a,o){if(a&&a.code==="ENOENT")return e();var u=o&&o.isSymbolicLink();i.symlinks[t]=u,!u&&o&&!o.isDirectory()?(i.cache[t]="FILE",e()):i._readdir(t,!1,e)}};be.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=vb("readdir\0"+t+"\0"+e,r),!!r)){if(e&&!gb(this.symlinks,t))return this._readdirInGlobStar(t,r);if(gb(this.cache,t)){var i=this.cache[t];if(!i||i==="FILE")return r();if(Array.isArray(i))return r(null,i)}var n=this;n.fs.readdir(t,vie(this,t,r))}};function vie(t,e,r){return function(i,n){i?t._readdirError(e,i,r):t._readdirEntries(e,n,r)}}be.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var i=0;i<e.length;i++){var n=e[i];t==="/"?n=t+n:n=t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,r(null,e)}};be.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var i=this._makeAbs(t);if(this.cache[i]="FILE",i===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);n.path=this.cwd,n.code=e.code,this.emit("error",n),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e);break}return r()}};be.prototype._processGlobStar=function(t,e,r,i,n,s,a){var o=this;this._readdir(r,s,function(u,f){o._processGlobStar2(t,e,r,i,n,s,f,a)})};be.prototype._processGlobStar2=function(t,e,r,i,n,s,a,o){if(!a)return o();var u=i.slice(1),f=t?[t]:[],h=f.concat(u);this._process(h,n,!1,o);var g=this.symlinks[r],m=a.length;if(g&&s)return o();for(var c=0;c<m;c++){var d=a[c];if(!(d.charAt(0)==="."&&!this.dot)){var v=f.concat(a[c],u);this._process(v,n,!0,o);var w=f.concat(a[c],i);this._process(w,n,!0,o)}}o()};be.prototype._processSimple=function(t,e,r){var i=this;this._stat(t,function(n,s){i._processSimple2(t,e,n,s,r)})};be.prototype._processSimple2=function(t,e,r,i,n){if(this.matches[e]||(this.matches[e]=Object.create(null)),!i)return n();if(t&&Yl(t)&&!this.nomount){var s=/[\/\\]$/.test(t);t.charAt(0)==="/"?t=db.join(this.root,t):(t=db.resolve(this.root,t),s&&(t+="/"))}process.platform==="win32"&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),n()};be.prototype._stat=function(t,e){var r=this._makeAbs(t),i=t.slice(-1)==="/";if(t.length>this.maxLength)return e();if(!this.stat&&gb(this.cache,r)){var n=this.cache[r];if(Array.isArray(n)&&(n="DIR"),!i||n==="DIR")return e(null,n);if(i&&n==="FILE")return e()}var s,a=this.statCache[r];if(a!==void 0){if(a===!1)return e(null,a);var o=a.isDirectory()?"DIR":"FILE";return i&&o==="FILE"?e():e(null,o,a)}var u=this,f=vb("stat\0"+r,h);f&&u.fs.lstat(r,f);function h(g,m){if(m&&m.isSymbolicLink())return u.fs.stat(r,function(c,d){c?u._stat2(t,r,null,m,e):u._stat2(t,r,c,d,e)});u._stat2(t,r,g,m,e)}};be.prototype._stat2=function(t,e,r,i,n){if(r&&(r.code==="ENOENT"||r.code==="ENOTDIR"))return this.statCache[e]=!1,n();var s=t.slice(-1)==="/";if(this.statCache[e]=i,e.slice(-1)==="/"&&i&&!i.isDirectory())return n(null,!1,i);var a=!0;return i&&(a=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||a,s&&a==="FILE"?n():n(null,a,i)}});var bb=y((Uhe,hL)=>{hL.exports=wb;wb.sync=fL;var ye=require("assert"),oL=require("path"),nL=require("fs"),Xa=void 0;try{Xa=Wc()}catch{}var lL=parseInt("666",8),yie={nosort:!0,silent:!0},yb=0,Kl=process.platform==="win32";function uL(t){var e=["unlink","chmod","stat","lstat","rmdir","readdir"];if(e.forEach(function(r){t[r]=t[r]||nL[r],r=r+"Sync",t[r]=t[r]||nL[r]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob!==!0&&Xa===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||yie}function wb(t,e,r){typeof e=="function"&&(r=e,e={}),ye(t,"rimraf: missing path"),ye.equal(typeof t,"string","rimraf: path should be a string"),ye.equal(typeof r,"function","rimraf: callback function required"),ye(e,"rimraf: invalid options argument provided"),ye.equal(typeof e,"object","rimraf: options should be object"),uL(e);var i=0,n=null,s=0;if(e.disableGlob||!Xa.hasMagic(t))return o(null,[t]);e.lstat(t,function(u,f){if(!u)return o(null,[t]);Xa(t,e.glob,o)});function a(u){n=n||u,--s===0&&r(n)}function o(u,f){if(u)return r(u);if(s=f.length,s===0)return r();f.forEach(function(h){_b(h,e,function g(m){if(m){if((m.code==="EBUSY"||m.code==="ENOTEMPTY"||m.code==="EPERM")&&i<e.maxBusyTries){i++;var c=i*100;return setTimeout(function(){_b(h,e,g)},c)}if(m.code==="EMFILE"&&yb<e.emfileWait)return setTimeout(function(){_b(h,e,g)},yb++);m.code==="ENOENT"&&(m=null)}yb=0,a(m)})})}}function _b(t,e,r){ye(t),ye(e),ye(typeof r=="function"),e.lstat(t,function(i,n){if(i&&i.code==="ENOENT")return r(null);if(i&&i.code==="EPERM"&&Kl&&sL(t,e,i,r),n&&n.isDirectory())return Hc(t,e,i,r);e.unlink(t,function(s){if(s){if(s.code==="ENOENT")return r(null);if(s.code==="EPERM")return Kl?sL(t,e,s,r):Hc(t,e,s,r);if(s.code==="EISDIR")return Hc(t,e,s,r)}return r(s)})})}function sL(t,e,r,i){ye(t),ye(e),ye(typeof i=="function"),r&&ye(r instanceof Error),e.chmod(t,lL,function(n){n?i(n.code==="ENOENT"?null:r):e.stat(t,function(s,a){s?i(s.code==="ENOENT"?null:r):a.isDirectory()?Hc(t,e,r,i):e.unlink(t,i)})})}function aL(t,e,r){ye(t),ye(e),r&&ye(r instanceof Error);try{e.chmodSync(t,lL)}catch(n){if(n.code==="ENOENT")return;throw r}try{var i=e.statSync(t)}catch(n){if(n.code==="ENOENT")return;throw r}i.isDirectory()?Uc(t,e,r):e.unlinkSync(t)}function Hc(t,e,r,i){ye(t),ye(e),r&&ye(r instanceof Error),ye(typeof i=="function"),e.rmdir(t,function(n){n&&(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")?_ie(t,e,i):n&&n.code==="ENOTDIR"?i(r):i(n)})}function _ie(t,e,r){ye(t),ye(e),ye(typeof r=="function"),e.readdir(t,function(i,n){if(i)return r(i);var s=n.length;if(s===0)return e.rmdir(t,r);var a;n.forEach(function(o){wb(oL.join(t,o),e,function(u){if(!a){if(u)return r(a=u);--s===0&&e.rmdir(t,r)}})})})}function fL(t,e){e=e||{},uL(e),ye(t,"rimraf: missing path"),ye.equal(typeof t,"string","rimraf: path should be a string"),ye(e,"rimraf: missing options"),ye.equal(typeof e,"object","rimraf: options should be object");var r;if(e.disableGlob||!Xa.hasMagic(t))r=[t];else try{e.lstatSync(t),r=[t]}catch{r=Xa.sync(t,e.glob)}if(!!r.length)for(var i=0;i<r.length;i++){var t=r[i];try{var n=e.lstatSync(t)}catch(a){if(a.code==="ENOENT")return;a.code==="EPERM"&&Kl&&aL(t,e,a)}try{n&&n.isDirectory()?Uc(t,e,null):e.unlinkSync(t)}catch(a){if(a.code==="ENOENT")return;if(a.code==="EPERM")return Kl?aL(t,e,a):Uc(t,e,a);if(a.code!=="EISDIR")throw a;Uc(t,e,a)}}}function Uc(t,e,r){ye(t),ye(e),r&&ye(r instanceof Error);try{e.rmdirSync(t)}catch(i){if(i.code==="ENOENT")return;if(i.code==="ENOTDIR")throw r;(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")&&wie(t,e)}}function wie(t,e){ye(t),ye(e),e.readdirSync(t).forEach(function(a){fL(oL.join(t,a),e)});var r=Kl?100:1,i=0;do{var n=!0;try{var s=e.rmdirSync(t,e);return n=!1,s}finally{if(++i<r&&n)continue}}while(!0)}});var xb=y((zhe,pL)=>{var Ql=require("path"),cL=require("fs"),dL=parseInt("0777",8);pL.exports=Va.mkdirp=Va.mkdirP=Va;function Va(t,e,r,i){typeof e=="function"?(r=e,e={}):(!e||typeof e!="object")&&(e={mode:e});var n=e.mode,s=e.fs||cL;n===void 0&&(n=dL),i||(i=null);var a=r||function(){};t=Ql.resolve(t),s.mkdir(t,n,function(o){if(!o)return i=i||t,a(null,i);switch(o.code){case"ENOENT":if(Ql.dirname(t)===t)return a(o);Va(Ql.dirname(t),e,function(u,f){u?a(u,f):Va(t,e,a,f)});break;default:s.stat(t,function(u,f){u||!f.isDirectory()?a(o,i):a(null,i)});break}})}Va.sync=function t(e,r,i){(!r||typeof r!="object")&&(r={mode:r});var n=r.mode,s=r.fs||cL;n===void 0&&(n=dL),i||(i=null),e=Ql.resolve(e);try{s.mkdirSync(e,n),i=i||e}catch(o){switch(o.code){case"ENOENT":i=t(Ql.dirname(e),r,i),t(e,r,i);break;default:var a;try{a=s.statSync(e)}catch{throw o}if(!a.isDirectory())throw o;break}}return i}});var zc=y((Xhe,gL)=>{gL.exports=Tb;function Tb(t){if(t._collected)return;if(t._paused)return t.on("resume",Tb.bind(null,t));t._collected=!0,t.pause(),t.on("data",r),t.on("end",r);var e=[];function r(a){typeof a=="string"&&(a=new Buffer(a)),!(Buffer.isBuffer(a)&&!a.length)&&e.push(a)}t.on("entry",n);var i=[];function n(a){Tb(a),i.push(a)}t.on("proxy",s);function s(a){a.pause()}t.pipe=function(a){return function(o){var u=0;(function h(){var g=i[u++];if(!g)return f();g.on("end",h),o?o.add(g):t.emit("entry",g)})();function f(){t.removeListener("entry",n),t.removeListener("data",r),t.removeListener("end",r),t.pipe=a,o&&t.pipe(o),e.forEach(function(h){h?t.emit("data",h):t.emit("end")}),t.resume()}return o}}(t.pipe)}});var Eb=y((Vhe,vL)=>{vL.exports=Zi;var Xc=Ga(),bie=le(),xie=xb(),mL=require("path"),Tie=zc();bie(Zi,Xc);function Zi(t){var e=this;e instanceof Zi||e.error("DirWriter must be called as constructor.",null,!0),(t.type!=="Directory"||!t.Directory)&&e.error("Non-directory type "+t.type+" "+JSON.stringify(t),null,!0),Xc.call(this,t)}Zi.prototype._create=function(){var t=this;xie(t._path,Xc.dirmode,function(e){if(e)return t.error(e);t.ready=!0,t.emit("ready"),t._process()})};Zi.prototype.write=function(){return!0};Zi.prototype.end=function(){this._ended=!0,this._process()};Zi.prototype.add=function(t){var e=this;return Tie(t),!e.ready||e._currentEntry?(e._buffer.push(t),!1):e._ended?e.error("add after end"):(e._buffer.push(t),e._process(),this._buffer.length===0)};Zi.prototype._process=function(){var t=this;if(t._processing)return;var e=t._buffer.shift();if(!e){t.emit("drain"),t._ended&&t._finish();return}t._processing=!0,t.emit("entry",e);var r=e,i;do{if(i=r._path||r.path,i===t.root._path||i===t._path||i&&i.indexOf(t._path)===0)return t._processing=!1,e._collected&&e.pipe(),t._process();r=r.parent}while(r);var n={parent:t,root:t.root||t,type:e.type,depth:t.depth+1};i=e._path||e.path||e.props.path,e.parent&&(i=i.substr(e.parent._path.length+1)),n.path=mL.join(t.path,mL.join("/",i)),n.filter=t.filter,Object.keys(e.props).forEach(function(u){n.hasOwnProperty(u)||(n[u]=e.props[u])});var s=t._currentChild=new Xc(n);s.on("ready",function(){e.pipe(s),e.resume()}),s.on("error",function(u){s._swallowErrors?(t.warn(u),s.emit("end"),s.emit("close")):t.emit("error",u)}),s.on("close",o);var a=!1;function o(){a||(a=!0,t._currentChild=null,t._processing=!1,t._process())}}});var Cb=y((Ghe,xL)=>{xL.exports=Jl;var _L=Cr(),wL=Ga(),Eie=le(),Cie=require("path"),Sie=bb();Eie(Jl,wL);function Jl(t){var e=this;if(!(e instanceof Jl))throw new Error("LinkWriter must be called as constructor.");if(!(t.type==="Link"&&t.Link||t.type==="SymbolicLink"&&t.SymbolicLink))throw new Error("Non-link type "+t.type);t.linkpath===""&&(t.linkpath="."),t.linkpath||e.error("Need linkpath property to create "+t.type),wL.call(this,t)}Jl.prototype._create=function(){var t=this,e=t.type==="Link"||process.platform==="win32",r=e?"link":"symlink",i=e?Cie.resolve(t.dirname,t.linkpath):t.linkpath;if(e)return yL(t,i,r);_L.readlink(t._path,function(n,s){if(s&&s===i)return bL(t);yL(t,i,r)})};function yL(t,e,r){Sie(t._path,function(i){if(i)return t.error(i);kie(t,e,r)})}function kie(t,e,r){_L[r](e,t._path,function(i){if(i)if((i.code==="ENOENT"||i.code==="EACCES"||i.code==="EPERM")&&process.platform==="win32")t.ready=!0,t.emit("ready"),t.emit("end"),t.emit("close"),t.end=t._finish=function(){};else return t.error(i);bL(t)})}function bL(t){t.ready=!0,t.emit("ready"),t._ended&&!t._finished&&t._finish()}Jl.prototype.end=function(){this._ended=!0,this.ready&&(this._finished=!0,this._finish())}});var Sb=y((Zhe,EL)=>{EL.exports=es;var Rie=Cr(),Vc=Ga(),Oie=le(),TL={};Oie(es,Vc);function es(t){var e=this;if(!(e instanceof es))throw new Error("FileWriter must be called as constructor.");if(t.type!=="File"||!t.File)throw new Error("Non-file type "+t.type);e._buffer=[],e._bytesWritten=0,Vc.call(this,t)}es.prototype._create=function(){var t=this;if(!t._stream){var e={};t.props.flags&&(e.flags=t.props.flags),e.mode=Vc.filemode,t._old&&t._old.blksize&&(e.bufferSize=t._old.blksize),t._stream=Rie.createWriteStream(t._path,e),t._stream.on("open",function(){t.ready=!0,t._buffer.forEach(function(r){r===TL?t._stream.end():t._stream.write(r)}),t.emit("ready"),t.emit("drain")}),t._stream.on("error",function(r){t.emit("error",r)}),t._stream.on("drain",function(){t.emit("drain")}),t._stream.on("close",function(){t._finish()})}};es.prototype.write=function(t){var e=this;if(e._bytesWritten+=t.length,!e.ready){if(!Buffer.isBuffer(t)&&typeof t!="string")throw new Error("invalid write data");return e._buffer.push(t),!1}var r=e._stream.write(t);return r===!1&&e._stream._queue?e._stream._queue.length<=2:r};es.prototype.end=function(t){var e=this;return t&&e.write(t),e.ready?e._stream.end():(e._buffer.push(TL),!1)};es.prototype._finish=function(){var t=this;typeof t.size=="number"&&t._bytesWritten!==t.size&&t.error(`Did not get expected byte count.
expect: `+t.size+`
actual: `+t._bytesWritten),Vc.prototype._finish.call(t)}});var Rb=y((Yhe,CL)=>{CL.exports=Yi;var kb=Ga(),Aie=Hl(),Fie=le(),Nie=zc(),Die=require("fs");Fie(Yi,kb);function Yi(t){var e=this;if(!(e instanceof Yi))throw new Error("ProxyWriter must be called as constructor.");e.props=t,e._needDrain=!1,kb.call(e,t)}Yi.prototype._stat=function(){var t=this,e=t.props,r=e.follow?"stat":"lstat";Die[r](e.path,function(i,n){var s;i||!n?s="File":s=Aie(n),e[s]=!0,e.type=t.type=s,t._old=n,t._addProxy(kb(e,n))})};Yi.prototype._addProxy=function(t){var e=this;if(e._proxy)return e.error("proxy already set");e._proxy=t,["ready","error","close","pipe","drain","warn"].forEach(function(i){t.on(i,e.emit.bind(e,i))}),e.emit("proxy",t);var r=e._buffer;r.forEach(function(i){t[i[0]].apply(t,i[1])}),e._buffer.length=0,e._needsDrain&&e.emit("drain")};Yi.prototype.add=function(t){return Nie(t),this._proxy?this._proxy.add(t):(this._buffer.push(["add",[t]]),this._needDrain=!0,!1)};Yi.prototype.write=function(t){return this._proxy?this._proxy.write(t):(this._buffer.push(["write",[t]]),this._needDrain=!0,!1)};Yi.prototype.end=function(t){return this._proxy?this._proxy.end(t):(this._buffer.push(["end",[t]]),!1)}});var Ga=y((Khe,qL)=>{qL.exports=Gt;var Vt=Cr(),qie=le(),Iie=bb(),Mie=xb(),eu=require("path"),kL=process.platform==="win32"?0:process.umask(),RL=Hl(),OL=Rc();qie(Gt,OL);Gt.dirmode=parseInt("0777",8)&~kL;Gt.filemode=parseInt("0666",8)&~kL;var Pie=Eb(),Lie=Cb(),Bie=Sb(),jie=Rb();function Gt(t,e){var r=this;typeof t=="string"&&(t={path:t});var i=RL(t),n=Gt;switch(i){case"Directory":n=Pie;break;case"File":n=Bie;break;case"Link":case"SymbolicLink":n=Lie;break;case null:default:n=jie;break}if(!(r instanceof n))return new n(t);OL.call(r),t.path||r.error("Must provide a path",null,!0),r.type=t.type,r.props=t,r.depth=t.depth||0,r.clobber=t.clobber===!1?t.clobber:!0,r.parent=t.parent||null,r.root=t.root||t.parent&&t.parent.root||r,r._path=r.path=eu.resolve(t.path),process.platform==="win32"&&(r.path=r._path=r.path.replace(/\?/g,"_"),r._path.length>=260&&(r._swallowErrors=!0,r._path="\\\\?\\"+r.path.replace(/\//g,"\\"))),r.basename=eu.basename(t.path),r.dirname=eu.dirname(t.path),r.linkpath=t.linkpath||null,t.parent=t.root=null,r.size=t.size,typeof t.mode=="string"&&(t.mode=parseInt(t.mode,8)),r.readable=!1,r.writable=!0,r._buffer=[],r.ready=!1,r.filter=typeof t.filter=="function"?t.filter:null,r._stat(e)}Gt.prototype._create=function(){var t=this;Vt[t.props.follow?"stat":"lstat"](t._path,function(e){if(e)return t.warn("Cannot create "+t._path+`
Unsupported type: `+t.type,"ENOTSUP");t._finish()})};Gt.prototype._stat=function(t){var e=this,r=e.props,i=r.follow?"stat":"lstat",n=e._proxy||e;t?s(null,t):Vt[i](e._path,s);function s(a,o){if(e.filter&&!e.filter.call(n,n,o)){e._aborted=!0,e.emit("end"),e.emit("close");return}if(a||!o)return Ob(e);e._old=o;var u=RL(o);if(u!==e.type||e.type==="File"&&o.nlink>1)return Iie(e._path,function(f){if(f)return e.error(f);e._old=null,Ob(e)});Ob(e)}};function Ob(t){Mie(eu.dirname(t._path),Gt.dirmode,function(e,r){return e?t.error(e):(t._madeDir=r,t._create())})}function AL(t,e,r,i,n){var s=e.mode,a=e.follow||t.type!=="SymbolicLink"?"chmod":"lchmod";if(!Vt[a]||typeof s!="number")return n();var o=r.mode&parseInt("0777",8);if(s=s&parseInt("0777",8),s===o)return n();Vt[a](i,s,n)}function FL(t,e,r,i,n){if(process.platform==="win32"||!process.getuid||process.getuid()!==0||typeof e.uid!="number"&&typeof e.gid!="number"||r.uid===e.uid&&r.gid===e.gid)return n();var s=t.props.follow||t.type!=="SymbolicLink"?"chown":"lchown";if(!Vt[s])return n();typeof e.uid!="number"&&(e.uid=r.uid),typeof e.gid!="number"&&(e.gid=r.gid),Vt[s](i,e.uid,e.gid,n)}function NL(t,e,r,i,n){if(!Vt.utimes||process.platform==="win32")return n();var s=e.follow||t.type!=="SymbolicLink"?"utimes":"lutimes";if(s==="lutimes"&&!Vt[s]&&(s="utimes"),!Vt[s])return n();var a=r.atime,o=r.mtime,u=e.atime,f=e.mtime;if(u===void 0&&(u=a),f===void 0&&(f=o),SL(u)||(u=new Date(u)),SL(f)||(u=new Date(f)),u.getTime()===a.getTime()&&f.getTime()===o.getTime())return n();Vt[s](i,u,f,n)}Gt.prototype._finish=function(){var t=this;if(t._finishing)return;t._finishing=!0;var e=0,r=null,i=!1;if(t._old)t._old.atime=new Date(0),t._old.mtime=new Date(0),s(t._old);else{var n=t.props.follow?"stat":"lstat";Vt[n](t._path,function(o,u){if(o)if(o.code==="ENOENT"&&(t.type==="Link"||t.type==="SymbolicLink")&&process.platform==="win32"){t.ready=!0,t.emit("ready"),t.emit("end"),t.emit("close"),t.end=t._finish=function(){};return}else return t.error(o);s(t._old=u)})}return;function s(o){e+=3,AL(t,t.props,o,t._path,a("chmod")),FL(t,t.props,o,t._path,a("chown")),NL(t,t.props,o,t._path,a("utimes"))}function a(o){return function(u){if(r)return;if(u)return u.fstream_finish_call=o,t.error(r=u);if(--e>0||i)return;if(i=!0,t._madeDir)DL(t,t._path,f);else return f();function f(h){if(h)return h.fstream_finish_call="setupMadeDir",t.error(h);t.emit("end"),t.emit("close")}}}};function DL(t,e,r){var i=t._madeDir,n=eu.dirname(e);Wie(t,n,function(s){if(s)return r(s);if(n===i)return r();DL(t,n,r)})}function Wie(t,e,r){var i={};Object.keys(t.props).forEach(function(o){i[o]=t.props[o],o==="mode"&&t.type!=="Directory"&&(i[o]=i[o]|parseInt("0111",8))});var n=3,s=null;Vt.stat(e,function(o,u){if(o)return r(s=o);AL(t,i,u,e,a),FL(t,i,u,e,a),NL(t,i,u,e,a)});function a(o){if(!s){if(o)return r(s=o);if(--n===0)return r()}}}Gt.prototype.pipe=function(){this.error("Can't pipe from writable stream")};Gt.prototype.add=function(){this.error("Can't add to non-Directory type")};Gt.prototype.write=function(){return!0};function $ie(t){return Object.prototype.toString.call(t)}function SL(t){return typeof t=="object"&&$ie(t)==="[object Date]"}});var Ab=y(fe=>{fe.Abstract=Rc();fe.Reader=Vn();fe.Writer=Ga();fe.File={Reader:z0(),Writer:Sb()};fe.Dir={Reader:U0(),Writer:Eb()};fe.Link={Reader:$0(),Writer:Cb()};fe.Proxy={Reader:V0(),Writer:Rb()};fe.Reader.Dir=fe.DirReader=fe.Dir.Reader;fe.Reader.File=fe.FileReader=fe.File.Reader;fe.Reader.Link=fe.LinkReader=fe.Link.Reader;fe.Reader.Proxy=fe.ProxyReader=fe.Proxy.Reader;fe.Writer.Dir=fe.DirWriter=fe.Dir.Writer;fe.Writer.File=fe.FileWriter=fe.File.Writer;fe.Writer.Link=fe.LinkWriter=fe.Link.Writer;fe.Writer.Proxy=fe.ProxyWriter=fe.Proxy.Writer;fe.collect=zc()});var ML=y((Jhe,IL)=>{IL.exports=Gie;var Hie=vc(),Uie=Ab().Writer,Fb=require("path"),zie=require("stream"),Xie=I0(),Vie=ji();function Gie(t){t.path=Fb.resolve(Fb.normalize(t.path));var e=new Hie(t),r=new zie.Writable({objectMode:!0});r._write=function(n,s,a){if(n.type=="Directory")return a();var o=Fb.join(t.path,n.path);if(o.indexOf(t.path)!=0)return a();let u=t.getWriter?t.getWriter({path:o}):Uie({path:o});n.pipe(u).on("error",a).on("close",a)};var i=Xie(e,r);return e.once("crx-header",function(n){i.crxHeader=n}),e.pipe(r).on("finish",function(){i.emit("close")}),i.promise=function(){return new Vie(function(n,s){i.on("close",n),i.on("error",s)})},i}});var PL=y((ece,Gc)=>{var Ye=function(t){"use strict";var e=1e7,r=7,i=9007199254740992,n=m(i),s="0123456789abcdefghijklmnopqrstuvwxyz",a=typeof BigInt=="function";function o(p,_,x,S){return typeof p>"u"?o[0]:typeof _<"u"?+_==10&&!x?Q(p):Ja(p,_,x,S):Q(p)}function u(p,_){this.value=p,this.sign=_,this.isSmall=!1}u.prototype=Object.create(o.prototype);function f(p){this.value=p,this.sign=p<0,this.isSmall=!0}f.prototype=Object.create(o.prototype);function h(p){this.value=p}h.prototype=Object.create(o.prototype);function g(p){return-i<p&&p<i}function m(p){return p<1e7?[p]:p<1e14?[p%1e7,Math.floor(p/1e7)]:[p%1e7,Math.floor(p/1e7)%1e7,Math.floor(p/1e14)]}function c(p){d(p);var _=p.length;if(_<4&&N(p,n)<0)switch(_){case 0:return 0;case 1:return p[0];case 2:return p[0]+p[1]*e;default:return p[0]+(p[1]+p[2]*e)*e}return p}function d(p){for(var _=p.length;p[--_]===0;);p.length=_+1}function v(p){for(var _=new Array(p),x=-1;++x<p;)_[x]=0;return _}function w(p){return p>0?Math.floor(p):Math.ceil(p)}function b(p,_){var x=p.length,S=_.length,I=new Array(x),F=0,L=e,U,z;for(z=0;z<S;z++)U=p[z]+_[z]+F,F=U>=L?1:0,I[z]=U-F*L;for(;z<x;)U=p[z]+F,F=U===L?1:0,I[z++]=U-F*L;return F>0&&I.push(F),I}function C(p,_){return p.length>=_.length?b(p,_):b(_,p)}function O(p,_){var x=p.length,S=new Array(x),I=e,F,L;for(L=0;L<x;L++)F=p[L]-I+_,_=Math.floor(F/I),S[L]=F-_*I,_+=1;for(;_>0;)S[L++]=_%I,_=Math.floor(_/I);return S}u.prototype.add=function(p){var _=Q(p);if(this.sign!==_.sign)return this.subtract(_.negate());var x=this.value,S=_.value;return _.isSmall?new u(O(x,Math.abs(S)),this.sign):new u(C(x,S),this.sign)},u.prototype.plus=u.prototype.add,f.prototype.add=function(p){var _=Q(p),x=this.value;if(x<0!==_.sign)return this.subtract(_.negate());var S=_.value;if(_.isSmall){if(g(x+S))return new f(x+S);S=m(Math.abs(S))}return new u(O(S,Math.abs(x)),x<0)},f.prototype.plus=f.prototype.add,h.prototype.add=function(p){return new h(this.value+Q(p).value)},h.prototype.plus=h.prototype.add;function R(p,_){var x=p.length,S=_.length,I=new Array(x),F=0,L=e,U,z;for(U=0;U<S;U++)z=p[U]-F-_[U],z<0?(z+=L,F=1):F=0,I[U]=z;for(U=S;U<x;U++){if(z=p[U]-F,z<0)z+=L;else{I[U++]=z;break}I[U]=z}for(;U<x;U++)I[U]=p[U];return d(I),I}function M(p,_,x){var S;return N(p,_)>=0?S=R(p,_):(S=R(_,p),x=!x),S=c(S),typeof S=="number"?(x&&(S=-S),new f(S)):new u(S,x)}function X(p,_,x){var S=p.length,I=new Array(S),F=-_,L=e,U,z;for(U=0;U<S;U++)z=p[U]+F,F=Math.floor(z/L),z%=L,I[U]=z<0?z+L:z;return I=c(I),typeof I=="number"?(x&&(I=-I),new f(I)):new u(I,x)}u.prototype.subtract=function(p){var _=Q(p);if(this.sign!==_.sign)return this.add(_.negate());var x=this.value,S=_.value;return _.isSmall?X(x,Math.abs(S),this.sign):M(x,S,this.sign)},u.prototype.minus=u.prototype.subtract,f.prototype.subtract=function(p){var _=Q(p),x=this.value;if(x<0!==_.sign)return this.add(_.negate());var S=_.value;return _.isSmall?new f(x-S):X(S,Math.abs(x),x>=0)},f.prototype.minus=f.prototype.subtract,h.prototype.subtract=function(p){return new h(this.value-Q(p).value)},h.prototype.minus=h.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},f.prototype.negate=function(){var p=this.sign,_=new f(-this.value);return _.sign=!p,_},h.prototype.negate=function(){return new h(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},f.prototype.abs=function(){return new f(Math.abs(this.value))},h.prototype.abs=function(){return new h(this.value>=0?this.value:-this.value)};function H(p,_){var x=p.length,S=_.length,I=x+S,F=v(I),L=e,U,z,ee,ie,ne;for(ee=0;ee<x;++ee){ie=p[ee];for(var ce=0;ce<S;++ce)ne=_[ce],U=ie*ne+F[ee+ce],z=Math.floor(U/L),F[ee+ce]=U-z*L,F[ee+ce+1]+=z}return d(F),F}function W(p,_){var x=p.length,S=new Array(x),I=e,F=0,L,U;for(U=0;U<x;U++)L=p[U]*_+F,F=Math.floor(L/I),S[U]=L-F*I;for(;F>0;)S[U++]=F%I,F=Math.floor(F/I);return S}function P(p,_){for(var x=[];_-- >0;)x.push(0);return x.concat(p)}function G(p,_){var x=Math.max(p.length,_.length);if(x<=30)return H(p,_);x=Math.ceil(x/2);var S=p.slice(x),I=p.slice(0,x),F=_.slice(x),L=_.slice(0,x),U=G(I,L),z=G(S,F),ee=G(C(I,S),C(L,F)),ie=C(C(U,P(R(R(ee,U),z),x)),P(z,2*x));return d(ie),ie}function q(p,_){return-.012*p-.012*_+15e-6*p*_>0}u.prototype.multiply=function(p){var _=Q(p),x=this.value,S=_.value,I=this.sign!==_.sign,F;if(_.isSmall){if(S===0)return o[0];if(S===1)return this;if(S===-1)return this.negate();if(F=Math.abs(S),F<e)return new u(W(x,F),I);S=m(F)}return q(x.length,S.length)?new u(G(x,S),I):new u(H(x,S),I)},u.prototype.times=u.prototype.multiply;function E(p,_,x){return p<e?new u(W(_,p),x):new u(H(_,m(p)),x)}f.prototype._multiplyBySmall=function(p){return g(p.value*this.value)?new f(p.value*this.value):E(Math.abs(p.value),m(Math.abs(this.value)),this.sign!==p.sign)},u.prototype._multiplyBySmall=function(p){return p.value===0?o[0]:p.value===1?this:p.value===-1?this.negate():E(Math.abs(p.value),this.value,this.sign!==p.sign)},f.prototype.multiply=function(p){return Q(p)._multiplyBySmall(this)},f.prototype.times=f.prototype.multiply,h.prototype.multiply=function(p){return new h(this.value*Q(p).value)},h.prototype.times=h.prototype.multiply;function A(p){var _=p.length,x=v(_+_),S=e,I,F,L,U,z;for(L=0;L<_;L++){U=p[L],F=0-U*U;for(var ee=L;ee<_;ee++)z=p[ee],I=2*(U*z)+x[L+ee]+F,F=Math.floor(I/S),x[L+ee]=I-F*S;x[L+_]=F}return d(x),x}u.prototype.square=function(){return new u(A(this.value),!1)},f.prototype.square=function(){var p=this.value*this.value;return g(p)?new f(p):new u(A(m(Math.abs(this.value))),!1)},h.prototype.square=function(p){return new h(this.value*this.value)};function $(p,_){var x=p.length,S=_.length,I=e,F=v(_.length),L=_[S-1],U=Math.ceil(I/(2*L)),z=W(p,U),ee=W(_,U),ie,ne,ce,Ot,xt,sd,ad;for(z.length<=x&&z.push(0),ee.push(0),L=ee[S-1],ne=x-S;ne>=0;ne--){for(ie=I-1,z[ne+S]!==L&&(ie=Math.floor((z[ne+S]*I+z[ne+S-1])/L)),ce=0,Ot=0,sd=ee.length,xt=0;xt<sd;xt++)ce+=ie*ee[xt],ad=Math.floor(ce/I),Ot+=z[ne+xt]-(ce-ad*I),ce=ad,Ot<0?(z[ne+xt]=Ot+I,Ot=-1):(z[ne+xt]=Ot,Ot=0);for(;Ot!==0;){for(ie-=1,ce=0,xt=0;xt<sd;xt++)ce+=z[ne+xt]-I+ee[xt],ce<0?(z[ne+xt]=ce+I,ce=0):(z[ne+xt]=ce,ce=1);Ot+=ce}F[ne]=ie}return z=T(z,U)[0],[c(F),c(z)]}function B(p,_){for(var x=p.length,S=_.length,I=[],F=[],L=e,U,z,ee,ie,ne;x;){if(F.unshift(p[--x]),d(F),N(F,_)<0){I.push(0);continue}z=F.length,ee=F[z-1]*L+F[z-2],ie=_[S-1]*L+_[S-2],z>S&&(ee=(ee+1)*L),U=Math.ceil(ee/ie);do{if(ne=W(_,U),N(ne,F)<=0)break;U--}while(U);I.push(U),F=R(F,ne)}return I.reverse(),[c(I),c(F)]}function T(p,_){var x=p.length,S=v(x),I=e,F,L,U,z;for(U=0,F=x-1;F>=0;--F)z=U*I+p[F],L=w(z/_),U=z-L*_,S[F]=L|0;return[S,U|0]}function k(p,_){var x,S=Q(_);if(a)return[new h(p.value/S.value),new h(p.value%S.value)];var I=p.value,F=S.value,L;if(F===0)throw new Error("Cannot divide by zero");if(p.isSmall)return S.isSmall?[new f(w(I/F)),new f(I%F)]:[o[0],p];if(S.isSmall){if(F===1)return[p,o[0]];if(F==-1)return[p.negate(),o[0]];var U=Math.abs(F);if(U<e){x=T(I,U),L=c(x[0]);var z=x[1];return p.sign&&(z=-z),typeof L=="number"?(p.sign!==S.sign&&(L=-L),[new f(L),new f(z)]):[new u(L,p.sign!==S.sign),new f(z)]}F=m(U)}var ee=N(I,F);if(ee===-1)return[o[0],p];if(ee===0)return[o[p.sign===S.sign?1:-1],o[0]];I.length+F.length<=200?x=$(I,F):x=B(I,F),L=x[0];var ie=p.sign!==S.sign,ne=x[1],ce=p.sign;return typeof L=="number"?(ie&&(L=-L),L=new f(L)):L=new u(L,ie),typeof ne=="number"?(ce&&(ne=-ne),ne=new f(ne)):ne=new u(ne,ce),[L,ne]}u.prototype.divmod=function(p){var _=k(this,p);return{quotient:_[0],remainder:_[1]}},h.prototype.divmod=f.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(p){return k(this,p)[0]},h.prototype.over=h.prototype.divide=function(p){return new h(this.value/Q(p).value)},f.prototype.over=f.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(p){return k(this,p)[1]},h.prototype.mod=h.prototype.remainder=function(p){return new h(this.value%Q(p).value)},f.prototype.remainder=f.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(p){var _=Q(p),x=this.value,S=_.value,I,F,L;if(S===0)return o[1];if(x===0)return o[0];if(x===1)return o[1];if(x===-1)return _.isEven()?o[1]:o[-1];if(_.sign)return o[0];if(!_.isSmall)throw new Error("The exponent "+_.toString()+" is too large.");if(this.isSmall&&g(I=Math.pow(x,S)))return new f(w(I));for(F=this,L=o[1];S&!0&&(L=L.times(F),--S),S!==0;)S/=2,F=F.square();return L},f.prototype.pow=u.prototype.pow,h.prototype.pow=function(p){var _=Q(p),x=this.value,S=_.value,I=BigInt(0),F=BigInt(1),L=BigInt(2);if(S===I)return o[1];if(x===I)return o[0];if(x===F)return o[1];if(x===BigInt(-1))return _.isEven()?o[1]:o[-1];if(_.isNegative())return new h(I);for(var U=this,z=o[1];(S&F)===F&&(z=z.times(U),--S),S!==I;)S/=L,U=U.square();return z},u.prototype.modPow=function(p,_){if(p=Q(p),_=Q(_),_.isZero())throw new Error("Cannot take modPow with modulus 0");var x=o[1],S=this.mod(_);for(p.isNegative()&&(p=p.multiply(o[-1]),S=S.modInv(_));p.isPositive();){if(S.isZero())return o[0];p.isOdd()&&(x=x.multiply(S).mod(_)),p=p.divide(2),S=S.square().mod(_)}return x},h.prototype.modPow=f.prototype.modPow=u.prototype.modPow;function N(p,_){if(p.length!==_.length)return p.length>_.length?1:-1;for(var x=p.length-1;x>=0;x--)if(p[x]!==_[x])return p[x]>_[x]?1:-1;return 0}u.prototype.compareAbs=function(p){var _=Q(p),x=this.value,S=_.value;return _.isSmall?1:N(x,S)},f.prototype.compareAbs=function(p){var _=Q(p),x=Math.abs(this.value),S=_.value;return _.isSmall?(S=Math.abs(S),x===S?0:x>S?1:-1):-1},h.prototype.compareAbs=function(p){var _=this.value,x=Q(p).value;return _=_>=0?_:-_,x=x>=0?x:-x,_===x?0:_>x?1:-1},u.prototype.compare=function(p){if(p===1/0)return-1;if(p===-1/0)return 1;var _=Q(p),x=this.value,S=_.value;return this.sign!==_.sign?_.sign?1:-1:_.isSmall?this.sign?-1:1:N(x,S)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,f.prototype.compare=function(p){if(p===1/0)return-1;if(p===-1/0)return 1;var _=Q(p),x=this.value,S=_.value;return _.isSmall?x==S?0:x>S?1:-1:x<0!==_.sign?x<0?-1:1:x<0?1:-1},f.prototype.compareTo=f.prototype.compare,h.prototype.compare=function(p){if(p===1/0)return-1;if(p===-1/0)return 1;var _=this.value,x=Q(p).value;return _===x?0:_>x?1:-1},h.prototype.compareTo=h.prototype.compare,u.prototype.equals=function(p){return this.compare(p)===0},h.prototype.eq=h.prototype.equals=f.prototype.eq=f.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(p){return this.compare(p)!==0},h.prototype.neq=h.prototype.notEquals=f.prototype.neq=f.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(p){return this.compare(p)>0},h.prototype.gt=h.prototype.greater=f.prototype.gt=f.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(p){return this.compare(p)<0},h.prototype.lt=h.prototype.lesser=f.prototype.lt=f.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(p){return this.compare(p)>=0},h.prototype.geq=h.prototype.greaterOrEquals=f.prototype.geq=f.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(p){return this.compare(p)<=0},h.prototype.leq=h.prototype.lesserOrEquals=f.prototype.leq=f.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return(this.value[0]&1)===0},f.prototype.isEven=function(){return(this.value&1)===0},h.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return(this.value[0]&1)===1},f.prototype.isOdd=function(){return(this.value&1)===1},h.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},f.prototype.isPositive=function(){return this.value>0},h.prototype.isPositive=f.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},f.prototype.isNegative=function(){return this.value<0},h.prototype.isNegative=f.prototype.isNegative,u.prototype.isUnit=function(){return!1},f.prototype.isUnit=function(){return Math.abs(this.value)===1},h.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},f.prototype.isZero=function(){return this.value===0},h.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(p){var _=Q(p);return _.isZero()?!1:_.isUnit()?!0:_.compareAbs(2)===0?this.isEven():this.mod(_).isZero()},h.prototype.isDivisibleBy=f.prototype.isDivisibleBy=u.prototype.isDivisibleBy;function j(p){var _=p.abs();if(_.isUnit())return!1;if(_.equals(2)||_.equals(3)||_.equals(5))return!0;if(_.isEven()||_.isDivisibleBy(3)||_.isDivisibleBy(5))return!1;if(_.lesser(49))return!0}function V(p,_){for(var x=p.prev(),S=x,I=0,F,L,U,z;S.isEven();)S=S.divide(2),I++;e:for(U=0;U<_.length;U++)if(!p.lesser(_[U])&&(z=Ye(_[U]).modPow(S,p),!(z.isUnit()||z.equals(x)))){for(F=I-1;F!=0;F--){if(z=z.square().mod(p),z.isUnit())return!1;if(z.equals(x))continue e}return!1}return!0}u.prototype.isPrime=function(p){var _=j(this);if(_!==t)return _;var x=this.abs(),S=x.bitLength();if(S<=64)return V(x,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var I=Math.log(2)*S.toJSNumber(),F=Math.ceil(p===!0?2*Math.pow(I,2):I),L=[],U=0;U<F;U++)L.push(Ye(U+2));return V(x,L)},h.prototype.isPrime=f.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(p,_){var x=j(this);if(x!==t)return x;for(var S=this.abs(),I=p===t?5:p,F=[],L=0;L<I;L++)F.push(Ye.randBetween(2,S.minus(2),_));return V(S,F)},h.prototype.isProbablePrime=f.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(p){for(var _=Ye.zero,x=Ye.one,S=Q(p),I=this.abs(),F,L,U;!I.isZero();)F=S.divide(I),L=_,U=S,_=x,S=I,x=L.subtract(F.multiply(x)),I=U.subtract(F.multiply(I));if(!S.isUnit())throw new Error(this.toString()+" and "+p.toString()+" are not co-prime");return _.compare(0)===-1&&(_=_.add(p)),this.isNegative()?_.negate():_},h.prototype.modInv=f.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var p=this.value;return this.sign?X(p,1,this.sign):new u(O(p,1),this.sign)},f.prototype.next=function(){var p=this.value;return p+1<i?new f(p+1):new u(n,!1)},h.prototype.next=function(){return new h(this.value+BigInt(1))},u.prototype.prev=function(){var p=this.value;return this.sign?new u(O(p,1),!0):X(p,1,this.sign)},f.prototype.prev=function(){var p=this.value;return p-1>-i?new f(p-1):new u(n,!0)},h.prototype.prev=function(){return new h(this.value-BigInt(1))};for(var Y=[1];2*Y[Y.length-1]<=e;)Y.push(2*Y[Y.length-1]);var J=Y.length,te=Y[J-1];function Ce(p){return Math.abs(p)<=e}u.prototype.shiftLeft=function(p){var _=Q(p).toJSNumber();if(!Ce(_))throw new Error(String(_)+" is too large for shifting.");if(_<0)return this.shiftRight(-_);var x=this;if(x.isZero())return x;for(;_>=J;)x=x.multiply(te),_-=J-1;return x.multiply(Y[_])},h.prototype.shiftLeft=f.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(p){var _,x=Q(p).toJSNumber();if(!Ce(x))throw new Error(String(x)+" is too large for shifting.");if(x<0)return this.shiftLeft(-x);for(var S=this;x>=J;){if(S.isZero()||S.isNegative()&&S.isUnit())return S;_=k(S,te),S=_[1].isNegative()?_[0].prev():_[0],x-=J-1}return _=k(S,Y[x]),_[1].isNegative()?_[0].prev():_[0]},h.prototype.shiftRight=f.prototype.shiftRight=u.prototype.shiftRight;function xe(p,_,x){_=Q(_);for(var S=p.isNegative(),I=_.isNegative(),F=S?p.not():p,L=I?_.not():_,U=0,z=0,ee=null,ie=null,ne=[];!F.isZero()||!L.isZero();)ee=k(F,te),U=ee[1].toJSNumber(),S&&(U=te-1-U),ie=k(L,te),z=ie[1].toJSNumber(),I&&(z=te-1-z),F=ee[0],L=ie[0],ne.push(x(U,z));for(var ce=x(S?1:0,I?1:0)!==0?Ye(-1):Ye(0),Ot=ne.length-1;Ot>=0;Ot-=1)ce=ce.multiply(te).add(Ye(ne[Ot]));return ce}u.prototype.not=function(){return this.negate().prev()},h.prototype.not=f.prototype.not=u.prototype.not,u.prototype.and=function(p){return xe(this,p,function(_,x){return _&x})},h.prototype.and=f.prototype.and=u.prototype.and,u.prototype.or=function(p){return xe(this,p,function(_,x){return _|x})},h.prototype.or=f.prototype.or=u.prototype.or,u.prototype.xor=function(p){return xe(this,p,function(_,x){return _^x})},h.prototype.xor=f.prototype.xor=u.prototype.xor;var he=1<<30,ae=(e&-e)*(e&-e)|he;function Se(p){var _=p.value,x=typeof _=="number"?_|he:typeof _=="bigint"?_|BigInt(he):_[0]+_[1]*e|ae;return x&-x}function tt(p,_){if(_.compareTo(p)<=0){var x=tt(p,_.square(_)),S=x.p,I=x.e,F=S.multiply(_);return F.compareTo(p)<=0?{p:F,e:I*2+1}:{p:S,e:I*2}}return{p:Ye(1),e:0}}u.prototype.bitLength=function(){var p=this;return p.compareTo(Ye(0))<0&&(p=p.negate().subtract(Ye(1))),p.compareTo(Ye(0))===0?Ye(0):Ye(tt(p,Ye(2)).e).add(Ye(1))},h.prototype.bitLength=f.prototype.bitLength=u.prototype.bitLength;function mt(p,_){return p=Q(p),_=Q(_),p.greater(_)?p:_}function ar(p,_){return p=Q(p),_=Q(_),p.lesser(_)?p:_}function Rr(p,_){if(p=Q(p).abs(),_=Q(_).abs(),p.equals(_))return p;if(p.isZero())return _;if(_.isZero())return p;for(var x=o[1],S,I;p.isEven()&&_.isEven();)S=ar(Se(p),Se(_)),p=p.divide(S),_=_.divide(S),x=x.multiply(S);for(;p.isEven();)p=p.divide(Se(p));do{for(;_.isEven();)_=_.divide(Se(_));p.greater(_)&&(I=_,_=p,p=I),_=_.subtract(p)}while(!_.isZero());return x.isUnit()?p:p.multiply(x)}function oi(p,_){return p=Q(p).abs(),_=Q(_).abs(),p.divide(Rr(p,_)).multiply(_)}function lu(p,_,x){p=Q(p),_=Q(_);var S=x||Math.random,I=ar(p,_),F=mt(p,_),L=F.subtract(I).add(1);if(L.isSmall)return I.add(Math.floor(S()*L));for(var U=Or(L,e).value,z=[],ee=!0,ie=0;ie<U.length;ie++){var ne=ee?U[ie]+(ie+1<U.length?U[ie+1]/e:0):e,ce=w(S()*ne);z.push(ce),ce<U[ie]&&(ee=!1)}return I.add(o.fromArray(z,e,!1))}var Ja=function(p,_,x,S){x=x||s,p=String(p),S||(p=p.toLowerCase(),x=x.toLowerCase());var I=p.length,F,L=Math.abs(_),U={};for(F=0;F<x.length;F++)U[x[F]]=F;for(F=0;F<I;F++){var z=p[F];if(z!=="-"&&z in U&&U[z]>=L){if(z==="1"&&L===1)continue;throw new Error(z+" is not a valid digit in base "+_+".")}}_=Q(_);var ee=[],ie=p[0]==="-";for(F=ie?1:0;F<p.length;F++){var z=p[F];if(z in U)ee.push(Q(U[z]));else if(z==="<"){var ne=F;do F++;while(p[F]!==">"&&F<p.length);ee.push(Q(p.slice(ne+1,F)))}else throw new Error(z+" is not a valid character")}return rs(ee,_,ie)};function rs(p,_,x){var S=o[0],I=o[1],F;for(F=p.length-1;F>=0;F--)S=S.add(p[F].times(I)),I=I.times(_);return x?S.negate():S}function nd(p,_){return _=_||s,p<_.length?_[p]:"<"+p+">"}function Or(p,_){if(_=Ye(_),_.isZero()){if(p.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(_.equals(-1)){if(p.isZero())return{value:[0],isNegative:!1};if(p.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-p.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var x=Array.apply(null,Array(p.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return x.unshift([1]),{value:[].concat.apply([],x),isNegative:!1}}var S=!1;if(p.isNegative()&&_.isPositive()&&(S=!0,p=p.abs()),_.isUnit())return p.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(p.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:S};for(var I=[],F=p,L;F.isNegative()||F.compareAbs(_)>=0;){L=F.divmod(_),F=L.quotient;var U=L.remainder;U.isNegative()&&(U=_.minus(U).abs(),F=F.next()),I.push(U.toJSNumber())}return I.push(F.toJSNumber()),{value:I.reverse(),isNegative:S}}function uu(p,_,x){var S=Or(p,_);return(S.isNegative?"-":"")+S.value.map(function(I){return nd(I,x)}).join("")}u.prototype.toArray=function(p){return Or(this,p)},f.prototype.toArray=function(p){return Or(this,p)},h.prototype.toArray=function(p){return Or(this,p)},u.prototype.toString=function(p,_){if(p===t&&(p=10),p!==10)return uu(this,p,_);for(var x=this.value,S=x.length,I=String(x[--S]),F="0000000",L;--S>=0;)L=String(x[S]),I+=F.slice(L.length)+L;var U=this.sign?"-":"";return U+I},f.prototype.toString=function(p,_){return p===t&&(p=10),p!=10?uu(this,p,_):String(this.value)},h.prototype.toString=f.prototype.toString,h.prototype.toJSON=u.prototype.toJSON=f.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,f.prototype.valueOf=function(){return this.value},f.prototype.toJSNumber=f.prototype.valueOf,h.prototype.valueOf=h.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function or(p){if(g(+p)){var _=+p;if(_===w(_))return a?new h(BigInt(_)):new f(_);throw new Error("Invalid integer: "+p)}var x=p[0]==="-";x&&(p=p.slice(1));var S=p.split(/e/i);if(S.length>2)throw new Error("Invalid integer: "+S.join("e"));if(S.length===2){var I=S[1];if(I[0]==="+"&&(I=I.slice(1)),I=+I,I!==w(I)||!g(I))throw new Error("Invalid integer: "+I+" is not a valid exponent.");var F=S[0],L=F.indexOf(".");if(L>=0&&(I-=F.length-L-1,F=F.slice(0,L)+F.slice(L+1)),I<0)throw new Error("Cannot include negative exponent part for integers");F+=new Array(I+1).join("0"),p=F}var U=/^([0-9][0-9]*)$/.test(p);if(!U)throw new Error("Invalid integer: "+p);if(a)return new h(BigInt(x?"-"+p:p));for(var z=[],ee=p.length,ie=r,ne=ee-ie;ee>0;)z.push(+p.slice(ne,ee)),ne-=ie,ne<0&&(ne=0),ee-=ie;return d(z),new u(z,x)}function fu(p){if(a)return new h(BigInt(p));if(g(p)){if(p!==w(p))throw new Error(p+" is not an integer.");return new f(p)}return or(p.toString())}function Q(p){return typeof p=="number"?fu(p):typeof p=="string"?or(p):typeof p=="bigint"?new h(p):p}for(var D=0;D<1e3;D++)o[D]=Q(D),D>0&&(o[-D]=Q(-D));return o.one=o[1],o.zero=o[0],o.minusOne=o[-1],o.max=mt,o.min=ar,o.gcd=Rr,o.lcm=oi,o.isInstance=function(p){return p instanceof u||p instanceof f||p instanceof h},o.randBetween=lu,o.fromArray=function(p,_,x){return rs(p.map(Q),Q(_||10),x)},o}();typeof Gc<"u"&&Gc.hasOwnProperty("exports")&&(Gc.exports=Ye);typeof define=="function"&&define.amd&&define(function(){return Ye})});var jL=y((tce,BL)=>{var Ki=PL(),Zc=require("stream");(!Zc.Writable||!Zc.Writable.prototype.destroy)&&(Zc=ti());var Yc;function Zie(){var t=3988292384,e,r,i;for(Yc=[],r=0;r<256;r++){for(e=r,i=0;i<8;i++)e=e&1?t^e>>>1:e=e>>>1;Yc[r]=e>>>0}}function LL(t,e){return Yc||Zie(),t.charCodeAt&&(t=t.charCodeAt(0)),Ki(e).shiftRight(8).and(16777215).xor(Yc[Ki(e).xor(t).and(255)]).value}function Za(){if(!(this instanceof Za))return new Za;this.key0=305419896,this.key1=591751049,this.key2=878082192}Za.prototype.update=function(t){this.key0=LL(t,this.key0),this.key1=Ki(this.key0).and(255).and(4294967295).add(this.key1),this.key1=Ki(this.key1).multiply(134775813).add(1).and(4294967295).value,this.key2=LL(Ki(this.key1).shiftRight(24).and(255),this.key2)};Za.prototype.decryptByte=function(t){var e=Ki(this.key2).or(2);return t=t^Ki(e).multiply(Ki(e^1)).shiftRight(8).and(255),this.update(t),t};Za.prototype.stream=function(){var t=Zc.Transform(),e=this;return t._transform=function(r,i,n){for(var s=0;s<r.length;s++)r[s]=e.decryptByte(r[s]);this.push(r),n()},t};BL.exports=Za});var $L=y((rce,WL)=>{var Yie=ji(),Kie=jL(),Qie=cc(),tu=require("stream"),Jie=wl(),ene=require("zlib"),tne=gc(),rne=Fa(),ine=mc();(!tu.Writable||!tu.Writable.prototype.destroy)&&(tu=ti());WL.exports=function(e,r,i,n){var s=Qie(),a=tu.PassThrough(),o=e.stream(r);return o.pipe(s).on("error",function(u){a.emit("error",u)}),a.vars=s.pull(30).then(function(u){var f=Jie.parse(u).word32lu("signature").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;return f.lastModifiedDateTime=ine(f.lastModifiedDate,f.lastModifiedTime),s.pull(f.fileNameLength).then(function(h){return f.fileName=h.toString("utf8"),s.pull(f.extraFieldLength)}).then(function(h){var g;return f.extra=tne(h,f),n&&n.compressedSize&&(f=n),f.flags&1&&(g=s.pull(12).then(function(m){if(!i)throw new Error("MISSING_PASSWORD");var c=Kie();String(i).split("").forEach(function(w){c.update(w)});for(var d=0;d<m.length;d++)m[d]=c.decryptByte(m[d]);f.decrypt=c,f.compressedSize-=12;var v=f.flags&8?f.lastModifiedTime>>8&255:f.crc32>>24&255;if(m[11]!==v)throw new Error("BAD_PASSWORD");return f})),Yie.resolve(g).then(function(){return a.emit("vars",f),f})})}),a.vars.then(function(u){var f=!(u.flags&8)||u.compressedSize>0,h,g=u.compressionMethod?ene.createInflateRaw():tu.PassThrough();f?(a.size=u.uncompressedSize,h=u.compressedSize):(h=rne.alloc(4),h.writeUInt32LE(134695760,0));var m=s.stream(h);u.decrypt&&(m=m.pipe(u.decrypt.stream())),m.pipe(g).on("error",function(c){a.emit("error",c)}).pipe(a).on("finish",function(){o.destroy?o.destroy():o.abort?o.abort():o.close?o.close():o.push?o.push():console.log("warning - unable to close stream")})}).catch(function(u){a.emit("error",u)}),a}});var zL=y((ice,UL)=>{var nu=wl(),iu=cc(),nne=$L(),ru=ji(),sne=pc(),ane=gc(),one=Fa(),Nb=require("path"),lne=Ab().Writer,une=mc(),HL=one.alloc(4);HL.writeUInt32LE(101010256,0);function fne(t){var e=t.stream(0).pipe(iu());return e.pull(4).then(function(r){var i=r.readUInt32LE(0);if(i===875721283){var n;return e.pull(12).then(function(s){n=nu.parse(s).word32lu("version").word32lu("pubKeyLength").word32lu("signatureLength").vars}).then(function(){return e.pull(n.pubKeyLength+n.signatureLength)}).then(function(s){return n.publicKey=s.slice(0,n.pubKeyLength),n.signature=s.slice(n.pubKeyLength),n.size=16+n.pubKeyLength+n.signatureLength,n})}})}function hne(t,e){var r=nu.parse(e).word32lu("signature").word32lu("diskNumber").word64lu("offsetToStartOfCentralDirectory").word32lu("numberOfDisks").vars;if(r.signature!=117853008)throw new Error("invalid zip64 end of central dir locator signature (0x07064b50): 0x"+r.signature.toString(16));var i=iu();return t.stream(r.offsetToStartOfCentralDirectory).pipe(i),i.pull(56)}function cne(t){var e=nu.parse(t).word32lu("signature").word64lu("sizeOfCentralDirectory").word16lu("version").word16lu("versionsNeededToExtract").word32lu("diskNumber").word32lu("diskStart").word64lu("numberOfRecordsOnDisk").word64lu("numberOfRecords").word64lu("sizeOfCentralDirectory").word64lu("offsetToStartOfCentralDirectory").vars;if(e.signature!=101075792)throw new Error("invalid zip64 end of central dir locator signature (0x06064b50): 0x0"+e.signature.toString(16));return e}UL.exports=function(e,r){var i=iu(),n=iu(),s=r&&r.tailSize||80,a,o,u,f;return r&&r.crx&&(o=fne(e)),e.size().then(function(h){return a=h,e.stream(Math.max(0,h-s)).on("error",function(g){i.emit("error",g)}).pipe(i),i.pull(HL)}).then(function(){return ru.props({directory:i.pull(22),crxHeader:o})}).then(function(h){var g=h.directory;if(u=h.crxHeader&&h.crxHeader.size||0,f=nu.parse(g).word32lu("signature").word16lu("diskNumber").word16lu("diskStart").word16lu("numberOfRecordsOnDisk").word16lu("numberOfRecords").word32lu("sizeOfCentralDirectory").word32lu("offsetToStartOfCentralDirectory").word16lu("commentLength").vars,f.numberOfRecords==65535||f.numberOfRecords==65535||f.offsetToStartOfCentralDirectory==4294967295){let c=a-(s-i.match+20),d=iu();return e.stream(c).pipe(d),d.pull(20).then(function(v){return hne(e,v)}).then(function(v){f=cne(v)})}else f.offsetToStartOfCentralDirectory+=u}).then(function(){if(f.commentLength)return i.pull(f.commentLength).then(function(h){f.comment=h.toString("utf8")})}).then(function(){return e.stream(f.offsetToStartOfCentralDirectory).pipe(n),f.extract=function(h){if(!h||!h.path)throw new Error("PATH_MISSING");return h.path=Nb.resolve(Nb.normalize(h.path)),f.files.then(function(g){return ru.map(g,function(m){if(m.type!="Directory"){var c=Nb.join(h.path,m.path);if(c.indexOf(h.path)==0){var d=h.getWriter?h.getWriter({path:c}):lne({path:c});return new ru(function(v,w){m.stream(h.password).on("error",w).pipe(d).on("close",v).on("error",w)})}}},{concurrency:h.concurrency>1?h.concurrency:1})})},f.files=ru.mapSeries(Array(f.numberOfRecords),function(){return n.pull(46).then(function(h){var g=nu.parse(h).word32lu("signature").word16lu("versionMadeBy").word16lu("versionsNeededToExtract").word16lu("flags").word16lu("compressionMethod").word16lu("lastModifiedTime").word16lu("lastModifiedDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumber").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("offsetToLocalFileHeader").vars;return g.offsetToLocalFileHeader+=u,g.lastModifiedDateTime=une(g.lastModifiedDate,g.lastModifiedTime),n.pull(g.fileNameLength).then(function(m){return g.pathBuffer=m,g.path=m.toString("utf8"),g.isUnicode=(g.flags&2048)!=0,n.pull(g.extraFieldLength)}).then(function(m){return g.extra=ane(m,g),n.pull(g.fileCommentLength)}).then(function(m){return g.comment=m,g.type=g.uncompressedSize===0&&/[\/\\]$/.test(g.path)?"Directory":"File",g.stream=function(c){return nne(e,g.offsetToLocalFileHeader,c,g)},g.buffer=function(c){return sne(g.stream(c))},g})})}),ru.props(f)})}});var GL=y((nce,VL)=>{var XL=Cr(),Kc=ji(),su=zL(),Qc=require("stream");(!Qc.Writable||!Qc.Writable.prototype.destroy)&&(Qc=ti());VL.exports={buffer:function(t,e){var r={stream:function(i,n){var s=Qc.PassThrough();return s.end(t.slice(i,n)),s},size:function(){return Kc.resolve(t.length)}};return su(r,e)},file:function(t,e){var r={stream:function(i,n){return XL.createReadStream(t,{start:i,end:n&&i+n})},size:function(){return new Kc(function(i,n){XL.stat(t,function(s,a){s?n(s):i(a.size)})})}};return su(r,e)},url:function(t,e,r){if(typeof e=="string"&&(e={url:e}),!e.url)throw"URL missing";e.headers=e.headers||{};var i={stream:function(n,s){var a=Object.create(e);return a.headers=Object.create(e.headers),a.headers.range="bytes="+n+"-"+(s||""),t(a)},size:function(){return new Kc(function(n,s){var a=t(e);a.on("response",function(o){a.abort(),o.headers["content-length"]?n(o.headers["content-length"]):s(new Error("Missing content length header"))}).on("error",s)})}};return su(i,r)},s3:function(t,e,r){var i={size:function(){return new Kc(function(n,s){t.headObject(e,function(a,o){a?s(a):n(o.ContentLength)})})},stream:function(n,s){var a={};for(var o in e)a[o]=e[o];return a.Range="bytes="+n+"-"+(s||""),t.getObject(a).createReadStream()}};return su(i,r)},custom:function(t,e){return su(t,e)}}});var ZL=y(au=>{"use strict";aq();fq();pp();au.Parse=vc();au.ParseOne=j2();au.Extract=ML();au.Open=GL()});var iB=y((ace,rB)=>{var Ee=require("assert"),JL=require("path"),YL=require("fs"),Ya;try{Ya=Wc()}catch{}var dne={nosort:!0,silent:!0},Db=0,ou=process.platform==="win32",eB=t=>{if(["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{t[r]=t[r]||YL[r],r=r+"Sync",t[r]=t[r]||YL[r]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,t.glob===!1&&(t.disableGlob=!0),t.disableGlob!==!0&&Ya===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");t.disableGlob=t.disableGlob||!1,t.glob=t.glob||dne},Ib=(t,e,r)=>{typeof e=="function"&&(r=e,e={}),Ee(t,"rimraf: missing path"),Ee.equal(typeof t,"string","rimraf: path should be a string"),Ee.equal(typeof r,"function","rimraf: callback function required"),Ee(e,"rimraf: invalid options argument provided"),Ee.equal(typeof e,"object","rimraf: options should be object"),eB(e);let i=0,n=null,s=0,a=u=>{n=n||u,--s===0&&r(n)},o=(u,f)=>{if(u)return r(u);if(s=f.length,s===0)return r();f.forEach(h=>{let g=m=>{if(m){if((m.code==="EBUSY"||m.code==="ENOTEMPTY"||m.code==="EPERM")&&i<e.maxBusyTries)return i++,setTimeout(()=>qb(h,e,g),i*100);if(m.code==="EMFILE"&&Db<e.emfileWait)return setTimeout(()=>qb(h,e,g),Db++);m.code==="ENOENT"&&(m=null)}Db=0,a(m)};qb(h,e,g)})};if(e.disableGlob||!Ya.hasMagic(t))return o(null,[t]);e.lstat(t,(u,f)=>{if(!u)return o(null,[t]);Ya(t,e.glob,o)})},qb=(t,e,r)=>{Ee(t),Ee(e),Ee(typeof r=="function"),e.lstat(t,(i,n)=>{if(i&&i.code==="ENOENT")return r(null);if(i&&i.code==="EPERM"&&ou&&KL(t,e,i,r),n&&n.isDirectory())return Jc(t,e,i,r);e.unlink(t,s=>{if(s){if(s.code==="ENOENT")return r(null);if(s.code==="EPERM")return ou?KL(t,e,s,r):Jc(t,e,s,r);if(s.code==="EISDIR")return Jc(t,e,s,r)}return r(s)})})},KL=(t,e,r,i)=>{Ee(t),Ee(e),Ee(typeof i=="function"),e.chmod(t,438,n=>{n?i(n.code==="ENOENT"?null:r):e.stat(t,(s,a)=>{s?i(s.code==="ENOENT"?null:r):a.isDirectory()?Jc(t,e,r,i):e.unlink(t,i)})})},QL=(t,e,r)=>{Ee(t),Ee(e);try{e.chmodSync(t,438)}catch(n){if(n.code==="ENOENT")return;throw r}let i;try{i=e.statSync(t)}catch(n){if(n.code==="ENOENT")return;throw r}i.isDirectory()?ed(t,e,r):e.unlinkSync(t)},Jc=(t,e,r,i)=>{Ee(t),Ee(e),Ee(typeof i=="function"),e.rmdir(t,n=>{n&&(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")?pne(t,e,i):n&&n.code==="ENOTDIR"?i(r):i(n)})},pne=(t,e,r)=>{Ee(t),Ee(e),Ee(typeof r=="function"),e.readdir(t,(i,n)=>{if(i)return r(i);let s=n.length;if(s===0)return e.rmdir(t,r);let a;n.forEach(o=>{Ib(JL.join(t,o),e,u=>{if(!a){if(u)return r(a=u);--s===0&&e.rmdir(t,r)}})})})},tB=(t,e)=>{e=e||{},eB(e),Ee(t,"rimraf: missing path"),Ee.equal(typeof t,"string","rimraf: path should be a string"),Ee(e,"rimraf: missing options"),Ee.equal(typeof e,"object","rimraf: options should be object");let r;if(e.disableGlob||!Ya.hasMagic(t))r=[t];else try{e.lstatSync(t),r=[t]}catch{r=Ya.sync(t,e.glob)}if(!!r.length)for(let i=0;i<r.length;i++){let n=r[i],s;try{s=e.lstatSync(n)}catch(a){if(a.code==="ENOENT")return;a.code==="EPERM"&&ou&&QL(n,e,a)}try{s&&s.isDirectory()?ed(n,e,null):e.unlinkSync(n)}catch(a){if(a.code==="ENOENT")return;if(a.code==="EPERM")return ou?QL(n,e,a):ed(n,e,a);if(a.code!=="EISDIR")throw a;ed(n,e,a)}}},ed=(t,e,r)=>{Ee(t),Ee(e);try{e.rmdirSync(t)}catch(i){if(i.code==="ENOENT")return;if(i.code==="ENOTDIR")throw r;(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")&&gne(t,e)}},gne=(t,e)=>{Ee(t),Ee(e),e.readdirSync(t).forEach(n=>tB(JL.join(t,n),e));let r=ou?100:1,i=0;do{let n=!0;try{let s=e.rmdirSync(t,e);return n=!1,s}finally{if(++i<r&&n)continue}}while(!0)};rB.exports=Ib;Ib.sync=tB});var bB=y((oce,ai)=>{var et=require("fs"),jb=require("os"),Pt=require("path"),nB=require("crypto"),kr={fs:et.constants,os:jb.constants},oB=iB(),sB="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",lB=/XXXXXX/,mne=3,uB=(kr.O_CREAT||kr.fs.O_CREAT)|(kr.O_EXCL||kr.fs.O_EXCL)|(kr.O_RDWR||kr.fs.O_RDWR),vne=jb.platform()==="win32",yne=kr.EBADF||kr.os.errno.EBADF,_ne=kr.ENOENT||kr.os.errno.ENOENT,fB=448,hB=384,wne="exit",Ka=[],cB=et.rmdirSync.bind(et),dB=oB.sync,pB=!1;function Wb(t,e){let r=Qa(t,e),i=r[0],n=r[1];try{yB(i)}catch(a){return n(a)}let s=i.tries;(function a(){try{let o=vB(i);et.stat(o,function(u){if(!u)return s-- >0?a():n(new Error("Could not get a unique tmp filename, max tries reached "+o));n(null,o)})}catch(o){n(o)}})()}function $b(t){let e=Qa(t),r=e[0];yB(r);let i=r.tries;do{let n=vB(r);try{et.statSync(n)}catch{return n}}while(i-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function bne(t,e){let r=Qa(t,e),i=r[0],n=r[1];Wb(i,function(a,o){if(a)return n(a);et.open(o,uB,i.mode||hB,function(f,h){if(f)return n(f);if(i.discardDescriptor)return et.close(h,function(m){return n(m,o,void 0,Pb(o,-1,i,!1))});{let g=i.discardDescriptor||i.detachDescriptor;n(null,o,h,Pb(o,g?-1:h,i,!1))}})})}function xne(t){let e=Qa(t),r=e[0],i=r.discardDescriptor||r.detachDescriptor,n=$b(r);var s=et.openSync(n,uB,r.mode||hB);return r.discardDescriptor&&(et.closeSync(s),s=void 0),{name:n,fd:s,removeCallback:Pb(n,i?-1:s,r,!0)}}function Tne(t,e){let r=Qa(t,e),i=r[0],n=r[1];Wb(i,function(a,o){if(a)return n(a);et.mkdir(o,i.mode||fB,function(f){if(f)return n(f);n(null,o,gB(o,i,!1))})})}function Ene(t){let e=Qa(t),r=e[0],i=$b(r);return et.mkdirSync(i,r.mode||fB),{name:i,removeCallback:gB(i,r,!0)}}function Cne(t,e){let r=function(i){if(i&&!Bb(i))return e(i);e()};0<=t[0]?et.close(t[0],function(){et.unlink(t[1],r)}):et.unlink(t[1],r)}function Sne(t){let e=null;try{0<=t[0]&&et.closeSync(t[0])}catch(r){if(!Rne(r)&&!Bb(r))throw r}finally{try{et.unlinkSync(t[1])}catch(r){Bb(r)||(e=r)}}if(e!==null)throw e}function Pb(t,e,r,i){let n=td(Sne,[e,t],i),s=td(Cne,[e,t],i,n);return r.keep||Ka.unshift(n),i?n:s}function gB(t,e,r){let i=e.unsafeCleanup?oB:et.rmdir.bind(et),n=e.unsafeCleanup?dB:cB,s=td(n,t,r),a=td(i,t,r,s);return e.keep||Ka.unshift(s),r?s:a}function td(t,e,r,i){let n=!1;return function s(a){if(!n){let o=i||s,u=Ka.indexOf(o);return u>=0&&Ka.splice(u,1),n=!0,r||t===cB||t===dB?t(e):t(e,a||function(){})}}}function kne(){if(!!pB)for(;Ka.length;)try{Ka[0]()}catch{}}function aB(t){let e=[],r=null;try{r=nB.randomBytes(t)}catch{r=nB.pseudoRandomBytes(t)}for(var i=0;i<t;i++)e.push(sB[r[i]%sB.length]);return e.join("")}function mB(t){return t===null||Rt(t)||!t.trim()}function Rt(t){return typeof t>"u"}function Qa(t,e){if(typeof t=="function")return[{},t];if(Rt(t))return[{},e];let r={};for(let i of Object.getOwnPropertyNames(t))r[i]=t[i];return[r,e]}function vB(t){let e=t.tmpdir;if(!Rt(t.name))return Pt.join(e,t.dir,t.name);if(!Rt(t.template))return Pt.join(e,t.dir,t.template).replace(lB,aB(6));let r=[t.prefix?t.prefix:"tmp","-",process.pid,"-",aB(12),t.postfix?"-"+t.postfix:""].join("");return Pt.join(e,t.dir,r)}function yB(t){t.tmpdir=wB(t);let e=t.tmpdir;if(Rt(t.name)||Mb(t.name,"name",e),Rt(t.dir)||Mb(t.dir,"dir",e),!Rt(t.template)&&(Mb(t.template,"template",e),!t.template.match(lB)))throw new Error(`Invalid template, found "${t.template}".`);if(!Rt(t.tries)&&isNaN(t.tries)||t.tries<0)throw new Error(`Invalid tries, found "${t.tries}".`);t.tries=Rt(t.name)?t.tries||mne:1,t.keep=!!t.keep,t.detachDescriptor=!!t.detachDescriptor,t.discardDescriptor=!!t.discardDescriptor,t.unsafeCleanup=!!t.unsafeCleanup,t.dir=Rt(t.dir)?"":Pt.relative(e,Lb(t.dir,e)),t.template=Rt(t.template)?void 0:Pt.relative(e,Lb(t.template,e)),t.template=mB(t.template)?void 0:Pt.relative(t.dir,t.template),t.name=Rt(t.name)?void 0:Hb(t.name),t.prefix=Rt(t.prefix)?"":t.prefix,t.postfix=Rt(t.postfix)?"":t.postfix}function Lb(t,e){let r=Hb(t);return r.startsWith(e)?Pt.resolve(r):Pt.resolve(Pt.join(e,r))}function Hb(t){return mB(t)?t:t.replace(/["']/g,"")}function Mb(t,e,r){if(e==="name"){if(Pt.isAbsolute(t))throw new Error(`${e} option must not contain an absolute path, found "${t}".`);let i=Pt.basename(t);if(i===".."||i==="."||i!==t)throw new Error(`${e} option must not contain a path, found "${t}".`)}else{if(Pt.isAbsolute(t)&&!t.startsWith(r))throw new Error(`${e} option must be relative to "${r}", found "${t}".`);let i=Lb(t,r);if(!i.startsWith(r))throw new Error(`${e} option must be relative to "${r}", found "${i}".`)}}function Rne(t){return _B(t,-yne,"EBADF")}function Bb(t){return _B(t,-_ne,"ENOENT")}function _B(t,e,r){return vne?t.code===r:t.code===r&&t.errno===e}function One(){pB=!0}function wB(t){return Pt.resolve(Hb(t&&t.tmpdir||jb.tmpdir()))}process.addListener(wne,kne);Object.defineProperty(ai.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return wB()}});ai.exports.dir=Tne;ai.exports.dirSync=Ene;ai.exports.file=bne;ai.exports.fileSync=xne;ai.exports.tmpName=Wb;ai.exports.tmpNameSync=$b;ai.exports.setGracefulCleanup=One});var TB=y((lce,xB)=>{xB.exports=async function*(e){let r=[];e.on("data",o=>r.push(o));let i,n=new Promise(o=>i=o),s=!1;e.on("end",()=>{s=!0,i()});let a=!1;for(e.on("error",o=>{a=o,i()});!s||r.length>0;)if(r.length===0?(e.resume(),await Promise.race([Ane(e,"data"),n])):(e.pause(),yield r.shift()),a)throw a;i()};function Ane(t,e){return new Promise(r=>{let i=!1,n=()=>{i||(i=!0,t.removeListener(e,n),r())};t.addListener(e,n)})}});var kB=y((uce,SB)=>{var{EventEmitter:Fne}=require("events"),Nne=rl(),Dne=je(),rd=qt(),EB=Me(),qne=Fr(),Ine=du(),CB=pu(),Ub=class extends Fne{constructor({workbook:e,id:r,iterator:i,options:n}){super(),this.workbook=e,this.id=r,this.iterator=i,this.options=n||{},this.name=`Sheet${this.id}`,this._columns=null,this._keys={},this._dimensions=new qne}destroy(){throw new Error("Invalid Operation: destroy")}get dimensions(){return this._dimensions}get columns(){return this._columns}getColumn(e){if(typeof e=="string"){let r=this._keys[e];if(r)return r;e=EB.l2n(e)}if(this._columns||(this._columns=[]),e>this._columns.length){let r=this._columns.length+1;for(;r<=e;)this._columns.push(new CB(this,r++))}return this._columns[e-1]}getColumnKey(e){return this._keys[e]}setColumnKey(e,r){this._keys[e]=r}deleteColumnKey(e){delete this._keys[e]}eachColumnKey(e){Dne.each(this._keys,e)}async read(){try{for await(let e of this.parse())for(let{eventType:r,value:i}of e)this.emit(r,i);this.emit("finished")}catch(e){this.emit("error",e)}}async*[Symbol.asyncIterator](){for await(let e of this.parse())for(let{eventType:r,value:i}of e)r==="row"&&(yield i)}async*parse(){let{iterator:e,options:r}=this,i=!1,n=!1,s=null;switch(r.worksheets){case"emit":i=!0;break;case"prep":break;default:break}switch(r.hyperlinks){case"emit":n=!0;break;case"cache":this.hyperlinks=s={};break;default:break}if(!i&&!n&&!s)return;let{sharedStrings:a,styles:o,properties:u}=this.workbook,f=!1,h=!1,g=!1,m=null,c=null,d=null,v=null;for await(let w of Nne(e)){let b=[];for(let{eventType:C,value:O}of w)if(C==="opentag"){let R=O;if(i)switch(R.name){case"cols":f=!0,m=[];break;case"sheetData":h=!0;break;case"col":f&&m.push({min:parseInt(R.attributes.min,10),max:parseInt(R.attributes.max,10),width:parseFloat(R.attributes.width),styleId:parseInt(R.attributes.style||"0",10)});break;case"row":if(h){let M=parseInt(R.attributes.r,10);if(c=new Ine(this,M),R.attributes.ht&&(c.height=parseFloat(R.attributes.ht)),R.attributes.s){let X=parseInt(R.attributes.s,10),H=o.getStyleModel(X);H&&(c.style=H)}}break;case"c":c&&(d={ref:R.attributes.r,s:parseInt(R.attributes.s,10),t:R.attributes.t});break;case"f":d&&(v=d.f={text:""});break;case"v":d&&(v=d.v={text:""});break;case"mergeCell":break;default:break}if(n||s)switch(R.name){case"hyperlinks":g=!0;break;case"hyperlink":if(g){let M={ref:R.attributes.ref,rId:R.attributes["r:id"]};n?b.push({eventType:"hyperlink",value:M}):s[M.ref]=M}break;default:break}}else if(C==="text")i&&v&&(v.text+=O);else if(C==="closetag"){let R=O;if(i)switch(R.name){case"cols":f=!1,this._columns=CB.fromModel(m);break;case"sheetData":h=!1;break;case"row":this._dimensions.expandRow(c),b.push({eventType:"row",value:c}),c=null;break;case"c":if(c&&d){let M=EB.decodeAddress(d.ref),X=c.getCell(M.col);if(d.s){let H=o.getStyleModel(d.s);H&&(X.style=H)}if(d.f){let H={formula:d.f.text};d.v&&(d.t==="str"?H.result=rd.xmlDecode(d.v.text):H.result=parseFloat(d.v.text)),X.value=H}else if(d.v)switch(d.t){case"s":{let H=parseInt(d.v.text,10);a?X.value=a[H]:X.value={sharedString:H};break}case"str":X.value=rd.xmlDecode(d.v.text);break;case"e":X.value={error:d.v.text};break;case"b":X.value=parseInt(d.v.text,10)!==0;break;default:rd.isDateFmt(X.numFmt)?X.value=rd.excelToDate(parseFloat(d.v.text),u.model&&u.model.date1904):X.value=parseFloat(d.v.text);break}if(s){let H=s[d.ref];H&&(X.text=X.value,X.value=void 0,X.hyperlink=H)}d=null}break;default:break}if(n||s)switch(R.name){case"hyperlinks":g=!1;break;default:break}}b.length>0&&(yield b)}}};SB.exports=Ub});var OB=y((fce,RB)=>{var{EventEmitter:Mne}=require("events"),Pne=rl(),Lne=Zt(),Bne=Ai(),zb=class extends Mne{constructor({workbook:e,id:r,iterator:i,options:n}){super(),this.workbook=e,this.id=r,this.iterator=i,this.options=n}get count(){return this.hyperlinks&&this.hyperlinks.length||0}each(e){return this.hyperlinks.forEach(e)}async read(){let{iterator:e,options:r}=this,i=!1,n=null;switch(r.hyperlinks){case"emit":i=!0;break;case"cache":this.hyperlinks=n={};break;default:break}if(!i&&!n){this.emit("finished");return}try{for await(let s of Pne(e))for(let{eventType:a,value:o}of s)if(a==="opentag"){let u=o;if(u.name==="Relationship"){let f=u.attributes.Id;switch(u.attributes.Type){case Bne.Hyperlink:{let h={type:Lne.RelationshipType.Styles,rId:f,target:u.attributes.Target,targetMode:u.attributes.TargetMode};i?this.emit("hyperlink",h):n[h.rId]=h}break;default:break}}}this.emit("finished")}catch(s){this.emit("error",s)}}};RB.exports=zb});var DB=y((hce,NB)=>{var Xb=require("fs"),{EventEmitter:jne}=require("events"),{PassThrough:Wne,Readable:$ne}=Ko(),Hne=require("stream"),Une=ZL(),FB=bB(),ts=TB(),zne=rl(),AB=zf(),Xne=Gf(),Vne=Vf(),Gne=kB(),Zne=OB();FB.setGracefulCleanup();var id=class extends jne{constructor(e,r={}){super(),this.input=e,this.options={worksheets:"emit",sharedStrings:"cache",hyperlinks:"ignore",styles:"ignore",entries:"ignore",...r},this.styles=new AB,this.styles.init()}_getStream(e){if(e instanceof Hne.Readable||e instanceof $ne)return e;if(typeof e=="string")return Xb.createReadStream(e);throw new Error(`Could not recognise input: ${e}`)}async read(e,r){try{for await(let{eventType:i,value:n}of this.parse(e,r))switch(i){case"shared-strings":this.emit(i,n);break;case"worksheet":this.emit(i,n),await n.read();break;case"hyperlinks":this.emit(i,n);break}this.emit("end"),this.emit("finished")}catch(i){this.emit("error",i)}}async*[Symbol.asyncIterator](){for await(let{eventType:e,value:r}of this.parse())e==="worksheet"&&(yield r)}async*parse(e,r){r&&(this.options=r);let i=this.stream=this._getStream(e||this.input),n=Une.Parse({forceStream:!0});i.pipe(n);let s=[];for await(let a of ts(n)){let o,u;switch(a.path){case"_rels/.rels":break;case"xl/_rels/workbook.xml.rels":await this._parseRels(a);break;case"xl/workbook.xml":await this._parseWorkbook(a);break;case"xl/sharedStrings.xml":yield*this._parseSharedStrings(a);break;case"xl/styles.xml":await this._parseStyles(a);break;default:a.path.match(/xl\/worksheets\/sheet\d+[.]xml/)?(o=a.path.match(/xl\/worksheets\/sheet(\d+)[.]xml/),u=o[1],this.sharedStrings&&this.workbookRels?yield*this._parseWorksheet(ts(a),u):await new Promise((f,h)=>{FB.file((g,m,c,d)=>{if(g)return h(g);s.push({sheetNo:u,path:m,tempFileCleanupCallback:d});let v=Xb.createWriteStream(m);return a.pipe(v),v.on("finish",()=>f())})})):a.path.match(/xl\/worksheets\/_rels\/sheet\d+[.]xml.rels/)&&(o=a.path.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),u=o[1],yield*this._parseHyperlinks(ts(a),u));break}a.autodrain()}for(let{sheetNo:a,path:o,tempFileCleanupCallback:u}of s){let f=Xb.createReadStream(o);f[Symbol.asyncIterator]||(f=f.pipe(new Wne)),yield*this._parseWorksheet(f,a),u()}}_emitEntry(e){this.options.entries==="emit"&&this.emit("entry",e)}async _parseRels(e){let r=new Vne;this.workbookRels=await r.parseStream(ts(e))}async _parseWorkbook(e){this._emitEntry({type:"workbook"});let r=new Xne;await r.parseStream(ts(e)),this.properties=r.map.workbookPr,this.model=r.model}async*_parseSharedStrings(e){switch(this._emitEntry({type:"shared-strings"}),this.options.sharedStrings){case"cache":this.sharedStrings=[];break;case"emit":break;default:return}let r=null,i=[],n=0,s=null;for await(let a of zne(ts(e)))for(let{eventType:o,value:u}of a)if(o==="opentag"){let f=u;switch(f.name){case"b":s=s||{},s.bold=!0;break;case"charset":s=s||{},s.charset=parseInt(f.attributes.charset,10);break;case"color":s=s||{},s.color={},f.attributes.rgb&&(s.color.argb=f.attributes.argb),f.attributes.val&&(s.color.argb=f.attributes.val),f.attributes.theme&&(s.color.theme=f.attributes.theme);break;case"family":s=s||{},s.family=parseInt(f.attributes.val,10);break;case"i":s=s||{},s.italic=!0;break;case"outline":s=s||{},s.outline=!0;break;case"rFont":s=s||{},s.name=f.value;break;case"si":s=null,i=[],r=null;break;case"sz":s=s||{},s.size=parseInt(f.attributes.val,10);break;case"strike":break;case"t":r=null;break;case"u":s=s||{},s.underline=!0;break;case"vertAlign":s=s||{},s.vertAlign=f.attributes.val;break}}else if(o==="text")r=r?r+u:u;else if(o==="closetag")switch(u.name){case"r":i.push({font:s,text:r}),s=null,r=null;break;case"si":this.options.sharedStrings==="cache"?this.sharedStrings.push(i.length?{richText:i}:r):this.options.sharedStrings==="emit"&&(yield{index:n++,text:i.length?{richText:i}:r}),i=[],s=null,r=null;break}}async _parseStyles(e){this._emitEntry({type:"styles"}),this.options.styles==="cache"&&(this.styles=new AB,await this.styles.parseStream(ts(e)))}*_parseWorksheet(e,r){this._emitEntry({type:"worksheet",id:r});let i=new Gne({workbook:this,id:r,iterator:e,options:this.options}),n=(this.workbookRels||[]).find(a=>a.Target===`worksheets/sheet${r}.xml`),s=n&&(this.model.sheets||[]).find(a=>a.rId===n.Id);s&&(i.id=s.id,i.name=s.name,i.state=s.state),this.options.worksheets==="emit"&&(yield{eventType:"worksheet",value:i})}*_parseHyperlinks(e,r){this._emitEntry({type:"hyperlinks",id:r});let i=new Zne({workbook:this,id:r,iterator:e,options:this.options});this.options.hyperlinks==="emit"&&(yield{eventType:"hyperlinks",value:i})}};id.Options={worksheets:["emit","ignore"],sharedStrings:["cache","emit","ignore"],hyperlinks:["cache","emit","ignore"],styles:["cache","ignore"],entries:["emit","ignore"]};NB.exports=id});var MB=y((cce,IB)=>{var qB={Workbook:LD(),ModelContainer:jD(),stream:{xlsx:{WorkbookWriter:nq(),WorkbookReader:DB()}}};Object.assign(qB,Zt());IB.exports=qB});if(parseInt(process.versions.node.split(".")[0],10)<10)throw new Error("For node versions older than 10, please use the ES5 Import: https://github.com/exceljs/exceljs#es5-imports");module.exports=MB();
/*!
 * Tmp
 *
 * Copyright (c) 2011-2017 KARASZI Istvan <github@spam.raszi.hu>
 *
 * MIT Licensed
 */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Character class utilities for XML NS 1.0 edition 3.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */
/**
 * Character classes and associated utilities for the 2nd edition of XML 1.1.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */
/**
 * Character classes and associated utilities for the 5th edition of XML 1.0.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */
