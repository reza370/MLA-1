import{L as tr,n as Vt,i as Ki,a as qi}from"./vueConfig-a3f6b6fb.js";import{_ as ir}from"./switch-0040a7d5.js";import{_ as sr,a as ut}from"./option-516a088f.js";import{D as rr}from"./DatabaseType-a91c3df0.js";import"./focus-34de79c8.js";import"./scrollbar-8b140c0c.js";import"./index-3fc21955.js";var Vi={exports:{}};(function(Se,$){(function(ie,de){Se.exports=de()})(self,()=>(()=>{var ie={4567:function(K,c,w){var m=this&&this.__decorate||function(s,l,f,_){var C,p=arguments.length,y=p<3?l:_===null?_=Object.getOwnPropertyDescriptor(l,f):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(s,l,f,_);else for(var L=s.length-1;L>=0;L--)(C=s[L])&&(y=(p<3?C(y):p>3?C(l,f,y):C(l,f))||y);return p>3&&y&&Object.defineProperty(l,f,y),y},g=this&&this.__param||function(s,l){return function(f,_){l(f,_,s)}};Object.defineProperty(c,"__esModule",{value:!0}),c.AccessibilityManager=void 0;const d=w(9042),u=w(6114),b=w(9924),v=w(844),a=w(5596),i=w(4725),h=w(3656);let r=class extends v.Disposable{constructor(s,l){super(),this._terminal=s,this._renderService=l,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let f=0;f<this._terminal.rows;f++)this._rowElements[f]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[f]);if(this._topBoundaryFocusListener=f=>this._handleBoundaryFocus(f,0),this._bottomBoundaryFocusListener=f=>this._handleBoundaryFocus(f,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new b.TimeBasedDebouncer(this._announceCharacters.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._liveRegionDebouncer),this.register(this._terminal.onResize(f=>this._handleResize(f.rows))),this.register(this._terminal.onRender(f=>this._refreshRows(f.start,f.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(f=>this._handleChar(f))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(f=>this._handleTab(f))),this.register(this._terminal.onKey(f=>this._handleKey(f.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new a.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,h.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,v.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(s){for(let l=0;l<s;l++)this._handleChar(" ")}_handleChar(s){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==s&&(this._charsToAnnounce+=s):this._charsToAnnounce+=s,s===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=d.tooMuchOutput)),u.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,u.isMac&&this._liveRegion.remove()}_handleKey(s){this._clearLiveRegion(),/\p{Control}/u.test(s)||this._charsToConsume.push(s)}_refreshRows(s,l){this._liveRegionDebouncer.refresh(s,l,this._terminal.rows)}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(s,l){const f=s.target,_=this._rowElements[l===0?1:this._rowElements.length-2];if(f.getAttribute("aria-posinset")===(l===0?"1":`${this._terminal.buffer.lines.length}`)||s.relatedTarget!==_)return;let C,p;if(l===0?(C=f,p=this._rowElements.pop(),this._rowContainer.removeChild(p)):(C=this._rowElements.shift(),p=f,this._rowContainer.removeChild(C)),C.removeEventListener("focus",this._topBoundaryFocusListener),p.removeEventListener("focus",this._bottomBoundaryFocusListener),l===0){const y=this._createAccessibilityTreeNode();this._rowElements.unshift(y),this._rowContainer.insertAdjacentElement("afterbegin",y)}else{const y=this._createAccessibilityTreeNode();this._rowElements.push(y),this._rowContainer.appendChild(y)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(l===0?-1:1),this._rowElements[l===0?1:this._rowElements.length-2].focus(),s.preventDefault(),s.stopImmediatePropagation()}_handleResize(s){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let l=this._rowContainer.children.length;l<this._terminal.rows;l++)this._rowElements[l]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[l]);for(;this._rowElements.length>s;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const s=document.createElement("div");return s.setAttribute("role","listitem"),s.tabIndex=-1,this._refreshRowDimensions(s),s}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let s=0;s<this._terminal.rows;s++)this._refreshRowDimensions(this._rowElements[s])}}_refreshRowDimensions(s){s.style.height=`${this._renderService.dimensions.css.cell.height}px`}};r=m([g(1,i.IRenderService)],r),c.AccessibilityManager=r},3614:(K,c)=>{function w(u){return u.replace(/\r?\n/g,"\r")}function m(u,b){return b?"\x1B[200~"+u+"\x1B[201~":u}function g(u,b,v){u=m(u=w(u),v.decPrivateModes.bracketedPasteMode),v.triggerDataEvent(u,!0),b.value=""}function d(u,b,v){const a=v.getBoundingClientRect(),i=u.clientX-a.left-10,h=u.clientY-a.top-10;b.style.width="20px",b.style.height="20px",b.style.left=`${i}px`,b.style.top=`${h}px`,b.style.zIndex="1000",b.focus()}Object.defineProperty(c,"__esModule",{value:!0}),c.rightClickHandler=c.moveTextAreaUnderMouseCursor=c.paste=c.handlePasteEvent=c.copyHandler=c.bracketTextForPaste=c.prepareTextForTerminal=void 0,c.prepareTextForTerminal=w,c.bracketTextForPaste=m,c.copyHandler=function(u,b){u.clipboardData&&u.clipboardData.setData("text/plain",b.selectionText),u.preventDefault()},c.handlePasteEvent=function(u,b,v){u.stopPropagation(),u.clipboardData&&g(u.clipboardData.getData("text/plain"),b,v)},c.paste=g,c.moveTextAreaUnderMouseCursor=d,c.rightClickHandler=function(u,b,v,a,i){d(u,b,v),i&&a.rightClickSelect(u),b.value=a.selectionText,b.select()}},7239:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorContrastCache=void 0;const m=w(1505);c.ColorContrastCache=class{constructor(){this._color=new m.TwoKeyMap,this._css=new m.TwoKeyMap}setCss(g,d,u){this._css.set(g,d,u)}getCss(g,d){return this._css.get(g,d)}setColor(g,d,u){this._color.set(g,d,u)}getColor(g,d){return this._color.get(g,d)}clear(){this._color.clear(),this._css.clear()}}},3656:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.addDisposableDomListener=void 0,c.addDisposableDomListener=function(w,m,g,d){w.addEventListener(m,g,d);let u=!1;return{dispose:()=>{u||(u=!0,w.removeEventListener(m,g,d))}}}},6465:function(K,c,w){var m=this&&this.__decorate||function(i,h,r,s){var l,f=arguments.length,_=f<3?h:s===null?s=Object.getOwnPropertyDescriptor(h,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(i,h,r,s);else for(var C=i.length-1;C>=0;C--)(l=i[C])&&(_=(f<3?l(_):f>3?l(h,r,_):l(h,r))||_);return f>3&&_&&Object.defineProperty(h,r,_),_},g=this&&this.__param||function(i,h){return function(r,s){h(r,s,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Linkifier2=void 0;const d=w(2585),u=w(8460),b=w(844),v=w(3656);let a=class extends b.Disposable{constructor(i){super(),this._bufferService=i,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new u.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new u.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,b.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,b.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}get currentLink(){return this._currentLink}registerLinkProvider(i){return this._linkProviders.push(i),{dispose:()=>{const h=this._linkProviders.indexOf(i);h!==-1&&this._linkProviders.splice(h,1)}}}attachToDom(i,h,r){this._element=i,this._mouseService=h,this._renderService=r,this.register((0,v.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,v.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,v.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,v.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(i){if(this._lastMouseEvent=i,!this._element||!this._mouseService)return;const h=this._positionFromMouseEvent(i,this._element,this._mouseService);if(!h)return;this._isMouseOut=!1;const r=i.composedPath();for(let s=0;s<r.length;s++){const l=r[s];if(l.classList.contains("xterm"))break;if(l.classList.contains("xterm-hover"))return}this._lastBufferCell&&h.x===this._lastBufferCell.x&&h.y===this._lastBufferCell.y||(this._handleHover(h),this._lastBufferCell=h)}_handleHover(i){if(this._activeLine!==i.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(i,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,i)||(this._clearCurrentLink(),this._askForLink(i,!0))}_askForLink(i,h){var r,s;this._activeProviderReplies&&h||((r=this._activeProviderReplies)===null||r===void 0||r.forEach(f=>{f==null||f.forEach(_=>{_.link.dispose&&_.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=i.y);let l=!1;for(const[f,_]of this._linkProviders.entries())h?!((s=this._activeProviderReplies)===null||s===void 0)&&s.get(f)&&(l=this._checkLinkProviderResult(f,i,l)):_.provideLinks(i.y,C=>{var p,y;if(this._isMouseOut)return;const L=C==null?void 0:C.map(T=>({link:T}));(p=this._activeProviderReplies)===null||p===void 0||p.set(f,L),l=this._checkLinkProviderResult(f,i,l),((y=this._activeProviderReplies)===null||y===void 0?void 0:y.size)===this._linkProviders.length&&this._removeIntersectingLinks(i.y,this._activeProviderReplies)})}_removeIntersectingLinks(i,h){const r=new Set;for(let s=0;s<h.size;s++){const l=h.get(s);if(l)for(let f=0;f<l.length;f++){const _=l[f],C=_.link.range.start.y<i?0:_.link.range.start.x,p=_.link.range.end.y>i?this._bufferService.cols:_.link.range.end.x;for(let y=C;y<=p;y++){if(r.has(y)){l.splice(f--,1);break}r.add(y)}}}}_checkLinkProviderResult(i,h,r){var s;if(!this._activeProviderReplies)return r;const l=this._activeProviderReplies.get(i);let f=!1;for(let _=0;_<i;_++)this._activeProviderReplies.has(_)&&!this._activeProviderReplies.get(_)||(f=!0);if(!f&&l){const _=l.find(C=>this._linkAtPosition(C.link,h));_&&(r=!0,this._handleNewLink(_))}if(this._activeProviderReplies.size===this._linkProviders.length&&!r)for(let _=0;_<this._activeProviderReplies.size;_++){const C=(s=this._activeProviderReplies.get(_))===null||s===void 0?void 0:s.find(p=>this._linkAtPosition(p.link,h));if(C){r=!0,this._handleNewLink(C);break}}return r}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(i){if(!this._element||!this._mouseService||!this._currentLink)return;const h=this._positionFromMouseEvent(i,this._element,this._mouseService);h&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,h)&&this._currentLink.link.activate(i,this._currentLink.link.text)}_clearCurrentLink(i,h){this._element&&this._currentLink&&this._lastMouseEvent&&(!i||!h||this._currentLink.link.range.start.y>=i&&this._currentLink.link.range.end.y<=h)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,b.disposeArray)(this._linkCacheDisposables))}_handleNewLink(i){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const h=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);h&&this._linkAtPosition(i.link,h)&&(this._currentLink=i,this._currentLink.state={decorations:{underline:i.link.decorations===void 0||i.link.decorations.underline,pointerCursor:i.link.decorations===void 0||i.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,i.link,this._lastMouseEvent),i.link.decorations={},Object.defineProperties(i.link.decorations,{pointerCursor:{get:()=>{var r,s;return(s=(r=this._currentLink)===null||r===void 0?void 0:r.state)===null||s===void 0?void 0:s.decorations.pointerCursor},set:r=>{var s,l;!((s=this._currentLink)===null||s===void 0)&&s.state&&this._currentLink.state.decorations.pointerCursor!==r&&(this._currentLink.state.decorations.pointerCursor=r,this._currentLink.state.isHovered&&((l=this._element)===null||l===void 0||l.classList.toggle("xterm-cursor-pointer",r)))}},underline:{get:()=>{var r,s;return(s=(r=this._currentLink)===null||r===void 0?void 0:r.state)===null||s===void 0?void 0:s.decorations.underline},set:r=>{var s,l,f;!((s=this._currentLink)===null||s===void 0)&&s.state&&((f=(l=this._currentLink)===null||l===void 0?void 0:l.state)===null||f===void 0?void 0:f.decorations.underline)!==r&&(this._currentLink.state.decorations.underline=r,this._currentLink.state.isHovered&&this._fireUnderlineEvent(i.link,r))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(r=>{if(!this._currentLink)return;const s=r.start===0?0:r.start+1+this._bufferService.buffer.ydisp,l=this._bufferService.buffer.ydisp+1+r.end;if(this._currentLink.link.range.start.y>=s&&this._currentLink.link.range.end.y<=l&&(this._clearCurrentLink(s,l),this._lastMouseEvent&&this._element)){const f=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);f&&this._askForLink(f,!1)}})))}_linkHover(i,h,r){var s;!((s=this._currentLink)===null||s===void 0)&&s.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!0),this._currentLink.state.decorations.pointerCursor&&i.classList.add("xterm-cursor-pointer")),h.hover&&h.hover(r,h.text)}_fireUnderlineEvent(i,h){const r=i.range,s=this._bufferService.buffer.ydisp,l=this._createLinkUnderlineEvent(r.start.x-1,r.start.y-s-1,r.end.x,r.end.y-s-1,void 0);(h?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(l)}_linkLeave(i,h,r){var s;!((s=this._currentLink)===null||s===void 0)&&s.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!1),this._currentLink.state.decorations.pointerCursor&&i.classList.remove("xterm-cursor-pointer")),h.leave&&h.leave(r,h.text)}_linkAtPosition(i,h){const r=i.range.start.y*this._bufferService.cols+i.range.start.x,s=i.range.end.y*this._bufferService.cols+i.range.end.x,l=h.y*this._bufferService.cols+h.x;return r<=l&&l<=s}_positionFromMouseEvent(i,h,r){const s=r.getCoords(i,h,this._bufferService.cols,this._bufferService.rows);if(s)return{x:s[0],y:s[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(i,h,r,s,l){return{x1:i,y1:h,x2:r,y2:s,cols:this._bufferService.cols,fg:l}}};a=m([g(0,d.IBufferService)],a),c.Linkifier2=a},9042:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tooMuchOutput=c.promptLabel=void 0,c.promptLabel="Terminal input",c.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(K,c,w){var m=this&&this.__decorate||function(a,i,h,r){var s,l=arguments.length,f=l<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,h):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(a,i,h,r);else for(var _=a.length-1;_>=0;_--)(s=a[_])&&(f=(l<3?s(f):l>3?s(i,h,f):s(i,h))||f);return l>3&&f&&Object.defineProperty(i,h,f),f},g=this&&this.__param||function(a,i){return function(h,r){i(h,r,a)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkProvider=void 0;const d=w(511),u=w(2585);let b=class{constructor(a,i,h){this._bufferService=a,this._optionsService=i,this._oscLinkService=h}provideLinks(a,i){var h;const r=this._bufferService.buffer.lines.get(a-1);if(!r)return void i(void 0);const s=[],l=this._optionsService.rawOptions.linkHandler,f=new d.CellData,_=r.getTrimmedLength();let C=-1,p=-1,y=!1;for(let L=0;L<_;L++)if(p!==-1||r.hasContent(L)){if(r.loadCell(L,f),f.hasExtendedAttrs()&&f.extended.urlId){if(p===-1){p=L,C=f.extended.urlId;continue}y=f.extended.urlId!==C}else p!==-1&&(y=!0);if(y||p!==-1&&L===_-1){const T=(h=this._oscLinkService.getLinkData(C))===null||h===void 0?void 0:h.uri;if(T){const D={start:{x:p+1,y:a},end:{x:L+(y||L!==_-1?0:1),y:a}};let B=!1;if(!(l!=null&&l.allowNonHttpProtocols))try{const H=new URL(T);["http:","https:"].includes(H.protocol)||(B=!0)}catch{B=!0}B||s.push({text:T,range:D,activate:(H,A)=>l?l.activate(H,A,D):v(0,A),hover:(H,A)=>{var F;return(F=l==null?void 0:l.hover)===null||F===void 0?void 0:F.call(l,H,A,D)},leave:(H,A)=>{var F;return(F=l==null?void 0:l.leave)===null||F===void 0?void 0:F.call(l,H,A,D)}})}y=!1,f.hasExtendedAttrs()&&f.extended.urlId?(p=L,C=f.extended.urlId):(p=-1,C=-1)}}i(s)}};function v(a,i){if(confirm(`Do you want to navigate to ${i}?

WARNING: This link could potentially be dangerous`)){const h=window.open();if(h){try{h.opener=null}catch{}h.location.href=i}else console.warn("Opening link blocked as opener could not be cleared")}}b=m([g(0,u.IBufferService),g(1,u.IOptionsService),g(2,u.IOscLinkService)],b),c.OscLinkProvider=b},6193:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.RenderDebouncer=void 0,c.RenderDebouncer=class{constructor(w,m){this._parentWindow=w,this._renderCallback=m,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(w){return this._refreshCallbacks.push(w),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(w,m,g){this._rowCount=g,w=w!==void 0?w:0,m=m!==void 0?m:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,w):w,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,m):m,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const w=Math.max(this._rowStart,0),m=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(w,m),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const w of this._refreshCallbacks)w(0);this._refreshCallbacks=[]}}},5596:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ScreenDprMonitor=void 0;const m=w(844);class g extends m.Disposable{constructor(u){super(),this._parentWindow=u,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,m.toDisposable)(()=>{this.clearListener()}))}setListener(u){this._listener&&this.clearListener(),this._listener=u,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var u;this._outerListener&&((u=this._resolutionMediaMatchList)===null||u===void 0||u.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}c.ScreenDprMonitor=g},3236:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Terminal=void 0;const m=w(2950),g=w(1680),d=w(3614),u=w(2584),b=w(5435),v=w(9312),a=w(6114),i=w(3656),h=w(9042),r=w(4567),s=w(1296),l=w(7399),f=w(8460),_=w(8437),C=w(3230),p=w(4725),y=w(428),L=w(8934),T=w(6465),D=w(5114),B=w(8969),H=w(8055),A=w(4269),F=w(5941),k=w(3107),O=w(5744),I=w(9074),P=w(2585),V=w(3730),te=w(844),he=w(6731),J=typeof window<"u"?window.document:null;class le extends B.CoreTerminal{constructor(z={}){super(z),this.browser=a,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new f.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new f.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new f.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new f.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new f.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new f.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new f.EventEmitter),this._onBlur=this.register(new f.EventEmitter),this._onA11yCharEmitter=this.register(new f.EventEmitter),this._onA11yTabEmitter=this.register(new f.EventEmitter),this._onWillOpen=this.register(new f.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(T.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(V.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(I.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((W,Z)=>this.refresh(W,Z))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(W=>this._reportWindowsOptions(W))),this.register(this._inputHandler.onColor(W=>this._handleColorEvent(W))),this.register((0,f.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,f.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,f.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,f.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(W=>this._afterResize(W.cols,W.rows))),this.register((0,te.toDisposable)(()=>{var W,Z;this._customKeyEventHandler=void 0,(Z=(W=this.element)===null||W===void 0?void 0:W.parentNode)===null||Z===void 0||Z.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(z){if(this._themeService)for(const W of z){let Z,ne="";switch(W.index){case 256:Z="foreground",ne="10";break;case 257:Z="background",ne="11";break;case 258:Z="cursor",ne="12";break;default:Z="ansi",ne="4;"+W.index}switch(W.type){case 0:const we=H.color.toColorRGB(Z==="ansi"?this._themeService.colors.ansi[W.index]:this._themeService.colors[Z]);this.coreService.triggerDataEvent(`${u.C0.ESC}]${ne};${(0,F.toRgbString)(we)}${u.C1_ESCAPED.ST}`);break;case 1:if(Z==="ansi")this._themeService.modifyColors(se=>se.ansi[W.index]=H.rgba.toColor(...W.color));else{const se=Z;this._themeService.modifyColors(Me=>Me[se]=H.rgba.toColor(...W.color))}break;case 2:this._themeService.restoreColor(W.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(z){var W;z?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=this._instantiationService.createInstance(r.AccessibilityManager,this)):((W=this._accessibilityManager)===null||W===void 0||W.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(z){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(u.C0.ESC+"[I"),this.updateCursorStyle(z),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var z;return(z=this.textarea)===null||z===void 0?void 0:z.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(u.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const z=this.buffer.ybase+this.buffer.y,W=this.buffer.lines.get(z);if(!W)return;const Z=Math.min(this.buffer.x,this.cols-1),ne=this._renderService.dimensions.css.cell.height,we=W.getWidth(Z),se=this._renderService.dimensions.css.cell.width*we,Me=this.buffer.y*this._renderService.dimensions.css.cell.height,X=Z*this._renderService.dimensions.css.cell.width;this.textarea.style.left=X+"px",this.textarea.style.top=Me+"px",this.textarea.style.width=se+"px",this.textarea.style.height=ne+"px",this.textarea.style.lineHeight=ne+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,i.addDisposableDomListener)(this.element,"copy",W=>{this.hasSelection()&&(0,d.copyHandler)(W,this._selectionService)}));const z=W=>(0,d.handlePasteEvent)(W,this.textarea,this.coreService);this.register((0,i.addDisposableDomListener)(this.textarea,"paste",z)),this.register((0,i.addDisposableDomListener)(this.element,"paste",z)),a.isFirefox?this.register((0,i.addDisposableDomListener)(this.element,"mousedown",W=>{W.button===2&&(0,d.rightClickHandler)(W,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,i.addDisposableDomListener)(this.element,"contextmenu",W=>{(0,d.rightClickHandler)(W,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),a.isLinux&&this.register((0,i.addDisposableDomListener)(this.element,"auxclick",W=>{W.button===1&&(0,d.moveTextAreaUnderMouseCursor)(W,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,i.addDisposableDomListener)(this.textarea,"keyup",z=>this._keyUp(z),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"keydown",z=>this._keyDown(z),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"keypress",z=>this._keyPress(z),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionupdate",z=>this._compositionHelper.compositionupdate(z))),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,i.addDisposableDomListener)(this.textarea,"input",z=>this._inputEvent(z),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(z){var W;if(!z)throw new Error("Terminal requires a parent element.");z.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=z.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),z.appendChild(this.element);const Z=J.createDocumentFragment();this._viewportElement=J.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),Z.appendChild(this._viewportElement),this._viewportScrollArea=J.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=J.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=J.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),Z.appendChild(this.screenElement),this.textarea=J.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",h.promptLabel),a.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(D.CoreBrowserService,this.textarea,(W=this._document.defaultView)!==null&&W!==void 0?W:window),this._instantiationService.setService(p.ICoreBrowserService,this._coreBrowserService),this.register((0,i.addDisposableDomListener)(this.textarea,"focus",ne=>this._handleTextAreaFocus(ne))),this.register((0,i.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(y.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(p.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(he.ThemeService),this._instantiationService.setService(p.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(A.CharacterJoinerService),this._instantiationService.setService(p.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(C.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(p.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(ne=>this._onRender.fire(ne))),this.onResize(ne=>this._renderService.resize(ne.cols,ne.rows)),this._compositionView=J.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(m.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(Z);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(L.MouseService),this._instantiationService.setService(p.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(g.Viewport,ne=>this.scrollLines(ne,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(p.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(ne=>this.scrollLines(ne.amount,ne.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(ne=>this._renderService.handleSelectionChanged(ne.start,ne.end,ne.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(ne=>{this.textarea.value=ne,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(ne=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,i.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(k.BufferDecorationRenderer,this.screenElement)),this.register((0,i.addDisposableDomListener)(this.element,"mousedown",ne=>this._selectionService.handleMouseDown(ne))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=this._instantiationService.createInstance(r.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",ne=>this._handleScreenReaderModeOptionChange(ne))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(O.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",ne=>{!this._overviewRulerRenderer&&ne&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(O.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(s.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const z=this,W=this.element;function Z(se){const Me=z._mouseService.getMouseReportCoords(se,z.screenElement);if(!Me)return!1;let X,ke;switch(se.overrideType||se.type){case"mousemove":ke=32,se.buttons===void 0?(X=3,se.button!==void 0&&(X=se.button<3?se.button:3)):X=1&se.buttons?0:4&se.buttons?1:2&se.buttons?2:3;break;case"mouseup":ke=0,X=se.button<3?se.button:3;break;case"mousedown":ke=1,X=se.button<3?se.button:3;break;case"wheel":if(z.viewport.getLinesScrolled(se)===0)return!1;ke=se.deltaY<0?0:1,X=4;break;default:return!1}return!(ke===void 0||X===void 0||X>4)&&z.coreMouseService.triggerMouseEvent({col:Me.col,row:Me.row,x:Me.x,y:Me.y,button:X,action:ke,ctrl:se.ctrlKey,alt:se.altKey,shift:se.shiftKey})}const ne={mouseup:null,wheel:null,mousedrag:null,mousemove:null},we={mouseup:se=>(Z(se),se.buttons||(this._document.removeEventListener("mouseup",ne.mouseup),ne.mousedrag&&this._document.removeEventListener("mousemove",ne.mousedrag)),this.cancel(se)),wheel:se=>(Z(se),this.cancel(se,!0)),mousedrag:se=>{se.buttons&&Z(se)},mousemove:se=>{se.buttons||Z(se)}};this.register(this.coreMouseService.onProtocolChange(se=>{se?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(se)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&se?ne.mousemove||(W.addEventListener("mousemove",we.mousemove),ne.mousemove=we.mousemove):(W.removeEventListener("mousemove",ne.mousemove),ne.mousemove=null),16&se?ne.wheel||(W.addEventListener("wheel",we.wheel,{passive:!1}),ne.wheel=we.wheel):(W.removeEventListener("wheel",ne.wheel),ne.wheel=null),2&se?ne.mouseup||(ne.mouseup=we.mouseup):(this._document.removeEventListener("mouseup",ne.mouseup),ne.mouseup=null),4&se?ne.mousedrag||(ne.mousedrag=we.mousedrag):(this._document.removeEventListener("mousemove",ne.mousedrag),ne.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,i.addDisposableDomListener)(W,"mousedown",se=>{if(se.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(se))return Z(se),ne.mouseup&&this._document.addEventListener("mouseup",ne.mouseup),ne.mousedrag&&this._document.addEventListener("mousemove",ne.mousedrag),this.cancel(se)})),this.register((0,i.addDisposableDomListener)(W,"wheel",se=>{if(!ne.wheel){if(!this.buffer.hasScrollback){const Me=this.viewport.getLinesScrolled(se);if(Me===0)return;const X=u.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(se.deltaY<0?"A":"B");let ke="";for(let ae=0;ae<Math.abs(Me);ae++)ke+=X;return this.coreService.triggerDataEvent(ke,!0),this.cancel(se,!0)}return this.viewport.handleWheel(se)?this.cancel(se):void 0}},{passive:!1})),this.register((0,i.addDisposableDomListener)(W,"touchstart",se=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(se),this.cancel(se)},{passive:!0})),this.register((0,i.addDisposableDomListener)(W,"touchmove",se=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(se)?void 0:this.cancel(se)},{passive:!1}))}refresh(z,W){var Z;(Z=this._renderService)===null||Z===void 0||Z.refreshRows(z,W)}updateCursorStyle(z){var W;!((W=this._selectionService)===null||W===void 0)&&W.shouldColumnSelect(z)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(z,W,Z=0){super.scrollLines(z,W,Z),this.refresh(0,this.rows-1)}paste(z){(0,d.paste)(z,this.textarea,this.coreService)}attachCustomKeyEventHandler(z){this._customKeyEventHandler=z}registerLinkProvider(z){return this.linkifier2.registerLinkProvider(z)}registerCharacterJoiner(z){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const W=this._characterJoinerService.register(z);return this.refresh(0,this.rows-1),W}deregisterCharacterJoiner(z){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(z)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(z){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+z)}registerDecoration(z){return this._decorationService.registerDecoration(z)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(z,W,Z){this._selectionService.setSelection(z,W,Z)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var z;(z=this._selectionService)===null||z===void 0||z.clearSelection()}selectAll(){var z;(z=this._selectionService)===null||z===void 0||z.selectAll()}selectLines(z,W){var Z;(Z=this._selectionService)===null||Z===void 0||Z.selectLines(z,W)}_keyDown(z){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1)return!1;const W=this.browser.isMac&&this.options.macOptionIsMeta&&z.altKey;if(!W&&!this._compositionHelper.keydown(z))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;W||z.key!=="Dead"&&z.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const Z=(0,l.evaluateKeyboardEvent)(z,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(z),Z.type===3||Z.type===2){const ne=this.rows-1;return this.scrollLines(Z.type===2?-ne:ne),this.cancel(z,!0)}return Z.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,z)||(Z.cancel&&this.cancel(z,!0),!Z.key||!!(z.key&&!z.ctrlKey&&!z.altKey&&!z.metaKey&&z.key.length===1&&z.key.charCodeAt(0)>=65&&z.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(Z.key!==u.C0.ETX&&Z.key!==u.C0.CR||(this.textarea.value=""),this._onKey.fire({key:Z.key,domEvent:z}),this._showCursor(),this.coreService.triggerDataEvent(Z.key,!0),!this.optionsService.rawOptions.screenReaderMode||z.altKey||z.ctrlKey?this.cancel(z,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(z,W){const Z=z.isMac&&!this.options.macOptionIsMeta&&W.altKey&&!W.ctrlKey&&!W.metaKey||z.isWindows&&W.altKey&&W.ctrlKey&&!W.metaKey||z.isWindows&&W.getModifierState("AltGraph");return W.type==="keypress"?Z:Z&&(!W.keyCode||W.keyCode>47)}_keyUp(z){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1||(function(W){return W.keyCode===16||W.keyCode===17||W.keyCode===18}(z)||this.focus(),this.updateCursorStyle(z),this._keyPressHandled=!1)}_keyPress(z){let W;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1)return!1;if(this.cancel(z),z.charCode)W=z.charCode;else if(z.which===null||z.which===void 0)W=z.keyCode;else{if(z.which===0||z.charCode===0)return!1;W=z.which}return!(!W||(z.altKey||z.ctrlKey||z.metaKey)&&!this._isThirdLevelShift(this.browser,z)||(W=String.fromCharCode(W),this._onKey.fire({key:W,domEvent:z}),this._showCursor(),this.coreService.triggerDataEvent(W,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(z){if(z.data&&z.inputType==="insertText"&&(!z.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const W=z.data;return this.coreService.triggerDataEvent(W,!0),this.cancel(z),!0}return!1}resize(z,W){z!==this.cols||W!==this.rows?super.resize(z,W):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(z,W){var Z,ne;(Z=this._charSizeService)===null||Z===void 0||Z.measure(),(ne=this.viewport)===null||ne===void 0||ne.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let z=1;z<this.rows;z++)this.buffer.lines.push(this.buffer.getBlankLine(_.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var z,W;this.options.rows=this.rows,this.options.cols=this.cols;const Z=this._customKeyEventHandler;this._setup(),super.reset(),(z=this._selectionService)===null||z===void 0||z.reset(),this._decorationService.reset(),this._customKeyEventHandler=Z,this.refresh(0,this.rows-1),(W=this.viewport)===null||W===void 0||W.syncScrollArea()}clearTextureAtlas(){var z;(z=this._renderService)===null||z===void 0||z.clearTextureAtlas()}_reportFocus(){var z;!((z=this.element)===null||z===void 0)&&z.classList.contains("focus")?this.coreService.triggerDataEvent(u.C0.ESC+"[I"):this.coreService.triggerDataEvent(u.C0.ESC+"[O")}_reportWindowsOptions(z){if(this._renderService)switch(z){case b.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const W=this._renderService.dimensions.css.canvas.width.toFixed(0),Z=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${u.C0.ESC}[4;${Z};${W}t`);break;case b.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const ne=this._renderService.dimensions.css.cell.width.toFixed(0),we=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${u.C0.ESC}[6;${we};${ne}t`)}}cancel(z,W){if(this.options.cancelEvents||W)return z.preventDefault(),z.stopPropagation(),!1}}c.Terminal=le},9924:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TimeBasedDebouncer=void 0,c.TimeBasedDebouncer=class{constructor(w,m=1e3){this._renderCallback=w,this._debounceThresholdMS=m,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(w,m,g){this._rowCount=g,w=w!==void 0?w:0,m=m!==void 0?m:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,w):w,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,m):m;const d=Date.now();if(d-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=d,this._innerRefresh();else if(!this._additionalRefreshRequested){const u=d-this._lastRefreshMs,b=this._debounceThresholdMS-u;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},b)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const w=Math.max(this._rowStart,0),m=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(w,m)}}},1680:function(K,c,w){var m=this&&this.__decorate||function(i,h,r,s){var l,f=arguments.length,_=f<3?h:s===null?s=Object.getOwnPropertyDescriptor(h,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(i,h,r,s);else for(var C=i.length-1;C>=0;C--)(l=i[C])&&(_=(f<3?l(_):f>3?l(h,r,_):l(h,r))||_);return f>3&&_&&Object.defineProperty(h,r,_),_},g=this&&this.__param||function(i,h){return function(r,s){h(r,s,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Viewport=void 0;const d=w(844),u=w(3656),b=w(4725),v=w(2585);let a=class extends d.Disposable{constructor(i,h,r,s,l,f,_,C,p){super(),this._scrollLines=i,this._viewportElement=h,this._scrollArea=r,this._bufferService=s,this._optionsService=l,this._charSizeService=f,this._renderService=_,this._coreBrowserService=C,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,u.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(y=>this._activeBuffer=y.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(y=>this._renderDimensions=y)),this._handleThemeChange(p.colors),this.register(p.onChangeColors(y=>this._handleThemeChange(y))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(i){this._viewportElement.style.backgroundColor=i.background.css}_refresh(i){if(i)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const h=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==h&&(this._lastRecordedBufferHeight=h,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const i=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==i&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=i),this._refreshAnimationFrame=null}syncScrollArea(i=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(i);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(i)}_handleScroll(i){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const h=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(h)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const i=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(i*(this._smoothScrollState.target-this._smoothScrollState.origin)),i<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(i,h){const r=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(h<0&&this._viewportElement.scrollTop!==0||h>0&&r<this._lastRecordedBufferHeight)||(i.cancelable&&i.preventDefault(),!1)}handleWheel(i){const h=this._getPixelsScrolled(i);return h!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+h:this._smoothScrollState.target+=h,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=h,this._bubbleScroll(i,h))}_getPixelsScrolled(i){if(i.deltaY===0||i.shiftKey)return 0;let h=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_LINE?h*=this._currentRowHeight:i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._currentRowHeight*this._bufferService.rows),h}getBufferElements(i,h){var r;let s,l="";const f=[],_=h??this._bufferService.buffer.lines.length,C=this._bufferService.buffer.lines;for(let p=i;p<_;p++){const y=C.get(p);if(!y)continue;const L=(r=C.get(p+1))===null||r===void 0?void 0:r.isWrapped;if(l+=y.translateToString(!L),!L||p===C.length-1){const T=document.createElement("div");T.textContent=l,f.push(T),l.length>0&&(s=T),l=""}}return{bufferElements:f,cursorElement:s}}getLinesScrolled(i){if(i.deltaY===0||i.shiftKey)return 0;let h=this._applyScrollModifier(i.deltaY,i);return i.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(h/=this._currentRowHeight+0,this._wheelPartialScroll+=h,h=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):i.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._bufferService.rows),h}_applyScrollModifier(i,h){const r=this._optionsService.rawOptions.fastScrollModifier;return r==="alt"&&h.altKey||r==="ctrl"&&h.ctrlKey||r==="shift"&&h.shiftKey?i*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:i*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(i){this._lastTouchY=i.touches[0].pageY}handleTouchMove(i){const h=this._lastTouchY-i.touches[0].pageY;return this._lastTouchY=i.touches[0].pageY,h!==0&&(this._viewportElement.scrollTop+=h,this._bubbleScroll(i,h))}};a=m([g(3,v.IBufferService),g(4,v.IOptionsService),g(5,b.ICharSizeService),g(6,b.IRenderService),g(7,b.ICoreBrowserService),g(8,b.IThemeService)],a),c.Viewport=a},3107:function(K,c,w){var m=this&&this.__decorate||function(i,h,r,s){var l,f=arguments.length,_=f<3?h:s===null?s=Object.getOwnPropertyDescriptor(h,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(i,h,r,s);else for(var C=i.length-1;C>=0;C--)(l=i[C])&&(_=(f<3?l(_):f>3?l(h,r,_):l(h,r))||_);return f>3&&_&&Object.defineProperty(h,r,_),_},g=this&&this.__param||function(i,h){return function(r,s){h(r,s,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferDecorationRenderer=void 0;const d=w(3656),u=w(4725),b=w(844),v=w(2585);let a=class extends b.Disposable{constructor(i,h,r,s){super(),this._screenElement=i,this._bufferService=h,this._decorationService=r,this._renderService=s,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,d.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(l=>this._removeDecoration(l))),this.register((0,b.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const i of this._decorationService.decorations)this._renderDecoration(i);this._dimensionsChanged=!1}_renderDecoration(i){this._refreshStyle(i),this._dimensionsChanged&&this._refreshXPosition(i)}_createElement(i){var h,r;const s=document.createElement("div");s.classList.add("xterm-decoration"),s.classList.toggle("xterm-decoration-top-layer",((h=i==null?void 0:i.options)===null||h===void 0?void 0:h.layer)==="top"),s.style.width=`${Math.round((i.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,s.style.height=(i.options.height||1)*this._renderService.dimensions.css.cell.height+"px",s.style.top=(i.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",s.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const l=(r=i.options.x)!==null&&r!==void 0?r:0;return l&&l>this._bufferService.cols&&(s.style.display="none"),this._refreshXPosition(i,s),s}_refreshStyle(i){const h=i.marker.line-this._bufferService.buffers.active.ydisp;if(h<0||h>=this._bufferService.rows)i.element&&(i.element.style.display="none",i.onRenderEmitter.fire(i.element));else{let r=this._decorationElements.get(i);r||(r=this._createElement(i),i.element=r,this._decorationElements.set(i,r),this._container.appendChild(r)),r.style.top=h*this._renderService.dimensions.css.cell.height+"px",r.style.display=this._altBufferIsActive?"none":"block",i.onRenderEmitter.fire(r)}}_refreshXPosition(i,h=i.element){var r;if(!h)return;const s=(r=i.options.x)!==null&&r!==void 0?r:0;(i.options.anchor||"left")==="right"?h.style.right=s?s*this._renderService.dimensions.css.cell.width+"px":"":h.style.left=s?s*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(i){var h;(h=this._decorationElements.get(i))===null||h===void 0||h.remove(),this._decorationElements.delete(i),i.dispose()}};a=m([g(1,v.IBufferService),g(2,v.IDecorationService),g(3,u.IRenderService)],a),c.BufferDecorationRenderer=a},5871:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorZoneStore=void 0,c.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(w){if(w.options.overviewRulerOptions){for(const m of this._zones)if(m.color===w.options.overviewRulerOptions.color&&m.position===w.options.overviewRulerOptions.position){if(this._lineIntersectsZone(m,w.marker.line))return;if(this._lineAdjacentToZone(m,w.marker.line,w.options.overviewRulerOptions.position))return void this._addLineToZone(m,w.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=w.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=w.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=w.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=w.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:w.options.overviewRulerOptions.color,position:w.options.overviewRulerOptions.position,startBufferLine:w.marker.line,endBufferLine:w.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(w){this._linePadding=w}_lineIntersectsZone(w,m){return m>=w.startBufferLine&&m<=w.endBufferLine}_lineAdjacentToZone(w,m,g){return m>=w.startBufferLine-this._linePadding[g||"full"]&&m<=w.endBufferLine+this._linePadding[g||"full"]}_addLineToZone(w,m){w.startBufferLine=Math.min(w.startBufferLine,m),w.endBufferLine=Math.max(w.endBufferLine,m)}}},5744:function(K,c,w){var m=this&&this.__decorate||function(l,f,_,C){var p,y=arguments.length,L=y<3?f:C===null?C=Object.getOwnPropertyDescriptor(f,_):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(l,f,_,C);else for(var T=l.length-1;T>=0;T--)(p=l[T])&&(L=(y<3?p(L):y>3?p(f,_,L):p(f,_))||L);return y>3&&L&&Object.defineProperty(f,_,L),L},g=this&&this.__param||function(l,f){return function(_,C){f(_,C,l)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OverviewRulerRenderer=void 0;const d=w(5871),u=w(3656),b=w(4725),v=w(844),a=w(2585),i={full:0,left:0,center:0,right:0},h={full:0,left:0,center:0,right:0},r={full:0,left:0,center:0,right:0};let s=class extends v.Disposable{constructor(l,f,_,C,p,y,L){var T;super(),this._viewportElement=l,this._screenElement=f,this._bufferService=_,this._decorationService=C,this._renderService=p,this._optionsService=y,this._coreBrowseService=L,this._colorZoneStore=new d.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(T=this._viewportElement.parentElement)===null||T===void 0||T.insertBefore(this._canvas,this._viewportElement);const D=this._canvas.getContext("2d");if(!D)throw new Error("Ctx cannot be null");this._ctx=D,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,v.toDisposable)(()=>{var B;(B=this._canvas)===null||B===void 0||B.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,u.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const l=Math.floor(this._canvas.width/3),f=Math.ceil(this._canvas.width/3);h.full=this._canvas.width,h.left=l,h.center=f,h.right=l,this._refreshDrawHeightConstants(),r.full=0,r.left=0,r.center=h.left,r.right=h.left+h.center}_refreshDrawHeightConstants(){i.full=Math.round(2*this._coreBrowseService.dpr);const l=this._canvas.height/this._bufferService.buffer.lines.length,f=Math.round(Math.max(Math.min(l,12),6)*this._coreBrowseService.dpr);i.left=f,i.center=f,i.right=f}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*i.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const f of this._decorationService.decorations)this._colorZoneStore.addDecoration(f);this._ctx.lineWidth=1;const l=this._colorZoneStore.zones;for(const f of l)f.position!=="full"&&this._renderColorZone(f);for(const f of l)f.position==="full"&&this._renderColorZone(f);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(l){this._ctx.fillStyle=l.color,this._ctx.fillRect(r[l.position||"full"],Math.round((this._canvas.height-1)*(l.startBufferLine/this._bufferService.buffers.active.lines.length)-i[l.position||"full"]/2),h[l.position||"full"],Math.round((this._canvas.height-1)*((l.endBufferLine-l.startBufferLine)/this._bufferService.buffers.active.lines.length)+i[l.position||"full"]))}_queueRefresh(l,f){this._shouldUpdateDimensions=l||this._shouldUpdateDimensions,this._shouldUpdateAnchor=f||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};s=m([g(2,a.IBufferService),g(3,a.IDecorationService),g(4,b.IRenderService),g(5,a.IOptionsService),g(6,b.ICoreBrowserService)],s),c.OverviewRulerRenderer=s},2950:function(K,c,w){var m=this&&this.__decorate||function(a,i,h,r){var s,l=arguments.length,f=l<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,h):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(a,i,h,r);else for(var _=a.length-1;_>=0;_--)(s=a[_])&&(f=(l<3?s(f):l>3?s(i,h,f):s(i,h))||f);return l>3&&f&&Object.defineProperty(i,h,f),f},g=this&&this.__param||function(a,i){return function(h,r){i(h,r,a)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CompositionHelper=void 0;const d=w(4725),u=w(2585),b=w(2584);let v=class{constructor(a,i,h,r,s,l){this._textarea=a,this._compositionView=i,this._bufferService=h,this._optionsService=r,this._coreService=s,this._renderService=l,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(a){this._compositionView.textContent=a.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(a){if(this._isComposing||this._isSendingComposition){if(a.keyCode===229||a.keyCode===16||a.keyCode===17||a.keyCode===18)return!1;this._finalizeComposition(!1)}return a.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(a){if(this._compositionView.classList.remove("active"),this._isComposing=!1,a){const i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let h;if(this._isSendingComposition=!1,i.start+=this._dataAlreadySent.length,this._isComposing)h=this._textarea.value.substring(i.start,i.end);else{const r=this._textarea.value.length-i.start;h=this._textarea.value.substring(0,r)}h.length>0&&this._coreService.triggerDataEvent(h,!0)}},0)}else{this._isSendingComposition=!1;const i=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(i,!0)}}_handleAnyTextareaChanges(){const a=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const i=this._textarea.value,h=i.replace(a,"");this._dataAlreadySent=h,i.length>a.length?this._coreService.triggerDataEvent(h,!0):i.length<a.length?this._coreService.triggerDataEvent(`${b.C0.DEL}`,!0):i.length===a.length&&i!==a&&this._coreService.triggerDataEvent(i,!0)}},0)}updateCompositionElements(a){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),h=this._renderService.dimensions.css.cell.height,r=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,s=i*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=s+"px",this._compositionView.style.top=r+"px",this._compositionView.style.height=h+"px",this._compositionView.style.lineHeight=h+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const l=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=r+"px",this._textarea.style.width=Math.max(l.width,1)+"px",this._textarea.style.height=Math.max(l.height,1)+"px",this._textarea.style.lineHeight=l.height+"px"}a||setTimeout(()=>this.updateCompositionElements(!0),0)}}};v=m([g(2,u.IBufferService),g(3,u.IOptionsService),g(4,u.ICoreService),g(5,d.IRenderService)],v),c.CompositionHelper=v},9806:(K,c)=>{function w(m,g,d){const u=d.getBoundingClientRect(),b=m.getComputedStyle(d),v=parseInt(b.getPropertyValue("padding-left")),a=parseInt(b.getPropertyValue("padding-top"));return[g.clientX-u.left-v,g.clientY-u.top-a]}Object.defineProperty(c,"__esModule",{value:!0}),c.getCoords=c.getCoordsRelativeToElement=void 0,c.getCoordsRelativeToElement=w,c.getCoords=function(m,g,d,u,b,v,a,i,h){if(!v)return;const r=w(m,g,d);return r?(r[0]=Math.ceil((r[0]+(h?a/2:0))/a),r[1]=Math.ceil(r[1]/i),r[0]=Math.min(Math.max(r[0],1),u+(h?1:0)),r[1]=Math.min(Math.max(r[1],1),b),r):void 0}},9504:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.moveToCellSequence=void 0;const m=w(2584);function g(i,h,r,s){const l=i-d(i,r),f=h-d(h,r),_=Math.abs(l-f)-function(C,p,y){let L=0;const T=C-d(C,y),D=p-d(p,y);for(let B=0;B<Math.abs(T-D);B++){const H=u(C,p)==="A"?-1:1,A=y.buffer.lines.get(T+H*B);A!=null&&A.isWrapped&&L++}return L}(i,h,r);return a(_,v(u(i,h),s))}function d(i,h){let r=0,s=h.buffer.lines.get(i),l=s==null?void 0:s.isWrapped;for(;l&&i>=0&&i<h.rows;)r++,s=h.buffer.lines.get(--i),l=s==null?void 0:s.isWrapped;return r}function u(i,h){return i>h?"A":"B"}function b(i,h,r,s,l,f){let _=i,C=h,p="";for(;_!==r||C!==s;)_+=l?1:-1,l&&_>f.cols-1?(p+=f.buffer.translateBufferLineToString(C,!1,i,_),_=0,i=0,C++):!l&&_<0&&(p+=f.buffer.translateBufferLineToString(C,!1,0,i+1),_=f.cols-1,i=_,C--);return p+f.buffer.translateBufferLineToString(C,!1,i,_)}function v(i,h){const r=h?"O":"[";return m.C0.ESC+r+i}function a(i,h){i=Math.floor(i);let r="";for(let s=0;s<i;s++)r+=h;return r}c.moveToCellSequence=function(i,h,r,s){const l=r.buffer.x,f=r.buffer.y;if(!r.buffer.hasScrollback)return function(p,y,L,T,D,B){return g(y,T,D,B).length===0?"":a(b(p,y,p,y-d(y,D),!1,D).length,v("D",B))}(l,f,0,h,r,s)+g(f,h,r,s)+function(p,y,L,T,D,B){let H;H=g(y,T,D,B).length>0?T-d(T,D):y;const A=T,F=function(k,O,I,P,V,te){let he;return he=g(I,P,V,te).length>0?P-d(P,V):O,k<I&&he<=P||k>=I&&he<P?"C":"D"}(p,y,L,T,D,B);return a(b(p,H,L,A,F==="C",D).length,v(F,B))}(l,f,i,h,r,s);let _;if(f===h)return _=l>i?"D":"C",a(Math.abs(l-i),v(_,s));_=f>h?"D":"C";const C=Math.abs(f-h);return a(function(p,y){return y.cols-p}(f>h?i:l,r)+(C-1)*r.cols+1+((f>h?l:i)-1),v(_,s))}},1296:function(K,c,w){var m=this&&this.__decorate||function(C,p,y,L){var T,D=arguments.length,B=D<3?p:L===null?L=Object.getOwnPropertyDescriptor(p,y):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(C,p,y,L);else for(var H=C.length-1;H>=0;H--)(T=C[H])&&(B=(D<3?T(B):D>3?T(p,y,B):T(p,y))||B);return D>3&&B&&Object.defineProperty(p,y,B),B},g=this&&this.__param||function(C,p){return function(y,L){p(y,L,C)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRenderer=void 0;const d=w(3787),u=w(2223),b=w(6171),v=w(4725),a=w(8055),i=w(8460),h=w(844),r=w(2585),s="xterm-dom-renderer-owner-",l="xterm-focus";let f=1,_=class extends h.Disposable{constructor(C,p,y,L,T,D,B,H,A,F){super(),this._element=C,this._screenElement=p,this._viewportElement=y,this._linkifier2=L,this._charSizeService=D,this._optionsService=B,this._bufferService=H,this._coreBrowserService=A,this._themeService=F,this._terminalClass=f++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new i.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,b.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(k=>this._injectCss(k))),this._injectCss(this._themeService.colors),this._rowFactory=T.createInstance(d.DomRendererRowFactory,document),this._element.classList.add(s+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(k=>this._handleLinkHover(k))),this.register(this._linkifier2.onHideLinkUnderline(k=>this._handleLinkLeave(k))),this.register((0,h.toDisposable)(()=>{this._element.classList.remove(s+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))}_updateDimensions(){const C=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*C,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*C),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/C),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/C),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const y of this._rowElements)y.style.width=`${this.dimensions.css.canvas.width}px`,y.style.height=`${this.dimensions.css.cell.height}px`,y.style.lineHeight=`${this.dimensions.css.cell.height}px`,y.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const p=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=p,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(C){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let p=`${this._terminalSelector} .xterm-rows { color: ${C.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;p+=`${this._terminalSelector} .xterm-rows .xterm-dim { color: ${a.color.multiplyOpacity(C.foreground,.5).css};}`,p+=`${this._terminalSelector} span:not(.${d.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${d.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${d.ITALIC_CLASS} { font-style: italic;}`,p+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",p+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${C.cursor.css};  color: ${C.cursorAccent.css}; } 50% {  background-color: ${C.cursorAccent.css};  color: ${C.cursor.css}; }}`,p+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_BLOCK_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_BAR_CLASS} ,${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_UNDERLINE_CLASS} { outline: 1px solid ${C.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${d.CURSOR_CLASS}.${d.CURSOR_BLINK_CLASS}:not(.${d.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${d.CURSOR_CLASS}.${d.CURSOR_BLINK_CLASS}.${d.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${C.cursor.css}; color: ${C.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${C.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${d.CURSOR_CLASS}.${d.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${C.cursor.css} inset;}`,p+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${C.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${C.selectionInactiveBackgroundOpaque.css};}`;for(const[y,L]of C.ansi.entries())p+=`${this._terminalSelector} .xterm-fg-${y} { color: ${L.css}; }${this._terminalSelector} .xterm-fg-${y}.${d.DIM_CLASS} { color: ${a.color.multiplyOpacity(L,.5).css}; }${this._terminalSelector} .xterm-bg-${y} { background-color: ${L.css}; }`;p+=`${this._terminalSelector} .xterm-fg-${u.INVERTED_DEFAULT_COLOR} { color: ${a.color.opaque(C.background).css}; }${this._terminalSelector} .xterm-fg-${u.INVERTED_DEFAULT_COLOR}.${d.DIM_CLASS} { color: ${a.color.multiplyOpacity(a.color.opaque(C.background),.5).css}; }${this._terminalSelector} .xterm-bg-${u.INVERTED_DEFAULT_COLOR} { background-color: ${C.foreground.css}; }`,this._themeStyleElement.textContent=p}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(C,p){for(let y=this._rowElements.length;y<=p;y++){const L=document.createElement("div");this._rowContainer.appendChild(L),this._rowElements.push(L)}for(;this._rowElements.length>p;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(C,p){this._refreshRowElements(C,p),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(l)}handleFocus(){this._rowContainer.classList.add(l)}handleSelectionChanged(C,p,y){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(C,p,y),this.renderRows(0,this._bufferService.rows-1),!C||!p)return;const L=C[1]-this._bufferService.buffer.ydisp,T=p[1]-this._bufferService.buffer.ydisp,D=Math.max(L,0),B=Math.min(T,this._bufferService.rows-1);if(D>=this._bufferService.rows||B<0)return;const H=document.createDocumentFragment();if(y){const A=C[0]>p[0];H.appendChild(this._createSelectionElement(D,A?p[0]:C[0],A?C[0]:p[0],B-D+1))}else{const A=L===D?C[0]:0,F=D===T?p[0]:this._bufferService.cols;H.appendChild(this._createSelectionElement(D,A,F));const k=B-D-1;if(H.appendChild(this._createSelectionElement(D+1,0,this._bufferService.cols,k)),D!==B){const O=T===B?p[0]:this._bufferService.cols;H.appendChild(this._createSelectionElement(B,0,O))}}this._selectionContainer.appendChild(H)}_createSelectionElement(C,p,y,L=1){const T=document.createElement("div");return T.style.height=L*this.dimensions.css.cell.height+"px",T.style.top=C*this.dimensions.css.cell.height+"px",T.style.left=p*this.dimensions.css.cell.width+"px",T.style.width=this.dimensions.css.cell.width*(y-p)+"px",T}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors)}clear(){for(const C of this._rowElements)C.replaceChildren()}renderRows(C,p){const y=this._bufferService.buffer.ybase+this._bufferService.buffer.y,L=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),T=this._optionsService.rawOptions.cursorBlink;for(let D=C;D<=p;D++){const B=this._rowElements[D],H=D+this._bufferService.buffer.ydisp,A=this._bufferService.buffer.lines.get(H),F=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[D]&&this._cellToRowElements[D].length===this._bufferService.cols||(this._cellToRowElements[D]=new Int16Array(this._bufferService.cols)),B.replaceChildren(this._rowFactory.createRow(A,H,H===y,F,L,T,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[D]))}}get _terminalSelector(){return`.${s}${this._terminalClass}`}_handleLinkHover(C){this._setCellUnderline(C.x1,C.x2,C.y1,C.y2,C.cols,!0)}_handleLinkLeave(C){this._setCellUnderline(C.x1,C.x2,C.y1,C.y2,C.cols,!1)}_setCellUnderline(C,p,y,L,T,D){if(C=this._cellToRowElements[y][C],p=this._cellToRowElements[L][p],C!==-1&&p!==-1)for(;C!==p||y!==L;){const B=this._rowElements[y];if(!B)return;const H=B.children[C];H&&(H.style.textDecoration=D?"underline":"none"),++C>=T&&(C=0,y++)}}};_=m([g(4,r.IInstantiationService),g(5,v.ICharSizeService),g(6,r.IOptionsService),g(7,r.IBufferService),g(8,v.ICoreBrowserService),g(9,v.IThemeService)],_),c.DomRenderer=_},3787:function(K,c,w){var m=this&&this.__decorate||function(_,C,p,y){var L,T=arguments.length,D=T<3?C:y===null?y=Object.getOwnPropertyDescriptor(C,p):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(_,C,p,y);else for(var B=_.length-1;B>=0;B--)(L=_[B])&&(D=(T<3?L(D):T>3?L(C,p,D):L(C,p))||D);return T>3&&D&&Object.defineProperty(C,p,D),D},g=this&&this.__param||function(_,C){return function(p,y){C(p,y,_)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRendererRowFactory=c.CURSOR_STYLE_UNDERLINE_CLASS=c.CURSOR_STYLE_BAR_CLASS=c.CURSOR_STYLE_BLOCK_CLASS=c.CURSOR_BLINK_CLASS=c.CURSOR_CLASS=c.STRIKETHROUGH_CLASS=c.OVERLINE_CLASS=c.UNDERLINE_CLASS=c.ITALIC_CLASS=c.DIM_CLASS=c.BOLD_CLASS=void 0;const d=w(2223),u=w(643),b=w(511),v=w(2585),a=w(8055),i=w(4725),h=w(4269),r=w(6171),s=w(3734);c.BOLD_CLASS="xterm-bold",c.DIM_CLASS="xterm-dim",c.ITALIC_CLASS="xterm-italic",c.UNDERLINE_CLASS="xterm-underline",c.OVERLINE_CLASS="xterm-overline",c.STRIKETHROUGH_CLASS="xterm-strikethrough",c.CURSOR_CLASS="xterm-cursor",c.CURSOR_BLINK_CLASS="xterm-cursor-blink",c.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",c.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",c.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let l=class{constructor(_,C,p,y,L,T,D){this._document=_,this._characterJoinerService=C,this._optionsService=p,this._coreBrowserService=y,this._coreService=L,this._decorationService=T,this._themeService=D,this._workCell=new b.CellData,this._columnSelectMode=!1}handleSelectionChanged(_,C,p){this._selectionStart=_,this._selectionEnd=C,this._columnSelectMode=p}createRow(_,C,p,y,L,T,D,B,H){const A=this._document.createDocumentFragment(),F=this._characterJoinerService.getJoinedCharacters(C);let k=0;for(let V=Math.min(_.length,B)-1;V>=0;V--)if(_.loadCell(V,this._workCell).getCode()!==u.NULL_CELL_CODE||p&&V===L){k=V+1;break}const O=this._themeService.colors;let I=-1,P=0;for(;P<k;P++){_.loadCell(P,this._workCell);let V=this._workCell.getWidth();if(V===0){H[P]=I;continue}let te=!1,he=P,J=this._workCell;if(F.length>0&&P===F[0][0]){te=!0;const ae=F.shift();J=new h.JoinedCellData(this._workCell,_.translateToString(!0,ae[0],ae[1]),ae[1]-ae[0]),he=ae[1]-1,V=J.getWidth()}const le=this._document.createElement("span");if(V>1&&(le.style.width=D*V+"px"),te&&(le.style.display="inline",L>=P&&L<=he&&(L=P)),!this._coreService.isCursorHidden&&p&&P===L)switch(le.classList.add(c.CURSOR_CLASS),T&&le.classList.add(c.CURSOR_BLINK_CLASS),y){case"bar":le.classList.add(c.CURSOR_STYLE_BAR_CLASS);break;case"underline":le.classList.add(c.CURSOR_STYLE_UNDERLINE_CLASS);break;default:le.classList.add(c.CURSOR_STYLE_BLOCK_CLASS)}if(J.isBold()&&le.classList.add(c.BOLD_CLASS),J.isItalic()&&le.classList.add(c.ITALIC_CLASS),J.isDim()&&le.classList.add(c.DIM_CLASS),J.isInvisible()?le.textContent=u.WHITESPACE_CELL_CHAR:le.textContent=J.getChars()||u.WHITESPACE_CELL_CHAR,J.isUnderline()&&(le.classList.add(`${c.UNDERLINE_CLASS}-${J.extended.underlineStyle}`),le.textContent===" "&&(le.textContent=""),!J.isUnderlineColorDefault()))if(J.isUnderlineColorRGB())le.style.textDecorationColor=`rgb(${s.AttributeData.toColorRGB(J.getUnderlineColor()).join(",")})`;else{let ae=J.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&J.isBold()&&ae<8&&(ae+=8),le.style.textDecorationColor=O.ansi[ae].css}J.isOverline()&&(le.classList.add(c.OVERLINE_CLASS),le.textContent===" "&&(le.textContent="")),J.isStrikethrough()&&le.classList.add(c.STRIKETHROUGH_CLASS);let G=J.getFgColor(),z=J.getFgColorMode(),W=J.getBgColor(),Z=J.getBgColorMode();const ne=!!J.isInverse();if(ne){const ae=G;G=W,W=ae;const _t=z;z=Z,Z=_t}let we,se,Me=!1;this._decorationService.forEachDecorationAtCell(P,C,void 0,ae=>{ae.options.layer!=="top"&&Me||(ae.backgroundColorRGB&&(Z=50331648,W=ae.backgroundColorRGB.rgba>>8&16777215,we=ae.backgroundColorRGB),ae.foregroundColorRGB&&(z=50331648,G=ae.foregroundColorRGB.rgba>>8&16777215,se=ae.foregroundColorRGB),Me=ae.options.layer==="top")});const X=this._isCellInSelection(P,C);let ke;switch(Me||O.selectionForeground&&X&&(z=50331648,G=O.selectionForeground.rgba>>8&16777215,se=O.selectionForeground),X&&(we=this._coreBrowserService.isFocused?O.selectionBackgroundOpaque:O.selectionInactiveBackgroundOpaque,Me=!0),Me&&le.classList.add("xterm-decoration-top"),Z){case 16777216:case 33554432:ke=O.ansi[W],le.classList.add(`xterm-bg-${W}`);break;case 50331648:ke=a.rgba.toColor(W>>16,W>>8&255,255&W),this._addStyle(le,`background-color:#${f((W>>>0).toString(16),"0",6)}`);break;default:ne?(ke=O.foreground,le.classList.add(`xterm-bg-${d.INVERTED_DEFAULT_COLOR}`)):ke=O.background}switch(we||J.isDim()&&(we=a.color.multiplyOpacity(ke,.5)),z){case 16777216:case 33554432:J.isBold()&&G<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(G+=8),this._applyMinimumContrast(le,ke,O.ansi[G],J,we,void 0)||le.classList.add(`xterm-fg-${G}`);break;case 50331648:const ae=a.rgba.toColor(G>>16&255,G>>8&255,255&G);this._applyMinimumContrast(le,ke,ae,J,we,se)||this._addStyle(le,`color:#${f(G.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(le,ke,O.foreground,J,we,void 0)||ne&&le.classList.add(`xterm-fg-${d.INVERTED_DEFAULT_COLOR}`)}A.appendChild(le),H[P]=++I,P=he}return P<B-1&&H.subarray(P).fill(++I),A}_applyMinimumContrast(_,C,p,y,L,T){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,r.excludeFromContrastRatioDemands)(y.getCode()))return!1;let D;return L||T||(D=this._themeService.colors.contrastCache.getColor(C.rgba,p.rgba)),D===void 0&&(D=a.color.ensureContrastRatio(L||C,T||p,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((L||C).rgba,(T||p).rgba,D??null)),!!D&&(this._addStyle(_,`color:${D.css}`),!0)}_addStyle(_,C){_.setAttribute("style",`${_.getAttribute("style")||""}${C};`)}_isCellInSelection(_,C){const p=this._selectionStart,y=this._selectionEnd;return!(!p||!y)&&(this._columnSelectMode?p[0]<=y[0]?_>=p[0]&&C>=p[1]&&_<y[0]&&C<=y[1]:_<p[0]&&C>=p[1]&&_>=y[0]&&C<=y[1]:C>p[1]&&C<y[1]||p[1]===y[1]&&C===p[1]&&_>=p[0]&&_<y[0]||p[1]<y[1]&&C===y[1]&&_<y[0]||p[1]<y[1]&&C===p[1]&&_>=p[0])}};function f(_,C,p){for(;_.length<p;)_=C+_;return _}l=m([g(1,i.ICharacterJoinerService),g(2,v.IOptionsService),g(3,i.ICoreBrowserService),g(4,v.ICoreService),g(5,v.IDecorationService),g(6,i.IThemeService)],l),c.DomRendererRowFactory=l},2223:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const m=w(6114);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=m.isFirefox||m.isLegacyEdge?"bottom":"ideographic"},6171:(K,c)=>{function w(m){return 57508<=m&&m<=57558}Object.defineProperty(c,"__esModule",{value:!0}),c.createRenderDimensions=c.excludeFromContrastRatioDemands=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(m){if(!m)throw new Error("value must not be falsy");return m},c.isPowerlineGlyph=w,c.isRestrictedPowerlineGlyph=function(m){return 57520<=m&&m<=57527},c.excludeFromContrastRatioDemands=function(m){return w(m)||function(g){return 9472<=g&&g<=9631}(m)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionModel=void 0,c.SelectionModel=class{constructor(w){this._bufferService=w,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const w=this.selectionStart[0]+this.selectionStartLength;return w>this._bufferService.cols?w%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(w/this._bufferService.cols)-1]:[w%this._bufferService.cols,this.selectionStart[1]+Math.floor(w/this._bufferService.cols)]:[w,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const w=this.selectionStart[0]+this.selectionStartLength;return w>this._bufferService.cols?[w%this._bufferService.cols,this.selectionStart[1]+Math.floor(w/this._bufferService.cols)]:[Math.max(w,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const w=this.selectionStart,m=this.selectionEnd;return!(!w||!m)&&(w[1]>m[1]||w[1]===m[1]&&w[0]>m[0])}handleTrim(w){return this.selectionStart&&(this.selectionStart[1]-=w),this.selectionEnd&&(this.selectionEnd[1]-=w),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(K,c,w){var m=this&&this.__decorate||function(i,h,r,s){var l,f=arguments.length,_=f<3?h:s===null?s=Object.getOwnPropertyDescriptor(h,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(i,h,r,s);else for(var C=i.length-1;C>=0;C--)(l=i[C])&&(_=(f<3?l(_):f>3?l(h,r,_):l(h,r))||_);return f>3&&_&&Object.defineProperty(h,r,_),_},g=this&&this.__param||function(i,h){return function(r,s){h(r,s,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharSizeService=void 0;const d=w(2585),u=w(8460),b=w(844);let v=class extends b.Disposable{constructor(i,h,r){super(),this._optionsService=r,this.width=0,this.height=0,this._onCharSizeChange=this.register(new u.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new a(i,h,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const i=this._measureStrategy.measure();i.width===this.width&&i.height===this.height||(this.width=i.width,this.height=i.height,this._onCharSizeChange.fire())}};v=m([g(2,d.IOptionsService)],v),c.CharSizeService=v;class a{constructor(h,r,s){this._document=h,this._parentElement=r,this._optionsService=s,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const h=this._measureElement.getBoundingClientRect();return h.width!==0&&h.height!==0&&(this._result.width=h.width,this._result.height=Math.ceil(h.height)),this._result}}},4269:function(K,c,w){var m=this&&this.__decorate||function(h,r,s,l){var f,_=arguments.length,C=_<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,s):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(h,r,s,l);else for(var p=h.length-1;p>=0;p--)(f=h[p])&&(C=(_<3?f(C):_>3?f(r,s,C):f(r,s))||C);return _>3&&C&&Object.defineProperty(r,s,C),C},g=this&&this.__param||function(h,r){return function(s,l){r(s,l,h)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const d=w(3734),u=w(643),b=w(511),v=w(2585);class a extends d.AttributeData{constructor(r,s,l){super(),this.content=0,this.combinedData="",this.fg=r.fg,this.bg=r.bg,this.combinedData=s,this._width=l}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(r){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=a;let i=class Xi{constructor(r){this._bufferService=r,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new b.CellData}register(r){const s={id:this._nextCharacterJoinerId++,handler:r};return this._characterJoiners.push(s),s.id}deregister(r){for(let s=0;s<this._characterJoiners.length;s++)if(this._characterJoiners[s].id===r)return this._characterJoiners.splice(s,1),!0;return!1}getJoinedCharacters(r){if(this._characterJoiners.length===0)return[];const s=this._bufferService.buffer.lines.get(r);if(!s||s.length===0)return[];const l=[],f=s.translateToString(!0);let _=0,C=0,p=0,y=s.getFg(0),L=s.getBg(0);for(let T=0;T<s.getTrimmedLength();T++)if(s.loadCell(T,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==y||this._workCell.bg!==L){if(T-_>1){const D=this._getJoinedRanges(f,p,C,s,_);for(let B=0;B<D.length;B++)l.push(D[B])}_=T,p=C,y=this._workCell.fg,L=this._workCell.bg}C+=this._workCell.getChars().length||u.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-_>1){const T=this._getJoinedRanges(f,p,C,s,_);for(let D=0;D<T.length;D++)l.push(T[D])}return l}_getJoinedRanges(r,s,l,f,_){const C=r.substring(s,l);let p=[];try{p=this._characterJoiners[0].handler(C)}catch(y){console.error(y)}for(let y=1;y<this._characterJoiners.length;y++)try{const L=this._characterJoiners[y].handler(C);for(let T=0;T<L.length;T++)Xi._mergeRanges(p,L[T])}catch(L){console.error(L)}return this._stringRangesToCellRanges(p,f,_),p}_stringRangesToCellRanges(r,s,l){let f=0,_=!1,C=0,p=r[f];if(p){for(let y=l;y<this._bufferService.cols;y++){const L=s.getWidth(y),T=s.getString(y).length||u.WHITESPACE_CELL_CHAR.length;if(L!==0){if(!_&&p[0]<=C&&(p[0]=y,_=!0),p[1]<=C){if(p[1]=y,p=r[++f],!p)break;p[0]<=C?(p[0]=y,_=!0):_=!1}C+=T}}p&&(p[1]=this._bufferService.cols)}}static _mergeRanges(r,s){let l=!1;for(let f=0;f<r.length;f++){const _=r[f];if(l){if(s[1]<=_[0])return r[f-1][1]=s[1],r;if(s[1]<=_[1])return r[f-1][1]=Math.max(s[1],_[1]),r.splice(f,1),r;r.splice(f,1),f--}else{if(s[1]<=_[0])return r.splice(f,0,s),r;if(s[1]<=_[1])return _[0]=Math.min(s[0],_[0]),r;s[0]<_[1]&&(_[0]=Math.min(s[0],_[0]),l=!0)}}return l?r[r.length-1][1]=s[1]:r.push(s),r}};i=m([g(0,v.IBufferService)],i),c.CharacterJoinerService=i},5114:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreBrowserService=void 0,c.CoreBrowserService=class{constructor(w,m){this._textarea=w,this.window=m,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(K,c,w){var m=this&&this.__decorate||function(v,a,i,h){var r,s=arguments.length,l=s<3?a:h===null?h=Object.getOwnPropertyDescriptor(a,i):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(v,a,i,h);else for(var f=v.length-1;f>=0;f--)(r=v[f])&&(l=(s<3?r(l):s>3?r(a,i,l):r(a,i))||l);return s>3&&l&&Object.defineProperty(a,i,l),l},g=this&&this.__param||function(v,a){return function(i,h){a(i,h,v)}};Object.defineProperty(c,"__esModule",{value:!0}),c.MouseService=void 0;const d=w(4725),u=w(9806);let b=class{constructor(v,a){this._renderService=v,this._charSizeService=a}getCoords(v,a,i,h,r){return(0,u.getCoords)(window,v,a,i,h,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,r)}getMouseReportCoords(v,a){const i=(0,u.getCoordsRelativeToElement)(window,v,a);if(!(!this._charSizeService.hasValidSize||i[0]<0||i[1]<0||i[0]>=this._renderService.dimensions.css.canvas.width||i[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};b=m([g(0,d.IRenderService),g(1,d.ICharSizeService)],b),c.MouseService=b},3230:function(K,c,w){var m=this&&this.__decorate||function(l,f,_,C){var p,y=arguments.length,L=y<3?f:C===null?C=Object.getOwnPropertyDescriptor(f,_):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(l,f,_,C);else for(var T=l.length-1;T>=0;T--)(p=l[T])&&(L=(y<3?p(L):y>3?p(f,_,L):p(f,_))||L);return y>3&&L&&Object.defineProperty(f,_,L),L},g=this&&this.__param||function(l,f){return function(_,C){f(_,C,l)}};Object.defineProperty(c,"__esModule",{value:!0}),c.RenderService=void 0;const d=w(6193),u=w(8460),b=w(844),v=w(5596),a=w(3656),i=w(2585),h=w(4725),r=w(7226);let s=class extends b.Disposable{constructor(l,f,_,C,p,y,L,T){if(super(),this._rowCount=l,this._charSizeService=C,this._pausedResizeTask=new r.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new u.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new u.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new u.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new u.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var D;return(D=this._renderer)===null||D===void 0?void 0:D.dispose()}}),this._renderDebouncer=new d.RenderDebouncer(L.window,(D,B)=>this._renderRows(D,B)),this.register(this._renderDebouncer),this._screenDprMonitor=new v.ScreenDprMonitor(L.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(y.onResize(()=>this._fullRefresh())),this.register(y.buffers.onBufferActivate(()=>{var D;return(D=this._renderer)===null||D===void 0?void 0:D.clear()})),this.register(_.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(p.onDecorationRegistered(()=>this._fullRefresh())),this.register(p.onDecorationRemoved(()=>this._fullRefresh())),this.register(_.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(y.cols,y.rows),this._fullRefresh()})),this.register(_.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(y.buffer.y,y.buffer.y,!0))),this.register((0,a.addDisposableDomListener)(L.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(T.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in L.window){const D=new L.window.IntersectionObserver(B=>this._handleIntersectionChange(B[B.length-1]),{threshold:0});D.observe(f),this.register({dispose:()=>D.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(l){this._isPaused=l.isIntersecting===void 0?l.intersectionRatio===0:!l.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(l,f,_=!1){this._isPaused?this._needsFullRefresh=!0:(_||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(l,f,this._rowCount))}_renderRows(l,f){this._renderer&&(l=Math.min(l,this._rowCount-1),f=Math.min(f,this._rowCount-1),this._renderer.renderRows(l,f),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:l,end:f}),this._onRender.fire({start:l,end:f}),this._isNextRenderRedrawOnly=!0)}resize(l,f){this._rowCount=f,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(l){var f;(f=this._renderer)===null||f===void 0||f.dispose(),this._renderer=l,this._renderer.onRequestRedraw(_=>this.refreshRows(_.start,_.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(l){return this._renderDebouncer.addRefreshCallback(l)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var l,f;this._renderer&&((f=(l=this._renderer).clearTextureAtlas)===null||f===void 0||f.call(l),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(l,f){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(l,f)):this._renderer.handleResize(l,f),this._fullRefresh())}handleCharSizeChanged(){var l;(l=this._renderer)===null||l===void 0||l.handleCharSizeChanged()}handleBlur(){var l;(l=this._renderer)===null||l===void 0||l.handleBlur()}handleFocus(){var l;(l=this._renderer)===null||l===void 0||l.handleFocus()}handleSelectionChanged(l,f,_){var C;this._selectionState.start=l,this._selectionState.end=f,this._selectionState.columnSelectMode=_,(C=this._renderer)===null||C===void 0||C.handleSelectionChanged(l,f,_)}handleCursorMove(){var l;(l=this._renderer)===null||l===void 0||l.handleCursorMove()}clear(){var l;(l=this._renderer)===null||l===void 0||l.clear()}};s=m([g(2,i.IOptionsService),g(3,h.ICharSizeService),g(4,i.IDecorationService),g(5,i.IBufferService),g(6,h.ICoreBrowserService),g(7,h.IThemeService)],s),c.RenderService=s},9312:function(K,c,w){var m=this&&this.__decorate||function(p,y,L,T){var D,B=arguments.length,H=B<3?y:T===null?T=Object.getOwnPropertyDescriptor(y,L):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(p,y,L,T);else for(var A=p.length-1;A>=0;A--)(D=p[A])&&(H=(B<3?D(H):B>3?D(y,L,H):D(y,L))||H);return B>3&&H&&Object.defineProperty(y,L,H),H},g=this&&this.__param||function(p,y){return function(L,T){y(L,T,p)}};Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionService=void 0;const d=w(6114),u=w(456),b=w(511),v=w(8460),a=w(4725),i=w(2585),h=w(9806),r=w(9504),s=w(844),l=w(4841),f=String.fromCharCode(160),_=new RegExp(f,"g");let C=class extends s.Disposable{constructor(p,y,L,T,D,B,H,A,F){super(),this._element=p,this._screenElement=y,this._linkifier=L,this._bufferService=T,this._coreService=D,this._mouseService=B,this._optionsService=H,this._renderService=A,this._coreBrowserService=F,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new b.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new v.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new v.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new v.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new v.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=k=>this._handleMouseMove(k),this._mouseUpListener=k=>this._handleMouseUp(k),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(k=>this._handleTrim(k)),this.register(this._bufferService.buffers.onBufferActivate(k=>this._handleBufferActivate(k))),this.enable(),this._model=new u.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,s.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const p=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;return!(!p||!y||p[0]===y[0]&&p[1]===y[1])}get selectionText(){const p=this._model.finalSelectionStart,y=this._model.finalSelectionEnd;if(!p||!y)return"";const L=this._bufferService.buffer,T=[];if(this._activeSelectionMode===3){if(p[0]===y[0])return"";const D=p[0]<y[0]?p[0]:y[0],B=p[0]<y[0]?y[0]:p[0];for(let H=p[1];H<=y[1];H++){const A=L.translateBufferLineToString(H,!0,D,B);T.push(A)}}else{const D=p[1]===y[1]?y[0]:void 0;T.push(L.translateBufferLineToString(p[1],!0,p[0],D));for(let B=p[1]+1;B<=y[1]-1;B++){const H=L.lines.get(B),A=L.translateBufferLineToString(B,!0);H!=null&&H.isWrapped?T[T.length-1]+=A:T.push(A)}if(p[1]!==y[1]){const B=L.lines.get(y[1]),H=L.translateBufferLineToString(y[1],!0,0,y[0]);B&&B.isWrapped?T[T.length-1]+=H:T.push(H)}}return T.map(D=>D.replace(_," ")).join(d.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(p){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),d.isLinux&&p&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(p){const y=this._getMouseBufferCoords(p),L=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!!(L&&T&&y)&&this._areCoordsInSelection(y,L,T)}isCellInSelection(p,y){const L=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!(!L||!T)&&this._areCoordsInSelection([p,y],L,T)}_areCoordsInSelection(p,y,L){return p[1]>y[1]&&p[1]<L[1]||y[1]===L[1]&&p[1]===y[1]&&p[0]>=y[0]&&p[0]<L[0]||y[1]<L[1]&&p[1]===L[1]&&p[0]<L[0]||y[1]<L[1]&&p[1]===y[1]&&p[0]>=y[0]}_selectWordAtCursor(p,y){var L,T;const D=(T=(L=this._linkifier.currentLink)===null||L===void 0?void 0:L.link)===null||T===void 0?void 0:T.range;if(D)return this._model.selectionStart=[D.start.x-1,D.start.y-1],this._model.selectionStartLength=(0,l.getRangeLength)(D,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const B=this._getMouseBufferCoords(p);return!!B&&(this._selectWordAt(B,y),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(p,y){this._model.clearSelection(),p=Math.max(p,0),y=Math.min(y,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,p],this._model.selectionEnd=[this._bufferService.cols,y],this.refresh(),this._onSelectionChange.fire()}_handleTrim(p){this._model.handleTrim(p)&&this.refresh()}_getMouseBufferCoords(p){const y=this._mouseService.getCoords(p,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(y)return y[0]--,y[1]--,y[1]+=this._bufferService.buffer.ydisp,y}_getMouseEventScrollAmount(p){let y=(0,h.getCoordsRelativeToElement)(this._coreBrowserService.window,p,this._screenElement)[1];const L=this._renderService.dimensions.css.canvas.height;return y>=0&&y<=L?0:(y>L&&(y-=L),y=Math.min(Math.max(y,-50),50),y/=50,y/Math.abs(y)+Math.round(14*y))}shouldForceSelection(p){return d.isMac?p.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:p.shiftKey}handleMouseDown(p){if(this._mouseDownTimeStamp=p.timeStamp,(p.button!==2||!this.hasSelection)&&p.button===0){if(!this._enabled){if(!this.shouldForceSelection(p))return;p.stopPropagation()}p.preventDefault(),this._dragScrollAmount=0,this._enabled&&p.shiftKey?this._handleIncrementalClick(p):p.detail===1?this._handleSingleClick(p):p.detail===2?this._handleDoubleClick(p):p.detail===3&&this._handleTripleClick(p),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(p){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(p))}_handleSingleClick(p){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(p)?3:0,this._model.selectionStart=this._getMouseBufferCoords(p),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const y=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);y&&y.length!==this._model.selectionStart[0]&&y.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(p){this._selectWordAtCursor(p,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(p){const y=this._getMouseBufferCoords(p);y&&(this._activeSelectionMode=2,this._selectLineAt(y[1]))}shouldColumnSelect(p){return p.altKey&&!(d.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(p){if(p.stopImmediatePropagation(),!this._model.selectionStart)return;const y=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(p),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(p),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const L=this._bufferService.buffer;if(this._model.selectionEnd[1]<L.lines.length){const T=L.lines.get(this._model.selectionEnd[1]);T&&T.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}y&&y[0]===this._model.selectionEnd[0]&&y[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const p=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(p.ydisp+this._bufferService.rows,p.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=p.ydisp),this.refresh()}}_handleMouseUp(p){const y=p.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&y<500&&p.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const L=this._mouseService.getCoords(p,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(L&&L[0]!==void 0&&L[1]!==void 0){const T=(0,r.moveToCellSequence)(L[0]-1,L[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(T,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const p=this._model.finalSelectionStart,y=this._model.finalSelectionEnd,L=!(!p||!y||p[0]===y[0]&&p[1]===y[1]);L?p&&y&&(this._oldSelectionStart&&this._oldSelectionEnd&&p[0]===this._oldSelectionStart[0]&&p[1]===this._oldSelectionStart[1]&&y[0]===this._oldSelectionEnd[0]&&y[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(p,y,L)):this._oldHasSelection&&this._fireOnSelectionChange(p,y,L)}_fireOnSelectionChange(p,y,L){this._oldSelectionStart=p,this._oldSelectionEnd=y,this._oldHasSelection=L,this._onSelectionChange.fire()}_handleBufferActivate(p){this.clearSelection(),this._trimListener.dispose(),this._trimListener=p.activeBuffer.lines.onTrim(y=>this._handleTrim(y))}_convertViewportColToCharacterIndex(p,y){let L=y;for(let T=0;y>=T;T++){const D=p.loadCell(T,this._workCell).getChars().length;this._workCell.getWidth()===0?L--:D>1&&y!==T&&(L+=D-1)}return L}setSelection(p,y,L){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[p,y],this._model.selectionStartLength=L,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(p){this._isClickInSelection(p)||(this._selectWordAtCursor(p,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(p,y,L=!0,T=!0){if(p[0]>=this._bufferService.cols)return;const D=this._bufferService.buffer,B=D.lines.get(p[1]);if(!B)return;const H=D.translateBufferLineToString(p[1],!1);let A=this._convertViewportColToCharacterIndex(B,p[0]),F=A;const k=p[0]-A;let O=0,I=0,P=0,V=0;if(H.charAt(A)===" "){for(;A>0&&H.charAt(A-1)===" ";)A--;for(;F<H.length&&H.charAt(F+1)===" ";)F++}else{let J=p[0],le=p[0];B.getWidth(J)===0&&(O++,J--),B.getWidth(le)===2&&(I++,le++);const G=B.getString(le).length;for(G>1&&(V+=G-1,F+=G-1);J>0&&A>0&&!this._isCharWordSeparator(B.loadCell(J-1,this._workCell));){B.loadCell(J-1,this._workCell);const z=this._workCell.getChars().length;this._workCell.getWidth()===0?(O++,J--):z>1&&(P+=z-1,A-=z-1),A--,J--}for(;le<B.length&&F+1<H.length&&!this._isCharWordSeparator(B.loadCell(le+1,this._workCell));){B.loadCell(le+1,this._workCell);const z=this._workCell.getChars().length;this._workCell.getWidth()===2?(I++,le++):z>1&&(V+=z-1,F+=z-1),F++,le++}}F++;let te=A+k-O+P,he=Math.min(this._bufferService.cols,F-A+O+I-P-V);if(y||H.slice(A,F).trim()!==""){if(L&&te===0&&B.getCodePoint(0)!==32){const J=D.lines.get(p[1]-1);if(J&&B.isWrapped&&J.getCodePoint(this._bufferService.cols-1)!==32){const le=this._getWordAt([this._bufferService.cols-1,p[1]-1],!1,!0,!1);if(le){const G=this._bufferService.cols-le.start;te-=G,he+=G}}}if(T&&te+he===this._bufferService.cols&&B.getCodePoint(this._bufferService.cols-1)!==32){const J=D.lines.get(p[1]+1);if(J!=null&&J.isWrapped&&J.getCodePoint(0)!==32){const le=this._getWordAt([0,p[1]+1],!1,!1,!0);le&&(he+=le.length)}}return{start:te,length:he}}}_selectWordAt(p,y){const L=this._getWordAt(p,y);if(L){for(;L.start<0;)L.start+=this._bufferService.cols,p[1]--;this._model.selectionStart=[L.start,p[1]],this._model.selectionStartLength=L.length}}_selectToWordAt(p){const y=this._getWordAt(p,!0);if(y){let L=p[1];for(;y.start<0;)y.start+=this._bufferService.cols,L--;if(!this._model.areSelectionValuesReversed())for(;y.start+y.length>this._bufferService.cols;)y.length-=this._bufferService.cols,L++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?y.start:y.start+y.length,L]}}_isCharWordSeparator(p){return p.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(p.getChars())>=0}_selectLineAt(p){const y=this._bufferService.buffer.getWrappedRangeForLine(p),L={start:{x:0,y:y.first},end:{x:this._bufferService.cols-1,y:y.last}};this._model.selectionStart=[0,y.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,l.getRangeLength)(L,this._bufferService.cols)}};C=m([g(3,i.IBufferService),g(4,i.ICoreService),g(5,a.IMouseService),g(6,i.IOptionsService),g(7,a.IRenderService),g(8,a.ICoreBrowserService)],C),c.SelectionService=C},4725:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IThemeService=c.ICharacterJoinerService=c.ISelectionService=c.IRenderService=c.IMouseService=c.ICoreBrowserService=c.ICharSizeService=void 0;const m=w(8343);c.ICharSizeService=(0,m.createDecorator)("CharSizeService"),c.ICoreBrowserService=(0,m.createDecorator)("CoreBrowserService"),c.IMouseService=(0,m.createDecorator)("MouseService"),c.IRenderService=(0,m.createDecorator)("RenderService"),c.ISelectionService=(0,m.createDecorator)("SelectionService"),c.ICharacterJoinerService=(0,m.createDecorator)("CharacterJoinerService"),c.IThemeService=(0,m.createDecorator)("ThemeService")},6731:function(K,c,w){var m=this&&this.__decorate||function(C,p,y,L){var T,D=arguments.length,B=D<3?p:L===null?L=Object.getOwnPropertyDescriptor(p,y):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(C,p,y,L);else for(var H=C.length-1;H>=0;H--)(T=C[H])&&(B=(D<3?T(B):D>3?T(p,y,B):T(p,y))||B);return D>3&&B&&Object.defineProperty(p,y,B),B},g=this&&this.__param||function(C,p){return function(y,L){p(y,L,C)}};Object.defineProperty(c,"__esModule",{value:!0}),c.ThemeService=c.DEFAULT_ANSI_COLORS=void 0;const d=w(7239),u=w(8055),b=w(8460),v=w(844),a=w(2585),i=u.css.toColor("#ffffff"),h=u.css.toColor("#000000"),r=u.css.toColor("#ffffff"),s=u.css.toColor("#000000"),l={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};c.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const C=[u.css.toColor("#2e3436"),u.css.toColor("#cc0000"),u.css.toColor("#4e9a06"),u.css.toColor("#c4a000"),u.css.toColor("#3465a4"),u.css.toColor("#75507b"),u.css.toColor("#06989a"),u.css.toColor("#d3d7cf"),u.css.toColor("#555753"),u.css.toColor("#ef2929"),u.css.toColor("#8ae234"),u.css.toColor("#fce94f"),u.css.toColor("#729fcf"),u.css.toColor("#ad7fa8"),u.css.toColor("#34e2e2"),u.css.toColor("#eeeeec")],p=[0,95,135,175,215,255];for(let y=0;y<216;y++){const L=p[y/36%6|0],T=p[y/6%6|0],D=p[y%6];C.push({css:u.channels.toCss(L,T,D),rgba:u.channels.toRgba(L,T,D)})}for(let y=0;y<24;y++){const L=8+10*y;C.push({css:u.channels.toCss(L,L,L),rgba:u.channels.toRgba(L,L,L)})}return C})());let f=class extends v.Disposable{constructor(C){super(),this._optionsService=C,this._onChangeColors=this.register(new b.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new d.ColorContrastCache,this._colors={foreground:i,background:h,cursor:r,cursorAccent:s,selectionForeground:void 0,selectionBackgroundTransparent:l,selectionBackgroundOpaque:u.color.blend(h,l),selectionInactiveBackgroundTransparent:l,selectionInactiveBackgroundOpaque:u.color.blend(h,l),ansi:c.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(C={}){const p=this._colors;if(p.foreground=_(C.foreground,i),p.background=_(C.background,h),p.cursor=_(C.cursor,r),p.cursorAccent=_(C.cursorAccent,s),p.selectionBackgroundTransparent=_(C.selectionBackground,l),p.selectionBackgroundOpaque=u.color.blend(p.background,p.selectionBackgroundTransparent),p.selectionInactiveBackgroundTransparent=_(C.selectionInactiveBackground,p.selectionBackgroundTransparent),p.selectionInactiveBackgroundOpaque=u.color.blend(p.background,p.selectionInactiveBackgroundTransparent),p.selectionForeground=C.selectionForeground?_(C.selectionForeground,u.NULL_COLOR):void 0,p.selectionForeground===u.NULL_COLOR&&(p.selectionForeground=void 0),u.color.isOpaque(p.selectionBackgroundTransparent)&&(p.selectionBackgroundTransparent=u.color.opacity(p.selectionBackgroundTransparent,.3)),u.color.isOpaque(p.selectionInactiveBackgroundTransparent)&&(p.selectionInactiveBackgroundTransparent=u.color.opacity(p.selectionInactiveBackgroundTransparent,.3)),p.ansi=c.DEFAULT_ANSI_COLORS.slice(),p.ansi[0]=_(C.black,c.DEFAULT_ANSI_COLORS[0]),p.ansi[1]=_(C.red,c.DEFAULT_ANSI_COLORS[1]),p.ansi[2]=_(C.green,c.DEFAULT_ANSI_COLORS[2]),p.ansi[3]=_(C.yellow,c.DEFAULT_ANSI_COLORS[3]),p.ansi[4]=_(C.blue,c.DEFAULT_ANSI_COLORS[4]),p.ansi[5]=_(C.magenta,c.DEFAULT_ANSI_COLORS[5]),p.ansi[6]=_(C.cyan,c.DEFAULT_ANSI_COLORS[6]),p.ansi[7]=_(C.white,c.DEFAULT_ANSI_COLORS[7]),p.ansi[8]=_(C.brightBlack,c.DEFAULT_ANSI_COLORS[8]),p.ansi[9]=_(C.brightRed,c.DEFAULT_ANSI_COLORS[9]),p.ansi[10]=_(C.brightGreen,c.DEFAULT_ANSI_COLORS[10]),p.ansi[11]=_(C.brightYellow,c.DEFAULT_ANSI_COLORS[11]),p.ansi[12]=_(C.brightBlue,c.DEFAULT_ANSI_COLORS[12]),p.ansi[13]=_(C.brightMagenta,c.DEFAULT_ANSI_COLORS[13]),p.ansi[14]=_(C.brightCyan,c.DEFAULT_ANSI_COLORS[14]),p.ansi[15]=_(C.brightWhite,c.DEFAULT_ANSI_COLORS[15]),C.extendedAnsi){const y=Math.min(p.ansi.length-16,C.extendedAnsi.length);for(let L=0;L<y;L++)p.ansi[L+16]=_(C.extendedAnsi[L],c.DEFAULT_ANSI_COLORS[L+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(C){this._restoreColor(C),this._onChangeColors.fire(this.colors)}_restoreColor(C){if(C!==void 0)switch(C){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[C]=this._restoreColors.ansi[C]}else for(let p=0;p<this._restoreColors.ansi.length;++p)this._colors.ansi[p]=this._restoreColors.ansi[p]}modifyColors(C){C(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function _(C,p){if(C!==void 0)try{return u.css.toColor(C)}catch{}return p}f=m([g(0,a.IOptionsService)],f),c.ThemeService=f},6349:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CircularList=void 0;const m=w(8460),g=w(844);class d extends g.Disposable{constructor(b){super(),this._maxLength=b,this.onDeleteEmitter=this.register(new m.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new m.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new m.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(b){if(this._maxLength===b)return;const v=new Array(b);for(let a=0;a<Math.min(b,this.length);a++)v[a]=this._array[this._getCyclicIndex(a)];this._array=v,this._maxLength=b,this._startIndex=0}get length(){return this._length}set length(b){if(b>this._length)for(let v=this._length;v<b;v++)this._array[v]=void 0;this._length=b}get(b){return this._array[this._getCyclicIndex(b)]}set(b,v){this._array[this._getCyclicIndex(b)]=v}push(b){this._array[this._getCyclicIndex(this._length)]=b,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(b,v,...a){if(v){for(let i=b;i<this._length-v;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+v)];this._length-=v,this.onDeleteEmitter.fire({index:b,amount:v})}for(let i=this._length-1;i>=b;i--)this._array[this._getCyclicIndex(i+a.length)]=this._array[this._getCyclicIndex(i)];for(let i=0;i<a.length;i++)this._array[this._getCyclicIndex(b+i)]=a[i];if(a.length&&this.onInsertEmitter.fire({index:b,amount:a.length}),this._length+a.length>this._maxLength){const i=this._length+a.length-this._maxLength;this._startIndex+=i,this._length=this._maxLength,this.onTrimEmitter.fire(i)}else this._length+=a.length}trimStart(b){b>this._length&&(b=this._length),this._startIndex+=b,this._length-=b,this.onTrimEmitter.fire(b)}shiftElements(b,v,a){if(!(v<=0)){if(b<0||b>=this._length)throw new Error("start argument out of range");if(b+a<0)throw new Error("Cannot shift elements in list beyond index 0");if(a>0){for(let h=v-1;h>=0;h--)this.set(b+h+a,this.get(b+h));const i=b+v+a-this._length;if(i>0)for(this._length+=i;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let i=0;i<v;i++)this.set(b+i+a,this.get(b+i))}}_getCyclicIndex(b){return(this._startIndex+b)%this._maxLength}}c.CircularList=d},1439:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.clone=void 0,c.clone=function w(m,g=5){if(typeof m!="object")return m;const d=Array.isArray(m)?[]:{};for(const u in m)d[u]=g<=1?m[u]:m[u]&&w(m[u],g-1);return d}},8055:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;const m=w(6114);let g=0,d=0,u=0,b=0;var v,a,i;function h(s){const l=s.toString(16);return l.length<2?"0"+l:l}function r(s,l){return s<l?(l+.05)/(s+.05):(s+.05)/(l+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},function(s){s.toCss=function(l,f,_,C){return C!==void 0?`#${h(l)}${h(f)}${h(_)}${h(C)}`:`#${h(l)}${h(f)}${h(_)}`},s.toRgba=function(l,f,_,C=255){return(l<<24|f<<16|_<<8|C)>>>0}}(v=c.channels||(c.channels={})),function(s){function l(f,_){return b=Math.round(255*_),[g,d,u]=i.toChannels(f.rgba),{css:v.toCss(g,d,u,b),rgba:v.toRgba(g,d,u,b)}}s.blend=function(f,_){if(b=(255&_.rgba)/255,b===1)return{css:_.css,rgba:_.rgba};const C=_.rgba>>24&255,p=_.rgba>>16&255,y=_.rgba>>8&255,L=f.rgba>>24&255,T=f.rgba>>16&255,D=f.rgba>>8&255;return g=L+Math.round((C-L)*b),d=T+Math.round((p-T)*b),u=D+Math.round((y-D)*b),{css:v.toCss(g,d,u),rgba:v.toRgba(g,d,u)}},s.isOpaque=function(f){return(255&f.rgba)==255},s.ensureContrastRatio=function(f,_,C){const p=i.ensureContrastRatio(f.rgba,_.rgba,C);if(p)return i.toColor(p>>24&255,p>>16&255,p>>8&255)},s.opaque=function(f){const _=(255|f.rgba)>>>0;return[g,d,u]=i.toChannels(_),{css:v.toCss(g,d,u),rgba:_}},s.opacity=l,s.multiplyOpacity=function(f,_){return b=255&f.rgba,l(f,b*_/255)},s.toColorRGB=function(f){return[f.rgba>>24&255,f.rgba>>16&255,f.rgba>>8&255]}}(c.color||(c.color={})),function(s){let l,f;if(!m.isNode){const _=document.createElement("canvas");_.width=1,_.height=1;const C=_.getContext("2d",{willReadFrequently:!0});C&&(l=C,l.globalCompositeOperation="copy",f=l.createLinearGradient(0,0,1,1))}s.toColor=function(_){if(_.match(/#[\da-f]{3,8}/i))switch(_.length){case 4:return g=parseInt(_.slice(1,2).repeat(2),16),d=parseInt(_.slice(2,3).repeat(2),16),u=parseInt(_.slice(3,4).repeat(2),16),i.toColor(g,d,u);case 5:return g=parseInt(_.slice(1,2).repeat(2),16),d=parseInt(_.slice(2,3).repeat(2),16),u=parseInt(_.slice(3,4).repeat(2),16),b=parseInt(_.slice(4,5).repeat(2),16),i.toColor(g,d,u,b);case 7:return{css:_,rgba:(parseInt(_.slice(1),16)<<8|255)>>>0};case 9:return{css:_,rgba:parseInt(_.slice(1),16)>>>0}}const C=_.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return g=parseInt(C[1]),d=parseInt(C[2]),u=parseInt(C[3]),b=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),i.toColor(g,d,u,b);if(!l||!f)throw new Error("css.toColor: Unsupported css format");if(l.fillStyle=f,l.fillStyle=_,typeof l.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(l.fillRect(0,0,1,1),[g,d,u,b]=l.getImageData(0,0,1,1).data,b!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(g,d,u,b),css:_}}}(c.css||(c.css={})),function(s){function l(f,_,C){const p=f/255,y=_/255,L=C/255;return .2126*(p<=.03928?p/12.92:Math.pow((p+.055)/1.055,2.4))+.7152*(y<=.03928?y/12.92:Math.pow((y+.055)/1.055,2.4))+.0722*(L<=.03928?L/12.92:Math.pow((L+.055)/1.055,2.4))}s.relativeLuminance=function(f){return l(f>>16&255,f>>8&255,255&f)},s.relativeLuminance2=l}(a=c.rgb||(c.rgb={})),function(s){function l(_,C,p){const y=_>>24&255,L=_>>16&255,T=_>>8&255;let D=C>>24&255,B=C>>16&255,H=C>>8&255,A=r(a.relativeLuminance2(D,B,H),a.relativeLuminance2(y,L,T));for(;A<p&&(D>0||B>0||H>0);)D-=Math.max(0,Math.ceil(.1*D)),B-=Math.max(0,Math.ceil(.1*B)),H-=Math.max(0,Math.ceil(.1*H)),A=r(a.relativeLuminance2(D,B,H),a.relativeLuminance2(y,L,T));return(D<<24|B<<16|H<<8|255)>>>0}function f(_,C,p){const y=_>>24&255,L=_>>16&255,T=_>>8&255;let D=C>>24&255,B=C>>16&255,H=C>>8&255,A=r(a.relativeLuminance2(D,B,H),a.relativeLuminance2(y,L,T));for(;A<p&&(D<255||B<255||H<255);)D=Math.min(255,D+Math.ceil(.1*(255-D))),B=Math.min(255,B+Math.ceil(.1*(255-B))),H=Math.min(255,H+Math.ceil(.1*(255-H))),A=r(a.relativeLuminance2(D,B,H),a.relativeLuminance2(y,L,T));return(D<<24|B<<16|H<<8|255)>>>0}s.ensureContrastRatio=function(_,C,p){const y=a.relativeLuminance(_>>8),L=a.relativeLuminance(C>>8);if(r(y,L)<p){if(L<y){const B=l(_,C,p),H=r(y,a.relativeLuminance(B>>8));if(H<p){const A=f(_,C,p);return H>r(y,a.relativeLuminance(A>>8))?B:A}return B}const T=f(_,C,p),D=r(y,a.relativeLuminance(T>>8));if(D<p){const B=l(_,C,p);return D>r(y,a.relativeLuminance(B>>8))?T:B}return T}},s.reduceLuminance=l,s.increaseLuminance=f,s.toChannels=function(_){return[_>>24&255,_>>16&255,_>>8&255,255&_]},s.toColor=function(_,C,p,y){return{css:v.toCss(_,C,p,y),rgba:v.toRgba(_,C,p,y)}}}(i=c.rgba||(c.rgba={})),c.toPaddedHex=h,c.contrastRatio=r},8969:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreTerminal=void 0;const m=w(844),g=w(2585),d=w(4348),u=w(7866),b=w(744),v=w(7302),a=w(6975),i=w(8460),h=w(1753),r=w(1480),s=w(7994),l=w(9282),f=w(5435),_=w(5981),C=w(2660);let p=!1;class y extends m.Disposable{constructor(T){super(),this._onBinary=this.register(new i.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new i.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new i.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new i.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new i.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new i.EventEmitter),this._instantiationService=new d.InstantiationService,this.optionsService=this.register(new v.OptionsService(T)),this._instantiationService.setService(g.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(b.BufferService)),this._instantiationService.setService(g.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(u.LogService)),this._instantiationService.setService(g.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(a.CoreService)),this._instantiationService.setService(g.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(h.CoreMouseService)),this._instantiationService.setService(g.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(r.UnicodeService)),this._instantiationService.setService(g.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(s.CharsetService),this._instantiationService.setService(g.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(C.OscLinkService),this._instantiationService.setService(g.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new f.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,i.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,i.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,i.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,i.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",D=>this._handleWindowsModeOptionChange(D))),this.register(this._bufferService.onScroll(D=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(D=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new _.WriteBuffer((D,B)=>this._inputHandler.parse(D,B))),this.register((0,i.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,m.toDisposable)(()=>{var D;(D=this._windowsMode)===null||D===void 0||D.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new i.EventEmitter),this._onScroll.event(T=>{var D;(D=this._onScrollApi)===null||D===void 0||D.fire(T.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(T){for(const D in T)this.optionsService.options[D]=T[D]}write(T,D){this._writeBuffer.write(T,D)}writeSync(T,D){this._logService.logLevel<=g.LogLevelEnum.WARN&&!p&&(this._logService.warn("writeSync is unreliable and will be removed soon."),p=!0),this._writeBuffer.writeSync(T,D)}resize(T,D){isNaN(T)||isNaN(D)||(T=Math.max(T,b.MINIMUM_COLS),D=Math.max(D,b.MINIMUM_ROWS),this._bufferService.resize(T,D))}scroll(T,D=!1){this._bufferService.scroll(T,D)}scrollLines(T,D,B){this._bufferService.scrollLines(T,D,B)}scrollPages(T){this._bufferService.scrollPages(T)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(T){this._bufferService.scrollToLine(T)}registerEscHandler(T,D){return this._inputHandler.registerEscHandler(T,D)}registerDcsHandler(T,D){return this._inputHandler.registerDcsHandler(T,D)}registerCsiHandler(T,D){return this._inputHandler.registerCsiHandler(T,D)}registerOscHandler(T,D){return this._inputHandler.registerOscHandler(T,D)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(T){var D;T?this._enableWindowsMode():((D=this._windowsMode)===null||D===void 0||D.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){const T=[];T.push(this.onLineFeed(l.updateWindowsModeWrappedState.bind(null,this._bufferService))),T.push(this.registerCsiHandler({final:"H"},()=>((0,l.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(const D of T)D.dispose()}}}}}c.CoreTerminal=y},8460:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=w=>(this._listeners.push(w),{dispose:()=>{if(!this._disposed){for(let m=0;m<this._listeners.length;m++)if(this._listeners[m]===w)return void this._listeners.splice(m,1)}}})),this._event}fire(w,m){const g=[];for(let d=0;d<this._listeners.length;d++)g.push(this._listeners[d]);for(let d=0;d<g.length;d++)g[d].call(void 0,w,m)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(w,m){return w(g=>m.fire(g))}},5435:function(K,c,w){var m=this&&this.__decorate||function(F,k,O,I){var P,V=arguments.length,te=V<3?k:I===null?I=Object.getOwnPropertyDescriptor(k,O):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")te=Reflect.decorate(F,k,O,I);else for(var he=F.length-1;he>=0;he--)(P=F[he])&&(te=(V<3?P(te):V>3?P(k,O,te):P(k,O))||te);return V>3&&te&&Object.defineProperty(k,O,te),te},g=this&&this.__param||function(F,k){return function(O,I){k(O,I,F)}};Object.defineProperty(c,"__esModule",{value:!0}),c.InputHandler=c.WindowsOptionsReportType=void 0;const d=w(2584),u=w(7116),b=w(2015),v=w(844),a=w(482),i=w(8437),h=w(8460),r=w(643),s=w(511),l=w(3734),f=w(2585),_=w(6242),C=w(6351),p=w(5941),y={"(":0,")":1,"*":2,"+":3,"-":1,".":2},L=131072;function T(F,k){if(F>24)return k.setWinLines||!1;switch(F){case 1:return!!k.restoreWin;case 2:return!!k.minimizeWin;case 3:return!!k.setWinPosition;case 4:return!!k.setWinSizePixels;case 5:return!!k.raiseWin;case 6:return!!k.lowerWin;case 7:return!!k.refreshWin;case 8:return!!k.setWinSizeChars;case 9:return!!k.maximizeWin;case 10:return!!k.fullscreenWin;case 11:return!!k.getWinState;case 13:return!!k.getWinPosition;case 14:return!!k.getWinSizePixels;case 15:return!!k.getScreenSizePixels;case 16:return!!k.getCellSizePixels;case 18:return!!k.getWinSizeChars;case 19:return!!k.getScreenSizeChars;case 20:return!!k.getIconTitle;case 21:return!!k.getWinTitle;case 22:return!!k.pushTitle;case 23:return!!k.popTitle;case 24:return!!k.setWinLines}return!1}var D;(function(F){F[F.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",F[F.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(D=c.WindowsOptionsReportType||(c.WindowsOptionsReportType={}));let B=0;class H extends v.Disposable{constructor(k,O,I,P,V,te,he,J,le=new b.EscapeSequenceParser){super(),this._bufferService=k,this._charsetService=O,this._coreService=I,this._logService=P,this._optionsService=V,this._oscLinkService=te,this._coreMouseService=he,this._unicodeService=J,this._parser=le,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new a.StringToUtf32,this._utf8Decoder=new a.Utf8ToUtf32,this._workCell=new s.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new h.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new h.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new h.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new h.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new h.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new h.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new h.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new h.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new h.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new h.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new h.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new h.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new h.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new A(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(G=>this._activeBuffer=G.activeBuffer)),this._parser.setCsiHandlerFallback((G,z)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(G),params:z.toArray()})}),this._parser.setEscHandlerFallback(G=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(G)})}),this._parser.setExecuteHandlerFallback(G=>{this._logService.debug("Unknown EXECUTE code: ",{code:G})}),this._parser.setOscHandlerFallback((G,z,W)=>{this._logService.debug("Unknown OSC code: ",{identifier:G,action:z,data:W})}),this._parser.setDcsHandlerFallback((G,z,W)=>{z==="HOOK"&&(W=W.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(G),action:z,payload:W})}),this._parser.setPrintHandler((G,z,W)=>this.print(G,z,W)),this._parser.registerCsiHandler({final:"@"},G=>this.insertChars(G)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},G=>this.scrollLeft(G)),this._parser.registerCsiHandler({final:"A"},G=>this.cursorUp(G)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},G=>this.scrollRight(G)),this._parser.registerCsiHandler({final:"B"},G=>this.cursorDown(G)),this._parser.registerCsiHandler({final:"C"},G=>this.cursorForward(G)),this._parser.registerCsiHandler({final:"D"},G=>this.cursorBackward(G)),this._parser.registerCsiHandler({final:"E"},G=>this.cursorNextLine(G)),this._parser.registerCsiHandler({final:"F"},G=>this.cursorPrecedingLine(G)),this._parser.registerCsiHandler({final:"G"},G=>this.cursorCharAbsolute(G)),this._parser.registerCsiHandler({final:"H"},G=>this.cursorPosition(G)),this._parser.registerCsiHandler({final:"I"},G=>this.cursorForwardTab(G)),this._parser.registerCsiHandler({final:"J"},G=>this.eraseInDisplay(G,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},G=>this.eraseInDisplay(G,!0)),this._parser.registerCsiHandler({final:"K"},G=>this.eraseInLine(G,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},G=>this.eraseInLine(G,!0)),this._parser.registerCsiHandler({final:"L"},G=>this.insertLines(G)),this._parser.registerCsiHandler({final:"M"},G=>this.deleteLines(G)),this._parser.registerCsiHandler({final:"P"},G=>this.deleteChars(G)),this._parser.registerCsiHandler({final:"S"},G=>this.scrollUp(G)),this._parser.registerCsiHandler({final:"T"},G=>this.scrollDown(G)),this._parser.registerCsiHandler({final:"X"},G=>this.eraseChars(G)),this._parser.registerCsiHandler({final:"Z"},G=>this.cursorBackwardTab(G)),this._parser.registerCsiHandler({final:"`"},G=>this.charPosAbsolute(G)),this._parser.registerCsiHandler({final:"a"},G=>this.hPositionRelative(G)),this._parser.registerCsiHandler({final:"b"},G=>this.repeatPrecedingCharacter(G)),this._parser.registerCsiHandler({final:"c"},G=>this.sendDeviceAttributesPrimary(G)),this._parser.registerCsiHandler({prefix:">",final:"c"},G=>this.sendDeviceAttributesSecondary(G)),this._parser.registerCsiHandler({final:"d"},G=>this.linePosAbsolute(G)),this._parser.registerCsiHandler({final:"e"},G=>this.vPositionRelative(G)),this._parser.registerCsiHandler({final:"f"},G=>this.hVPosition(G)),this._parser.registerCsiHandler({final:"g"},G=>this.tabClear(G)),this._parser.registerCsiHandler({final:"h"},G=>this.setMode(G)),this._parser.registerCsiHandler({prefix:"?",final:"h"},G=>this.setModePrivate(G)),this._parser.registerCsiHandler({final:"l"},G=>this.resetMode(G)),this._parser.registerCsiHandler({prefix:"?",final:"l"},G=>this.resetModePrivate(G)),this._parser.registerCsiHandler({final:"m"},G=>this.charAttributes(G)),this._parser.registerCsiHandler({final:"n"},G=>this.deviceStatus(G)),this._parser.registerCsiHandler({prefix:"?",final:"n"},G=>this.deviceStatusPrivate(G)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},G=>this.softReset(G)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},G=>this.setCursorStyle(G)),this._parser.registerCsiHandler({final:"r"},G=>this.setScrollRegion(G)),this._parser.registerCsiHandler({final:"s"},G=>this.saveCursor(G)),this._parser.registerCsiHandler({final:"t"},G=>this.windowOptions(G)),this._parser.registerCsiHandler({final:"u"},G=>this.restoreCursor(G)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},G=>this.insertColumns(G)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},G=>this.deleteColumns(G)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},G=>this.selectProtected(G)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},G=>this.requestMode(G,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},G=>this.requestMode(G,!1)),this._parser.setExecuteHandler(d.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(d.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(d.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(d.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(d.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(d.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(d.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(d.C1.IND,()=>this.index()),this._parser.setExecuteHandler(d.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(d.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new _.OscHandler(G=>(this.setTitle(G),this.setIconName(G),!0))),this._parser.registerOscHandler(1,new _.OscHandler(G=>this.setIconName(G))),this._parser.registerOscHandler(2,new _.OscHandler(G=>this.setTitle(G))),this._parser.registerOscHandler(4,new _.OscHandler(G=>this.setOrReportIndexedColor(G))),this._parser.registerOscHandler(8,new _.OscHandler(G=>this.setHyperlink(G))),this._parser.registerOscHandler(10,new _.OscHandler(G=>this.setOrReportFgColor(G))),this._parser.registerOscHandler(11,new _.OscHandler(G=>this.setOrReportBgColor(G))),this._parser.registerOscHandler(12,new _.OscHandler(G=>this.setOrReportCursorColor(G))),this._parser.registerOscHandler(104,new _.OscHandler(G=>this.restoreIndexedColor(G))),this._parser.registerOscHandler(110,new _.OscHandler(G=>this.restoreFgColor(G))),this._parser.registerOscHandler(111,new _.OscHandler(G=>this.restoreBgColor(G))),this._parser.registerOscHandler(112,new _.OscHandler(G=>this.restoreCursorColor(G))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const G in u.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:G},()=>this.selectCharset("("+G)),this._parser.registerEscHandler({intermediates:")",final:G},()=>this.selectCharset(")"+G)),this._parser.registerEscHandler({intermediates:"*",final:G},()=>this.selectCharset("*"+G)),this._parser.registerEscHandler({intermediates:"+",final:G},()=>this.selectCharset("+"+G)),this._parser.registerEscHandler({intermediates:"-",final:G},()=>this.selectCharset("-"+G)),this._parser.registerEscHandler({intermediates:".",final:G},()=>this.selectCharset("."+G)),this._parser.registerEscHandler({intermediates:"/",final:G},()=>this.selectCharset("/"+G));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(G=>(this._logService.error("Parsing error: ",G),G)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new C.DcsHandler((G,z)=>this.requestStatusString(G,z)))}getAttrData(){return this._curAttrData}_preserveStack(k,O,I,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=k,this._parseStack.cursorStartY=O,this._parseStack.decodedLength=I,this._parseStack.position=P}_logSlowResolvingAsync(k){this._logService.logLevel<=f.LogLevelEnum.WARN&&Promise.race([k,new Promise((O,I)=>setTimeout(()=>I("#SLOW_TIMEOUT"),5e3))]).catch(O=>{if(O!=="#SLOW_TIMEOUT")throw O;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(k,O){let I,P=this._activeBuffer.x,V=this._activeBuffer.y,te=0;const he=this._parseStack.paused;if(he){if(I=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,O))return this._logSlowResolvingAsync(I),I;P=this._parseStack.cursorStartX,V=this._parseStack.cursorStartY,this._parseStack.paused=!1,k.length>L&&(te=this._parseStack.position+L)}if(this._logService.logLevel<=f.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof k=="string"?` "${k}"`:` "${Array.prototype.map.call(k,J=>String.fromCharCode(J)).join("")}"`),typeof k=="string"?k.split("").map(J=>J.charCodeAt(0)):k),this._parseBuffer.length<k.length&&this._parseBuffer.length<L&&(this._parseBuffer=new Uint32Array(Math.min(k.length,L))),he||this._dirtyRowTracker.clearRange(),k.length>L)for(let J=te;J<k.length;J+=L){const le=J+L<k.length?J+L:k.length,G=typeof k=="string"?this._stringDecoder.decode(k.substring(J,le),this._parseBuffer):this._utf8Decoder.decode(k.subarray(J,le),this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,G))return this._preserveStack(P,V,G,J),this._logSlowResolvingAsync(I),I}else if(!he){const J=typeof k=="string"?this._stringDecoder.decode(k,this._parseBuffer):this._utf8Decoder.decode(k,this._parseBuffer);if(I=this._parser.parse(this._parseBuffer,J))return this._preserveStack(P,V,J,0),this._logSlowResolvingAsync(I),I}this._activeBuffer.x===P&&this._activeBuffer.y===V||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(k,O,I){let P,V;const te=this._charsetService.charset,he=this._optionsService.rawOptions.screenReaderMode,J=this._bufferService.cols,le=this._coreService.decPrivateModes.wraparound,G=this._coreService.modes.insertMode,z=this._curAttrData;let W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&I-O>0&&W.getWidth(this._activeBuffer.x-1)===2&&W.setCellFromCodePoint(this._activeBuffer.x-1,0,1,z.fg,z.bg,z.extended);for(let Z=O;Z<I;++Z){if(P=k[Z],V=this._unicodeService.wcwidth(P),P<127&&te){const ne=te[String.fromCharCode(P)];ne&&(P=ne.charCodeAt(0))}if(he&&this._onA11yChar.fire((0,a.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),V||!this._activeBuffer.x){if(this._activeBuffer.x+V-1>=J){if(le){for(;this._activeBuffer.x<J;)W.setCellFromCodePoint(this._activeBuffer.x++,0,1,z.fg,z.bg,z.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),W=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=J-1,V===2)continue}if(G&&(W.insertCells(this._activeBuffer.x,V,this._activeBuffer.getNullCell(z),z),W.getWidth(J-1)===2&&W.setCellFromCodePoint(J-1,r.NULL_CELL_CODE,r.NULL_CELL_WIDTH,z.fg,z.bg,z.extended)),W.setCellFromCodePoint(this._activeBuffer.x++,P,V,z.fg,z.bg,z.extended),V>0)for(;--V;)W.setCellFromCodePoint(this._activeBuffer.x++,0,0,z.fg,z.bg,z.extended)}else W.getWidth(this._activeBuffer.x-1)?W.addCodepointToCell(this._activeBuffer.x-1,P):W.addCodepointToCell(this._activeBuffer.x-2,P)}I-O>0&&(W.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<J&&I-O>0&&W.getWidth(this._activeBuffer.x)===0&&!W.hasContent(this._activeBuffer.x)&&W.setCellFromCodePoint(this._activeBuffer.x,0,1,z.fg,z.bg,z.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(k,O){return k.final!=="t"||k.prefix||k.intermediates?this._parser.registerCsiHandler(k,O):this._parser.registerCsiHandler(k,I=>!T(I.params[0],this._optionsService.rawOptions.windowOptions)||O(I))}registerDcsHandler(k,O){return this._parser.registerDcsHandler(k,new C.DcsHandler(O))}registerEscHandler(k,O){return this._parser.registerEscHandler(k,O)}registerOscHandler(k,O){return this._parser.registerOscHandler(k,new _.OscHandler(O))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var k;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((k=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||k===void 0)&&k.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);O.hasWidth(this._activeBuffer.x)&&!O.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const k=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-k),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(k=this._bufferService.cols-1){this._activeBuffer.x=Math.min(k,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(k,O){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=k,this._activeBuffer.y=this._activeBuffer.scrollTop+O):(this._activeBuffer.x=k,this._activeBuffer.y=O),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(k,O){this._restrictCursor(),this._setCursor(this._activeBuffer.x+k,this._activeBuffer.y+O)}cursorUp(k){const O=this._activeBuffer.y-this._activeBuffer.scrollTop;return O>=0?this._moveCursor(0,-Math.min(O,k.params[0]||1)):this._moveCursor(0,-(k.params[0]||1)),!0}cursorDown(k){const O=this._activeBuffer.scrollBottom-this._activeBuffer.y;return O>=0?this._moveCursor(0,Math.min(O,k.params[0]||1)):this._moveCursor(0,k.params[0]||1),!0}cursorForward(k){return this._moveCursor(k.params[0]||1,0),!0}cursorBackward(k){return this._moveCursor(-(k.params[0]||1),0),!0}cursorNextLine(k){return this.cursorDown(k),this._activeBuffer.x=0,!0}cursorPrecedingLine(k){return this.cursorUp(k),this._activeBuffer.x=0,!0}cursorCharAbsolute(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(k){return this._setCursor(k.length>=2?(k.params[1]||1)-1:0,(k.params[0]||1)-1),!0}charPosAbsolute(k){return this._setCursor((k.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(k){return this._moveCursor(k.params[0]||1,0),!0}linePosAbsolute(k){return this._setCursor(this._activeBuffer.x,(k.params[0]||1)-1),!0}vPositionRelative(k){return this._moveCursor(0,k.params[0]||1),!0}hVPosition(k){return this.cursorPosition(k),!0}tabClear(k){const O=k.params[0];return O===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:O===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let O=k.params[0]||1;for(;O--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(k){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let O=k.params[0]||1;for(;O--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(k){const O=k.params[0];return O===1&&(this._curAttrData.bg|=536870912),O!==2&&O!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(k,O,I,P=!1,V=!1){const te=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);te.replaceCells(O,I,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),V),P&&(te.isWrapped=!1)}_resetBufferLine(k,O=!1){const I=this._activeBuffer.lines.get(this._activeBuffer.ybase+k);I.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),O),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+k),I.isWrapped=!1}eraseInDisplay(k,O=!1){let I;switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,O);I<this._bufferService.rows;I++)this._resetBufferLine(I,O);this._dirtyRowTracker.markDirty(I);break;case 1:for(I=this._activeBuffer.y,this._dirtyRowTracker.markDirty(I),this._eraseInBufferLine(I,0,this._activeBuffer.x+1,!0,O),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(I+1).isWrapped=!1);I--;)this._resetBufferLine(I,O);this._dirtyRowTracker.markDirty(0);break;case 2:for(I=this._bufferService.rows,this._dirtyRowTracker.markDirty(I-1);I--;)this._resetBufferLine(I,O);this._dirtyRowTracker.markDirty(0);break;case 3:const P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(k,O=!1){switch(this._restrictCursor(this._bufferService.cols),k.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,O);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,O);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,O)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(k){this._restrictCursor();let O=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,V=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;O--;)this._activeBuffer.lines.splice(V-1,1),this._activeBuffer.lines.splice(I,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(k){this._restrictCursor();let O=k.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const I=this._activeBuffer.ybase+this._activeBuffer.y;let P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;O--;)this._activeBuffer.lines.splice(I,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(k){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.insertCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(k){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.deleteCells(this._activeBuffer.x,k.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(k){let O=k.params[0]||1;for(;O--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(k){let O=k.params[0]||1;for(;O--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(i.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=k.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);P.deleteCells(0,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=k.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);P.insertCells(0,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=k.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);P.insertCells(this._activeBuffer.x,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(k){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const O=k.params[0]||1;for(let I=this._activeBuffer.scrollTop;I<=this._activeBuffer.scrollBottom;++I){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);P.deleteCells(this._activeBuffer.x,O,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(k){this._restrictCursor();const O=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return O&&(O.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(k.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(k){if(!this._parser.precedingCodepoint)return!0;const O=k.params[0]||1,I=new Uint32Array(O);for(let P=0;P<O;++P)I[P]=this._parser.precedingCodepoint;return this.print(I,0,I.length),!0}sendDeviceAttributesPrimary(k){return k.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(d.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(d.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(k){return k.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(d.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(d.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(k.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(d.C0.ESC+"[>83;40003;0c")),!0}_is(k){return(this._optionsService.rawOptions.termName+"").indexOf(k)===0}setMode(k){for(let O=0;O<k.length;O++)switch(k.params[O]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(k){for(let O=0;O<k.length;O++)switch(k.params[O]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,u.DEFAULT_CHARSET),this._charsetService.setgCharset(1,u.DEFAULT_CHARSET),this._charsetService.setgCharset(2,u.DEFAULT_CHARSET),this._charsetService.setgCharset(3,u.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(k){for(let O=0;O<k.length;O++)switch(k.params[O]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(k){for(let O=0;O<k.length;O++)switch(k.params[O]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),k.params[O]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(k,O){const I=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:V}=this._coreMouseService,te=this._coreService,{buffers:he,cols:J}=this._bufferService,{active:le,alt:G}=he,z=this._optionsService.rawOptions,W=se=>se?1:2,Z=k.params[0];return ne=Z,we=O?Z===2?4:Z===4?W(te.modes.insertMode):Z===12?3:Z===20?W(z.convertEol):0:Z===1?W(I.applicationCursorKeys):Z===3?z.windowOptions.setWinLines?J===80?2:J===132?1:0:0:Z===6?W(I.origin):Z===7?W(I.wraparound):Z===8?3:Z===9?W(P==="X10"):Z===12?W(z.cursorBlink):Z===25?W(!te.isCursorHidden):Z===45?W(I.reverseWraparound):Z===66?W(I.applicationKeypad):Z===67?4:Z===1e3?W(P==="VT200"):Z===1002?W(P==="DRAG"):Z===1003?W(P==="ANY"):Z===1004?W(I.sendFocus):Z===1005?4:Z===1006?W(V==="SGR"):Z===1015?4:Z===1016?W(V==="SGR_PIXELS"):Z===1048?1:Z===47||Z===1047||Z===1049?W(le===G):Z===2004?W(I.bracketedPasteMode):0,te.triggerDataEvent(`${d.C0.ESC}[${O?"":"?"}${ne};${we}$y`),!0;var ne,we}_updateAttrColor(k,O,I,P,V){return O===2?(k|=50331648,k&=-16777216,k|=l.AttributeData.fromColorRGB([I,P,V])):O===5&&(k&=-50331904,k|=33554432|255&I),k}_extractColor(k,O,I){const P=[0,0,-1,0,0,0];let V=0,te=0;do{if(P[te+V]=k.params[O+te],k.hasSubParams(O+te)){const he=k.getSubParams(O+te);let J=0;do P[1]===5&&(V=1),P[te+J+1+V]=he[J];while(++J<he.length&&J+te+1+V<P.length);break}if(P[1]===5&&te+V>=2||P[1]===2&&te+V>=5)break;P[1]&&(V=1)}while(++te+O<k.length&&te+V<P.length);for(let he=2;he<P.length;++he)P[he]===-1&&(P[he]=0);switch(P[0]){case 38:I.fg=this._updateAttrColor(I.fg,P[1],P[3],P[4],P[5]);break;case 48:I.bg=this._updateAttrColor(I.bg,P[1],P[3],P[4],P[5]);break;case 58:I.extended=I.extended.clone(),I.extended.underlineColor=this._updateAttrColor(I.extended.underlineColor,P[1],P[3],P[4],P[5])}return te}_processUnderline(k,O){O.extended=O.extended.clone(),(!~k||k>5)&&(k=1),O.extended.underlineStyle=k,O.fg|=268435456,k===0&&(O.fg&=-268435457),O.updateExtended()}_processSGR0(k){k.fg=i.DEFAULT_ATTR_DATA.fg,k.bg=i.DEFAULT_ATTR_DATA.bg,k.extended=k.extended.clone(),k.extended.underlineStyle=0,k.extended.underlineColor&=-67108864,k.updateExtended()}charAttributes(k){if(k.length===1&&k.params[0]===0)return this._processSGR0(this._curAttrData),!0;const O=k.length;let I;const P=this._curAttrData;for(let V=0;V<O;V++)I=k.params[V],I>=30&&I<=37?(P.fg&=-50331904,P.fg|=16777216|I-30):I>=40&&I<=47?(P.bg&=-50331904,P.bg|=16777216|I-40):I>=90&&I<=97?(P.fg&=-50331904,P.fg|=16777224|I-90):I>=100&&I<=107?(P.bg&=-50331904,P.bg|=16777224|I-100):I===0?this._processSGR0(P):I===1?P.fg|=134217728:I===3?P.bg|=67108864:I===4?(P.fg|=268435456,this._processUnderline(k.hasSubParams(V)?k.getSubParams(V)[0]:1,P)):I===5?P.fg|=536870912:I===7?P.fg|=67108864:I===8?P.fg|=1073741824:I===9?P.fg|=2147483648:I===2?P.bg|=134217728:I===21?this._processUnderline(2,P):I===22?(P.fg&=-134217729,P.bg&=-134217729):I===23?P.bg&=-67108865:I===24?(P.fg&=-268435457,this._processUnderline(0,P)):I===25?P.fg&=-536870913:I===27?P.fg&=-67108865:I===28?P.fg&=-1073741825:I===29?P.fg&=2147483647:I===39?(P.fg&=-67108864,P.fg|=16777215&i.DEFAULT_ATTR_DATA.fg):I===49?(P.bg&=-67108864,P.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):I===38||I===48||I===58?V+=this._extractColor(k,V,P):I===53?P.bg|=1073741824:I===55?P.bg&=-1073741825:I===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):I===100?(P.fg&=-67108864,P.fg|=16777215&i.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",I);return!0}deviceStatus(k){switch(k.params[0]){case 5:this._coreService.triggerDataEvent(`${d.C0.ESC}[0n`);break;case 6:const O=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[${O};${I}R`)}return!0}deviceStatusPrivate(k){if(k.params[0]===6){const O=this._activeBuffer.y+1,I=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${d.C0.ESC}[?${O};${I}R`)}return!0}softReset(k){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(k){const O=k.params[0]||1;switch(O){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const I=O%2==1;return this._optionsService.options.cursorBlink=I,!0}setScrollRegion(k){const O=k.params[0]||1;let I;return(k.length<2||(I=k.params[1])>this._bufferService.rows||I===0)&&(I=this._bufferService.rows),I>O&&(this._activeBuffer.scrollTop=O-1,this._activeBuffer.scrollBottom=I-1,this._setCursor(0,0)),!0}windowOptions(k){if(!T(k.params[0],this._optionsService.rawOptions.windowOptions))return!0;const O=k.length>1?k.params[1]:0;switch(k.params[0]){case 14:O!==2&&this._onRequestWindowsOptionsReport.fire(D.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(D.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${d.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:O!==0&&O!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),O!==0&&O!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:O!==0&&O!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),O!==0&&O!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(k){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(k){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(k){return this._windowTitle=k,this._onTitleChange.fire(k),!0}setIconName(k){return this._iconName=k,!0}setOrReportIndexedColor(k){const O=[],I=k.split(";");for(;I.length>1;){const P=I.shift(),V=I.shift();if(/^\d+$/.exec(P)){const te=parseInt(P);if(0<=te&&te<256)if(V==="?")O.push({type:0,index:te});else{const he=(0,p.parseColor)(V);he&&O.push({type:1,index:te,color:he})}}}return O.length&&this._onColor.fire(O),!0}setHyperlink(k){const O=k.split(";");return!(O.length<2)&&(O[1]?this._createHyperlink(O[0],O[1]):!O[0]&&this._finishHyperlink())}_createHyperlink(k,O){this._getCurrentLinkId()&&this._finishHyperlink();const I=k.split(":");let P;const V=I.findIndex(te=>te.startsWith("id="));return V!==-1&&(P=I[V].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:O}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(k,O){const I=k.split(";");for(let P=0;P<I.length&&!(O>=this._specialColors.length);++P,++O)if(I[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[O]}]);else{const V=(0,p.parseColor)(I[P]);V&&this._onColor.fire([{type:1,index:this._specialColors[O],color:V}])}return!0}setOrReportFgColor(k){return this._setOrReportSpecialColor(k,0)}setOrReportBgColor(k){return this._setOrReportSpecialColor(k,1)}setOrReportCursorColor(k){return this._setOrReportSpecialColor(k,2)}restoreIndexedColor(k){if(!k)return this._onColor.fire([{type:2}]),!0;const O=[],I=k.split(";");for(let P=0;P<I.length;++P)if(/^\d+$/.exec(I[P])){const V=parseInt(I[P]);0<=V&&V<256&&O.push({type:2,index:V})}return O.length&&this._onColor.fire(O),!0}restoreFgColor(k){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(k){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(k){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,u.DEFAULT_CHARSET),!0}selectCharset(k){return k.length!==2?(this.selectDefaultCharset(),!0):(k[0]==="/"||this._charsetService.setgCharset(y[k[0]],u.CHARSETS[k[1]]||u.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const k=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,k,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(k){return this._charsetService.setgLevel(k),!0}screenAlignmentPattern(){const k=new s.CellData;k.content=4194304|"E".charCodeAt(0),k.fg=this._curAttrData.fg,k.bg=this._curAttrData.bg,this._setCursor(0,0);for(let O=0;O<this._bufferService.rows;++O){const I=this._activeBuffer.ybase+this._activeBuffer.y+O,P=this._activeBuffer.lines.get(I);P&&(P.fill(k),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(k,O){const I=this._bufferService.buffer,P=this._optionsService.rawOptions;return(V=>(this._coreService.triggerDataEvent(`${d.C0.ESC}${V}${d.C0.ESC}\\`),!0))(k==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:k==='"p'?'P1$r61;1"p':k==="r"?`P1$r${I.scrollTop+1};${I.scrollBottom+1}r`:k==="m"?"P1$r0m":k===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(k,O){this._dirtyRowTracker.markRangeDirty(k,O)}}c.InputHandler=H;let A=class{constructor(F){this._bufferService=F,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(F){F<this.start?this.start=F:F>this.end&&(this.end=F)}markRangeDirty(F,k){F>k&&(B=F,F=k,k=B),F<this.start&&(this.start=F),k>this.end&&(this.end=k)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};A=m([g(0,f.IBufferService)],A)},844:(K,c)=>{function w(m){for(const g of m)g.dispose();m.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const m of this._disposables)m.dispose();this._disposables.length=0}register(m){return this._disposables.push(m),m}unregister(m){const g=this._disposables.indexOf(m);g!==-1&&this._disposables.splice(g,1)}},c.toDisposable=function(m){return{dispose:m}},c.disposeArray=w,c.getDisposeArrayDisposable=function(m){return{dispose:()=>w(m)}}},1505:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class w{constructor(){this._data={}}set(g,d,u){this._data[g]||(this._data[g]={}),this._data[g][d]=u}get(g,d){return this._data[g]?this._data[g][d]:void 0}clear(){this._data={}}}c.TwoKeyMap=w,c.FourKeyMap=class{constructor(){this._data=new w}set(m,g,d,u,b){this._data.get(m,g)||this._data.set(m,g,new w),this._data.get(m,g).set(d,u,b)}get(m,g,d,u){var b;return(b=this._data.get(m,g))===null||b===void 0?void 0:b.get(d,u)}clear(){this._data.clear()}}},6114:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof navigator>"u";const w=c.isNode?"node":navigator.userAgent,m=c.isNode?"node":navigator.platform;c.isFirefox=w.includes("Firefox"),c.isLegacyEdge=w.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(w),c.getSafariVersion=function(){if(!c.isSafari)return 0;const g=w.match(/Version\/(\d+)/);return g===null||g.length<2?0:parseInt(g[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(m),c.isIpad=m==="iPad",c.isIphone=m==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(m),c.isLinux=m.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(w)},6106:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SortedList=void 0;let w=0;c.SortedList=class{constructor(m){this._getKey=m,this._array=[]}clear(){this._array.length=0}insert(m){this._array.length!==0?(w=this._search(this._getKey(m),0,this._array.length-1),this._array.splice(w,0,m)):this._array.push(m)}delete(m){if(this._array.length===0)return!1;const g=this._getKey(m);if(g===void 0||(w=this._search(g,0,this._array.length-1),w===-1)||this._getKey(this._array[w])!==g)return!1;do if(this._array[w]===m)return this._array.splice(w,1),!0;while(++w<this._array.length&&this._getKey(this._array[w])===g);return!1}*getKeyIterator(m){if(this._array.length!==0&&(w=this._search(m,0,this._array.length-1),!(w<0||w>=this._array.length)&&this._getKey(this._array[w])===m))do yield this._array[w];while(++w<this._array.length&&this._getKey(this._array[w])===m)}forEachByKey(m,g){if(this._array.length!==0&&(w=this._search(m,0,this._array.length-1),!(w<0||w>=this._array.length)&&this._getKey(this._array[w])===m))do g(this._array[w]);while(++w<this._array.length&&this._getKey(this._array[w])===m)}values(){return this._array.values()}_search(m,g,d){if(d<g)return g;let u=Math.floor((g+d)/2);const b=this._getKey(this._array[u]);if(b>m)return this._search(m,g,u-1);if(b<m)return this._search(m,u+1,d);for(;u>0&&this._getKey(this._array[u-1])===m;)u--;return u}}},7226:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const m=w(6114);class g{constructor(){this._tasks=[],this._i=0}enqueue(b){this._tasks.push(b),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(b){this._idleCallback=void 0;let v=0,a=0,i=b.timeRemaining(),h=0;for(;this._i<this._tasks.length;){if(v=Date.now(),this._tasks[this._i]()||this._i++,v=Math.max(1,Date.now()-v),a=Math.max(v,a),h=b.timeRemaining(),1.5*a>h)return i-v<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(i-v))}ms`),void this._start();i=h}this.clear()}}class d extends g{_requestCallback(b){return setTimeout(()=>b(this._createDeadline(16)))}_cancelCallback(b){clearTimeout(b)}_createDeadline(b){const v=Date.now()+b;return{timeRemaining:()=>Math.max(0,v-Date.now())}}}c.PriorityTaskQueue=d,c.IdleTaskQueue=!m.isNode&&"requestIdleCallback"in window?class extends g{_requestCallback(u){return requestIdleCallback(u)}_cancelCallback(u){cancelIdleCallback(u)}}:d,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(u){this._queue.clear(),this._queue.enqueue(u)}flush(){this._queue.flush()}}},9282:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.updateWindowsModeWrappedState=void 0;const m=w(643);c.updateWindowsModeWrappedState=function(g){const d=g.buffer.lines.get(g.buffer.ybase+g.buffer.y-1),u=d==null?void 0:d.get(g.cols-1),b=g.buffer.lines.get(g.buffer.ybase+g.buffer.y);b&&u&&(b.isWrapped=u[m.CHAR_DATA_CODE_INDEX]!==m.NULL_CELL_CODE&&u[m.CHAR_DATA_CODE_INDEX]!==m.WHITESPACE_CELL_CODE)}},3734:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class w{constructor(){this.fg=0,this.bg=0,this.extended=new m}static toColorRGB(d){return[d>>>16&255,d>>>8&255,255&d]}static fromColorRGB(d){return(255&d[0])<<16|(255&d[1])<<8|255&d[2]}clone(){const d=new w;return d.fg=this.fg,d.bg=this.bg,d.extended=this.extended.clone(),d}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}c.AttributeData=w;class m{constructor(d=0,u=0){this._ext=0,this._urlId=0,this._ext=d,this._urlId=u}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(d){this._ext=d}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(d){this._ext&=-469762049,this._ext|=d<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(d){this._ext&=-67108864,this._ext|=67108863&d}get urlId(){return this._urlId}set urlId(d){this._urlId=d}clone(){return new m(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=m},9092:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Buffer=c.MAX_BUFFER_SIZE=void 0;const m=w(6349),g=w(8437),d=w(511),u=w(643),b=w(4634),v=w(4863),a=w(7116),i=w(3734),h=w(7226);c.MAX_BUFFER_SIZE=4294967295,c.Buffer=class{constructor(r,s,l){this._hasScrollback=r,this._optionsService=s,this._bufferService=l,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=g.DEFAULT_ATTR_DATA.clone(),this.savedCharset=a.DEFAULT_CHARSET,this.markers=[],this._nullCell=d.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]),this._whitespaceCell=d.CellData.fromCharData([0,u.WHITESPACE_CELL_CHAR,u.WHITESPACE_CELL_WIDTH,u.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new h.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new m.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(r){return r?(this._nullCell.fg=r.fg,this._nullCell.bg=r.bg,this._nullCell.extended=r.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new i.ExtendedAttrs),this._nullCell}getWhitespaceCell(r){return r?(this._whitespaceCell.fg=r.fg,this._whitespaceCell.bg=r.bg,this._whitespaceCell.extended=r.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new i.ExtendedAttrs),this._whitespaceCell}getBlankLine(r,s){return new g.BufferLine(this._bufferService.cols,this.getNullCell(r),s)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const r=this.ybase+this.y-this.ydisp;return r>=0&&r<this._rows}_getCorrectBufferLength(r){if(!this._hasScrollback)return r;const s=r+this._optionsService.rawOptions.scrollback;return s>c.MAX_BUFFER_SIZE?c.MAX_BUFFER_SIZE:s}fillViewportRows(r){if(this.lines.length===0){r===void 0&&(r=g.DEFAULT_ATTR_DATA);let s=this._rows;for(;s--;)this.lines.push(this.getBlankLine(r))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new m.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(r,s){const l=this.getNullCell(g.DEFAULT_ATTR_DATA);let f=0;const _=this._getCorrectBufferLength(s);if(_>this.lines.maxLength&&(this.lines.maxLength=_),this.lines.length>0){if(this._cols<r)for(let p=0;p<this.lines.length;p++)f+=+this.lines.get(p).resize(r,l);let C=0;if(this._rows<s)for(let p=this._rows;p<s;p++)this.lines.length<s+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new g.BufferLine(r,l)):this.ybase>0&&this.lines.length<=this.ybase+this.y+C+1?(this.ybase--,C++,this.ydisp>0&&this.ydisp--):this.lines.push(new g.BufferLine(r,l)));else for(let p=this._rows;p>s;p--)this.lines.length>s+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(_<this.lines.maxLength){const p=this.lines.length-_;p>0&&(this.lines.trimStart(p),this.ybase=Math.max(this.ybase-p,0),this.ydisp=Math.max(this.ydisp-p,0),this.savedY=Math.max(this.savedY-p,0)),this.lines.maxLength=_}this.x=Math.min(this.x,r-1),this.y=Math.min(this.y,s-1),C&&(this.y+=C),this.savedX=Math.min(this.savedX,r-1),this.scrollTop=0}if(this.scrollBottom=s-1,this._isReflowEnabled&&(this._reflow(r,s),this._cols>r))for(let C=0;C<this.lines.length;C++)f+=+this.lines.get(C).resize(r,l);this._cols=r,this._rows=s,this._memoryCleanupQueue.clear(),f>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let r=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,r=!1);let s=0;for(;this._memoryCleanupPosition<this.lines.length;)if(s+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),s>100)return!0;return r}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(r,s){this._cols!==r&&(r>this._cols?this._reflowLarger(r,s):this._reflowSmaller(r,s))}_reflowLarger(r,s){const l=(0,b.reflowLargerGetLinesToRemove)(this.lines,this._cols,r,this.ybase+this.y,this.getNullCell(g.DEFAULT_ATTR_DATA));if(l.length>0){const f=(0,b.reflowLargerCreateNewLayout)(this.lines,l);(0,b.reflowLargerApplyNewLayout)(this.lines,f.layout),this._reflowLargerAdjustViewport(r,s,f.countRemoved)}}_reflowLargerAdjustViewport(r,s,l){const f=this.getNullCell(g.DEFAULT_ATTR_DATA);let _=l;for(;_-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<s&&this.lines.push(new g.BufferLine(r,f))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-l,0)}_reflowSmaller(r,s){const l=this.getNullCell(g.DEFAULT_ATTR_DATA),f=[];let _=0;for(let C=this.lines.length-1;C>=0;C--){let p=this.lines.get(C);if(!p||!p.isWrapped&&p.getTrimmedLength()<=r)continue;const y=[p];for(;p.isWrapped&&C>0;)p=this.lines.get(--C),y.unshift(p);const L=this.ybase+this.y;if(L>=C&&L<C+y.length)continue;const T=y[y.length-1].getTrimmedLength(),D=(0,b.reflowSmallerGetNewLineLengths)(y,this._cols,r),B=D.length-y.length;let H;H=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+B):Math.max(0,this.lines.length-this.lines.maxLength+B);const A=[];for(let V=0;V<B;V++){const te=this.getBlankLine(g.DEFAULT_ATTR_DATA,!0);A.push(te)}A.length>0&&(f.push({start:C+y.length+_,newLines:A}),_+=A.length),y.push(...A);let F=D.length-1,k=D[F];k===0&&(F--,k=D[F]);let O=y.length-B-1,I=T;for(;O>=0;){const V=Math.min(I,k);if(y[F]===void 0)break;if(y[F].copyCellsFrom(y[O],I-V,k-V,V,!0),k-=V,k===0&&(F--,k=D[F]),I-=V,I===0){O--;const te=Math.max(O,0);I=(0,b.getWrappedLineTrimmedLength)(y,te,this._cols)}}for(let V=0;V<y.length;V++)D[V]<r&&y[V].setCell(D[V],l);let P=B-H;for(;P-- >0;)this.ybase===0?this.y<s-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+_)-s&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+B,this.ybase+s-1)}if(f.length>0){const C=[],p=[];for(let F=0;F<this.lines.length;F++)p.push(this.lines.get(F));const y=this.lines.length;let L=y-1,T=0,D=f[T];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+_);let B=0;for(let F=Math.min(this.lines.maxLength-1,y+_-1);F>=0;F--)if(D&&D.start>L+B){for(let k=D.newLines.length-1;k>=0;k--)this.lines.set(F--,D.newLines[k]);F++,C.push({index:L+1,amount:D.newLines.length}),B+=D.newLines.length,D=f[++T]}else this.lines.set(F,p[L--]);let H=0;for(let F=C.length-1;F>=0;F--)C[F].index+=H,this.lines.onInsertEmitter.fire(C[F]),H+=C[F].amount;const A=Math.max(0,y+_-this.lines.maxLength);A>0&&this.lines.onTrimEmitter.fire(A)}}translateBufferLineToString(r,s,l=0,f){const _=this.lines.get(r);return _?_.translateToString(s,l,f):""}getWrappedRangeForLine(r){let s=r,l=r;for(;s>0&&this.lines.get(s).isWrapped;)s--;for(;l+1<this.lines.length&&this.lines.get(l+1).isWrapped;)l++;return{first:s,last:l}}setupTabStops(r){for(r!=null?this.tabs[r]||(r=this.prevStop(r)):(this.tabs={},r=0);r<this._cols;r+=this._optionsService.rawOptions.tabStopWidth)this.tabs[r]=!0}prevStop(r){for(r==null&&(r=this.x);!this.tabs[--r]&&r>0;);return r>=this._cols?this._cols-1:r<0?0:r}nextStop(r){for(r==null&&(r=this.x);!this.tabs[++r]&&r<this._cols;);return r>=this._cols?this._cols-1:r<0?0:r}clearMarkers(r){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].line===r&&(this.markers[s].dispose(),this.markers.splice(s--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].dispose(),this.markers.splice(r--,1);this._isClearing=!1}addMarker(r){const s=new v.Marker(r);return this.markers.push(s),s.register(this.lines.onTrim(l=>{s.line-=l,s.line<0&&s.dispose()})),s.register(this.lines.onInsert(l=>{s.line>=l.index&&(s.line+=l.amount)})),s.register(this.lines.onDelete(l=>{s.line>=l.index&&s.line<l.index+l.amount&&s.dispose(),s.line>l.index&&(s.line-=l.amount)})),s.register(s.onDispose(()=>this._removeMarker(s))),s}_removeMarker(r){this._isClearing||this.markers.splice(this.markers.indexOf(r),1)}}},8437:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLine=c.DEFAULT_ATTR_DATA=void 0;const m=w(482),g=w(643),d=w(511),u=w(3734);c.DEFAULT_ATTR_DATA=Object.freeze(new u.AttributeData);let b=0;class v{constructor(i,h,r=!1){this.isWrapped=r,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*i);const s=h||d.CellData.fromCharData([0,g.NULL_CELL_CHAR,g.NULL_CELL_WIDTH,g.NULL_CELL_CODE]);for(let l=0;l<i;++l)this.setCell(l,s);this.length=i}get(i){const h=this._data[3*i+0],r=2097151&h;return[this._data[3*i+1],2097152&h?this._combined[i]:r?(0,m.stringFromCodePoint)(r):"",h>>22,2097152&h?this._combined[i].charCodeAt(this._combined[i].length-1):r]}set(i,h){this._data[3*i+1]=h[g.CHAR_DATA_ATTR_INDEX],h[g.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[i]=h[1],this._data[3*i+0]=2097152|i|h[g.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*i+0]=h[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|h[g.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(i){return this._data[3*i+0]>>22}hasWidth(i){return 12582912&this._data[3*i+0]}getFg(i){return this._data[3*i+1]}getBg(i){return this._data[3*i+2]}hasContent(i){return 4194303&this._data[3*i+0]}getCodePoint(i){const h=this._data[3*i+0];return 2097152&h?this._combined[i].charCodeAt(this._combined[i].length-1):2097151&h}isCombined(i){return 2097152&this._data[3*i+0]}getString(i){const h=this._data[3*i+0];return 2097152&h?this._combined[i]:2097151&h?(0,m.stringFromCodePoint)(2097151&h):""}isProtected(i){return 536870912&this._data[3*i+2]}loadCell(i,h){return b=3*i,h.content=this._data[b+0],h.fg=this._data[b+1],h.bg=this._data[b+2],2097152&h.content&&(h.combinedData=this._combined[i]),268435456&h.bg&&(h.extended=this._extendedAttrs[i]),h}setCell(i,h){2097152&h.content&&(this._combined[i]=h.combinedData),268435456&h.bg&&(this._extendedAttrs[i]=h.extended),this._data[3*i+0]=h.content,this._data[3*i+1]=h.fg,this._data[3*i+2]=h.bg}setCellFromCodePoint(i,h,r,s,l,f){268435456&l&&(this._extendedAttrs[i]=f),this._data[3*i+0]=h|r<<22,this._data[3*i+1]=s,this._data[3*i+2]=l}addCodepointToCell(i,h){let r=this._data[3*i+0];2097152&r?this._combined[i]+=(0,m.stringFromCodePoint)(h):(2097151&r?(this._combined[i]=(0,m.stringFromCodePoint)(2097151&r)+(0,m.stringFromCodePoint)(h),r&=-2097152,r|=2097152):r=h|4194304,this._data[3*i+0]=r)}insertCells(i,h,r,s){if((i%=this.length)&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,(s==null?void 0:s.fg)||0,(s==null?void 0:s.bg)||0,(s==null?void 0:s.extended)||new u.ExtendedAttrs),h<this.length-i){const l=new d.CellData;for(let f=this.length-i-h-1;f>=0;--f)this.setCell(i+h+f,this.loadCell(i+f,l));for(let f=0;f<h;++f)this.setCell(i+f,r)}else for(let l=i;l<this.length;++l)this.setCell(l,r);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(s==null?void 0:s.fg)||0,(s==null?void 0:s.bg)||0,(s==null?void 0:s.extended)||new u.ExtendedAttrs)}deleteCells(i,h,r,s){if(i%=this.length,h<this.length-i){const l=new d.CellData;for(let f=0;f<this.length-i-h;++f)this.setCell(i+f,this.loadCell(i+h+f,l));for(let f=this.length-h;f<this.length;++f)this.setCell(f,r)}else for(let l=i;l<this.length;++l)this.setCell(l,r);i&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,(s==null?void 0:s.fg)||0,(s==null?void 0:s.bg)||0,(s==null?void 0:s.extended)||new u.ExtendedAttrs),this.getWidth(i)!==0||this.hasContent(i)||this.setCellFromCodePoint(i,0,1,(s==null?void 0:s.fg)||0,(s==null?void 0:s.bg)||0,(s==null?void 0:s.extended)||new u.ExtendedAttrs)}replaceCells(i,h,r,s,l=!1){if(l)for(i&&this.getWidth(i-1)===2&&!this.isProtected(i-1)&&this.setCellFromCodePoint(i-1,0,1,(s==null?void 0:s.fg)||0,(s==null?void 0:s.bg)||0,(s==null?void 0:s.extended)||new u.ExtendedAttrs),h<this.length&&this.getWidth(h-1)===2&&!this.isProtected(h)&&this.setCellFromCodePoint(h,0,1,(s==null?void 0:s.fg)||0,(s==null?void 0:s.bg)||0,(s==null?void 0:s.extended)||new u.ExtendedAttrs);i<h&&i<this.length;)this.isProtected(i)||this.setCell(i,r),i++;else for(i&&this.getWidth(i-1)===2&&this.setCellFromCodePoint(i-1,0,1,(s==null?void 0:s.fg)||0,(s==null?void 0:s.bg)||0,(s==null?void 0:s.extended)||new u.ExtendedAttrs),h<this.length&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h,0,1,(s==null?void 0:s.fg)||0,(s==null?void 0:s.bg)||0,(s==null?void 0:s.extended)||new u.ExtendedAttrs);i<h&&i<this.length;)this.setCell(i++,r)}resize(i,h){if(i===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const r=3*i;if(i>this.length){if(this._data.buffer.byteLength>=4*r)this._data=new Uint32Array(this._data.buffer,0,r);else{const s=new Uint32Array(r);s.set(this._data),this._data=s}for(let s=this.length;s<i;++s)this.setCell(s,h)}else{this._data=this._data.subarray(0,r);const s=Object.keys(this._combined);for(let f=0;f<s.length;f++){const _=parseInt(s[f],10);_>=i&&delete this._combined[_]}const l=Object.keys(this._extendedAttrs);for(let f=0;f<l.length;f++){const _=parseInt(l[f],10);_>=i&&delete this._extendedAttrs[_]}}return this.length=i,4*r*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const i=new Uint32Array(this._data.length);return i.set(this._data),this._data=i,1}return 0}fill(i,h=!1){if(h)for(let r=0;r<this.length;++r)this.isProtected(r)||this.setCell(r,i);else{this._combined={},this._extendedAttrs={};for(let r=0;r<this.length;++r)this.setCell(r,i)}}copyFrom(i){this.length!==i.length?this._data=new Uint32Array(i._data):this._data.set(i._data),this.length=i.length,this._combined={};for(const h in i._combined)this._combined[h]=i._combined[h];this._extendedAttrs={};for(const h in i._extendedAttrs)this._extendedAttrs[h]=i._extendedAttrs[h];this.isWrapped=i.isWrapped}clone(){const i=new v(0);i._data=new Uint32Array(this._data),i.length=this.length;for(const h in this._combined)i._combined[h]=this._combined[h];for(const h in this._extendedAttrs)i._extendedAttrs[h]=this._extendedAttrs[h];return i.isWrapped=this.isWrapped,i}getTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(4194303&this._data[3*i+0])return i+(this._data[3*i+0]>>22);return 0}copyCellsFrom(i,h,r,s,l){const f=i._data;if(l)for(let C=s-1;C>=0;C--){for(let p=0;p<3;p++)this._data[3*(r+C)+p]=f[3*(h+C)+p];268435456&f[3*(h+C)+2]&&(this._extendedAttrs[r+C]=i._extendedAttrs[h+C])}else for(let C=0;C<s;C++){for(let p=0;p<3;p++)this._data[3*(r+C)+p]=f[3*(h+C)+p];268435456&f[3*(h+C)+2]&&(this._extendedAttrs[r+C]=i._extendedAttrs[h+C])}const _=Object.keys(i._combined);for(let C=0;C<_.length;C++){const p=parseInt(_[C],10);p>=h&&(this._combined[p-h+r]=i._combined[p])}}translateToString(i=!1,h=0,r=this.length){i&&(r=Math.min(r,this.getTrimmedLength()));let s="";for(;h<r;){const l=this._data[3*h+0],f=2097151&l;s+=2097152&l?this._combined[h]:f?(0,m.stringFromCodePoint)(f):g.WHITESPACE_CELL_CHAR,h+=l>>22||1}return s}}c.BufferLine=v},4841:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getRangeLength=void 0,c.getRangeLength=function(w,m){if(w.start.y>w.end.y)throw new Error(`Buffer range end (${w.end.x}, ${w.end.y}) cannot be before start (${w.start.x}, ${w.start.y})`);return m*(w.end.y-w.start.y)+(w.end.x-w.start.x+1)}},4634:(K,c)=>{function w(m,g,d){if(g===m.length-1)return m[g].getTrimmedLength();const u=!m[g].hasContent(d-1)&&m[g].getWidth(d-1)===1,b=m[g+1].getWidth(0)===2;return u&&b?d-1:d}Object.defineProperty(c,"__esModule",{value:!0}),c.getWrappedLineTrimmedLength=c.reflowSmallerGetNewLineLengths=c.reflowLargerApplyNewLayout=c.reflowLargerCreateNewLayout=c.reflowLargerGetLinesToRemove=void 0,c.reflowLargerGetLinesToRemove=function(m,g,d,u,b){const v=[];for(let a=0;a<m.length-1;a++){let i=a,h=m.get(++i);if(!h.isWrapped)continue;const r=[m.get(a)];for(;i<m.length&&h.isWrapped;)r.push(h),h=m.get(++i);if(u>=a&&u<i){a+=r.length-1;continue}let s=0,l=w(r,s,g),f=1,_=0;for(;f<r.length;){const p=w(r,f,g),y=p-_,L=d-l,T=Math.min(y,L);r[s].copyCellsFrom(r[f],_,l,T,!1),l+=T,l===d&&(s++,l=0),_+=T,_===p&&(f++,_=0),l===0&&s!==0&&r[s-1].getWidth(d-1)===2&&(r[s].copyCellsFrom(r[s-1],d-1,l++,1,!1),r[s-1].setCell(d-1,b))}r[s].replaceCells(l,d,b);let C=0;for(let p=r.length-1;p>0&&(p>s||r[p].getTrimmedLength()===0);p--)C++;C>0&&(v.push(a+r.length-C),v.push(C)),a+=r.length-1}return v},c.reflowLargerCreateNewLayout=function(m,g){const d=[];let u=0,b=g[u],v=0;for(let a=0;a<m.length;a++)if(b===a){const i=g[++u];m.onDeleteEmitter.fire({index:a-v,amount:i}),a+=i-1,v+=i,b=g[++u]}else d.push(a);return{layout:d,countRemoved:v}},c.reflowLargerApplyNewLayout=function(m,g){const d=[];for(let u=0;u<g.length;u++)d.push(m.get(g[u]));for(let u=0;u<d.length;u++)m.set(u,d[u]);m.length=g.length},c.reflowSmallerGetNewLineLengths=function(m,g,d){const u=[],b=m.map((h,r)=>w(m,r,g)).reduce((h,r)=>h+r);let v=0,a=0,i=0;for(;i<b;){if(b-i<d){u.push(b-i);break}v+=d;const h=w(m,a,g);v>h&&(v-=h,a++);const r=m[a].getWidth(v-1)===2;r&&v--;const s=r?d-1:d;u.push(s),i+=s}return u},c.getWrappedLineTrimmedLength=w},5295:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferSet=void 0;const m=w(9092),g=w(8460),d=w(844);class u extends d.Disposable{constructor(v,a){super(),this._optionsService=v,this._bufferService=a,this._onBufferActivate=this.register(new g.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new m.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new m.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(v){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(v),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(v,a){this._normal.resize(v,a),this._alt.resize(v,a),this.setupTabStops(v)}setupTabStops(v){this._normal.setupTabStops(v),this._alt.setupTabStops(v)}}c.BufferSet=u},511:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const m=w(482),g=w(643),d=w(3734);class u extends d.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new d.ExtendedAttrs,this.combinedData=""}static fromCharData(v){const a=new u;return a.setFromCharData(v),a}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,m.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(v){this.fg=v[g.CHAR_DATA_ATTR_INDEX],this.bg=0;let a=!1;if(v[g.CHAR_DATA_CHAR_INDEX].length>2)a=!0;else if(v[g.CHAR_DATA_CHAR_INDEX].length===2){const i=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){const h=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=h&&h<=57343?this.content=1024*(i-55296)+h-56320+65536|v[g.CHAR_DATA_WIDTH_INDEX]<<22:a=!0}else a=!0}else this.content=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[g.CHAR_DATA_WIDTH_INDEX]<<22;a&&(this.combinedData=v[g.CHAR_DATA_CHAR_INDEX],this.content=2097152|v[g.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=u},643:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},4863:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Marker=void 0;const m=w(8460),g=w(844);class d{constructor(b){this.line=b,this.isDisposed=!1,this._disposables=[],this._id=d._nextId++,this._onDispose=this.register(new m.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,g.disposeArray)(this._disposables),this._disposables.length=0)}register(b){return this._disposables.push(b),b}}c.Marker=d,d._nextId=1},7116:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_CHARSET=c.CHARSETS=void 0,c.CHARSETS={},c.DEFAULT_CHARSET=c.CHARSETS.B,c.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},c.CHARSETS.A={"#":""},c.CHARSETS.B=void 0,c.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},c.CHARSETS.C=c.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.E=c.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},c.CHARSETS.H=c.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(K,c)=>{var w,m;Object.defineProperty(c,"__esModule",{value:!0}),c.C1_ESCAPED=c.C1=c.C0=void 0,function(g){g.NUL="\0",g.SOH="",g.STX="",g.ETX="",g.EOT="",g.ENQ="",g.ACK="",g.BEL="\x07",g.BS="\b",g.HT="	",g.LF=`
`,g.VT="\v",g.FF="\f",g.CR="\r",g.SO="",g.SI="",g.DLE="",g.DC1="",g.DC2="",g.DC3="",g.DC4="",g.NAK="",g.SYN="",g.ETB="",g.CAN="",g.EM="",g.SUB="",g.ESC="\x1B",g.FS="",g.GS="",g.RS="",g.US="",g.SP=" ",g.DEL=""}(w=c.C0||(c.C0={})),(m=c.C1||(c.C1={})).PAD="",m.HOP="",m.BPH="",m.NBH="",m.IND="",m.NEL="",m.SSA="",m.ESA="",m.HTS="",m.HTJ="",m.VTS="",m.PLD="",m.PLU="",m.RI="",m.SS2="",m.SS3="",m.DCS="",m.PU1="",m.PU2="",m.STS="",m.CCH="",m.MW="",m.SPA="",m.EPA="",m.SOS="",m.SGCI="",m.SCI="",m.CSI="",m.ST="",m.OSC="",m.PM="",m.APC="",(c.C1_ESCAPED||(c.C1_ESCAPED={})).ST=`${w.ESC}\\`},7399:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.evaluateKeyboardEvent=void 0;const m=w(2584),g={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};c.evaluateKeyboardEvent=function(d,u,b,v){const a={type:0,cancel:!1,key:void 0},i=(d.shiftKey?1:0)|(d.altKey?2:0)|(d.ctrlKey?4:0)|(d.metaKey?8:0);switch(d.keyCode){case 0:d.key==="UIKeyInputUpArrow"?a.key=u?m.C0.ESC+"OA":m.C0.ESC+"[A":d.key==="UIKeyInputLeftArrow"?a.key=u?m.C0.ESC+"OD":m.C0.ESC+"[D":d.key==="UIKeyInputRightArrow"?a.key=u?m.C0.ESC+"OC":m.C0.ESC+"[C":d.key==="UIKeyInputDownArrow"&&(a.key=u?m.C0.ESC+"OB":m.C0.ESC+"[B");break;case 8:if(d.altKey){a.key=m.C0.ESC+m.C0.DEL;break}a.key=m.C0.DEL;break;case 9:if(d.shiftKey){a.key=m.C0.ESC+"[Z";break}a.key=m.C0.HT,a.cancel=!0;break;case 13:a.key=d.altKey?m.C0.ESC+m.C0.CR:m.C0.CR,a.cancel=!0;break;case 27:a.key=m.C0.ESC,d.altKey&&(a.key=m.C0.ESC+m.C0.ESC),a.cancel=!0;break;case 37:if(d.metaKey)break;i?(a.key=m.C0.ESC+"[1;"+(i+1)+"D",a.key===m.C0.ESC+"[1;3D"&&(a.key=m.C0.ESC+(b?"b":"[1;5D"))):a.key=u?m.C0.ESC+"OD":m.C0.ESC+"[D";break;case 39:if(d.metaKey)break;i?(a.key=m.C0.ESC+"[1;"+(i+1)+"C",a.key===m.C0.ESC+"[1;3C"&&(a.key=m.C0.ESC+(b?"f":"[1;5C"))):a.key=u?m.C0.ESC+"OC":m.C0.ESC+"[C";break;case 38:if(d.metaKey)break;i?(a.key=m.C0.ESC+"[1;"+(i+1)+"A",b||a.key!==m.C0.ESC+"[1;3A"||(a.key=m.C0.ESC+"[1;5A")):a.key=u?m.C0.ESC+"OA":m.C0.ESC+"[A";break;case 40:if(d.metaKey)break;i?(a.key=m.C0.ESC+"[1;"+(i+1)+"B",b||a.key!==m.C0.ESC+"[1;3B"||(a.key=m.C0.ESC+"[1;5B")):a.key=u?m.C0.ESC+"OB":m.C0.ESC+"[B";break;case 45:d.shiftKey||d.ctrlKey||(a.key=m.C0.ESC+"[2~");break;case 46:a.key=i?m.C0.ESC+"[3;"+(i+1)+"~":m.C0.ESC+"[3~";break;case 36:a.key=i?m.C0.ESC+"[1;"+(i+1)+"H":u?m.C0.ESC+"OH":m.C0.ESC+"[H";break;case 35:a.key=i?m.C0.ESC+"[1;"+(i+1)+"F":u?m.C0.ESC+"OF":m.C0.ESC+"[F";break;case 33:d.shiftKey?a.type=2:d.ctrlKey?a.key=m.C0.ESC+"[5;"+(i+1)+"~":a.key=m.C0.ESC+"[5~";break;case 34:d.shiftKey?a.type=3:d.ctrlKey?a.key=m.C0.ESC+"[6;"+(i+1)+"~":a.key=m.C0.ESC+"[6~";break;case 112:a.key=i?m.C0.ESC+"[1;"+(i+1)+"P":m.C0.ESC+"OP";break;case 113:a.key=i?m.C0.ESC+"[1;"+(i+1)+"Q":m.C0.ESC+"OQ";break;case 114:a.key=i?m.C0.ESC+"[1;"+(i+1)+"R":m.C0.ESC+"OR";break;case 115:a.key=i?m.C0.ESC+"[1;"+(i+1)+"S":m.C0.ESC+"OS";break;case 116:a.key=i?m.C0.ESC+"[15;"+(i+1)+"~":m.C0.ESC+"[15~";break;case 117:a.key=i?m.C0.ESC+"[17;"+(i+1)+"~":m.C0.ESC+"[17~";break;case 118:a.key=i?m.C0.ESC+"[18;"+(i+1)+"~":m.C0.ESC+"[18~";break;case 119:a.key=i?m.C0.ESC+"[19;"+(i+1)+"~":m.C0.ESC+"[19~";break;case 120:a.key=i?m.C0.ESC+"[20;"+(i+1)+"~":m.C0.ESC+"[20~";break;case 121:a.key=i?m.C0.ESC+"[21;"+(i+1)+"~":m.C0.ESC+"[21~";break;case 122:a.key=i?m.C0.ESC+"[23;"+(i+1)+"~":m.C0.ESC+"[23~";break;case 123:a.key=i?m.C0.ESC+"[24;"+(i+1)+"~":m.C0.ESC+"[24~";break;default:if(!d.ctrlKey||d.shiftKey||d.altKey||d.metaKey)if(b&&!v||!d.altKey||d.metaKey)!b||d.altKey||d.ctrlKey||d.shiftKey||!d.metaKey?d.key&&!d.ctrlKey&&!d.altKey&&!d.metaKey&&d.keyCode>=48&&d.key.length===1?a.key=d.key:d.key&&d.ctrlKey&&(d.key==="_"&&(a.key=m.C0.US),d.key==="@"&&(a.key=m.C0.NUL)):d.keyCode===65&&(a.type=1);else{const h=g[d.keyCode],r=h==null?void 0:h[d.shiftKey?1:0];if(r)a.key=m.C0.ESC+r;else if(d.keyCode>=65&&d.keyCode<=90){const s=d.ctrlKey?d.keyCode-64:d.keyCode+32;let l=String.fromCharCode(s);d.shiftKey&&(l=l.toUpperCase()),a.key=m.C0.ESC+l}else if(d.keyCode===32)a.key=m.C0.ESC+(d.ctrlKey?m.C0.NUL:" ");else if(d.key==="Dead"&&d.code.startsWith("Key")){let s=d.code.slice(3,4);d.shiftKey||(s=s.toLowerCase()),a.key=m.C0.ESC+s,a.cancel=!0}}else d.keyCode>=65&&d.keyCode<=90?a.key=String.fromCharCode(d.keyCode-64):d.keyCode===32?a.key=m.C0.NUL:d.keyCode>=51&&d.keyCode<=55?a.key=String.fromCharCode(d.keyCode-51+27):d.keyCode===56?a.key=m.C0.DEL:d.keyCode===219?a.key=m.C0.ESC:d.keyCode===220?a.key=m.C0.FS:d.keyCode===221&&(a.key=m.C0.GS)}return a}},482:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(w){return w>65535?(w-=65536,String.fromCharCode(55296+(w>>10))+String.fromCharCode(w%1024+56320)):String.fromCharCode(w)},c.utf32ToString=function(w,m=0,g=w.length){let d="";for(let u=m;u<g;++u){let b=w[u];b>65535?(b-=65536,d+=String.fromCharCode(55296+(b>>10))+String.fromCharCode(b%1024+56320)):d+=String.fromCharCode(b)}return d},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(w,m){const g=w.length;if(!g)return 0;let d=0,u=0;if(this._interim){const b=w.charCodeAt(u++);56320<=b&&b<=57343?m[d++]=1024*(this._interim-55296)+b-56320+65536:(m[d++]=this._interim,m[d++]=b),this._interim=0}for(let b=u;b<g;++b){const v=w.charCodeAt(b);if(55296<=v&&v<=56319){if(++b>=g)return this._interim=v,d;const a=w.charCodeAt(b);56320<=a&&a<=57343?m[d++]=1024*(v-55296)+a-56320+65536:(m[d++]=v,m[d++]=a)}else v!==65279&&(m[d++]=v)}return d}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(w,m){const g=w.length;if(!g)return 0;let d,u,b,v,a=0,i=0,h=0;if(this.interim[0]){let l=!1,f=this.interim[0];f&=(224&f)==192?31:(240&f)==224?15:7;let _,C=0;for(;(_=63&this.interim[++C])&&C<4;)f<<=6,f|=_;const p=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=p-C;for(;h<y;){if(h>=g)return 0;if(_=w[h++],(192&_)!=128){h--,l=!0;break}this.interim[C++]=_,f<<=6,f|=63&_}l||(p===2?f<128?h--:m[a++]=f:p===3?f<2048||f>=55296&&f<=57343||f===65279||(m[a++]=f):f<65536||f>1114111||(m[a++]=f)),this.interim.fill(0)}const r=g-4;let s=h;for(;s<g;){for(;!(!(s<r)||128&(d=w[s])||128&(u=w[s+1])||128&(b=w[s+2])||128&(v=w[s+3]));)m[a++]=d,m[a++]=u,m[a++]=b,m[a++]=v,s+=4;if(d=w[s++],d<128)m[a++]=d;else if((224&d)==192){if(s>=g)return this.interim[0]=d,a;if(u=w[s++],(192&u)!=128){s--;continue}if(i=(31&d)<<6|63&u,i<128){s--;continue}m[a++]=i}else if((240&d)==224){if(s>=g)return this.interim[0]=d,a;if(u=w[s++],(192&u)!=128){s--;continue}if(s>=g)return this.interim[0]=d,this.interim[1]=u,a;if(b=w[s++],(192&b)!=128){s--;continue}if(i=(15&d)<<12|(63&u)<<6|63&b,i<2048||i>=55296&&i<=57343||i===65279)continue;m[a++]=i}else if((248&d)==240){if(s>=g)return this.interim[0]=d,a;if(u=w[s++],(192&u)!=128){s--;continue}if(s>=g)return this.interim[0]=d,this.interim[1]=u,a;if(b=w[s++],(192&b)!=128){s--;continue}if(s>=g)return this.interim[0]=d,this.interim[1]=u,this.interim[2]=b,a;if(v=w[s++],(192&v)!=128){s--;continue}if(i=(7&d)<<18|(63&u)<<12|(63&b)<<6|63&v,i<65536||i>1114111)continue;m[a++]=i}}return a}}},225:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeV6=void 0;const w=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],m=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let g;c.UnicodeV6=class{constructor(){if(this.version="6",!g){g=new Uint8Array(65536),g.fill(1),g[0]=0,g.fill(0,1,32),g.fill(0,127,160),g.fill(2,4352,4448),g[9001]=2,g[9002]=2,g.fill(2,11904,42192),g[12351]=1,g.fill(2,44032,55204),g.fill(2,63744,64256),g.fill(2,65040,65050),g.fill(2,65072,65136),g.fill(2,65280,65377),g.fill(2,65504,65511);for(let d=0;d<w.length;++d)g.fill(0,w[d][0],w[d][1]+1)}}wcwidth(d){return d<32?0:d<127?1:d<65536?g[d]:function(u,b){let v,a=0,i=b.length-1;if(u<b[0][0]||u>b[i][1])return!1;for(;i>=a;)if(v=a+i>>1,u>b[v][1])a=v+1;else{if(!(u<b[v][0]))return!0;i=v-1}return!1}(d,m)?0:d>=131072&&d<=196605||d>=196608&&d<=262141?2:1}}},5981:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WriteBuffer=void 0;const m=w(8460),g=w(844);class d extends g.Disposable{constructor(b){super(),this._action=b,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new m.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(b,v){if(v!==void 0&&this._syncCalls>v)return void(this._syncCalls=0);if(this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let a;for(this._isSyncWriting=!0;a=this._writeBuffer.shift();){this._action(a);const i=this._callbacks.shift();i&&i()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(b,v){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(v),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=b.length,this._writeBuffer.push(b),this._callbacks.push(v)}_innerWrite(b=0,v=!0){const a=b||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const i=this._writeBuffer[this._bufferOffset],h=this._action(i,v);if(h){const s=l=>Date.now()-a>=12?setTimeout(()=>this._innerWrite(0,l)):this._innerWrite(a,l);return void h.catch(l=>(queueMicrotask(()=>{throw l}),Promise.resolve(!1))).then(s)}const r=this._callbacks[this._bufferOffset];if(r&&r(),this._bufferOffset++,this._pendingData-=i.length,Date.now()-a>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}c.WriteBuffer=d},5941:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.toRgbString=c.parseColor=void 0;const w=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,m=/^[\da-f]+$/;function g(d,u){const b=d.toString(16),v=b.length<2?"0"+b:b;switch(u){case 4:return b[0];case 8:return v;case 12:return(v+v).slice(0,3);default:return v+v}}c.parseColor=function(d){if(!d)return;let u=d.toLowerCase();if(u.indexOf("rgb:")===0){u=u.slice(4);const b=w.exec(u);if(b){const v=b[1]?15:b[4]?255:b[7]?4095:65535;return[Math.round(parseInt(b[1]||b[4]||b[7]||b[10],16)/v*255),Math.round(parseInt(b[2]||b[5]||b[8]||b[11],16)/v*255),Math.round(parseInt(b[3]||b[6]||b[9]||b[12],16)/v*255)]}}else if(u.indexOf("#")===0&&(u=u.slice(1),m.exec(u)&&[3,6,9,12].includes(u.length))){const b=u.length/3,v=[0,0,0];for(let a=0;a<3;++a){const i=parseInt(u.slice(b*a,b*a+b),16);v[a]=b===1?i<<4:b===2?i:b===3?i>>4:i>>8}return v}},c.toRgbString=function(d,u=16){const[b,v,a]=d;return`rgb:${g(b,u)}/${g(v,u)}/${g(a,u)}`}},5770:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PAYLOAD_LIMIT=void 0,c.PAYLOAD_LIMIT=1e7},6351:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DcsHandler=c.DcsParser=void 0;const m=w(482),g=w(8742),d=w(5770),u=[];c.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=u,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=u}registerHandler(v,a){this._handlers[v]===void 0&&(this._handlers[v]=[]);const i=this._handlers[v];return i.push(a),{dispose:()=>{const h=i.indexOf(a);h!==-1&&i.splice(h,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}reset(){if(this._active.length)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].unhook(!1);this._stack.paused=!1,this._active=u,this._ident=0}hook(v,a){if(this.reset(),this._ident=v,this._active=this._handlers[v]||u,this._active.length)for(let i=this._active.length-1;i>=0;i--)this._active[i].hook(a);else this._handlerFb(this._ident,"HOOK",a)}put(v,a,i){if(this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].put(v,a,i);else this._handlerFb(this._ident,"PUT",(0,m.utf32ToString)(v,a,i))}unhook(v,a=!0){if(this._active.length){let i=!1,h=this._active.length-1,r=!1;if(this._stack.paused&&(h=this._stack.loopPosition-1,i=a,r=this._stack.fallThrough,this._stack.paused=!1),!r&&i===!1){for(;h>=0&&(i=this._active[h].unhook(v),i!==!0);h--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!1,i;h--}for(;h>=0;h--)if(i=this._active[h].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",v);this._active=u,this._ident=0}};const b=new g.Params;b.addParam(0),c.DcsHandler=class{constructor(v){this._handler=v,this._data="",this._params=b,this._hitLimit=!1}hook(v){this._params=v.length>1||v.params[0]?v.clone():b,this._data="",this._hitLimit=!1}put(v,a,i){this._hitLimit||(this._data+=(0,m.utf32ToString)(v,a,i),this._data.length>d.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(v){let a=!1;if(this._hitLimit)a=!1;else if(v&&(a=this._handler(this._data,this._params),a instanceof Promise))return a.then(i=>(this._params=b,this._data="",this._hitLimit=!1,i));return this._params=b,this._data="",this._hitLimit=!1,a}}},2015:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EscapeSequenceParser=c.VT500_TRANSITION_TABLE=c.TransitionTable=void 0;const m=w(844),g=w(8742),d=w(6242),u=w(6351);class b{constructor(h){this.table=new Uint8Array(h)}setDefault(h,r){this.table.fill(h<<4|r)}add(h,r,s,l){this.table[r<<8|h]=s<<4|l}addMany(h,r,s,l){for(let f=0;f<h.length;f++)this.table[r<<8|h[f]]=s<<4|l}}c.TransitionTable=b;const v=160;c.VT500_TRANSITION_TABLE=function(){const i=new b(4095),h=Array.apply(null,Array(256)).map((C,p)=>p),r=(C,p)=>h.slice(C,p),s=r(32,127),l=r(0,24);l.push(25),l.push.apply(l,r(28,32));const f=r(0,14);let _;for(_ in i.setDefault(1,0),i.addMany(s,0,2,0),f)i.addMany([24,26,153,154],_,3,0),i.addMany(r(128,144),_,3,0),i.addMany(r(144,152),_,3,0),i.add(156,_,0,0),i.add(27,_,11,1),i.add(157,_,4,8),i.addMany([152,158,159],_,0,7),i.add(155,_,11,3),i.add(144,_,11,9);return i.addMany(l,0,3,0),i.addMany(l,1,3,1),i.add(127,1,0,1),i.addMany(l,8,0,8),i.addMany(l,3,3,3),i.add(127,3,0,3),i.addMany(l,4,3,4),i.add(127,4,0,4),i.addMany(l,6,3,6),i.addMany(l,5,3,5),i.add(127,5,0,5),i.addMany(l,2,3,2),i.add(127,2,0,2),i.add(93,1,4,8),i.addMany(s,8,5,8),i.add(127,8,5,8),i.addMany([156,27,24,26,7],8,6,0),i.addMany(r(28,32),8,0,8),i.addMany([88,94,95],1,0,7),i.addMany(s,7,0,7),i.addMany(l,7,0,7),i.add(156,7,0,0),i.add(127,7,0,7),i.add(91,1,11,3),i.addMany(r(64,127),3,7,0),i.addMany(r(48,60),3,8,4),i.addMany([60,61,62,63],3,9,4),i.addMany(r(48,60),4,8,4),i.addMany(r(64,127),4,7,0),i.addMany([60,61,62,63],4,0,6),i.addMany(r(32,64),6,0,6),i.add(127,6,0,6),i.addMany(r(64,127),6,0,0),i.addMany(r(32,48),3,9,5),i.addMany(r(32,48),5,9,5),i.addMany(r(48,64),5,0,6),i.addMany(r(64,127),5,7,0),i.addMany(r(32,48),4,9,5),i.addMany(r(32,48),1,9,2),i.addMany(r(32,48),2,9,2),i.addMany(r(48,127),2,10,0),i.addMany(r(48,80),1,10,0),i.addMany(r(81,88),1,10,0),i.addMany([89,90,92],1,10,0),i.addMany(r(96,127),1,10,0),i.add(80,1,11,9),i.addMany(l,9,0,9),i.add(127,9,0,9),i.addMany(r(28,32),9,0,9),i.addMany(r(32,48),9,9,12),i.addMany(r(48,60),9,8,10),i.addMany([60,61,62,63],9,9,10),i.addMany(l,11,0,11),i.addMany(r(32,128),11,0,11),i.addMany(r(28,32),11,0,11),i.addMany(l,10,0,10),i.add(127,10,0,10),i.addMany(r(28,32),10,0,10),i.addMany(r(48,60),10,8,10),i.addMany([60,61,62,63],10,0,11),i.addMany(r(32,48),10,9,12),i.addMany(l,12,0,12),i.add(127,12,0,12),i.addMany(r(28,32),12,0,12),i.addMany(r(32,48),12,9,12),i.addMany(r(48,64),12,0,11),i.addMany(r(64,127),12,12,13),i.addMany(r(64,127),10,12,13),i.addMany(r(64,127),9,12,13),i.addMany(l,13,13,13),i.addMany(s,13,13,13),i.add(127,13,0,13),i.addMany([27,156,24,26],13,14,0),i.add(v,0,2,0),i.add(v,8,5,8),i.add(v,6,0,6),i.add(v,11,0,11),i.add(v,13,13,13),i}();class a extends m.Disposable{constructor(h=c.VT500_TRANSITION_TABLE){super(),this._transitions=h,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new g.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(r,s,l)=>{},this._executeHandlerFb=r=>{},this._csiHandlerFb=(r,s)=>{},this._escHandlerFb=r=>{},this._errorHandlerFb=r=>r,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,m.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new d.OscParser),this._dcsParser=this.register(new u.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(h,r=[64,126]){let s=0;if(h.prefix){if(h.prefix.length>1)throw new Error("only one byte as prefix supported");if(s=h.prefix.charCodeAt(0),s&&60>s||s>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(h.intermediates){if(h.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let f=0;f<h.intermediates.length;++f){const _=h.intermediates.charCodeAt(f);if(32>_||_>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");s<<=8,s|=_}}if(h.final.length!==1)throw new Error("final must be a single byte");const l=h.final.charCodeAt(0);if(r[0]>l||l>r[1])throw new Error(`final must be in range ${r[0]} .. ${r[1]}`);return s<<=8,s|=l,s}identToString(h){const r=[];for(;h;)r.push(String.fromCharCode(255&h)),h>>=8;return r.reverse().join("")}setPrintHandler(h){this._printHandler=h}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(h,r){const s=this._identifier(h,[48,126]);this._escHandlers[s]===void 0&&(this._escHandlers[s]=[]);const l=this._escHandlers[s];return l.push(r),{dispose:()=>{const f=l.indexOf(r);f!==-1&&l.splice(f,1)}}}clearEscHandler(h){this._escHandlers[this._identifier(h,[48,126])]&&delete this._escHandlers[this._identifier(h,[48,126])]}setEscHandlerFallback(h){this._escHandlerFb=h}setExecuteHandler(h,r){this._executeHandlers[h.charCodeAt(0)]=r}clearExecuteHandler(h){this._executeHandlers[h.charCodeAt(0)]&&delete this._executeHandlers[h.charCodeAt(0)]}setExecuteHandlerFallback(h){this._executeHandlerFb=h}registerCsiHandler(h,r){const s=this._identifier(h);this._csiHandlers[s]===void 0&&(this._csiHandlers[s]=[]);const l=this._csiHandlers[s];return l.push(r),{dispose:()=>{const f=l.indexOf(r);f!==-1&&l.splice(f,1)}}}clearCsiHandler(h){this._csiHandlers[this._identifier(h)]&&delete this._csiHandlers[this._identifier(h)]}setCsiHandlerFallback(h){this._csiHandlerFb=h}registerDcsHandler(h,r){return this._dcsParser.registerHandler(this._identifier(h),r)}clearDcsHandler(h){this._dcsParser.clearHandler(this._identifier(h))}setDcsHandlerFallback(h){this._dcsParser.setHandlerFallback(h)}registerOscHandler(h,r){return this._oscParser.registerHandler(h,r)}clearOscHandler(h){this._oscParser.clearHandler(h)}setOscHandlerFallback(h){this._oscParser.setHandlerFallback(h)}setErrorHandler(h){this._errorHandler=h}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(h,r,s,l,f){this._parseStack.state=h,this._parseStack.handlers=r,this._parseStack.handlerPos=s,this._parseStack.transition=l,this._parseStack.chunkPos=f}parse(h,r,s){let l,f=0,_=0,C=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,C=this._parseStack.chunkPos+1;else{if(s===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const p=this._parseStack.handlers;let y=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(s===!1&&y>-1){for(;y>=0&&(l=p[y](this._params),l!==!0);y--)if(l instanceof Promise)return this._parseStack.handlerPos=y,l}this._parseStack.handlers=[];break;case 4:if(s===!1&&y>-1){for(;y>=0&&(l=p[y](),l!==!0);y--)if(l instanceof Promise)return this._parseStack.handlerPos=y,l}this._parseStack.handlers=[];break;case 6:if(f=h[this._parseStack.chunkPos],l=this._dcsParser.unhook(f!==24&&f!==26,s),l)return l;f===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(f=h[this._parseStack.chunkPos],l=this._oscParser.end(f!==24&&f!==26,s),l)return l;f===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,C=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let p=C;p<r;++p){switch(f=h[p],_=this._transitions.table[this.currentState<<8|(f<160?f:v)],_>>4){case 2:for(let B=p+1;;++B){if(B>=r||(f=h[B])<32||f>126&&f<v){this._printHandler(h,p,B),p=B-1;break}if(++B>=r||(f=h[B])<32||f>126&&f<v){this._printHandler(h,p,B),p=B-1;break}if(++B>=r||(f=h[B])<32||f>126&&f<v){this._printHandler(h,p,B),p=B-1;break}if(++B>=r||(f=h[B])<32||f>126&&f<v){this._printHandler(h,p,B),p=B-1;break}}break;case 3:this._executeHandlers[f]?this._executeHandlers[f]():this._executeHandlerFb(f),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:p,code:f,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const y=this._csiHandlers[this._collect<<8|f];let L=y?y.length-1:-1;for(;L>=0&&(l=y[L](this._params),l!==!0);L--)if(l instanceof Promise)return this._preserveStack(3,y,L,_,p),l;L<0&&this._csiHandlerFb(this._collect<<8|f,this._params),this.precedingCodepoint=0;break;case 8:do switch(f){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(f-48)}while(++p<r&&(f=h[p])>47&&f<60);p--;break;case 9:this._collect<<=8,this._collect|=f;break;case 10:const T=this._escHandlers[this._collect<<8|f];let D=T?T.length-1:-1;for(;D>=0&&(l=T[D](),l!==!0);D--)if(l instanceof Promise)return this._preserveStack(4,T,D,_,p),l;D<0&&this._escHandlerFb(this._collect<<8|f),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|f,this._params);break;case 13:for(let B=p+1;;++B)if(B>=r||(f=h[B])===24||f===26||f===27||f>127&&f<v){this._dcsParser.put(h,p,B),p=B-1;break}break;case 14:if(l=this._dcsParser.unhook(f!==24&&f!==26),l)return this._preserveStack(6,[],0,_,p),l;f===27&&(_|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let B=p+1;;B++)if(B>=r||(f=h[B])<32||f>127&&f<v){this._oscParser.put(h,p,B),p=B-1;break}break;case 6:if(l=this._oscParser.end(f!==24&&f!==26),l)return this._preserveStack(5,[],0,_,p),l;f===27&&(_|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&_}}}c.EscapeSequenceParser=a},6242:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OscHandler=c.OscParser=void 0;const m=w(5770),g=w(482),d=[];c.OscParser=class{constructor(){this._state=0,this._active=d,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(u,b){this._handlers[u]===void 0&&(this._handlers[u]=[]);const v=this._handlers[u];return v.push(b),{dispose:()=>{const a=v.indexOf(b);a!==-1&&v.splice(a,1)}}}clearHandler(u){this._handlers[u]&&delete this._handlers[u]}setHandlerFallback(u){this._handlerFb=u}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}reset(){if(this._state===2)for(let u=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;u>=0;--u)this._active[u].end(!1);this._stack.paused=!1,this._active=d,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||d,this._active.length)for(let u=this._active.length-1;u>=0;u--)this._active[u].start();else this._handlerFb(this._id,"START")}_put(u,b,v){if(this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].put(u,b,v);else this._handlerFb(this._id,"PUT",(0,g.utf32ToString)(u,b,v))}start(){this.reset(),this._state=1}put(u,b,v){if(this._state!==3){if(this._state===1)for(;b<v;){const a=u[b++];if(a===59){this._state=2,this._start();break}if(a<48||57<a)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+a-48}this._state===2&&v-b>0&&this._put(u,b,v)}}end(u,b=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let v=!1,a=this._active.length-1,i=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,v=b,i=this._stack.fallThrough,this._stack.paused=!1),!i&&v===!1){for(;a>=0&&(v=this._active[a].end(u),v!==!0);a--)if(v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,v;a--}for(;a>=0;a--)if(v=this._active[a].end(!1),v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,v}else this._handlerFb(this._id,"END",u);this._active=d,this._id=-1,this._state=0}}},c.OscHandler=class{constructor(u){this._handler=u,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(u,b,v){this._hitLimit||(this._data+=(0,g.utf32ToString)(u,b,v),this._data.length>m.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(u){let b=!1;if(this._hitLimit)b=!1;else if(u&&(b=this._handler(this._data),b instanceof Promise))return b.then(v=>(this._data="",this._hitLimit=!1,v));return this._data="",this._hitLimit=!1,b}}},8742:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Params=void 0;const w=2147483647;class m{constructor(d=32,u=32){if(this.maxLength=d,this.maxSubParamsLength=u,u>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(d),this.length=0,this._subParams=new Int32Array(u),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(d),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(d){const u=new m;if(!d.length)return u;for(let b=Array.isArray(d[0])?1:0;b<d.length;++b){const v=d[b];if(Array.isArray(v))for(let a=0;a<v.length;++a)u.addSubParam(v[a]);else u.addParam(v)}return u}clone(){const d=new m(this.maxLength,this.maxSubParamsLength);return d.params.set(this.params),d.length=this.length,d._subParams.set(this._subParams),d._subParamsLength=this._subParamsLength,d._subParamsIdx.set(this._subParamsIdx),d._rejectDigits=this._rejectDigits,d._rejectSubDigits=this._rejectSubDigits,d._digitIsSub=this._digitIsSub,d}toArray(){const d=[];for(let u=0;u<this.length;++u){d.push(this.params[u]);const b=this._subParamsIdx[u]>>8,v=255&this._subParamsIdx[u];v-b>0&&d.push(Array.prototype.slice.call(this._subParams,b,v))}return d}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(d){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=d>w?w:d}}addSubParam(d){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(d<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=d>w?w:d,this._subParamsIdx[this.length-1]++}}hasSubParams(d){return(255&this._subParamsIdx[d])-(this._subParamsIdx[d]>>8)>0}getSubParams(d){const u=this._subParamsIdx[d]>>8,b=255&this._subParamsIdx[d];return b-u>0?this._subParams.subarray(u,b):null}getSubParamsAll(){const d={};for(let u=0;u<this.length;++u){const b=this._subParamsIdx[u]>>8,v=255&this._subParamsIdx[u];v-b>0&&(d[u]=this._subParams.slice(b,v))}return d}addDigit(d){let u;if(this._rejectDigits||!(u=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const b=this._digitIsSub?this._subParams:this.params,v=b[u-1];b[u-1]=~v?Math.min(10*v+d,w):d}}c.Params=m},5741:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.AddonManager=void 0,c.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let w=this._addons.length-1;w>=0;w--)this._addons[w].instance.dispose()}loadAddon(w,m){const g={instance:m,dispose:m.dispose,isDisposed:!1};this._addons.push(g),m.dispose=()=>this._wrappedAddonDispose(g),m.activate(w)}_wrappedAddonDispose(w){if(w.isDisposed)return;let m=-1;for(let g=0;g<this._addons.length;g++)if(this._addons[g]===w){m=g;break}if(m===-1)throw new Error("Could not dispose an addon that has not been loaded");w.isDisposed=!0,w.dispose.apply(w.instance),this._addons.splice(m,1)}}},8771:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferApiView=void 0;const m=w(3785),g=w(511);c.BufferApiView=class{constructor(d,u){this._buffer=d,this.type=u}init(d){return this._buffer=d,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(d){const u=this._buffer.lines.get(d);if(u)return new m.BufferLineApiView(u)}getNullCell(){return new g.CellData}}},3785:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLineApiView=void 0;const m=w(511);c.BufferLineApiView=class{constructor(g){this._line=g}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(g,d){if(!(g<0||g>=this._line.length))return d?(this._line.loadCell(g,d),d):this._line.loadCell(g,new m.CellData)}translateToString(g,d,u){return this._line.translateToString(g,d,u)}}},8285:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferNamespaceApi=void 0;const m=w(8771),g=w(8460);c.BufferNamespaceApi=class{constructor(d){this._core=d,this._onBufferChange=new g.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new m.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new m.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ParserApi=void 0,c.ParserApi=class{constructor(w){this._core=w}registerCsiHandler(w,m){return this._core.registerCsiHandler(w,g=>m(g.toArray()))}addCsiHandler(w,m){return this.registerCsiHandler(w,m)}registerDcsHandler(w,m){return this._core.registerDcsHandler(w,(g,d)=>m(g,d.toArray()))}addDcsHandler(w,m){return this.registerDcsHandler(w,m)}registerEscHandler(w,m){return this._core.registerEscHandler(w,m)}addEscHandler(w,m){return this.registerEscHandler(w,m)}registerOscHandler(w,m){return this._core.registerOscHandler(w,m)}addOscHandler(w,m){return this.registerOscHandler(w,m)}}},7090:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeApi=void 0,c.UnicodeApi=class{constructor(w){this._core=w}register(w){this._core.unicodeService.register(w)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(w){this._core.unicodeService.activeVersion=w}}},744:function(K,c,w){var m=this&&this.__decorate||function(i,h,r,s){var l,f=arguments.length,_=f<3?h:s===null?s=Object.getOwnPropertyDescriptor(h,r):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(i,h,r,s);else for(var C=i.length-1;C>=0;C--)(l=i[C])&&(_=(f<3?l(_):f>3?l(h,r,_):l(h,r))||_);return f>3&&_&&Object.defineProperty(h,r,_),_},g=this&&this.__param||function(i,h){return function(r,s){h(r,s,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferService=c.MINIMUM_ROWS=c.MINIMUM_COLS=void 0;const d=w(2585),u=w(5295),b=w(8460),v=w(844);c.MINIMUM_COLS=2,c.MINIMUM_ROWS=1;let a=class extends v.Disposable{constructor(i){super(),this.isUserScrolling=!1,this._onResize=this.register(new b.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new b.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(i.rawOptions.cols||0,c.MINIMUM_COLS),this.rows=Math.max(i.rawOptions.rows||0,c.MINIMUM_ROWS),this.buffers=this.register(new u.BufferSet(i,this))}get buffer(){return this.buffers.active}resize(i,h){this.cols=i,this.rows=h,this.buffers.resize(i,h),this._onResize.fire({cols:i,rows:h})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(i,h=!1){const r=this.buffer;let s;s=this._cachedBlankLine,s&&s.length===this.cols&&s.getFg(0)===i.fg&&s.getBg(0)===i.bg||(s=r.getBlankLine(i,h),this._cachedBlankLine=s),s.isWrapped=h;const l=r.ybase+r.scrollTop,f=r.ybase+r.scrollBottom;if(r.scrollTop===0){const _=r.lines.isFull;f===r.lines.length-1?_?r.lines.recycle().copyFrom(s):r.lines.push(s.clone()):r.lines.splice(f+1,0,s.clone()),_?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{const _=f-l+1;r.lines.shiftElements(l+1,_-1,-1),r.lines.set(f,s.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)}scrollLines(i,h,r){const s=this.buffer;if(i<0){if(s.ydisp===0)return;this.isUserScrolling=!0}else i+s.ydisp>=s.ybase&&(this.isUserScrolling=!1);const l=s.ydisp;s.ydisp=Math.max(Math.min(s.ydisp+i,s.ybase),0),l!==s.ydisp&&(h||this._onScroll.fire(s.ydisp))}scrollPages(i){this.scrollLines(i*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(i){const h=i-this.buffer.ydisp;h!==0&&this.scrollLines(h)}};a=m([g(0,d.IOptionsService)],a),c.BufferService=a},7994:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CharsetService=void 0,c.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(w){this.glevel=w,this.charset=this._charsets[w]}setgCharset(w,m){this._charsets[w]=m,this.glevel===w&&(this.charset=m)}}},1753:function(K,c,w){var m=this&&this.__decorate||function(s,l,f,_){var C,p=arguments.length,y=p<3?l:_===null?_=Object.getOwnPropertyDescriptor(l,f):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(s,l,f,_);else for(var L=s.length-1;L>=0;L--)(C=s[L])&&(y=(p<3?C(y):p>3?C(l,f,y):C(l,f))||y);return p>3&&y&&Object.defineProperty(l,f,y),y},g=this&&this.__param||function(s,l){return function(f,_){l(f,_,s)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreMouseService=void 0;const d=w(2585),u=w(8460),b=w(844),v={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:s=>s.button!==4&&s.action===1&&(s.ctrl=!1,s.alt=!1,s.shift=!1,!0)},VT200:{events:19,restrict:s=>s.action!==32},DRAG:{events:23,restrict:s=>s.action!==32||s.button!==3},ANY:{events:31,restrict:s=>!0}};function a(s,l){let f=(s.ctrl?16:0)|(s.shift?4:0)|(s.alt?8:0);return s.button===4?(f|=64,f|=s.action):(f|=3&s.button,4&s.button&&(f|=64),8&s.button&&(f|=128),s.action===32?f|=32:s.action!==0||l||(f|=3)),f}const i=String.fromCharCode,h={DEFAULT:s=>{const l=[a(s,!1)+32,s.col+32,s.row+32];return l[0]>255||l[1]>255||l[2]>255?"":`\x1B[M${i(l[0])}${i(l[1])}${i(l[2])}`},SGR:s=>{const l=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${a(s,!0)};${s.col};${s.row}${l}`},SGR_PIXELS:s=>{const l=s.action===0&&s.button!==4?"m":"M";return`\x1B[<${a(s,!0)};${s.x};${s.y}${l}`}};let r=class extends b.Disposable{constructor(s,l){super(),this._bufferService=s,this._coreService=l,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new u.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const f of Object.keys(v))this.addProtocol(f,v[f]);for(const f of Object.keys(h))this.addEncoding(f,h[f]);this.reset()}addProtocol(s,l){this._protocols[s]=l}addEncoding(s,l){this._encodings[s]=l}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(s){if(!this._protocols[s])throw new Error(`unknown protocol "${s}"`);this._activeProtocol=s,this._onProtocolChange.fire(this._protocols[s].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(s){if(!this._encodings[s])throw new Error(`unknown encoding "${s}"`);this._activeEncoding=s}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(s){if(s.col<0||s.col>=this._bufferService.cols||s.row<0||s.row>=this._bufferService.rows||s.button===4&&s.action===32||s.button===3&&s.action!==32||s.button!==4&&(s.action===2||s.action===3)||(s.col++,s.row++,s.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,s,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(s))return!1;const l=this._encodings[this._activeEncoding](s);return l&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(l):this._coreService.triggerDataEvent(l,!0)),this._lastEvent=s,!0}explainEvents(s){return{down:!!(1&s),up:!!(2&s),drag:!!(4&s),move:!!(8&s),wheel:!!(16&s)}}_equalEvents(s,l,f){if(f){if(s.x!==l.x||s.y!==l.y)return!1}else if(s.col!==l.col||s.row!==l.row)return!1;return s.button===l.button&&s.action===l.action&&s.ctrl===l.ctrl&&s.alt===l.alt&&s.shift===l.shift}};r=m([g(0,d.IBufferService),g(1,d.ICoreService)],r),c.CoreMouseService=r},6975:function(K,c,w){var m=this&&this.__decorate||function(r,s,l,f){var _,C=arguments.length,p=C<3?s:f===null?f=Object.getOwnPropertyDescriptor(s,l):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(r,s,l,f);else for(var y=r.length-1;y>=0;y--)(_=r[y])&&(p=(C<3?_(p):C>3?_(s,l,p):_(s,l))||p);return C>3&&p&&Object.defineProperty(s,l,p),p},g=this&&this.__param||function(r,s){return function(l,f){s(l,f,r)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreService=void 0;const d=w(2585),u=w(8460),b=w(1439),v=w(844),a=Object.freeze({insertMode:!1}),i=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let h=class extends v.Disposable{constructor(r,s,l){super(),this._bufferService=r,this._logService=s,this._optionsService=l,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new u.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new u.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new u.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new u.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,b.clone)(a),this.decPrivateModes=(0,b.clone)(i)}reset(){this.modes=(0,b.clone)(a),this.decPrivateModes=(0,b.clone)(i)}triggerDataEvent(r,s=!1){if(this._optionsService.rawOptions.disableStdin)return;const l=this._bufferService.buffer;s&&this._optionsService.rawOptions.scrollOnUserInput&&l.ybase!==l.ydisp&&this._onRequestScrollToBottom.fire(),s&&this._onUserInput.fire(),this._logService.debug(`sending data "${r}"`,()=>r.split("").map(f=>f.charCodeAt(0))),this._onData.fire(r)}triggerBinaryEvent(r){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${r}"`,()=>r.split("").map(s=>s.charCodeAt(0))),this._onBinary.fire(r))}};h=m([g(0,d.IBufferService),g(1,d.ILogService),g(2,d.IOptionsService)],h),c.CoreService=h},9074:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DecorationService=void 0;const m=w(8055),g=w(8460),d=w(844),u=w(6106);let b=0,v=0;class a extends d.Disposable{constructor(){super(),this._decorations=new u.SortedList(r=>r==null?void 0:r.marker.line),this._onDecorationRegistered=this.register(new g.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new g.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,d.toDisposable)(()=>{for(const r of this._decorations.values())this._onDecorationRemoved.fire(r);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(r){if(r.marker.isDisposed)return;const s=new i(r);if(s){const l=s.marker.onDispose(()=>s.dispose());s.onDispose(()=>{s&&(this._decorations.delete(s)&&this._onDecorationRemoved.fire(s),l.dispose())}),this._decorations.insert(s),this._onDecorationRegistered.fire(s)}return s}reset(){for(const r of this._decorations.values())r.dispose();this._decorations.clear()}*getDecorationsAtCell(r,s,l){var f,_,C;let p=0,y=0;for(const L of this._decorations.getKeyIterator(s))p=(f=L.options.x)!==null&&f!==void 0?f:0,y=p+((_=L.options.width)!==null&&_!==void 0?_:1),r>=p&&r<y&&(!l||((C=L.options.layer)!==null&&C!==void 0?C:"bottom")===l)&&(yield L)}forEachDecorationAtCell(r,s,l,f){this._decorations.forEachByKey(s,_=>{var C,p,y;b=(C=_.options.x)!==null&&C!==void 0?C:0,v=b+((p=_.options.width)!==null&&p!==void 0?p:1),r>=b&&r<v&&(!l||((y=_.options.layer)!==null&&y!==void 0?y:"bottom")===l)&&f(_)})}dispose(){for(const r of this._decorations.values())this._onDecorationRemoved.fire(r);this.reset()}}c.DecorationService=a;class i extends d.Disposable{constructor(r){super(),this.options=r,this.onRenderEmitter=this.register(new g.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new g.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=r.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=m.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=m.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.InstantiationService=c.ServiceCollection=void 0;const m=w(2585),g=w(8343);class d{constructor(...b){this._entries=new Map;for(const[v,a]of b)this.set(v,a)}set(b,v){const a=this._entries.get(b);return this._entries.set(b,v),a}forEach(b){for(const[v,a]of this._entries.entries())b(v,a)}has(b){return this._entries.has(b)}get(b){return this._entries.get(b)}}c.ServiceCollection=d,c.InstantiationService=class{constructor(){this._services=new d,this._services.set(m.IInstantiationService,this)}setService(u,b){this._services.set(u,b)}getService(u){return this._services.get(u)}createInstance(u,...b){const v=(0,g.getServiceDependencies)(u).sort((h,r)=>h.index-r.index),a=[];for(const h of v){const r=this._services.get(h.id);if(!r)throw new Error(`[createInstance] ${u.name} depends on UNKNOWN service ${h.id}.`);a.push(r)}const i=v.length>0?v[0].index:b.length;if(b.length!==i)throw new Error(`[createInstance] First service dependency of ${u.name} at position ${i+1} conflicts with ${b.length} static arguments`);return new u(...b,...a)}}},7866:function(K,c,w){var m=this&&this.__decorate||function(a,i,h,r){var s,l=arguments.length,f=l<3?i:r===null?r=Object.getOwnPropertyDescriptor(i,h):r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(a,i,h,r);else for(var _=a.length-1;_>=0;_--)(s=a[_])&&(f=(l<3?s(f):l>3?s(i,h,f):s(i,h))||f);return l>3&&f&&Object.defineProperty(i,h,f),f},g=this&&this.__param||function(a,i){return function(h,r){i(h,r,a)}};Object.defineProperty(c,"__esModule",{value:!0}),c.LogService=void 0;const d=w(844),u=w(2585),b={debug:u.LogLevelEnum.DEBUG,info:u.LogLevelEnum.INFO,warn:u.LogLevelEnum.WARN,error:u.LogLevelEnum.ERROR,off:u.LogLevelEnum.OFF};let v=class extends d.Disposable{constructor(a){super(),this._optionsService=a,this.logLevel=u.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=b[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(a){for(let i=0;i<a.length;i++)typeof a[i]=="function"&&(a[i]=a[i]())}_log(a,i,h){this._evalLazyOptionalParams(h),a.call(console,"xterm.js: "+i,...h)}debug(a,...i){this.logLevel<=u.LogLevelEnum.DEBUG&&this._log(console.log,a,i)}info(a,...i){this.logLevel<=u.LogLevelEnum.INFO&&this._log(console.info,a,i)}warn(a,...i){this.logLevel<=u.LogLevelEnum.WARN&&this._log(console.warn,a,i)}error(a,...i){this.logLevel<=u.LogLevelEnum.ERROR&&this._log(console.error,a,i)}};v=m([g(0,u.IOptionsService)],v),c.LogService=v},7302:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OptionsService=c.DEFAULT_OPTIONS=void 0;const m=w(8460),g=w(6114),d=w(844);c.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:g.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const u=["normal","bold","100","200","300","400","500","600","700","800","900"];class b extends d.Disposable{constructor(a){super(),this._onOptionChange=this.register(new m.EventEmitter),this.onOptionChange=this._onOptionChange.event;const i=Object.assign({},c.DEFAULT_OPTIONS);for(const h in a)if(h in i)try{const r=a[h];i[h]=this._sanitizeAndValidateOption(h,r)}catch(r){console.error(r)}this.rawOptions=i,this.options=Object.assign({},i),this._setupOptions()}onSpecificOptionChange(a,i){return this.onOptionChange(h=>{h===a&&i(this.rawOptions[a])})}onMultipleOptionChange(a,i){return this.onOptionChange(h=>{a.indexOf(h)!==-1&&i()})}_setupOptions(){const a=h=>{if(!(h in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${h}"`);return this.rawOptions[h]},i=(h,r)=>{if(!(h in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${h}"`);r=this._sanitizeAndValidateOption(h,r),this.rawOptions[h]!==r&&(this.rawOptions[h]=r,this._onOptionChange.fire(h))};for(const h in this.rawOptions){const r={get:a.bind(this,h),set:i.bind(this,h)};Object.defineProperty(this.options,h,r)}}_sanitizeAndValidateOption(a,i){switch(a){case"cursorStyle":if(i||(i=c.DEFAULT_OPTIONS[a]),!function(h){return h==="block"||h==="underline"||h==="bar"}(i))throw new Error(`"${i}" is not a valid value for ${a}`);break;case"wordSeparator":i||(i=c.DEFAULT_OPTIONS[a]);break;case"fontWeight":case"fontWeightBold":if(typeof i=="number"&&1<=i&&i<=1e3)break;i=u.includes(i)?i:c.DEFAULT_OPTIONS[a];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${a} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(`${a} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${a} cannot be less than or equal to 0, value: ${i}`);case"rows":case"cols":if(!i&&i!==0)throw new Error(`${a} must be numeric, value: ${i}`)}return i}}c.OptionsService=b},2660:function(K,c,w){var m=this&&this.__decorate||function(b,v,a,i){var h,r=arguments.length,s=r<3?v:i===null?i=Object.getOwnPropertyDescriptor(v,a):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(b,v,a,i);else for(var l=b.length-1;l>=0;l--)(h=b[l])&&(s=(r<3?h(s):r>3?h(v,a,s):h(v,a))||s);return r>3&&s&&Object.defineProperty(v,a,s),s},g=this&&this.__param||function(b,v){return function(a,i){v(a,i,b)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkService=void 0;const d=w(2585);let u=class{constructor(b){this._bufferService=b,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(b){const v=this._bufferService.buffer;if(b.id===void 0){const l=v.addMarker(v.ybase+v.y),f={data:b,id:this._nextId++,lines:[l]};return l.onDispose(()=>this._removeMarkerFromLink(f,l)),this._dataByLinkId.set(f.id,f),f.id}const a=b,i=this._getEntryIdKey(a),h=this._entriesWithId.get(i);if(h)return this.addLineToLink(h.id,v.ybase+v.y),h.id;const r=v.addMarker(v.ybase+v.y),s={id:this._nextId++,key:this._getEntryIdKey(a),data:a,lines:[r]};return r.onDispose(()=>this._removeMarkerFromLink(s,r)),this._entriesWithId.set(s.key,s),this._dataByLinkId.set(s.id,s),s.id}addLineToLink(b,v){const a=this._dataByLinkId.get(b);if(a&&a.lines.every(i=>i.line!==v)){const i=this._bufferService.buffer.addMarker(v);a.lines.push(i),i.onDispose(()=>this._removeMarkerFromLink(a,i))}}getLinkData(b){var v;return(v=this._dataByLinkId.get(b))===null||v===void 0?void 0:v.data}_getEntryIdKey(b){return`${b.id};;${b.uri}`}_removeMarkerFromLink(b,v){const a=b.lines.indexOf(v);a!==-1&&(b.lines.splice(a,1),b.lines.length===0&&(b.data.id!==void 0&&this._entriesWithId.delete(b.key),this._dataByLinkId.delete(b.id)))}};u=m([g(0,d.IBufferService)],u),c.OscLinkService=u},8343:(K,c)=>{function w(m,g,d){g.di$target===g?g.di$dependencies.push({id:m,index:d}):(g.di$dependencies=[{id:m,index:d}],g.di$target=g)}Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0,c.serviceRegistry=new Map,c.getServiceDependencies=function(m){return m.di$dependencies||[]},c.createDecorator=function(m){if(c.serviceRegistry.has(m))return c.serviceRegistry.get(m);const g=function(d,u,b){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");w(g,d,b)};return g.toString=()=>m,c.serviceRegistry.set(m,g),g}},2585:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const m=w(8343);var g;c.IBufferService=(0,m.createDecorator)("BufferService"),c.ICoreMouseService=(0,m.createDecorator)("CoreMouseService"),c.ICoreService=(0,m.createDecorator)("CoreService"),c.ICharsetService=(0,m.createDecorator)("CharsetService"),c.IInstantiationService=(0,m.createDecorator)("InstantiationService"),(g=c.LogLevelEnum||(c.LogLevelEnum={}))[g.DEBUG=0]="DEBUG",g[g.INFO=1]="INFO",g[g.WARN=2]="WARN",g[g.ERROR=3]="ERROR",g[g.OFF=4]="OFF",c.ILogService=(0,m.createDecorator)("LogService"),c.IOptionsService=(0,m.createDecorator)("OptionsService"),c.IOscLinkService=(0,m.createDecorator)("OscLinkService"),c.IUnicodeService=(0,m.createDecorator)("UnicodeService"),c.IDecorationService=(0,m.createDecorator)("DecorationService")},1480:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeService=void 0;const m=w(8460),g=w(225);c.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new m.EventEmitter,this.onChange=this._onChange.event;const d=new g.UnicodeV6;this.register(d),this._active=d.version,this._activeProvider=d}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(d){if(!this._providers[d])throw new Error(`unknown Unicode version "${d}"`);this._active=d,this._activeProvider=this._providers[d],this._onChange.fire(d)}register(d){this._providers[d.version]=d}wcwidth(d){return this._activeProvider.wcwidth(d)}getStringCellWidth(d){let u=0;const b=d.length;for(let v=0;v<b;++v){let a=d.charCodeAt(v);if(55296<=a&&a<=56319){if(++v>=b)return u+this.wcwidth(a);const i=d.charCodeAt(v);56320<=i&&i<=57343?a=1024*(a-55296)+i-56320+65536:u+=this.wcwidth(i)}u+=this.wcwidth(a)}return u}}}},de={};function ve(K){var c=de[K];if(c!==void 0)return c.exports;var w=de[K]={exports:{}};return ie[K].call(w.exports,w,w.exports,ve),w.exports}var ge={};return(()=>{var K=ge;Object.defineProperty(K,"__esModule",{value:!0}),K.Terminal=void 0;const c=ve(3236),w=ve(9042),m=ve(7975),g=ve(7090),d=ve(5741),u=ve(8285),b=["cols","rows"];K.Terminal=class{constructor(v){this._core=new c.Terminal(v),this._addonManager=new d.AddonManager,this._publicOptions=Object.assign({},this._core.options);const a=h=>this._core.options[h],i=(h,r)=>{this._checkReadonlyOptions(h),this._core.options[h]=r};for(const h in this._core.options){const r={get:a.bind(this,h),set:i.bind(this,h)};Object.defineProperty(this._publicOptions,h,r)}}_checkReadonlyOptions(v){if(b.includes(v))throw new Error(`Option "${v}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new m.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new g.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new u.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const v=this._core.coreService.decPrivateModes;let a="none";switch(this._core.coreMouseService.activeProtocol){case"X10":a="x10";break;case"VT200":a="vt200";break;case"DRAG":a="drag";break;case"ANY":a="any"}return{applicationCursorKeysMode:v.applicationCursorKeys,applicationKeypadMode:v.applicationKeypad,bracketedPasteMode:v.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:a,originMode:v.origin,reverseWraparoundMode:v.reverseWraparound,sendFocusMode:v.sendFocus,wraparoundMode:v.wraparound}}get options(){return this._publicOptions}set options(v){for(const a in v)this._publicOptions[a]=v[a]}blur(){this._core.blur()}focus(){this._core.focus()}resize(v,a){this._verifyIntegers(v,a),this._core.resize(v,a)}open(v){this._core.open(v)}attachCustomKeyEventHandler(v){this._core.attachCustomKeyEventHandler(v)}registerLinkProvider(v){return this._core.registerLinkProvider(v)}registerCharacterJoiner(v){return this._checkProposedApi(),this._core.registerCharacterJoiner(v)}deregisterCharacterJoiner(v){this._checkProposedApi(),this._core.deregisterCharacterJoiner(v)}registerMarker(v=0){return this._verifyIntegers(v),this._core.addMarker(v)}registerDecoration(v){var a,i,h;return this._checkProposedApi(),this._verifyPositiveIntegers((a=v.x)!==null&&a!==void 0?a:0,(i=v.width)!==null&&i!==void 0?i:0,(h=v.height)!==null&&h!==void 0?h:0),this._core.registerDecoration(v)}hasSelection(){return this._core.hasSelection()}select(v,a,i){this._verifyIntegers(v,a,i),this._core.select(v,a,i)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(v,a){this._verifyIntegers(v,a),this._core.selectLines(v,a)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(v){this._verifyIntegers(v),this._core.scrollLines(v)}scrollPages(v){this._verifyIntegers(v),this._core.scrollPages(v)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(v){this._verifyIntegers(v),this._core.scrollToLine(v)}clear(){this._core.clear()}write(v,a){this._core.write(v,a)}writeln(v,a){this._core.write(v),this._core.write(`\r
`,a)}paste(v){this._core.paste(v)}refresh(v,a){this._verifyIntegers(v,a),this._core.refresh(v,a)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(v){return this._addonManager.loadAddon(this,v)}static get strings(){return w}_verifyIntegers(...v){for(const a of v)if(a===1/0||isNaN(a)||a%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...v){for(const a of v)if(a&&(a===1/0||isNaN(a)||a%1!=0||a<0))throw new Error("This API only accepts positive integers")}}})(),ge})())})(Vi);var nr=Vi.exports,Yi={exports:{}};(function(Se,$){(function(ie,de){Se.exports=de()})(self,function(){return(()=>{var ie={903:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BaseRenderLayer=void 0;const m=w(503),g=w(627),d=w(237),u=w(860),b=w(374),v=w(296),a=w(855),i=w(274),h=w(859),r=w(399),s=w(345);class l extends h.Disposable{constructor(C,p,y,L,T,D,B,H,A,F){super(),this._terminal=C,this._container=p,this._alpha=T,this._themeService=D,this._bufferService=B,this._optionsService=H,this._decorationService=A,this._coreBrowserService=F,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._selectionModel=(0,v.createSelectionRenderModel)(),this._bitmapGenerator=[],this._onAddTextureAtlasCanvas=this.register(new s.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._cellColorResolver=new i.CellColorResolver(this._terminal,this._selectionModel,this._decorationService,this._coreBrowserService,this._themeService),this._canvas=document.createElement("canvas"),this._canvas.classList.add(`xterm-${y}-layer`),this._canvas.style.zIndex=L.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this._refreshCharAtlas(this._themeService.colors),this.register(this._themeService.onChangeColors(k=>{this._refreshCharAtlas(k),this.reset()})),this.register((0,h.toDisposable)(()=>{var k;(0,m.removeElementFromParent)(this._canvas),(k=this._charAtlas)===null||k===void 0||k.dispose()}))}get canvas(){return this._canvas}get cacheCanvas(){var C;return(C=this._charAtlas)===null||C===void 0?void 0:C.pages[0].canvas}_initCanvas(){this._ctx=(0,b.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(){}handleFocus(){}handleCursorMove(){}handleGridChanged(C,p){}handleSelectionChanged(C,p,y=!1){this._selectionModel.update(this._terminal,C,p,y)}_setTransparency(C){if(C===this._alpha)return;const p=this._canvas;this._alpha=C,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,p),this._refreshCharAtlas(this._themeService.colors),this.handleGridChanged(0,this._bufferService.rows-1)}_refreshCharAtlas(C){var p;if(!(this._deviceCharWidth<=0&&this._deviceCharHeight<=0)){(p=this._charAtlasDisposable)===null||p===void 0||p.dispose(),this._charAtlas=(0,g.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,C,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlasDisposable=(0,s.forwardEvent)(this._charAtlas.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),this._charAtlas.warmUp();for(let y=0;y<this._charAtlas.pages.length;y++)this._bitmapGenerator[y]=new f(this._charAtlas.pages[y].canvas)}}resize(C){this._deviceCellWidth=C.device.cell.width,this._deviceCellHeight=C.device.cell.height,this._deviceCharWidth=C.device.char.width,this._deviceCharHeight=C.device.char.height,this._deviceCharLeft=C.device.char.left,this._deviceCharTop=C.device.char.top,this._canvas.width=C.device.canvas.width,this._canvas.height=C.device.canvas.height,this._canvas.style.width=`${C.css.canvas.width}px`,this._canvas.style.height=`${C.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(this._themeService.colors)}clearTextureAtlas(){var C;(C=this._charAtlas)===null||C===void 0||C.clearTexture()}_fillCells(C,p,y,L){this._ctx.fillRect(C*this._deviceCellWidth,p*this._deviceCellHeight,y*this._deviceCellWidth,L*this._deviceCellHeight)}_fillMiddleLineAtCells(C,p,y=1){const L=Math.ceil(.5*this._deviceCellHeight);this._ctx.fillRect(C*this._deviceCellWidth,(p+1)*this._deviceCellHeight-L-this._coreBrowserService.dpr,y*this._deviceCellWidth,this._coreBrowserService.dpr)}_fillBottomLineAtCells(C,p,y=1,L=0){this._ctx.fillRect(C*this._deviceCellWidth,(p+1)*this._deviceCellHeight+L-this._coreBrowserService.dpr-1,y*this._deviceCellWidth,this._coreBrowserService.dpr)}_curlyUnderlineAtCell(C,p,y=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const L=this._coreBrowserService.dpr;this._ctx.lineWidth=L;for(let T=0;T<y;T++){const D=(C+T)*this._deviceCellWidth,B=(C+T+.5)*this._deviceCellWidth,H=(C+T+1)*this._deviceCellWidth,A=(p+1)*this._deviceCellHeight-L-1,F=A-L,k=A+L;this._ctx.moveTo(D,A),this._ctx.bezierCurveTo(D,F,B,F,B,A),this._ctx.bezierCurveTo(B,k,H,k,H,A)}this._ctx.stroke(),this._ctx.restore()}_dottedUnderlineAtCell(C,p,y=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const L=this._coreBrowserService.dpr;this._ctx.lineWidth=L,this._ctx.setLineDash([2*L,L]);const T=C*this._deviceCellWidth,D=(p+1)*this._deviceCellHeight-L-1;this._ctx.moveTo(T,D);for(let B=0;B<y;B++){const H=(C+y+B)*this._deviceCellWidth;this._ctx.lineTo(H,D)}this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}_dashedUnderlineAtCell(C,p,y=1){this._ctx.save(),this._ctx.beginPath(),this._ctx.strokeStyle=this._ctx.fillStyle;const L=this._coreBrowserService.dpr;this._ctx.lineWidth=L,this._ctx.setLineDash([4*L,3*L]);const T=C*this._deviceCellWidth,D=(C+y)*this._deviceCellWidth,B=(p+1)*this._deviceCellHeight-L-1;this._ctx.moveTo(T,B),this._ctx.lineTo(D,B),this._ctx.stroke(),this._ctx.closePath(),this._ctx.restore()}_fillLeftLineAtCell(C,p,y){this._ctx.fillRect(C*this._deviceCellWidth,p*this._deviceCellHeight,this._coreBrowserService.dpr*y,this._deviceCellHeight)}_strokeRectAtCell(C,p,y,L){const T=this._coreBrowserService.dpr;this._ctx.lineWidth=T,this._ctx.strokeRect(C*this._deviceCellWidth+T/2,p*this._deviceCellHeight+T/2,y*this._deviceCellWidth-T,L*this._deviceCellHeight-T)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(C,p,y,L){this._alpha?this._ctx.clearRect(C*this._deviceCellWidth,p*this._deviceCellHeight,y*this._deviceCellWidth,L*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(C*this._deviceCellWidth,p*this._deviceCellHeight,y*this._deviceCellWidth,L*this._deviceCellHeight))}_fillCharTrueColor(C,p,y){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=d.TEXT_BASELINE,this._clipRow(y);let L=!1;this._optionsService.rawOptions.customGlyphs!==!1&&(L=(0,u.tryDrawCustomChar)(this._ctx,C.getChars(),p*this._deviceCellWidth,y*this._deviceCellHeight,this._deviceCellWidth,this._deviceCellHeight,this._optionsService.rawOptions.fontSize,this._coreBrowserService.dpr)),L||this._ctx.fillText(C.getChars(),p*this._deviceCellWidth+this._deviceCharLeft,y*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_drawChars(C,p,y){var L,T;const D=C.getChars();let B;this._cellColorResolver.resolve(C,p,this._bufferService.buffer.ydisp+y),B=D&&D.length>1?this._charAtlas.getRasterizedGlyphCombinedChar(D,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext):this._charAtlas.getRasterizedGlyph(C.getCode()||a.WHITESPACE_CELL_CODE,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext),B.size.x&&B.size.y&&(this._ctx.save(),this._clipRow(y),this._charAtlas.pages[B.texturePage].version!==((L=this._bitmapGenerator[B.texturePage])===null||L===void 0?void 0:L.version)&&(this._bitmapGenerator[B.texturePage]||(this._bitmapGenerator[B.texturePage]=new f(this._charAtlas.pages[B.texturePage].canvas)),this._bitmapGenerator[B.texturePage].refresh(),this._bitmapGenerator[B.texturePage].version=this._charAtlas.pages[B.texturePage].version),this._ctx.drawImage(((T=this._bitmapGenerator[B.texturePage])===null||T===void 0?void 0:T.bitmap)||this._charAtlas.pages[B.texturePage].canvas,B.texturePosition.x,B.texturePosition.y,B.size.x,B.size.y,p*this._deviceCellWidth+this._deviceCharLeft-B.offset.x,y*this._deviceCellHeight+this._deviceCharTop-B.offset.y,B.size.x,B.size.y),this._ctx.restore())}_clipRow(C){this._ctx.beginPath(),this._ctx.rect(0,C*this._deviceCellHeight,this._bufferService.cols*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(C,p){return`${p?"italic":""} ${C?this._optionsService.rawOptions.fontWeightBold:this._optionsService.rawOptions.fontWeight} ${this._optionsService.rawOptions.fontSize*this._coreBrowserService.dpr}px ${this._optionsService.rawOptions.fontFamily}`}}c.BaseRenderLayer=l;class f{constructor(C){this._canvas=C,this._state=0,this._commitTimeout=void 0,this._bitmap=void 0,this.version=-1}get bitmap(){return this._bitmap}refresh(){this._bitmap=void 0,r.isSafari||(this._commitTimeout===void 0&&(this._commitTimeout=window.setTimeout(()=>this._generate(),100)),this._state===1&&(this._state=2))}_generate(){this._state===0&&(this._bitmap=void 0,this._state=1,window.createImageBitmap(this._canvas).then(C=>{this._state===2?this.refresh():this._bitmap=C,this._state=0}),this._commitTimeout&&(this._commitTimeout=void 0))}}},949:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CanvasRenderer=void 0;const m=w(627),g=w(56),d=w(374),u=w(345),b=w(859),v=w(873),a=w(43),i=w(630),h=w(744);class r extends b.Disposable{constructor(l,f,_,C,p,y,L,T,D,B,H){super(),this._terminal=l,this._screenElement=f,this._bufferService=C,this._charSizeService=p,this._optionsService=y,this._coreBrowserService=D,this._themeService=H,this._onRequestRedraw=this.register(new u.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onChangeTextureAtlas=this.register(new u.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new u.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event;const A=this._optionsService.rawOptions.allowTransparency;this._renderLayers=[new h.TextRenderLayer(this._terminal,this._screenElement,0,A,this._bufferService,this._optionsService,L,B,this._coreBrowserService,H),new i.SelectionRenderLayer(this._terminal,this._screenElement,1,this._bufferService,this._coreBrowserService,B,this._optionsService,H),new a.LinkRenderLayer(this._terminal,this._screenElement,2,_,this._bufferService,this._optionsService,B,this._coreBrowserService,H),new v.CursorRenderLayer(this._terminal,this._screenElement,3,this._onRequestRedraw,this._bufferService,this._optionsService,T,this._coreBrowserService,B,H)];for(const F of this._renderLayers)(0,u.forwardEvent)(F.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas);this.dimensions=(0,d.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this.register((0,g.observeDevicePixelDimensions)(this._renderLayers[0].canvas,this._coreBrowserService.window,(F,k)=>this._setCanvasDevicePixelDimensions(F,k))),this.register((0,b.toDisposable)(()=>{for(const F of this._renderLayers)F.dispose();(0,m.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){return this._renderLayers[0].cacheCanvas}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._bufferService.cols,this._bufferService.rows))}handleResize(l,f){this._updateDimensions();for(const _ of this._renderLayers)_.resize(this.dimensions);this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}handleCharSizeChanged(){this.handleResize(this._bufferService.cols,this._bufferService.rows)}handleBlur(){this._runOperation(l=>l.handleBlur())}handleFocus(){this._runOperation(l=>l.handleFocus())}handleSelectionChanged(l,f,_=!1){this._runOperation(C=>C.handleSelectionChanged(l,f,_)),this._themeService.colors.selectionForeground&&this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}handleCursorMove(){this._runOperation(l=>l.handleCursorMove())}clear(){this._runOperation(l=>l.reset())}_runOperation(l){for(const f of this._renderLayers)l(f)}renderRows(l,f){for(const _ of this._renderLayers)_.handleGridChanged(l,f)}clearTextureAtlas(){for(const l of this._renderLayers)l.clearTextureAtlas()}_updateDimensions(){if(!this._charSizeService.hasValidSize)return;const l=this._coreBrowserService.dpr;this.dimensions.device.char.width=Math.floor(this._charSizeService.width*l),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*l),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._bufferService.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._bufferService.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/l),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/l),this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows,this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols}_setCanvasDevicePixelDimensions(l,f){this.dimensions.device.canvas.height=f,this.dimensions.device.canvas.width=l;for(const _ of this._renderLayers)_.resize(this.dimensions);this._requestRedrawViewport()}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})}}c.CanvasRenderer=r},873:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CursorRenderLayer=void 0;const m=w(903),g=w(782),d=w(859);class u extends m.BaseRenderLayer{constructor(a,i,h,r,s,l,f,_,C,p){super(a,i,"cursor",h,!0,p,s,l,C,_),this._onRequestRedraw=r,this._coreService=f,this._cell=new g.CellData,this._state={x:0,y:0,isFocused:!1,style:"",width:0},this._cursorRenderers={bar:this._renderBarCursor.bind(this),block:this._renderBlockCursor.bind(this),underline:this._renderUnderlineCursor.bind(this)},this.register(l.onOptionChange(()=>this._handleOptionsChanged())),this.register((0,d.toDisposable)(()=>{var y;(y=this._cursorBlinkStateManager)===null||y===void 0||y.dispose(),this._cursorBlinkStateManager=void 0}))}resize(a){super.resize(a),this._state={x:0,y:0,isFocused:!1,style:"",width:0}}reset(){var a;this._clearCursor(),(a=this._cursorBlinkStateManager)===null||a===void 0||a.restartBlinkAnimation(),this._handleOptionsChanged()}handleBlur(){var a;(a=this._cursorBlinkStateManager)===null||a===void 0||a.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}handleFocus(){var a;(a=this._cursorBlinkStateManager)===null||a===void 0||a.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}_handleOptionsChanged(){var a;this._optionsService.rawOptions.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new b(this._coreBrowserService.isFocused,()=>{this._render(!0)},this._coreBrowserService)):((a=this._cursorBlinkStateManager)===null||a===void 0||a.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})}handleCursorMove(){var a;(a=this._cursorBlinkStateManager)===null||a===void 0||a.restartBlinkAnimation()}handleGridChanged(a,i){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()}_render(a){if(!this._coreService.isCursorInitialized||this._coreService.isCursorHidden)return void this._clearCursor();const i=this._bufferService.buffer.ybase+this._bufferService.buffer.y,h=i-this._bufferService.buffer.ydisp;if(h<0||h>=this._bufferService.rows)return void this._clearCursor();const r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(i).loadCell(r,this._cell),this._cell.content!==void 0){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css;const s=this._optionsService.rawOptions.cursorStyle;return s&&s!=="block"?this._cursorRenderers[s](r,h,this._cell):this._renderBlurCursor(r,h,this._cell),this._ctx.restore(),this._state.x=r,this._state.y=h,this._state.isFocused=!1,this._state.style=s,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===r&&this._state.y===h&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.rawOptions.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.rawOptions.cursorStyle||"block"](r,h,this._cell),this._ctx.restore(),this._state.x=r,this._state.y=h,this._state.isFocused=!1,this._state.style=this._optionsService.rawOptions.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}_clearCursor(){this._state&&(this._coreBrowserService.dpr<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})}_renderBarCursor(a,i,h){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillLeftLineAtCell(a,i,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()}_renderBlockCursor(a,i,h){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillCells(a,i,h.getWidth(),1),this._ctx.fillStyle=this._themeService.colors.cursorAccent.css,this._fillCharTrueColor(h,a,i),this._ctx.restore()}_renderUnderlineCursor(a,i,h){this._ctx.save(),this._ctx.fillStyle=this._themeService.colors.cursor.css,this._fillBottomLineAtCells(a,i),this._ctx.restore()}_renderBlurCursor(a,i,h){this._ctx.save(),this._ctx.strokeStyle=this._themeService.colors.cursor.css,this._strokeRectAtCell(a,i,h.getWidth(),1),this._ctx.restore()}}c.CursorRenderLayer=u;class b{constructor(a,i,h){this._renderCallback=i,this._coreBrowserService=h,this.isCursorVisible=!0,a&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(a=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){const i=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,i>0)return void this._restartInterval(i)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){const i=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(i)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},a)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},574:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.GridCache=void 0,c.GridCache=class{constructor(){this.cache=[]}resize(w,m){for(let g=0;g<w;g++){this.cache.length<=g&&this.cache.push([]);for(let d=this.cache[g].length;d<m;d++)this.cache[g].push(void 0);this.cache[g].length=m}this.cache.length=w}clear(){for(let w=0;w<this.cache.length;w++)for(let m=0;m<this.cache[w].length;m++)this.cache[w][m]=void 0}}},43:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkRenderLayer=void 0;const m=w(903),g=w(237),d=w(197);class u extends m.BaseRenderLayer{constructor(v,a,i,h,r,s,l,f,_){super(v,a,"link",i,!0,_,r,s,l,f),this.register(h.onShowLinkUnderline(C=>this._handleShowLinkUnderline(C))),this.register(h.onHideLinkUnderline(C=>this._handleHideLinkUnderline(C)))}resize(v){super.resize(v),this._state=void 0}reset(){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);const v=this._state.y2-this._state.y1-1;v>0&&this._clearCells(0,this._state.y1+1,this._state.cols,v),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(v){if(v.fg===g.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:v.fg&&(0,d.is256Color)(v.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[v.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,v.y1===v.y2)this._fillBottomLineAtCells(v.x1,v.y1,v.x2-v.x1);else{this._fillBottomLineAtCells(v.x1,v.y1,v.cols-v.x1);for(let a=v.y1+1;a<v.y2;a++)this._fillBottomLineAtCells(0,a,v.cols);this._fillBottomLineAtCells(0,v.y2,v.x2)}this._state=v}_handleHideLinkUnderline(v){this._clearCurrentLink()}}c.LinkRenderLayer=u},630:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionRenderLayer=void 0;const m=w(903);class g extends m.BaseRenderLayer{constructor(u,b,v,a,i,h,r,s){super(u,b,"selection",v,!0,s,a,r,h,i),this._clearState()}_clearState(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}}resize(u){super.resize(u),this._selectionModel.selectionStart&&this._selectionModel.selectionEnd&&this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}reset(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())}handleBlur(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}handleFocus(){this.reset(),this._redrawSelection(this._selectionModel.selectionStart,this._selectionModel.selectionEnd,this._selectionModel.columnSelectMode)}handleSelectionChanged(u,b,v){super.handleSelectionChanged(u,b,v),this._redrawSelection(u,b,v)}_redrawSelection(u,b,v){if(!this._didStateChange(u,b,v,this._bufferService.buffer.ydisp))return;if(this._clearAll(),!u||!b)return void this._clearState();const a=u[1]-this._bufferService.buffer.ydisp,i=b[1]-this._bufferService.buffer.ydisp,h=Math.max(a,0),r=Math.min(i,this._bufferService.rows-1);if(h>=this._bufferService.rows||r<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=(this._coreBrowserService.isFocused?this._themeService.colors.selectionBackgroundTransparent:this._themeService.colors.selectionInactiveBackgroundTransparent).css,v){const s=u[0],l=b[0]-s,f=r-h+1;this._fillCells(s,h,l,f)}else{const s=a===h?u[0]:0,l=h===i?b[0]:this._bufferService.cols;this._fillCells(s,h,l-s,1);const f=Math.max(r-h-1,0);if(this._fillCells(0,h+1,this._bufferService.cols,f),h!==r){const _=i===r?b[0]:this._bufferService.cols;this._fillCells(0,r,_,1)}}this._state.start=[u[0],u[1]],this._state.end=[b[0],b[1]],this._state.columnSelectMode=v,this._state.ydisp=this._bufferService.buffer.ydisp}}_didStateChange(u,b,v,a){return!this._areCoordinatesEqual(u,this._state.start)||!this._areCoordinatesEqual(b,this._state.end)||v!==this._state.columnSelectMode||a!==this._state.ydisp}_areCoordinatesEqual(u,b){return!(!u||!b)&&u[0]===b[0]&&u[1]===b[1]}}c.SelectionRenderLayer=g},744:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextRenderLayer=void 0;const m=w(574),g=w(903),d=w(147),u=w(855),b=w(782),v=w(577),a=w(160);class i extends g.BaseRenderLayer{constructor(r,s,l,f,_,C,p,y,L,T){super(r,s,"text",l,f,T,_,C,y,L),this._characterJoinerService=p,this._characterWidth=0,this._characterFont="",this._characterOverlapCache={},this._workCell=new b.CellData,this._state=new m.GridCache,this.register(C.onSpecificOptionChange("allowTransparency",D=>this._setTransparency(D)))}resize(r){super.resize(r);const s=this._getFont(!1,!1);this._characterWidth===r.device.char.width&&this._characterFont===s||(this._characterWidth=r.device.char.width,this._characterFont=s,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)}reset(){this._state.clear(),this._clearAll()}_forEachCell(r,s,l){for(let f=r;f<=s;f++){const _=f+this._bufferService.buffer.ydisp,C=this._bufferService.buffer.lines.get(_),p=this._characterJoinerService.getJoinedCharacters(_);for(let y=0;y<this._bufferService.cols;y++){C.loadCell(y,this._workCell);let L=this._workCell,T=!1,D=y;if(L.getWidth()===0)continue;const B=L.getCode();if(B!==0&&B!==32){if(p.length>0&&y===p[0][0]){T=!0;const H=p.shift();L=new v.JoinedCellData(this._workCell,C.translateToString(!0,H[0],H[1]),H[1]-H[0]),D=H[1]-1}!T&&this._isOverlapping(L)&&D<C.length-1&&C.getCodePoint(D+1)===u.NULL_CELL_CODE&&(L.content&=-12582913,L.content|=8388608),l(L,y,f),y=D}}}}_drawBackground(r,s){const l=this._ctx,f=this._bufferService.cols;let _=0,C=0,p=null;l.save(),this._forEachCell(r,s,(y,L,T)=>{let D=null;y.isInverse()?D=y.isFgDefault()?this._themeService.colors.foreground.css:y.isFgRGB()?`rgb(${d.AttributeData.toColorRGB(y.getFgColor()).join(",")})`:this._themeService.colors.ansi[y.getFgColor()].css:y.isBgRGB()?D=`rgb(${d.AttributeData.toColorRGB(y.getBgColor()).join(",")})`:y.isBgPalette()&&(D=this._themeService.colors.ansi[y.getBgColor()].css),D&&y.isDim()&&(D=a.color.multiplyOpacity(a.css.toColor(D),.5).css);let B=!1;this._decorationService.forEachDecorationAtCell(L,this._bufferService.buffer.ydisp+T,void 0,H=>{H.options.layer!=="top"&&B||(H.backgroundColorRGB&&(D=H.backgroundColorRGB.css),B=H.options.layer==="top")}),p===null&&(_=L,C=T),T!==C?(l.fillStyle=p||"",this._fillCells(_,C,f-_,1),_=L,C=T):p!==D&&(l.fillStyle=p||"",this._fillCells(_,C,L-_,1),_=L,C=T),p=D}),p!==null&&(l.fillStyle=p,this._fillCells(_,C,f-_,1)),l.restore()}_drawForeground(r,s){this._forEachCell(r,s,(l,f,_)=>this._drawChars(l,f,_))}handleGridChanged(r,s){this._state.cache.length!==0&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,r,this._bufferService.cols,s-r+1),this._drawBackground(r,s),this._drawForeground(r,s))}_isOverlapping(r){if(r.getWidth()!==1||r.getCode()<256)return!1;const s=r.getChars();if(this._characterOverlapCache.hasOwnProperty(s))return this._characterOverlapCache[s];this._ctx.save(),this._ctx.font=this._characterFont;const l=Math.floor(this._ctx.measureText(s).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[s]=l,l}}c.TextRenderLayer=i},503:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.removeElementFromParent=void 0,c.removeElementFromParent=function(...w){var m;for(const g of w)(m=g==null?void 0:g.parentElement)===null||m===void 0||m.removeChild(g)}},274:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellColorResolver=void 0;let w,m=0,g=0,d=!1,u=!1,b=!1;c.CellColorResolver=class{constructor(v,a,i,h,r){this._terminal=v,this._selectionRenderModel=a,this._decorationService=i,this._coreBrowserService=h,this._themeService=r,this.result={fg:0,bg:0,ext:0}}resolve(v,a,i){this.result.bg=v.bg,this.result.fg=v.fg,this.result.ext=268435456&v.bg?v.extended.ext:0,g=0,m=0,u=!1,d=!1,b=!1,w=this._themeService.colors,this._decorationService.forEachDecorationAtCell(a,i,"bottom",h=>{h.backgroundColorRGB&&(g=h.backgroundColorRGB.rgba>>8&16777215,u=!0),h.foregroundColorRGB&&(m=h.foregroundColorRGB.rgba>>8&16777215,d=!0)}),b=this._selectionRenderModel.isCellSelected(this._terminal,a,i),b&&(g=(this._coreBrowserService.isFocused?w.selectionBackgroundOpaque:w.selectionInactiveBackgroundOpaque).rgba>>8&16777215,u=!0,w.selectionForeground&&(m=w.selectionForeground.rgba>>8&16777215,d=!0)),this._decorationService.forEachDecorationAtCell(a,i,"top",h=>{h.backgroundColorRGB&&(g=h.backgroundColorRGB.rgba>>8&16777215,u=!0),h.foregroundColorRGB&&(m=h.foregroundColorRGB.rgba>>8&16777215,d=!0)}),u&&(g=b?-16777216&v.bg&-134217729|g|50331648:-16777216&v.bg|g|50331648),d&&(m=-16777216&v.fg&-67108865|m|50331648),67108864&this.result.fg&&(u&&!d&&(m=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&w.background.rgba>>8|50331648,d=!0),!u&&d&&(g=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&w.foreground.rgba>>8|50331648,u=!0)),w=void 0,this.result.bg=u?g:this.result.bg,this.result.fg=d?m:this.result.fg}}},627:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.removeTerminalFromCache=c.acquireTextureAtlas=void 0;const m=w(509),g=w(197),d=[];c.acquireTextureAtlas=function(u,b,v,a,i,h,r,s){const l=(0,g.generateConfig)(a,i,h,r,b,v,s);for(let C=0;C<d.length;C++){const p=d[C],y=p.ownedBy.indexOf(u);if(y>=0){if((0,g.configEquals)(p.config,l))return p.atlas;p.ownedBy.length===1?(p.atlas.dispose(),d.splice(C,1)):p.ownedBy.splice(y,1);break}}for(let C=0;C<d.length;C++){const p=d[C];if((0,g.configEquals)(p.config,l))return p.ownedBy.push(u),p.atlas}const f=u._core,_={atlas:new m.TextureAtlas(document,l,f.unicodeService),config:l,ownedBy:[u]};return d.push(_),_.atlas},c.removeTerminalFromCache=function(u){for(let b=0;b<d.length;b++){const v=d[b].ownedBy.indexOf(u);if(v!==-1){d[b].ownedBy.length===1?(d[b].atlas.dispose(),d.splice(b,1)):d[b].ownedBy.splice(v,1);break}}}},197:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.is256Color=c.configEquals=c.generateConfig=void 0;const m=w(160);c.generateConfig=function(g,d,u,b,v,a,i){const h={foreground:a.foreground,background:a.background,cursor:m.NULL_COLOR,cursorAccent:m.NULL_COLOR,selectionForeground:m.NULL_COLOR,selectionBackgroundTransparent:m.NULL_COLOR,selectionBackgroundOpaque:m.NULL_COLOR,selectionInactiveBackgroundTransparent:m.NULL_COLOR,selectionInactiveBackgroundOpaque:m.NULL_COLOR,ansi:a.ansi.slice(),contrastCache:a.contrastCache};return{customGlyphs:v.customGlyphs,devicePixelRatio:i,letterSpacing:v.letterSpacing,lineHeight:v.lineHeight,deviceCellWidth:g,deviceCellHeight:d,deviceCharWidth:u,deviceCharHeight:b,fontFamily:v.fontFamily,fontSize:v.fontSize,fontWeight:v.fontWeight,fontWeightBold:v.fontWeightBold,allowTransparency:v.allowTransparency,drawBoldTextInBrightColors:v.drawBoldTextInBrightColors,minimumContrastRatio:v.minimumContrastRatio,colors:h}},c.configEquals=function(g,d){for(let u=0;u<g.colors.ansi.length;u++)if(g.colors.ansi[u].rgba!==d.colors.ansi[u].rgba)return!1;return g.devicePixelRatio===d.devicePixelRatio&&g.customGlyphs===d.customGlyphs&&g.lineHeight===d.lineHeight&&g.letterSpacing===d.letterSpacing&&g.fontFamily===d.fontFamily&&g.fontSize===d.fontSize&&g.fontWeight===d.fontWeight&&g.fontWeightBold===d.fontWeightBold&&g.allowTransparency===d.allowTransparency&&g.deviceCharWidth===d.deviceCharWidth&&g.deviceCharHeight===d.deviceCharHeight&&g.drawBoldTextInBrightColors===d.drawBoldTextInBrightColors&&g.minimumContrastRatio===d.minimumContrastRatio&&g.colors.foreground.rgba===d.colors.foreground.rgba&&g.colors.background.rgba===d.colors.background.rgba},c.is256Color=function(g){return(50331648&g)==16777216||(50331648&g)==33554432}},237:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const m=w(399);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=m.isFirefox||m.isLegacyEdge?"bottom":"ideographic"},860:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tryDrawCustomChar=c.powerlineDefinitions=c.boxDrawingDefinitions=c.blockElementDefinitions=void 0;const m=w(374);c.blockElementDefinitions={"":[{x:0,y:0,w:8,h:4}],"":[{x:0,y:7,w:8,h:1}],"":[{x:0,y:6,w:8,h:2}],"":[{x:0,y:5,w:8,h:3}],"":[{x:0,y:4,w:8,h:4}],"":[{x:0,y:3,w:8,h:5}],"":[{x:0,y:2,w:8,h:6}],"":[{x:0,y:1,w:8,h:7}],"":[{x:0,y:0,w:8,h:8}],"":[{x:0,y:0,w:7,h:8}],"":[{x:0,y:0,w:6,h:8}],"":[{x:0,y:0,w:5,h:8}],"":[{x:0,y:0,w:4,h:8}],"":[{x:0,y:0,w:3,h:8}],"":[{x:0,y:0,w:2,h:8}],"":[{x:0,y:0,w:1,h:8}],"":[{x:4,y:0,w:4,h:8}],"":[{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8}],"":[{x:0,y:4,w:4,h:4}],"":[{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"":[{x:4,y:0,w:4,h:4}],"":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"":[{x:1,y:0,w:1,h:8}],"":[{x:2,y:0,w:1,h:8}],"":[{x:3,y:0,w:1,h:8}],"":[{x:4,y:0,w:1,h:8}],"":[{x:5,y:0,w:1,h:8}],"":[{x:6,y:0,w:1,h:8}],"":[{x:0,y:1,w:8,h:1}],"":[{x:0,y:2,w:8,h:1}],"":[{x:0,y:3,w:8,h:1}],"":[{x:0,y:4,w:8,h:1}],"":[{x:0,y:5,w:8,h:1}],"":[{x:0,y:6,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"":[{x:0,y:0,w:8,h:2}],"":[{x:0,y:0,w:8,h:3}],"":[{x:0,y:0,w:8,h:5}],"":[{x:0,y:0,w:8,h:6}],"":[{x:0,y:0,w:8,h:7}],"":[{x:6,y:0,w:2,h:8}],"":[{x:5,y:0,w:3,h:8}],"":[{x:3,y:0,w:5,h:8}],"":[{x:2,y:0,w:6,h:8}],"":[{x:1,y:0,w:7,h:8}],"":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};const g={"":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"":[[1,0],[0,0],[0,1],[0,0]],"":[[0,1],[1,1],[1,0],[1,1]]};c.boxDrawingDefinitions={"":{1:"M0,.5 L1,.5"},"":{3:"M0,.5 L1,.5"},"":{1:"M.5,0 L.5,1"},"":{3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5"},"":{3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M0,.5 L.5,.5 L.5,1"},"":{3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L1,.5"},"":{3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L0,.5"},"":{3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"":{1:"M.5,.5 L0,.5"},"":{3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0"},"":{3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5"},"":{3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1"},"":{3:"M.5,.5 L.5,1"},"":{1:(a,i)=>`M0,${.5-i} L1,${.5-i} M0,${.5+i} L1,${.5+i}`},"":{1:(a,i)=>`M${.5-a},0 L${.5-a},1 M${.5+a},0 L${.5+a},1`},"":{1:(a,i)=>`M.5,1 L.5,${.5-i} L1,${.5-i} M.5,${.5+i} L1,${.5+i}`},"":{1:(a,i)=>`M${.5-a},1 L${.5-a},.5 L1,.5 M${.5+a},.5 L${.5+a},1`},"":{1:(a,i)=>`M1,${.5-i} L${.5-a},${.5-i} L${.5-a},1 M1,${.5+i} L${.5+a},${.5+i} L${.5+a},1`},"":{1:(a,i)=>`M0,${.5-i} L.5,${.5-i} L.5,1 M0,${.5+i} L.5,${.5+i}`},"":{1:(a,i)=>`M${.5+a},1 L${.5+a},.5 L0,.5 M${.5-a},.5 L${.5-a},1`},"":{1:(a,i)=>`M0,${.5+i} L${.5-a},${.5+i} L${.5-a},1 M0,${.5-i} L${.5+a},${.5-i} L${.5+a},1`},"":{1:(a,i)=>`M.5,0 L.5,${.5+i} L1,${.5+i} M.5,${.5-i} L1,${.5-i}`},"":{1:(a,i)=>`M1,.5 L${.5-a},.5 L${.5-a},0 M${.5+a},.5 L${.5+a},0`},"":{1:(a,i)=>`M1,${.5-i} L${.5+a},${.5-i} L${.5+a},0 M1,${.5+i} L${.5-a},${.5+i} L${.5-a},0`},"":{1:(a,i)=>`M0,${.5+i} L.5,${.5+i} L.5,0 M0,${.5-i} L.5,${.5-i}`},"":{1:(a,i)=>`M0,.5 L${.5+a},.5 L${.5+a},0 M${.5-a},.5 L${.5-a},0`},"":{1:(a,i)=>`M0,${.5-i} L${.5-a},${.5-i} L${.5-a},0 M0,${.5+i} L${.5+a},${.5+i} L${.5+a},0`},"":{1:(a,i)=>`M.5,0 L.5,1 M.5,${.5-i} L1,${.5-i} M.5,${.5+i} L1,${.5+i}`},"":{1:(a,i)=>`M${.5-a},0 L${.5-a},1 M${.5+a},0 L${.5+a},1 M${.5+a},.5 L1,.5`},"":{1:(a,i)=>`M${.5-a},0 L${.5-a},1 M1,${.5+i} L${.5+a},${.5+i} L${.5+a},1 M1,${.5-i} L${.5+a},${.5-i} L${.5+a},0`},"":{1:(a,i)=>`M.5,0 L.5,1 M0,${.5-i} L.5,${.5-i} M0,${.5+i} L.5,${.5+i}`},"":{1:(a,i)=>`M0,.5 L${.5-a},.5 M${.5-a},0 L${.5-a},1 M${.5+a},0 L${.5+a},1`},"":{1:(a,i)=>`M${.5+a},0 L${.5+a},1 M0,${.5+i} L${.5-a},${.5+i} L${.5-a},1 M0,${.5-i} L${.5-a},${.5-i} L${.5-a},0`},"":{1:(a,i)=>`M0,${.5-i} L1,${.5-i} M0,${.5+i} L1,${.5+i} M.5,${.5+i} L.5,1`},"":{1:(a,i)=>`M0,.5 L1,.5 M${.5-a},.5 L${.5-a},1 M${.5+a},.5 L${.5+a},1`},"":{1:(a,i)=>`M0,${.5-i} L1,${.5-i} M0,${.5+i} L${.5-a},${.5+i} L${.5-a},1 M1,${.5+i} L${.5+a},${.5+i} L${.5+a},1`},"":{1:(a,i)=>`M.5,0 L.5,${.5-i} M0,${.5-i} L1,${.5-i} M0,${.5+i} L1,${.5+i}`},"":{1:(a,i)=>`M0,.5 L1,.5 M${.5-a},.5 L${.5-a},0 M${.5+a},.5 L${.5+a},0`},"":{1:(a,i)=>`M0,${.5+i} L1,${.5+i} M0,${.5-i} L${.5-a},${.5-i} L${.5-a},0 M1,${.5-i} L${.5+a},${.5-i} L${.5+a},0`},"":{1:(a,i)=>`M.5,0 L.5,1 M0,${.5-i} L1,${.5-i} M0,${.5+i} L1,${.5+i}`},"":{1:(a,i)=>`M0,.5 L1,.5 M${.5-a},0 L${.5-a},1 M${.5+a},0 L${.5+a},1`},"":{1:(a,i)=>`M0,${.5+i} L${.5-a},${.5+i} L${.5-a},1 M1,${.5+i} L${.5+a},${.5+i} L${.5+a},1 M0,${.5-i} L${.5-a},${.5-i} L${.5-a},0 M1,${.5-i} L${.5+a},${.5-i} L${.5+a},0`},"":{1:"M1,0 L0,1"},"":{1:"M0,0 L1,1"},"":{1:"M1,0 L0,1 M0,0 L1,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"":{1:(a,i)=>`M.5,1 L.5,${.5+i/.15*.5} C.5,${.5+i/.15*.5},.5,.5,1,.5`},"":{1:(a,i)=>`M.5,1 L.5,${.5+i/.15*.5} C.5,${.5+i/.15*.5},.5,.5,0,.5`},"":{1:(a,i)=>`M.5,0 L.5,${.5-i/.15*.5} C.5,${.5-i/.15*.5},.5,.5,0,.5`},"":{1:(a,i)=>`M.5,0 L.5,${.5-i/.15*.5} C.5,${.5-i/.15*.5},.5,.5,1,.5`}},c.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"":{d:"M0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:1,rightPadding:1},"":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"":{d:"M1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:1,leftPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},c.powerlineDefinitions[""]=c.powerlineDefinitions[""],c.powerlineDefinitions[""]=c.powerlineDefinitions[""],c.tryDrawCustomChar=function(a,i,h,r,s,l,f,_){const C=c.blockElementDefinitions[i];if(C)return function(T,D,B,H,A,F){for(let k=0;k<D.length;k++){const O=D[k],I=A/8,P=F/8;T.fillRect(B+O.x*I,H+O.y*P,O.w*I,O.h*P)}}(a,C,h,r,s,l),!0;const p=g[i];if(p)return function(T,D,B,H,A,F){let k=d.get(D);k||(k=new Map,d.set(D,k));const O=T.fillStyle;if(typeof O!="string")throw new Error(`Unexpected fillStyle type "${O}"`);let I=k.get(O);if(!I){const P=D[0].length,V=D.length,te=document.createElement("canvas");te.width=P,te.height=V;const he=(0,m.throwIfFalsy)(te.getContext("2d")),J=new ImageData(P,V);let le,G,z,W;if(O.startsWith("#"))le=parseInt(O.slice(1,3),16),G=parseInt(O.slice(3,5),16),z=parseInt(O.slice(5,7),16),W=O.length>7&&parseInt(O.slice(7,9),16)||1;else{if(!O.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${O}" when drawing pattern glyph`);[le,G,z,W]=O.substring(5,O.length-1).split(",").map(Z=>parseFloat(Z))}for(let Z=0;Z<V;Z++)for(let ne=0;ne<P;ne++)J.data[4*(Z*P+ne)]=le,J.data[4*(Z*P+ne)+1]=G,J.data[4*(Z*P+ne)+2]=z,J.data[4*(Z*P+ne)+3]=D[Z][ne]*(255*W);he.putImageData(J,0,0),I=(0,m.throwIfFalsy)(T.createPattern(te,null)),k.set(O,I)}T.fillStyle=I,T.fillRect(B,H,A,F)}(a,p,h,r,s,l),!0;const y=c.boxDrawingDefinitions[i];if(y)return function(T,D,B,H,A,F,k){T.strokeStyle=T.fillStyle;for(const[O,I]of Object.entries(D)){let P;T.beginPath(),T.lineWidth=k*Number.parseInt(O),P=typeof I=="function"?I(.15,.15/F*A):I;for(const V of P.split(" ")){const te=V[0],he=b[te];if(!he){console.error(`Could not find drawing instructions for "${te}"`);continue}const J=V.substring(1).split(",");J[0]&&J[1]&&he(T,v(J,A,F,B,H,!0,k))}T.stroke(),T.closePath()}}(a,y,h,r,s,l,_),!0;const L=c.powerlineDefinitions[i];return!!L&&(function(T,D,B,H,A,F,k,O){var I,P;const V=new Path2D;V.rect(B,H,A,F),T.clip(V),T.beginPath();const te=k/12;T.lineWidth=O*te;for(const he of D.d.split(" ")){const J=he[0],le=b[J];if(!le){console.error(`Could not find drawing instructions for "${J}"`);continue}const G=he.substring(1).split(",");G[0]&&G[1]&&le(T,v(G,A,F,B,H,!1,O,((I=D.leftPadding)!==null&&I!==void 0?I:0)*(te/2),((P=D.rightPadding)!==null&&P!==void 0?P:0)*(te/2)))}D.type===1?(T.strokeStyle=T.fillStyle,T.stroke()):T.fill(),T.closePath()}(a,L,h,r,s,l,f,_),!0)};const d=new Map;function u(a,i,h=0){return Math.max(Math.min(a,i),h)}const b={C:(a,i)=>a.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]),L:(a,i)=>a.lineTo(i[0],i[1]),M:(a,i)=>a.moveTo(i[0],i[1])};function v(a,i,h,r,s,l,f,_=0,C=0){const p=a.map(y=>parseFloat(y)||parseInt(y));if(p.length<2)throw new Error("Too few arguments for instruction");for(let y=0;y<p.length;y+=2)p[y]*=i-_*f-C*f,l&&p[y]!==0&&(p[y]=u(Math.round(p[y]+.5)-.5,i,0)),p[y]+=r+_*f;for(let y=1;y<p.length;y+=2)p[y]*=h,l&&p[y]!==0&&(p[y]=u(Math.round(p[y]+.5)-.5,h,0)),p[y]+=s;return p}},56:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.observeDevicePixelDimensions=void 0;const m=w(859);c.observeDevicePixelDimensions=function(g,d,u){let b=new d.ResizeObserver(v=>{const a=v.find(r=>r.target===g);if(!a)return;if(!("devicePixelContentBoxSize"in a))return b==null||b.disconnect(),void(b=void 0);const i=a.devicePixelContentBoxSize[0].inlineSize,h=a.devicePixelContentBoxSize[0].blockSize;i>0&&h>0&&u(i,h)});try{b.observe(g,{box:["device-pixel-content-box"]})}catch{b.disconnect(),b=void 0}return(0,m.toDisposable)(()=>b==null?void 0:b.disconnect())}},374:(K,c)=>{function w(m){return 57508<=m&&m<=57558}Object.defineProperty(c,"__esModule",{value:!0}),c.createRenderDimensions=c.excludeFromContrastRatioDemands=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(m){if(!m)throw new Error("value must not be falsy");return m},c.isPowerlineGlyph=w,c.isRestrictedPowerlineGlyph=function(m){return 57520<=m&&m<=57527},c.excludeFromContrastRatioDemands=function(m){return w(m)||function(g){return 9472<=g&&g<=9631}(m)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createSelectionRenderModel=void 0;class w{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(g,d,u,b=!1){if(this.selectionStart=d,this.selectionEnd=u,!d||!u||d[0]===u[0]&&d[1]===u[1])return void this.clear();const v=d[1]-g.buffer.active.viewportY,a=u[1]-g.buffer.active.viewportY,i=Math.max(v,0),h=Math.min(a,g.rows-1);i>=g.rows||h<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=b,this.viewportStartRow=v,this.viewportEndRow=a,this.viewportCappedStartRow=i,this.viewportCappedEndRow=h,this.startCol=d[0],this.endCol=u[0])}isCellSelected(g,d,u){return!!this.hasSelection&&(u-=g.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?d>=this.startCol&&u>=this.viewportCappedStartRow&&d<this.endCol&&u<=this.viewportCappedEndRow:d<this.startCol&&u>=this.viewportCappedStartRow&&d>=this.endCol&&u<=this.viewportCappedEndRow:u>this.viewportStartRow&&u<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&u===this.viewportStartRow&&d>=this.startCol&&d<this.endCol||this.viewportStartRow<this.viewportEndRow&&u===this.viewportEndRow&&d<this.endCol||this.viewportStartRow<this.viewportEndRow&&u===this.viewportStartRow&&d>=this.startCol)}}c.createSelectionRenderModel=function(){return new w}},509:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TextureAtlas=void 0;const m=w(237),g=w(855),d=w(147),u=w(160),b=w(860),v=w(374),a=w(485),i=w(385),h=w(345),r={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};let s;class l{constructor(y,L,T){this._document=y,this._config=L,this._unicodeService=T,this._didWarmUp=!1,this._cacheMap=new a.FourKeyMap,this._cacheMapCombined=new a.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new d.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new h.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new h.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=C(y,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,v.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}get pages(){return this._pages}dispose(){for(const y of this.pages)y.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){const y=new i.IdleTaskQueue;for(let L=33;L<126;L++)y.enqueue(()=>{if(!this._cacheMap.get(L,g.DEFAULT_COLOR,g.DEFAULT_COLOR,g.DEFAULT_EXT)){const T=this._drawToCache(L,g.DEFAULT_COLOR,g.DEFAULT_COLOR,g.DEFAULT_EXT);this._cacheMap.set(L,g.DEFAULT_COLOR,g.DEFAULT_COLOR,g.DEFAULT_EXT,T)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(const y of this._pages)y.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){l.maxAtlasPages&&this._pages.length>=Math.max(4,l.maxAtlasPages/2)&&queueMicrotask(()=>{const L=this._pages.filter(k=>2*k.canvas.width<=(l.maxTextureSize||4096)).sort((k,O)=>O.canvas.width!==k.canvas.width?O.canvas.width-k.canvas.width:O.percentageUsed-k.percentageUsed);let T=-1,D=0;for(let k=0;k<L.length;k++)if(L[k].canvas.width!==D)T=k,D=L[k].canvas.width;else if(k-T==3)break;const B=L.slice(T,T+4),H=B.map(k=>k.glyphs[0].texturePage).sort((k,O)=>k>O?1:-1),A=H[0],F=this._mergePages(B,A);F.version++,this._pages[A]=F;for(let k=H.length-1;k>=1;k--)this._deletePage(H[k]);this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(F.canvas)});const y=new f(this._document,this._textureSize);return this._pages.push(y),this._activePages.push(y),this._onAddTextureAtlasCanvas.fire(y.canvas),y}_mergePages(y,L){const T=2*y[0].canvas.width,D=new f(this._document,T,y);for(const[B,H]of y.entries()){const A=B*H.canvas.width%T,F=Math.floor(B/2)*H.canvas.height;D.ctx.drawImage(H.canvas,A,F);for(const O of H.glyphs)O.texturePage=L,O.sizeClipSpace.x=O.size.x/T,O.sizeClipSpace.y=O.size.y/T,O.texturePosition.x+=A,O.texturePosition.y+=F,O.texturePositionClipSpace.x=O.texturePosition.x/T,O.texturePositionClipSpace.y=O.texturePosition.y/T;this._onRemoveTextureAtlasCanvas.fire(H.canvas);const k=this._activePages.indexOf(H);k!==-1&&this._activePages.splice(k,1)}return D}_deletePage(y){this._pages.splice(y,1);for(let L=y;L<this._pages.length;L++){const T=this._pages[L];for(const D of T.glyphs)D.texturePage--;T.version++}}getRasterizedGlyphCombinedChar(y,L,T,D){return this._getFromCacheMap(this._cacheMapCombined,y,L,T,D)}getRasterizedGlyph(y,L,T,D){return this._getFromCacheMap(this._cacheMap,y,L,T,D)}_getFromCacheMap(y,L,T,D,B){return s=y.get(L,T,D,B),s||(s=this._drawToCache(L,T,D,B),y.set(L,T,D,B,s)),s}_getColorFromAnsiIndex(y){if(y>=this._config.colors.ansi.length)throw new Error("No color found for idx "+y);return this._config.colors.ansi[y]}_getBackgroundColor(y,L,T,D){if(this._config.allowTransparency)return u.NULL_COLOR;let B;switch(y){case 16777216:case 33554432:B=this._getColorFromAnsiIndex(L);break;case 50331648:const H=d.AttributeData.toColorRGB(L);B=u.rgba.toColor(H[0],H[1],H[2]);break;default:B=T?this._config.colors.foreground:this._config.colors.background}return D&&(B=u.color.blend(this._config.colors.background,u.color.multiplyOpacity(B,m.DIM_OPACITY))),B}_getForegroundColor(y,L,T,D,B,H,A,F,k,O){const I=this._getMinimumContrastColor(y,L,T,D,B,H,!1,k,O);if(I)return I;let P;switch(B){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&k&&H<8&&(H+=8),P=this._getColorFromAnsiIndex(H);break;case 50331648:const V=d.AttributeData.toColorRGB(H);P=u.rgba.toColor(V[0],V[1],V[2]);break;default:P=A?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(P=u.color.opaque(P)),F&&(P=u.color.multiplyOpacity(P,m.DIM_OPACITY)),P}_resolveBackgroundRgba(y,L,T){switch(y){case 16777216:case 33554432:return this._getColorFromAnsiIndex(L).rgba;case 50331648:return L<<8;default:return T?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(y,L,T,D){switch(y){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&D&&L<8&&(L+=8),this._getColorFromAnsiIndex(L).rgba;case 50331648:return L<<8;default:return T?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(y,L,T,D,B,H,A,F,k){if(this._config.minimumContrastRatio===1||k)return;const O=this._config.colors.contrastCache.getColor(y,D);if(O!==void 0)return O||void 0;const I=this._resolveBackgroundRgba(L,T,A),P=this._resolveForegroundRgba(B,H,A,F),V=u.rgba.ensureContrastRatio(I,P,this._config.minimumContrastRatio);if(!V)return void this._config.colors.contrastCache.setColor(y,D,null);const te=u.rgba.toColor(V>>24&255,V>>16&255,V>>8&255);return this._config.colors.contrastCache.setColor(y,D,te),te}_drawToCache(y,L,T,D){const B=typeof y=="number"?String.fromCharCode(y):y,H=this._config.deviceCellWidth*Math.max(B.length,2)+4;this._tmpCanvas.width<H&&(this._tmpCanvas.width=H);const A=this._config.deviceCellHeight+8;if(this._tmpCanvas.height<A&&(this._tmpCanvas.height=A),this._tmpCtx.save(),this._workAttributeData.fg=T,this._workAttributeData.bg=L,this._workAttributeData.extended.ext=D,this._workAttributeData.isInvisible())return r;const F=!!this._workAttributeData.isBold(),k=!!this._workAttributeData.isInverse(),O=!!this._workAttributeData.isDim(),I=!!this._workAttributeData.isItalic(),P=!!this._workAttributeData.isUnderline(),V=!!this._workAttributeData.isStrikethrough();let te=this._workAttributeData.getFgColor(),he=this._workAttributeData.getFgColorMode(),J=this._workAttributeData.getBgColor(),le=this._workAttributeData.getBgColorMode();if(k){const be=te;te=J,J=be;const Ee=he;he=le,le=Ee}const G=this._getBackgroundColor(le,J,k,O);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=G.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";const z=F?this._config.fontWeightBold:this._config.fontWeight,W=I?"italic":"";this._tmpCtx.font=`${W} ${z} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=m.TEXT_BASELINE;const Z=B.length===1&&(0,v.isPowerlineGlyph)(B.charCodeAt(0)),ne=B.length===1&&(0,v.isRestrictedPowerlineGlyph)(B.charCodeAt(0)),we=this._getForegroundColor(L,le,J,T,he,te,k,O,F,(0,v.excludeFromContrastRatioDemands)(B.charCodeAt(0)));this._tmpCtx.fillStyle=we.css;const se=ne?0:4;let Me=!1;this._config.customGlyphs!==!1&&(Me=(0,b.tryDrawCustomChar)(this._tmpCtx,B,se,se,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let X,ke=!Z;if(X=typeof y=="number"?this._unicodeService.wcwidth(y):this._unicodeService.getStringCellWidth(y),P){this._tmpCtx.save();const be=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),Ee=be%2==1?.5:0;if(this._tmpCtx.lineWidth=be,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())ke=!1,this._tmpCtx.strokeStyle=`rgb(${d.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{ke=!1;let ze=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&ze<8&&(ze+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(ze).css}this._tmpCtx.beginPath();const Pe=se,Ne=Math.ceil(se+this._config.deviceCharHeight)-Ee,rt=se+this._config.deviceCharHeight+be-Ee,Qe=Math.ceil(se+this._config.deviceCharHeight+2*be)-Ee;for(let ze=0;ze<X;ze++){this._tmpCtx.save();const Ae=Pe+ze*this._config.deviceCellWidth,Ke=Pe+(ze+1)*this._config.deviceCellWidth,bt=Ae+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(Ae,Ne),this._tmpCtx.lineTo(Ke,Ne),this._tmpCtx.moveTo(Ae,Qe),this._tmpCtx.lineTo(Ke,Qe);break;case 3:const nt=be<=1?Qe:Math.ceil(se+this._config.deviceCharHeight-be/2)-Ee,dt=be<=1?Ne:Math.ceil(se+this._config.deviceCharHeight+be/2)-Ee,Et=new Path2D;Et.rect(Ae,Ne,this._config.deviceCellWidth,Qe-Ne),this._tmpCtx.clip(Et),this._tmpCtx.moveTo(Ae-this._config.deviceCellWidth/2,rt),this._tmpCtx.bezierCurveTo(Ae-this._config.deviceCellWidth/2,dt,Ae,dt,Ae,rt),this._tmpCtx.bezierCurveTo(Ae,nt,bt,nt,bt,rt),this._tmpCtx.bezierCurveTo(bt,dt,Ke,dt,Ke,rt),this._tmpCtx.bezierCurveTo(Ke,nt,Ke+this._config.deviceCellWidth/2,nt,Ke+this._config.deviceCellWidth/2,rt);break;case 4:this._tmpCtx.setLineDash([2*this._config.devicePixelRatio,this._config.devicePixelRatio]),this._tmpCtx.moveTo(Ae,Ne),this._tmpCtx.lineTo(Ke,Ne);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(Ae,Ne),this._tmpCtx.lineTo(Ke,Ne);break;default:this._tmpCtx.moveTo(Ae,Ne),this._tmpCtx.lineTo(Ke,Ne)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!Me&&this._config.fontSize>=12&&!this._config.allowTransparency&&B!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";const ze=this._tmpCtx.measureText(B);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in ze&&ze.actualBoundingBoxDescent>0){this._tmpCtx.save();const Ae=new Path2D;Ae.rect(Pe,Ne-Math.ceil(be/2),this._config.deviceCellWidth,Qe-Ne+Math.ceil(be/2)),this._tmpCtx.clip(Ae),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=G.css,this._tmpCtx.strokeText(B,se,se+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(Me||this._tmpCtx.fillText(B,se,se+this._config.deviceCharHeight),B==="_"&&!this._config.allowTransparency){let be=_(this._tmpCtx.getImageData(se,se,this._config.deviceCellWidth,this._config.deviceCellHeight),G,we,ke);if(be)for(let Ee=1;Ee<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=G.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(B,se,se+this._config.deviceCharHeight-Ee),be=_(this._tmpCtx.getImageData(se,se,this._config.deviceCellWidth,this._config.deviceCellHeight),G,we,ke),be);Ee++);}if(V){const be=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),Ee=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=be,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(se,se+Math.floor(this._config.deviceCharHeight/2)-Ee),this._tmpCtx.lineTo(se+this._config.deviceCharWidth*X,se+Math.floor(this._config.deviceCharHeight/2)-Ee),this._tmpCtx.stroke()}this._tmpCtx.restore();const ae=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);let _t;if(_t=this._config.allowTransparency?function(be){for(let Ee=0;Ee<be.data.length;Ee+=4)if(be.data[Ee+3]>0)return!1;return!0}(ae):_(ae,G,we,ke),_t)return r;const Re=this._findGlyphBoundingBox(ae,this._workBoundingBox,H,ne,Me,se);let xe,Ce;for(;;){if(this._activePages.length===0){const be=this._createNewPage();xe=be,Ce=be.currentRow,Ce.height=Re.size.y;break}xe=this._activePages[this._activePages.length-1],Ce=xe.currentRow;for(const be of this._activePages)Re.size.y<=be.currentRow.height&&(xe=be,Ce=be.currentRow);for(let be=this._activePages.length-1;be>=0;be--)for(const Ee of this._activePages[be].fixedRows)Ee.height<=Ce.height&&Re.size.y<=Ee.height&&(xe=this._activePages[be],Ce=Ee);if(Ce.y+Re.size.y>=xe.canvas.height||Ce.height>Re.size.y+2){let be=!1;if(xe.currentRow.y+xe.currentRow.height+Re.size.y>=xe.canvas.height){let Ee;for(const Pe of this._activePages)if(Pe.currentRow.y+Pe.currentRow.height+Re.size.y<Pe.canvas.height){Ee=Pe;break}if(Ee)xe=Ee;else{const Pe=this._createNewPage();xe=Pe,Ce=Pe.currentRow,Ce.height=Re.size.y,be=!0}}be||(xe.currentRow.height>0&&xe.fixedRows.push(xe.currentRow),Ce={x:0,y:xe.currentRow.y+xe.currentRow.height,height:Re.size.y},xe.fixedRows.push(Ce),xe.currentRow={x:0,y:Ce.y+Ce.height,height:0})}if(Ce.x+Re.size.x<=xe.canvas.width)break;Ce===xe.currentRow?(Ce.x=0,Ce.y+=Ce.height,Ce.height=0):xe.fixedRows.splice(xe.fixedRows.indexOf(Ce),1)}return Re.texturePage=this._pages.indexOf(xe),Re.texturePosition.x=Ce.x,Re.texturePosition.y=Ce.y,Re.texturePositionClipSpace.x=Ce.x/xe.canvas.width,Re.texturePositionClipSpace.y=Ce.y/xe.canvas.height,Re.sizeClipSpace.x/=xe.canvas.width,Re.sizeClipSpace.y/=xe.canvas.height,Ce.height=Math.max(Ce.height,Re.size.y),Ce.x+=Re.size.x,xe.ctx.putImageData(ae,Re.texturePosition.x-this._workBoundingBox.left,Re.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,Re.size.x,Re.size.y),xe.addGlyph(Re),xe.version++,Re}_findGlyphBoundingBox(y,L,T,D,B,H){L.top=0;const A=D?this._config.deviceCellHeight:this._tmpCanvas.height,F=D?this._config.deviceCellWidth:T;let k=!1;for(let O=0;O<A;O++){for(let I=0;I<F;I++){const P=O*this._tmpCanvas.width*4+4*I+3;if(y.data[P]!==0){L.top=O,k=!0;break}}if(k)break}L.left=0,k=!1;for(let O=0;O<H+F;O++){for(let I=0;I<A;I++){const P=I*this._tmpCanvas.width*4+4*O+3;if(y.data[P]!==0){L.left=O,k=!0;break}}if(k)break}L.right=F,k=!1;for(let O=H+F-1;O>=H;O--){for(let I=0;I<A;I++){const P=I*this._tmpCanvas.width*4+4*O+3;if(y.data[P]!==0){L.right=O,k=!0;break}}if(k)break}L.bottom=A,k=!1;for(let O=A-1;O>=0;O--){for(let I=0;I<F;I++){const P=O*this._tmpCanvas.width*4+4*I+3;if(y.data[P]!==0){L.bottom=O,k=!0;break}}if(k)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:L.right-L.left+1,y:L.bottom-L.top+1},sizeClipSpace:{x:L.right-L.left+1,y:L.bottom-L.top+1},offset:{x:-L.left+H+(D||B?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-L.top+H+(D||B?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}c.TextureAtlas=l;class f{constructor(y,L,T){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],T)for(const D of T)this._glyphs.push(...D.glyphs),this._usedPixels+=D._usedPixels;this.canvas=C(y,L,L),this.ctx=(0,v.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(y){this._glyphs.push(y),this._usedPixels+=y.size.x*y.size.y}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function _(p,y,L,T){const D=y.rgba>>>24,B=y.rgba>>>16&255,H=y.rgba>>>8&255,A=L.rgba>>>24,F=L.rgba>>>16&255,k=L.rgba>>>8&255,O=Math.floor((Math.abs(D-A)+Math.abs(B-F)+Math.abs(H-k))/12);let I=!0;for(let P=0;P<p.data.length;P+=4)p.data[P]===D&&p.data[P+1]===B&&p.data[P+2]===H||T&&Math.abs(p.data[P]-D)+Math.abs(p.data[P+1]-B)+Math.abs(p.data[P+2]-H)<O?p.data[P+3]=0:I=!1;return I}function C(p,y,L){const T=p.createElement("canvas");return T.width=y,T.height=L,T}},577:function(K,c,w){var m=this&&this.__decorate||function(h,r,s,l){var f,_=arguments.length,C=_<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,s):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(h,r,s,l);else for(var p=h.length-1;p>=0;p--)(f=h[p])&&(C=(_<3?f(C):_>3?f(r,s,C):f(r,s))||C);return _>3&&C&&Object.defineProperty(r,s,C),C},g=this&&this.__param||function(h,r){return function(s,l){r(s,l,h)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const d=w(147),u=w(855),b=w(782),v=w(97);class a extends d.AttributeData{constructor(r,s,l){super(),this.content=0,this.combinedData="",this.fg=r.fg,this.bg=r.bg,this.combinedData=s,this._width=l}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(r){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=a;let i=class Zi{constructor(r){this._bufferService=r,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new b.CellData}register(r){const s={id:this._nextCharacterJoinerId++,handler:r};return this._characterJoiners.push(s),s.id}deregister(r){for(let s=0;s<this._characterJoiners.length;s++)if(this._characterJoiners[s].id===r)return this._characterJoiners.splice(s,1),!0;return!1}getJoinedCharacters(r){if(this._characterJoiners.length===0)return[];const s=this._bufferService.buffer.lines.get(r);if(!s||s.length===0)return[];const l=[],f=s.translateToString(!0);let _=0,C=0,p=0,y=s.getFg(0),L=s.getBg(0);for(let T=0;T<s.getTrimmedLength();T++)if(s.loadCell(T,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==y||this._workCell.bg!==L){if(T-_>1){const D=this._getJoinedRanges(f,p,C,s,_);for(let B=0;B<D.length;B++)l.push(D[B])}_=T,p=C,y=this._workCell.fg,L=this._workCell.bg}C+=this._workCell.getChars().length||u.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-_>1){const T=this._getJoinedRanges(f,p,C,s,_);for(let D=0;D<T.length;D++)l.push(T[D])}return l}_getJoinedRanges(r,s,l,f,_){const C=r.substring(s,l);let p=[];try{p=this._characterJoiners[0].handler(C)}catch(y){console.error(y)}for(let y=1;y<this._characterJoiners.length;y++)try{const L=this._characterJoiners[y].handler(C);for(let T=0;T<L.length;T++)Zi._mergeRanges(p,L[T])}catch(L){console.error(L)}return this._stringRangesToCellRanges(p,f,_),p}_stringRangesToCellRanges(r,s,l){let f=0,_=!1,C=0,p=r[f];if(p){for(let y=l;y<this._bufferService.cols;y++){const L=s.getWidth(y),T=s.getString(y).length||u.WHITESPACE_CELL_CHAR.length;if(L!==0){if(!_&&p[0]<=C&&(p[0]=y,_=!0),p[1]<=C){if(p[1]=y,p=r[++f],!p)break;p[0]<=C?(p[0]=y,_=!0):_=!1}C+=T}}p&&(p[1]=this._bufferService.cols)}}static _mergeRanges(r,s){let l=!1;for(let f=0;f<r.length;f++){const _=r[f];if(l){if(s[1]<=_[0])return r[f-1][1]=s[1],r;if(s[1]<=_[1])return r[f-1][1]=Math.max(s[1],_[1]),r.splice(f,1),r;r.splice(f,1),f--}else{if(s[1]<=_[0])return r.splice(f,0,s),r;if(s[1]<=_[1])return _[0]=Math.min(s[0],_[0]),r;s[0]<_[1]&&(_[0]=Math.min(s[0],_[0]),l=!0)}}return l?r[r.length-1][1]=s[1]:r.push(s),r}};i=m([g(0,v.IBufferService)],i),c.CharacterJoinerService=i},160:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;const m=w(399);let g=0,d=0,u=0,b=0;var v,a,i;function h(s){const l=s.toString(16);return l.length<2?"0"+l:l}function r(s,l){return s<l?(l+.05)/(s+.05):(s+.05)/(l+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},function(s){s.toCss=function(l,f,_,C){return C!==void 0?`#${h(l)}${h(f)}${h(_)}${h(C)}`:`#${h(l)}${h(f)}${h(_)}`},s.toRgba=function(l,f,_,C=255){return(l<<24|f<<16|_<<8|C)>>>0}}(v=c.channels||(c.channels={})),function(s){function l(f,_){return b=Math.round(255*_),[g,d,u]=i.toChannels(f.rgba),{css:v.toCss(g,d,u,b),rgba:v.toRgba(g,d,u,b)}}s.blend=function(f,_){if(b=(255&_.rgba)/255,b===1)return{css:_.css,rgba:_.rgba};const C=_.rgba>>24&255,p=_.rgba>>16&255,y=_.rgba>>8&255,L=f.rgba>>24&255,T=f.rgba>>16&255,D=f.rgba>>8&255;return g=L+Math.round((C-L)*b),d=T+Math.round((p-T)*b),u=D+Math.round((y-D)*b),{css:v.toCss(g,d,u),rgba:v.toRgba(g,d,u)}},s.isOpaque=function(f){return(255&f.rgba)==255},s.ensureContrastRatio=function(f,_,C){const p=i.ensureContrastRatio(f.rgba,_.rgba,C);if(p)return i.toColor(p>>24&255,p>>16&255,p>>8&255)},s.opaque=function(f){const _=(255|f.rgba)>>>0;return[g,d,u]=i.toChannels(_),{css:v.toCss(g,d,u),rgba:_}},s.opacity=l,s.multiplyOpacity=function(f,_){return b=255&f.rgba,l(f,b*_/255)},s.toColorRGB=function(f){return[f.rgba>>24&255,f.rgba>>16&255,f.rgba>>8&255]}}(c.color||(c.color={})),function(s){let l,f;if(!m.isNode){const _=document.createElement("canvas");_.width=1,_.height=1;const C=_.getContext("2d",{willReadFrequently:!0});C&&(l=C,l.globalCompositeOperation="copy",f=l.createLinearGradient(0,0,1,1))}s.toColor=function(_){if(_.match(/#[\da-f]{3,8}/i))switch(_.length){case 4:return g=parseInt(_.slice(1,2).repeat(2),16),d=parseInt(_.slice(2,3).repeat(2),16),u=parseInt(_.slice(3,4).repeat(2),16),i.toColor(g,d,u);case 5:return g=parseInt(_.slice(1,2).repeat(2),16),d=parseInt(_.slice(2,3).repeat(2),16),u=parseInt(_.slice(3,4).repeat(2),16),b=parseInt(_.slice(4,5).repeat(2),16),i.toColor(g,d,u,b);case 7:return{css:_,rgba:(parseInt(_.slice(1),16)<<8|255)>>>0};case 9:return{css:_,rgba:parseInt(_.slice(1),16)>>>0}}const C=_.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return g=parseInt(C[1]),d=parseInt(C[2]),u=parseInt(C[3]),b=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),i.toColor(g,d,u,b);if(!l||!f)throw new Error("css.toColor: Unsupported css format");if(l.fillStyle=f,l.fillStyle=_,typeof l.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(l.fillRect(0,0,1,1),[g,d,u,b]=l.getImageData(0,0,1,1).data,b!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(g,d,u,b),css:_}}}(c.css||(c.css={})),function(s){function l(f,_,C){const p=f/255,y=_/255,L=C/255;return .2126*(p<=.03928?p/12.92:Math.pow((p+.055)/1.055,2.4))+.7152*(y<=.03928?y/12.92:Math.pow((y+.055)/1.055,2.4))+.0722*(L<=.03928?L/12.92:Math.pow((L+.055)/1.055,2.4))}s.relativeLuminance=function(f){return l(f>>16&255,f>>8&255,255&f)},s.relativeLuminance2=l}(a=c.rgb||(c.rgb={})),function(s){function l(_,C,p){const y=_>>24&255,L=_>>16&255,T=_>>8&255;let D=C>>24&255,B=C>>16&255,H=C>>8&255,A=r(a.relativeLuminance2(D,B,H),a.relativeLuminance2(y,L,T));for(;A<p&&(D>0||B>0||H>0);)D-=Math.max(0,Math.ceil(.1*D)),B-=Math.max(0,Math.ceil(.1*B)),H-=Math.max(0,Math.ceil(.1*H)),A=r(a.relativeLuminance2(D,B,H),a.relativeLuminance2(y,L,T));return(D<<24|B<<16|H<<8|255)>>>0}function f(_,C,p){const y=_>>24&255,L=_>>16&255,T=_>>8&255;let D=C>>24&255,B=C>>16&255,H=C>>8&255,A=r(a.relativeLuminance2(D,B,H),a.relativeLuminance2(y,L,T));for(;A<p&&(D<255||B<255||H<255);)D=Math.min(255,D+Math.ceil(.1*(255-D))),B=Math.min(255,B+Math.ceil(.1*(255-B))),H=Math.min(255,H+Math.ceil(.1*(255-H))),A=r(a.relativeLuminance2(D,B,H),a.relativeLuminance2(y,L,T));return(D<<24|B<<16|H<<8|255)>>>0}s.ensureContrastRatio=function(_,C,p){const y=a.relativeLuminance(_>>8),L=a.relativeLuminance(C>>8);if(r(y,L)<p){if(L<y){const B=l(_,C,p),H=r(y,a.relativeLuminance(B>>8));if(H<p){const A=f(_,C,p);return H>r(y,a.relativeLuminance(A>>8))?B:A}return B}const T=f(_,C,p),D=r(y,a.relativeLuminance(T>>8));if(D<p){const B=l(_,C,p);return D>r(y,a.relativeLuminance(B>>8))?T:B}return T}},s.reduceLuminance=l,s.increaseLuminance=f,s.toChannels=function(_){return[_>>24&255,_>>16&255,_>>8&255,255&_]},s.toColor=function(_,C,p,y){return{css:v.toCss(_,C,p,y),rgba:v.toRgba(_,C,p,y)}}}(i=c.rgba||(c.rgba={})),c.toPaddedHex=h,c.contrastRatio=r},345:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=w=>(this._listeners.push(w),{dispose:()=>{if(!this._disposed){for(let m=0;m<this._listeners.length;m++)if(this._listeners[m]===w)return void this._listeners.splice(m,1)}}})),this._event}fire(w,m){const g=[];for(let d=0;d<this._listeners.length;d++)g.push(this._listeners[d]);for(let d=0;d<g.length;d++)g[d].call(void 0,w,m)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(w,m){return w(g=>m.fire(g))}},859:(K,c)=>{function w(m){for(const g of m)g.dispose();m.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const m of this._disposables)m.dispose();this._disposables.length=0}register(m){return this._disposables.push(m),m}unregister(m){const g=this._disposables.indexOf(m);g!==-1&&this._disposables.splice(g,1)}},c.toDisposable=function(m){return{dispose:m}},c.disposeArray=w,c.getDisposeArrayDisposable=function(m){return{dispose:()=>w(m)}}},485:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class w{constructor(){this._data={}}set(g,d,u){this._data[g]||(this._data[g]={}),this._data[g][d]=u}get(g,d){return this._data[g]?this._data[g][d]:void 0}clear(){this._data={}}}c.TwoKeyMap=w,c.FourKeyMap=class{constructor(){this._data=new w}set(m,g,d,u,b){this._data.get(m,g)||this._data.set(m,g,new w),this._data.get(m,g).set(d,u,b)}get(m,g,d,u){var b;return(b=this._data.get(m,g))===null||b===void 0?void 0:b.get(d,u)}clear(){this._data.clear()}}},399:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof navigator>"u";const w=c.isNode?"node":navigator.userAgent,m=c.isNode?"node":navigator.platform;c.isFirefox=w.includes("Firefox"),c.isLegacyEdge=w.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(w),c.getSafariVersion=function(){if(!c.isSafari)return 0;const g=w.match(/Version\/(\d+)/);return g===null||g.length<2?0:parseInt(g[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(m),c.isIpad=m==="iPad",c.isIphone=m==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(m),c.isLinux=m.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(w)},385:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const m=w(399);class g{constructor(){this._tasks=[],this._i=0}enqueue(b){this._tasks.push(b),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(b){this._idleCallback=void 0;let v=0,a=0,i=b.timeRemaining(),h=0;for(;this._i<this._tasks.length;){if(v=Date.now(),this._tasks[this._i]()||this._i++,v=Math.max(1,Date.now()-v),a=Math.max(v,a),h=b.timeRemaining(),1.5*a>h)return i-v<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(i-v))}ms`),void this._start();i=h}this.clear()}}class d extends g{_requestCallback(b){return setTimeout(()=>b(this._createDeadline(16)))}_cancelCallback(b){clearTimeout(b)}_createDeadline(b){const v=Date.now()+b;return{timeRemaining:()=>Math.max(0,v-Date.now())}}}c.PriorityTaskQueue=d,c.IdleTaskQueue=!m.isNode&&"requestIdleCallback"in window?class extends g{_requestCallback(u){return requestIdleCallback(u)}_cancelCallback(u){cancelIdleCallback(u)}}:d,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(u){this._queue.clear(),this._queue.enqueue(u)}flush(){this._queue.flush()}}},147:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class w{constructor(){this.fg=0,this.bg=0,this.extended=new m}static toColorRGB(d){return[d>>>16&255,d>>>8&255,255&d]}static fromColorRGB(d){return(255&d[0])<<16|(255&d[1])<<8|255&d[2]}clone(){const d=new w;return d.fg=this.fg,d.bg=this.bg,d.extended=this.extended.clone(),d}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}c.AttributeData=w;class m{constructor(d=0,u=0){this._ext=0,this._urlId=0,this._ext=d,this._urlId=u}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(d){this._ext=d}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(d){this._ext&=-469762049,this._ext|=d<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(d){this._ext&=-67108864,this._ext|=67108863&d}get urlId(){return this._urlId}set urlId(d){this._urlId=d}clone(){return new m(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=m},782:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const m=w(133),g=w(855),d=w(147);class u extends d.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new d.ExtendedAttrs,this.combinedData=""}static fromCharData(v){const a=new u;return a.setFromCharData(v),a}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,m.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(v){this.fg=v[g.CHAR_DATA_ATTR_INDEX],this.bg=0;let a=!1;if(v[g.CHAR_DATA_CHAR_INDEX].length>2)a=!0;else if(v[g.CHAR_DATA_CHAR_INDEX].length===2){const i=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){const h=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=h&&h<=57343?this.content=1024*(i-55296)+h-56320+65536|v[g.CHAR_DATA_WIDTH_INDEX]<<22:a=!0}else a=!0}else this.content=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[g.CHAR_DATA_WIDTH_INDEX]<<22;a&&(this.combinedData=v[g.CHAR_DATA_CHAR_INDEX],this.content=2097152|v[g.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=u},855:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},133:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(w){return w>65535?(w-=65536,String.fromCharCode(55296+(w>>10))+String.fromCharCode(w%1024+56320)):String.fromCharCode(w)},c.utf32ToString=function(w,m=0,g=w.length){let d="";for(let u=m;u<g;++u){let b=w[u];b>65535?(b-=65536,d+=String.fromCharCode(55296+(b>>10))+String.fromCharCode(b%1024+56320)):d+=String.fromCharCode(b)}return d},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(w,m){const g=w.length;if(!g)return 0;let d=0,u=0;if(this._interim){const b=w.charCodeAt(u++);56320<=b&&b<=57343?m[d++]=1024*(this._interim-55296)+b-56320+65536:(m[d++]=this._interim,m[d++]=b),this._interim=0}for(let b=u;b<g;++b){const v=w.charCodeAt(b);if(55296<=v&&v<=56319){if(++b>=g)return this._interim=v,d;const a=w.charCodeAt(b);56320<=a&&a<=57343?m[d++]=1024*(v-55296)+a-56320+65536:(m[d++]=v,m[d++]=a)}else v!==65279&&(m[d++]=v)}return d}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(w,m){const g=w.length;if(!g)return 0;let d,u,b,v,a=0,i=0,h=0;if(this.interim[0]){let l=!1,f=this.interim[0];f&=(224&f)==192?31:(240&f)==224?15:7;let _,C=0;for(;(_=63&this.interim[++C])&&C<4;)f<<=6,f|=_;const p=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,y=p-C;for(;h<y;){if(h>=g)return 0;if(_=w[h++],(192&_)!=128){h--,l=!0;break}this.interim[C++]=_,f<<=6,f|=63&_}l||(p===2?f<128?h--:m[a++]=f:p===3?f<2048||f>=55296&&f<=57343||f===65279||(m[a++]=f):f<65536||f>1114111||(m[a++]=f)),this.interim.fill(0)}const r=g-4;let s=h;for(;s<g;){for(;!(!(s<r)||128&(d=w[s])||128&(u=w[s+1])||128&(b=w[s+2])||128&(v=w[s+3]));)m[a++]=d,m[a++]=u,m[a++]=b,m[a++]=v,s+=4;if(d=w[s++],d<128)m[a++]=d;else if((224&d)==192){if(s>=g)return this.interim[0]=d,a;if(u=w[s++],(192&u)!=128){s--;continue}if(i=(31&d)<<6|63&u,i<128){s--;continue}m[a++]=i}else if((240&d)==224){if(s>=g)return this.interim[0]=d,a;if(u=w[s++],(192&u)!=128){s--;continue}if(s>=g)return this.interim[0]=d,this.interim[1]=u,a;if(b=w[s++],(192&b)!=128){s--;continue}if(i=(15&d)<<12|(63&u)<<6|63&b,i<2048||i>=55296&&i<=57343||i===65279)continue;m[a++]=i}else if((248&d)==240){if(s>=g)return this.interim[0]=d,a;if(u=w[s++],(192&u)!=128){s--;continue}if(s>=g)return this.interim[0]=d,this.interim[1]=u,a;if(b=w[s++],(192&b)!=128){s--;continue}if(s>=g)return this.interim[0]=d,this.interim[1]=u,this.interim[2]=b,a;if(v=w[s++],(192&v)!=128){s--;continue}if(i=(7&d)<<18|(63&u)<<12|(63&b)<<6|63&v,i<65536||i>1114111)continue;m[a++]=i}}return a}}},726:(K,c)=>{function w(m,g,d){g.di$target===g?g.di$dependencies.push({id:m,index:d}):(g.di$dependencies=[{id:m,index:d}],g.di$target=g)}Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0,c.serviceRegistry=new Map,c.getServiceDependencies=function(m){return m.di$dependencies||[]},c.createDecorator=function(m){if(c.serviceRegistry.has(m))return c.serviceRegistry.get(m);const g=function(d,u,b){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");w(g,d,b)};return g.toString=()=>m,c.serviceRegistry.set(m,g),g}},97:(K,c,w)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const m=w(726);var g;c.IBufferService=(0,m.createDecorator)("BufferService"),c.ICoreMouseService=(0,m.createDecorator)("CoreMouseService"),c.ICoreService=(0,m.createDecorator)("CoreService"),c.ICharsetService=(0,m.createDecorator)("CharsetService"),c.IInstantiationService=(0,m.createDecorator)("InstantiationService"),(g=c.LogLevelEnum||(c.LogLevelEnum={}))[g.DEBUG=0]="DEBUG",g[g.INFO=1]="INFO",g[g.WARN=2]="WARN",g[g.ERROR=3]="ERROR",g[g.OFF=4]="OFF",c.ILogService=(0,m.createDecorator)("LogService"),c.IOptionsService=(0,m.createDecorator)("OptionsService"),c.IOscLinkService=(0,m.createDecorator)("OscLinkService"),c.IUnicodeService=(0,m.createDecorator)("UnicodeService"),c.IDecorationService=(0,m.createDecorator)("DecorationService")}},de={};function ve(K){var c=de[K];if(c!==void 0)return c.exports;var w=de[K]={exports:{}};return ie[K].call(w.exports,w,w.exports,ve),w.exports}var ge={};return(()=>{var K=ge;Object.defineProperty(K,"__esModule",{value:!0}),K.CanvasAddon=void 0;const c=ve(949),w=ve(345),m=ve(859);class g extends m.Disposable{constructor(){super(...arguments),this._onChangeTextureAtlas=this.register(new w.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new w.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event}get textureAtlas(){var u;return(u=this._renderer)===null||u===void 0?void 0:u.textureAtlas}activate(u){const b=u._core;if(!u.element)return void this.register(b.onWillOpen(()=>this.activate(u)));this._terminal=u;const v=b.coreService,a=b.optionsService,i=b.screenElement,h=b.linkifier2,r=b,s=r._bufferService,l=r._renderService,f=r._characterJoinerService,_=r._charSizeService,C=r._coreBrowserService,p=r._decorationService,y=r._themeService;this._renderer=new c.CanvasRenderer(u,i,h,s,_,a,f,v,C,p,y),this.register((0,w.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,w.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),l.setRenderer(this._renderer),l.handleResize(s.cols,s.rows),this.register((0,m.toDisposable)(()=>{var L;l.setRenderer(this._terminal._core._createRenderer()),l.handleResize(u.cols,u.rows),(L=this._renderer)===null||L===void 0||L.dispose(),this._renderer=void 0}))}}K.CanvasAddon=g})(),ge})()})})(Yi);var or=Yi.exports,Ji={exports:{}};(function(Se,$){(function(ie,de){Se.exports=de()})(self,function(){return(()=>{var ie={};return(()=>{var de=ie;Object.defineProperty(de,"__esModule",{value:!0}),de.FitAddon=void 0,de.FitAddon=class{constructor(){}activate(ve){this._terminal=ve}dispose(){}fit(){const ve=this.proposeDimensions();if(!ve||!this._terminal||isNaN(ve.cols)||isNaN(ve.rows))return;const ge=this._terminal._core;this._terminal.rows===ve.rows&&this._terminal.cols===ve.cols||(ge._renderService.clear(),this._terminal.resize(ve.cols,ve.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const ve=this._terminal._core,ge=ve._renderService.dimensions;if(ge.css.cell.width===0||ge.css.cell.height===0)return;const K=this._terminal.options.scrollback===0?0:ve.viewport.scrollBarWidth,c=window.getComputedStyle(this._terminal.element.parentElement),w=parseInt(c.getPropertyValue("height")),m=Math.max(0,parseInt(c.getPropertyValue("width"))),g=window.getComputedStyle(this._terminal.element),d=w-(parseInt(g.getPropertyValue("padding-top"))+parseInt(g.getPropertyValue("padding-bottom"))),u=m-(parseInt(g.getPropertyValue("padding-right"))+parseInt(g.getPropertyValue("padding-left")))-K;return{cols:Math.max(2,Math.floor(u/ge.css.cell.width)),rows:Math.max(1,Math.floor(d/ge.css.cell.height))}}}})(),ie})()})})(Ji);var ar=Ji.exports,Kt={exports:{}};const lr={},hr=Object.freeze(Object.defineProperty({__proto__:null,default:lr},Symbol.toStringTag,{value:"Module"})),Ot=tr(hr);/*! For license information please see xterm-addon-ligatures.js.LICENSE.txt */(function(Se,$){(function(ie,de){Se.exports=de(Ot,Ot,Ot,Ot)})(self,function(ie,de,ve,ge){return(()=>{var K={185:(g,d)=>{function u(v){const a={};for(const[i,h]of Object.entries(v.individual))a[i]=b(h);for(const{range:i,entry:h}of v.range){const r=b(h);for(let s=i[0];s<i[1];s++)a[s]=r}return a}function b(v){const a={};return v.forward&&(a.forward=u(v.forward)),v.reverse&&(a.reverse=u(v.reverse)),v.lookup&&(a.lookup=v.lookup),a}Object.defineProperty(d,"__esModule",{value:!0}),d.default=u},98:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(602),v=u(593),a=u(233),i=u(694),h=u(532),r=u(595),s=u(223),l=u(439),f=u(349),_=u(185);class C{constructor(L,T){this._lookupTrees=[],this._glyphLookups={},this._font=L,T.cacheSize>0&&(this._cache=new v({max:T.cacheSize,length:(A,F)=>F.length}));const D=(this._font.tables.gsub&&this._font.tables.gsub.features.filter(A=>A.tag==="calt")||[]).reduce((A,F)=>[...A,...F.feature.lookupListIndexes],[]),B=this._font.tables.gsub&&this._font.tables.gsub.lookups||[],H=B.filter((A,F)=>D.some(k=>k===F));for(const[A,F]of H.entries()){const k=[];switch(F.lookupType){case 6:for(const[I,P]of F.subtables.entries())switch(P.substFormat){case 1:k.push(r.default(P,B,I));break;case 2:k.push(s.default(P,B,I));break;case 3:k.push(l.default(P,B,I))}break;case 8:for(const[I,P]of F.subtables.entries())k.push(f.default(P,I))}const O=_.default(a.default(k));this._lookupTrees.push({tree:O,processForward:F.lookupType!==8});for(const I of Object.keys(O))this._glyphLookups[I]||(this._glyphLookups[I]=[]),this._glyphLookups[I].push(A)}}findLigatures(L){const T=this._cache&&this._cache.get(L);if(T&&!Array.isArray(T))return T;const D=[];for(const A of L)D.push(this._font.charToGlyphIndex(A));if(this._lookupTrees.length===0)return{inputGlyphs:D,outputGlyphs:D,contextRanges:[]};const B=this._findInternal(D.slice()),H={inputGlyphs:D,outputGlyphs:B.sequence,contextRanges:B.ranges};return this._cache&&this._cache.set(L,H),H}findLigatureRanges(L){if(this._lookupTrees.length===0)return[];const T=this._cache&&this._cache.get(L);if(T)return Array.isArray(T)?T:T.contextRanges;const D=[];for(const H of L)D.push(this._font.charToGlyphIndex(H));const B=this._findInternal(D);return this._cache&&this._cache.set(L,B.ranges),B.ranges}_findInternal(L){const T=[];let D=this._getNextLookup(L,0);for(;D.index!==null;){const B=this._lookupTrees[D.index];if(B.processForward){let H=D.last;for(let A=D.first;A<H;A++){const F=i.default(B.tree,L,A,A);if(F){for(let k=0;k<F.substitutions.length;k++){const O=F.substitutions[k];O!==null&&(L[A+k]=O)}h.default(T,F.contextRange[0]+A,F.contextRange[1]+A),A+F.length>=H&&(H=A+F.length+1),A+=F.length-1}}}else for(let H=D.last-1;H>=D.first;H--){const A=i.default(B.tree,L,H,H);if(A){for(let F=0;F<A.substitutions.length;F++){const k=A.substitutions[F];k!==null&&(L[H+F]=k)}h.default(T,A.contextRange[0]+H,A.contextRange[1]+H),H-=A.length-1}}D=this._getNextLookup(L,D.index+1)}return{sequence:L,ranges:T}}_getNextLookup(L,T){const D={index:null,first:1/0,last:-1};for(let B=0;B<L.length;B++){const H=this._glyphLookups[L[B]];if(H)for(let A=0;A<H.length;A++){const F=H[A];if(F>=T){(D.index===null||F<=D.index)&&(D.index=F,D.first>B&&(D.first=B),D.last=B+1);break}}}return D}}async function p(y,L){const T=await Promise.resolve().then(()=>u(269)).then(D=>D.promisify(b.load)(y));return new C(T,Object.assign({cacheSize:0},L))}d.load=async function(y,L){const[T]=await Promise.resolve().then(()=>u(781)).then(D=>D.listVariants(y));if(!T)throw new Error(`Font ${y} not found`);return p(T.path,L)},d.loadFile=p,d.loadBuffer=function(y,L){const T=b.parse(y);return new C(T,Object.assign({cacheSize:0},L))}},233:(g,d)=>{function u(s,l){for(const[f,_]of Object.entries(l.individual))if(s.individual[f])b(s.individual[f],_);else{let C=!1;for(const[p,{range:y,entry:L}]of s.range.entries()){const T=a(Number(f),y);if(T.both!==null){C=!0,s.individual[f]=_,b(s.individual[f],h(L)),s.range.splice(p,1);for(const D of T.second)Array.isArray(D)?s.range.push({range:D,entry:h(L)}):s.individual[D]=h(L)}}C||(s.individual[f]=_)}for(const{range:f,entry:_}of l.range){let C=[f];for(let p=0;p<s.range.length;p++){const{range:y,entry:L}=s.range[p];for(const[T,D]of C.entries()){if(!Array.isArray(D)){const B=a(D,y);if(B.both===null)continue;s.individual[D]=h(_),b(s.individual[D],h(L)),s.range.splice(p,1),p--;for(const H of B.second)Array.isArray(H)?s.range.push({range:H,entry:h(L)}):s.individual[H]=h(L);C.splice(T,1,...B.first);break}{const B=v(D,y);if(B.both===null)continue;s.range.splice(p,1),p--;const H=h(L);Array.isArray(B.both)?s.range.push({range:B.both,entry:H}):s.individual[B.both]=H,b(H,h(_));for(const A of B.second)Array.isArray(A)?s.range.push({range:A,entry:h(L)}):s.individual[A]=h(L);C=B.first}}}for(const p of Object.keys(s.individual))for(const[y,L]of C.entries()){if(Array.isArray(L)){const T=a(Number(p),L);if(T.both===null)continue;b(s.individual[p],h(_)),C.splice(y,1,...T.second);break}if(Number(p)===L){b(s.individual[p],h(_));break}}for(const p of C)Array.isArray(p)?s.range.push({range:p,entry:h(_)}):s.individual[p]=h(_)}}function b(s,l){l.lookup&&(!s.lookup||s.lookup.index>l.lookup.index||s.lookup.index===l.lookup.index&&s.lookup.subIndex>l.lookup.subIndex)&&(s.lookup=l.lookup),l.forward&&(s.forward?u(s.forward,l.forward):s.forward=l.forward),l.reverse&&(s.reverse?u(s.reverse,l.reverse):s.reverse=l.reverse)}function v(s,l){const f={first:[],second:[],both:null};if(s[0]<l[1]&&l[0]<s[1]){const _=Math.max(s[0],l[0]),C=Math.min(s[1],l[1]);f.both=i(_,C)}if(s[0]<l[0]){const _=s[0],C=Math.min(l[0],s[1]);f.first.push(i(_,C))}else if(l[0]<s[0]){const _=l[0],C=Math.min(l[1],s[0]);f.second.push(i(_,C))}if(s[1]>l[1]){const _=Math.max(s[0],l[1]),C=s[1];f.first.push(i(_,C))}else if(l[1]>s[1]){const _=Math.max(s[1],l[0]),C=l[1];f.second.push(i(_,C))}return f}function a(s,l){if(s<l[0]||s>l[1])return{first:[s],second:[l],both:null};const f={first:[],second:[],both:s};return l[0]<s&&f.second.push(i(l[0],s)),l[1]>s&&f.second.push(i(s+1,l[1])),f}function i(s,l){return l-s==1?s:[s,l]}function h(s){const l={};return s.forward&&(l.forward=r(s.forward)),s.reverse&&(l.reverse=r(s.reverse)),s.lookup&&(l.lookup={contextRange:s.lookup.contextRange.slice(),index:s.lookup.index,length:s.lookup.length,subIndex:s.lookup.subIndex,substitutions:s.lookup.substitutions.slice()}),l}function r(s){const l={};for(const[f,_]of Object.entries(s.individual))l[f]=h(_);return{individual:l,range:s.range.map(({range:f,entry:_})=>({range:f.slice(),entry:h(_)}))}}Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(s){const l={individual:{},range:[]};for(const f of s)u(l,f);return l}},532:(g,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(u,b,v){let a=!1;for(let i=0;i<u.length;i++){const h=u[i];if(a){if(v<=h[0])return u[i-1][1]=v,u;if(v<=h[1])return u[i-1][1]=Math.max(v,h[1]),u.splice(i,1),a=!1,u;u.splice(i,1),i--}else{if(v<=h[0])return u.splice(i,0,[b,v]),u;if(v<=h[1])return h[0]=Math.min(b,h[0]),u;if(!(b<h[1]))continue;h[0]=Math.min(b,h[0]),a=!0}}return a?u[u.length-1][1]=v:u.push([b,v]),u}},595:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(283),v=u(267);d.default=function(a,i,h){const r={individual:{},range:[]},s=b.listGlyphsByIndex(a.coverage);for(const{glyphId:l,index:f}of s){const _=a.chainRuleSets[f];if(_)for(const[C,p]of _.entries()){let y=v.getInputTree(r,p.lookupRecords,i,0,l).map(({entry:L,substitution:T})=>({entry:L,substitutions:[T]}));for(const[L,T]of p.input.entries())y=v.processInputPosition([T],L+1,y,p.lookupRecords,i);for(const L of p.lookahead)y=v.processLookaheadPosition([L],y);for(const L of p.backtrack)y=v.processBacktrackPosition([L],y);for(const{entry:L,substitutions:T}of y)L.lookup={substitutions:T,length:p.input.length+1,index:h,subIndex:C,contextRange:[-1*p.backtrack.length,1+p.input.length+p.lookahead.length]}}}return r}},223:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(233),v=u(283),a=u(91),i=u(267);d.default=function(h,r,s){const l=[],f=v.listGlyphsByIndex(h.coverage);for(const{glyphId:_}of f){const C=a.default(h.inputClassDef,_);for(const[p,y]of C.entries()){if(y===null)continue;const L=h.chainClassSet[y];if(L)for(const[T,D]of L.entries()){const B={individual:{},range:[]};let H=i.getInputTree(B,D.lookupRecords,r,0,p).map(({entry:A,substitution:F})=>({entry:A,substitutions:[F]}));for(const[A,F]of D.input.entries())H=i.processInputPosition(a.listClassGlyphs(h.inputClassDef,F),A+1,H,D.lookupRecords,r);for(const A of D.lookahead)H=i.processLookaheadPosition(a.listClassGlyphs(h.lookaheadClassDef,A),H);for(const A of D.backtrack)H=i.processBacktrackPosition(a.listClassGlyphs(h.backtrackClassDef,A),H);for(const{entry:A,substitutions:F}of H)A.lookup={substitutions:F,index:s,subIndex:T,length:D.input.length+1,contextRange:[-1*D.backtrack.length,1+D.input.length+D.lookahead.length]};l.push(B)}}}return b.default(l)}},439:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(283),v=u(267);d.default=function(a,i,h){const r={individual:{},range:[]},s=b.listGlyphsByIndex(a.inputCoverage[0]);for(const{glyphId:l}of s){let f=v.getInputTree(r,a.lookupRecords,i,0,l).map(({entry:_,substitution:C})=>({entry:_,substitutions:[C]}));for(const[_,C]of a.inputCoverage.slice(1).entries())f=v.processInputPosition(b.listGlyphsByIndex(C).map(p=>p.glyphId),_+1,f,a.lookupRecords,i);for(const _ of a.lookaheadCoverage)f=v.processLookaheadPosition(b.listGlyphsByIndex(_).map(C=>C.glyphId),f);for(const _ of a.backtrackCoverage)f=v.processBacktrackPosition(b.listGlyphsByIndex(_).map(C=>C.glyphId),f);for(const{entry:_,substitutions:C}of f)_.lookup={substitutions:C,index:h,subIndex:0,length:a.inputCoverage.length,contextRange:[-1*a.backtrackCoverage.length,a.inputCoverage.length+a.lookaheadCoverage.length]}}return r}},349:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(283),v=u(267);d.default=function(a,i){const h={individual:{},range:[]},r=b.listGlyphsByIndex(a.coverage);for(const{glyphId:s,index:l}of r){const f={};Array.isArray(s)?h.range.push({entry:f,range:s}):h.individual[s]=f;let _=[{entry:f,substitutions:[a.substitutes[l]]}];for(const C of a.lookaheadCoverage)_=v.processLookaheadPosition(b.listGlyphsByIndex(C).map(p=>p.glyphId),_);for(const C of a.backtrackCoverage)_=v.processBacktrackPosition(b.listGlyphsByIndex(C).map(p=>p.glyphId),_);for(const{entry:C,substitutions:p}of _)C.lookup={substitutions:p,index:i,subIndex:0,length:1,contextRange:[-1*a.backtrackCoverage.length,1+a.lookaheadCoverage.length]}}return h}},91:(g,d)=>{function u(b,v){for(const a of b.ranges)if(a.start<=v&&a.end>=v)return a.classId;return null}Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(b,v){return b.format===2?Array.isArray(v)?function(a,i){let h=i[0],r=u(a,h),s=i[0]+1;const l=new Map;for(;s<i[1];)u(a,s)!==r&&(s-h<=1?l.set(h,r):l.set([h,s],r)),s++;return s-h<=1?l.set(h,r):l.set([h,s],r),l}(b,v):new Map([[v,u(b,v)]]):new Map([[v,null]])},d.listClassGlyphs=function(b,v){if(b.format===2){const a=[];for(const i of b.ranges)i.classId===v&&(i.end===i.start?a.push(i.start):a.push([i.start,i.end+1]));return a}return[]}},283:(g,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(u,b){switch(u.format){case 1:const v=u.glyphs.indexOf(b);return v!==-1?v:null;case 2:const a=u.ranges.find(i=>i.start<=b&&i.end>=b);return a?a.index:null}},d.listGlyphsByIndex=function(u){switch(u.format){case 1:return u.glyphs.map((v,a)=>({glyphId:v,index:a}));case 2:let b=[];for(const[v,a]of u.ranges.entries())a.end===a.start?b.push({glyphId:a.start,index:v}):b.push({glyphId:[a.start,a.end+1],index:v});return b}}},267:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(603);function v(i,h,r,s,l){const f=[];if(Array.isArray(l)){const _=function(C,p,y,L){for(const T of C.filter(D=>D.sequenceIndex===y))for(const D of p[T.lookupListIndex].subtables){const B=b.getRangeSubstitutionGlyphs(D,L);if(!Array.from(B.values()).every(H=>H!==null))return B}return new Map([[L,null]])}(h,r,s,l);for(const[C,p]of _){const y={};Array.isArray(C)?i.range.push({range:C,entry:y}):i.individual[C]={},f.push({entry:y,substitution:p})}}else i.individual[l]={},f.push({entry:i.individual[l],substitution:a(h,r,s,l)});return f}function a(i,h,r,s){for(const l of i.filter(f=>f.sequenceIndex===r))for(const f of h[l.lookupListIndex].subtables){const _=b.getIndividualSubstitutionGlyph(f,s);if(_!==null)return _}return null}d.processInputPosition=function(i,h,r,s,l){const f=[];for(const _ of r){_.entry.forward={individual:{},range:[]};for(const C of i)f.push(...v(_.entry.forward,s,l,h,C).map(({entry:p,substitution:y})=>({entry:p,substitutions:[..._.substitutions,y]})))}return f},d.processLookaheadPosition=function(i,h){const r=[];for(const s of h)for(const l of i){const f={};s.entry.forward||(s.entry.forward={individual:{},range:[]}),r.push({entry:f,substitutions:s.substitutions}),Array.isArray(l)?s.entry.forward.range.push({entry:f,range:l}):s.entry.forward.individual[l]=f}return r},d.processBacktrackPosition=function(i,h){const r=[];for(const s of h)for(const l of i){const f={};s.entry.reverse||(s.entry.reverse={individual:{},range:[]}),r.push({entry:f,substitutions:s.substitutions}),Array.isArray(l)?s.entry.reverse.range.push({entry:f,range:l}):s.entry.reverse.individual[l]=f}return r},d.getInputTree=v},603:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(283);function v(a,i){const h=b.default(a.coverage,i);if(h===null)return null;switch(a.substFormat){case 1:return(i+a.deltaGlyphId)%65536;case 2:return a.substitute[h]!=null?a.substitute[h]:null}}d.getRangeSubstitutionGlyphs=function(a,i){let h=i[0],r=v(a,h),s=i[0]+1;const l=new Map;for(;s<i[1];)v(a,s)!==r&&(s-h<=1?l.set(h,r):l.set([h,s],r)),s++;return s-h<=1?l.set(h,r):l.set([h,s],r),l},d.getIndividualSubstitutionGlyph=v},694:(g,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function u(b,v,a,i){let h=b[v[i]];if(!h)return;let r=h.lookup;if(h.reverse){const l=function(f,_,C){let p=f[_[--C]],y=p&&p.lookup;for(;p&&((!y&&p.lookup||p.lookup&&y&&y.index>p.lookup.index)&&(y=p.lookup),!(--C<0)&&p.reverse);)p=p.reverse[_[C]];return y}(h.reverse,v,a);(!r&&l||l&&r&&(r.index>l.index||r.index===l.index&&r.subIndex>l.subIndex))&&(r=l)}if(++i>=v.length||!h.forward)return r;const s=u(h.forward,v,a,i);return(!r&&s||s&&r&&(r.index>s.index||r.index===s.index&&r.subIndex>s.subIndex))&&(r=s),r}},814:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(82);var v,a;(function(s){s.Serif="serif",s.SansSerif="sansSerif",s.Monospace="monospace",s.Cursive="cursive",s.Unknown="unknown"})(v=d.Type||(d.Type={})),function(s){s.Regular="regular",s.Italic="italic",s.Oblique="oblique",s.Bold="bold",s.BoldItalic="boldItalic",s.BoldOblique="boldOblique",s.Other="other"}(a=d.Style||(d.Style={}));const i=[" Regular"," Bold"," Bold Italic"," Bold Oblique"," Italic"," Oblique"];function h(s){if(!s.os2&&!s.head)return a.Other;const l=s.os2?32&s.os2.fsSelection:1&s.head.macStyle,f=s.os2?1&s.os2.fsSelection:s.post?s.post.italicAngle<0:2&s.head.macStyle,_=s.os2?512&s.os2.fsSelection:s.post?s.post.italicAngle>0:0,C=s.os2?320&s.os2.fsSelection:1;return l?_?a.BoldOblique:f?a.BoldItalic:a.Bold:_?a.Oblique:f?a.Italic:C?a.Regular:a.Other}d.name=function(s,l){const f=s.names.preferredFamily&&s.names.preferredFamily[l]?s.names.preferredFamily[l]:s.names.fontFamily[l];if(b.platform()==="win32"){const _=`${f} ${s.names.preferredSubfamily&&s.names.preferredSubfamily[l]?s.names.preferredSubfamily[l]:s.names.fontSubfamily[l]}`;let C=-1;for(const p of i){const y=_.lastIndexOf(p);if(y!==-1){C=y;break}}return C!==-1?_.substring(0,C):_}return f},d.type=function(s){if(s.os2)switch(s.os2.panose[0]){case 2:return s.os2.panose[3]===9?v.Monospace:s.os2.panose[1]>=11&&s.os2.panose[1]<=15||s.os2.panose[1]===0?v.SansSerif:v.Serif;case 3:return v.Cursive}else if(s.post&&s.post.isFixedPitch)return v.Monospace;return v.Unknown},d.style=h;const r=[a.Bold,a.BoldItalic,a.BoldOblique];d.weight=function(s){return s.os2?s.os2.usWeightClass:r.includes(h(s))?700:400}},781:function(g,d,u){var b=this&&this.__rest||function(l,f){var _={};for(var C in l)Object.prototype.hasOwnProperty.call(l,C)&&f.indexOf(C)<0&&(_[C]=l[C]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function"){var p=0;for(C=Object.getOwnPropertySymbols(l);p<C.length;p++)f.indexOf(C[p])<0&&(_[C[p]]=l[C[p]])}return _};Object.defineProperty(d,"__esModule",{value:!0});const v=u(459),a=u(934),i=u(814);var h=u(814);async function r(l){const f=Object.assign({concurrency:4,language:"en"},l),_=await v.default({extensions:["ttf","otf"]}),C=await async function(y,L,T){const D=[];let B=0;const H=async F=>{D.push(await(async k=>{try{return s(k,await a.default(k),f.language)}catch(O){if(["TypeError","SyntaxError","ReferenceError","RangeError","AssertionError"].includes(O.name))throw O}})(L[F])),B<L.length&&await H(B++)},A=[];for(;B<L.length&&B<T;B++)A.push(H(B));return await Promise.all(A),D}(0,_,f.concurrency),p={};for(let y of C.filter(L=>L)){const{name:L}=y,T=b(y,["name"]);p[L]||(p[L]=[]),p[L].push(T)}return p}function s(l,f,_){return{name:i.name(f,_),path:l,type:i.type(f),weight:i.weight(f),style:i.style(f)}}d.Type=h.Type,d.Style=h.Style,d.list=r,d.listVariants=async function(l,f){return(await r(f))[l]||[]},d.get=async function(l,f){const _=Object.assign({language:"en"},f);return s(l,await a.default(l),_.language)}},934:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(89),v=u(896),a=u(380),i=u(879),h=u(130),r=u(731),s=u(954);var l;(function(C){C[C.TrueType=0]="TrueType",C[C.CFF=1]="CFF",C[C.Woff=2]="Woff"})(l||(l={}));const f={name:{tag:Buffer.from("name"),parse:a.default},ltag:{tag:Buffer.from("ltag"),parse:i.default},os2:{tag:Buffer.from("OS/2"),parse:h.default},head:{tag:Buffer.from("head"),parse:r.default},post:{tag:Buffer.from("post"),parse:s.default}};d.default=async function(C){return new Promise((p,y)=>{(async()=>{const L=v.default(),T=b.createReadStream(C);let D=!1;const B=()=>{D=!0};T.once("close",B),T.once("end",B),T.once("error",H=>{D=!0,y(H)}),T.pipe(L);try{switch(function(H){if(H.equals(_.one)||H.equals(_.true)||H.equals(_.typ1))return l.TrueType;if(H.equals(_.otto))return l.CFF;if(H.equals(_.woff))return l.Woff;throw new Error(`Unsupported signature type: ${H}`)}(await L.read(4))){case l.TrueType:case l.CFF:const H=(await L.read(2)).readUInt16BE(0);await L.skip(6);const A=await async function(I,P){const V={};for(let te=0;te<P;te++){const he=await I.read(4),J=await I.read(12);for(const[le,G]of Object.entries(f))if(he.equals(G.tag)&&(V[le]={offset:J.readUInt32BE(4),length:J.readUInt32BE(8)},V.name&&V.ltag&&V.os2))return V}return V}(L,H),F=Object.entries(A).sort((I,P)=>I[1].offset-P[1].offset),k={};for(const[I,P]of F)await L.skip(P.offset-L.offset),k[I]=await L.read(P.length);let O=[];if(k.ltag&&(O=f.ltag.parse(k.ltag)),!k.name)throw new Error(`missing required OpenType table 'name' in font file: ${C}`);return{names:f.name.parse(k.name,O),os2:k.os2&&f.os2.parse(k.os2),head:k.head&&f.head.parse(k.head),post:k.post&&f.post.parse(k.post)};case l.Woff:default:throw new Error("provided font type is not supported yet")}}finally{T.unpipe(L),D||(T.destroy(),L.destroy())}})().then(p,y)})};const _={one:Buffer.from([0,1,0,0]),otto:Buffer.from("OTTO"),true:Buffer.from("true"),typ1:Buffer.from("typ1"),woff:Buffer.from("wOFF")}},731:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(980);d.default=function(v){return{version:b.formatFixed(v.readUInt16BE(0),v.readUInt16BE(2)),fontRevision:b.formatFixed(v.readUInt16BE(4),v.readUInt16BE(6)),checkSumAdjustment:v.readUInt32BE(8),magicNumber:v.readUInt32BE(12),flags:v.readUInt16BE(16),unitsPerEm:v.readUInt16BE(18),created:b.formatLongDateTime(v.readUInt32BE(20),v.readUInt32BE(24)),modified:b.formatLongDateTime(v.readUInt32BE(28),v.readUInt32BE(32)),xMin:v.readInt16BE(36),yMin:v.readInt16BE(38),xMax:v.readInt16BE(40),yMax:v.readInt16BE(42),macStyle:v.readUInt16BE(44),lowestRecPPEM:v.readUInt16BE(46),fontDirectionHint:v.readInt16BE(48),indexToLocFormat:v.readInt16BE(50),glyphDataFormat:v.readInt16BE(52)}}},879:(g,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(u){if(u.readUInt32BE(0)!==1)throw new Error("Unsupported ltag table version.");const b=u.readUInt32BE(8),v=[];for(let a=0;a<b;a++){let i="";const h=u.readUInt16BE(12+4*a),r=u.readUInt16BE(14+4*a);for(let s=h;s<h+r;++s)i+=String.fromCharCode(u.readInt8(s));v.push(i)}return v}},380:(g,d)=>{Object.defineProperty(d,"__esModule",{value:!0});const u=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],b={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},v={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function a(_,C,p){switch(_){case 0:if(C===65535)return"und";if(p)return p[C];break;case 1:return b[C];case 3:return v[C]}}const i="utf-16",h={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},r={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function s(_,C,p){switch(_){case 0:return i;case 1:return r[p]||h[C];case 3:if(C===1||C===10)return i}}d.default=function(_,C){const p={},y=_.readUInt16BE(2),L=_.readUInt16BE(4);let T=6;for(let D=0;D<y;D++){const B=_.readUInt16BE(T+0),H=_.readUInt16BE(T+2),A=_.readUInt16BE(T+4),F=_.readUInt16BE(T+6),k=u[F]||String(F),O=_.readUInt16BE(T+8),I=_.readUInt16BE(T+10),P=a(B,A,C),V=s(B,H,A);if(T+=12,V!==void 0&&P!==void 0){let te;if(V===i){const he=O/2,J=Array(he);for(let le=0;le<he;le++)J[le]=_.readUInt16BE(L+I+2*le);te=String.fromCharCode(...J)}else te=f(_,L+I,O,V);if(te){let he=p[k];he===void 0&&(he=p[k]={}),he[P]=te}}}return p};const l={"x-mac-croatian":" ","x-mac-cyrillic":" ","x-mac-gaelic":" ","x-mac-greek":" ","x-mac-icelandic":" ","x-mac-inuit":" ","x-mac-ce":" ",macintosh:" ","x-mac-romanian":" ","x-mac-turkish":" "};function f(_,C,p,y){const L=l[y];if(L===void 0)return;let T="";for(let D=0;D<p;D++){const B=_.readUInt8(C+D);T+=B<=127?String.fromCharCode(B):L[127&B]}return T}},130:(g,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(u){const b={version:u.readUInt16BE(0),xAvgCharWidth:u.readUInt16BE(2),usWeightClass:u.readUInt16BE(4),usWidthClass:u.readUInt16BE(6),fsType:u.readUInt16BE(8),ySubscriptXSize:u.readInt16BE(10),ySubscriptYSize:u.readInt16BE(12),ySubscriptXOffset:u.readInt16BE(14),ySubscriptYOffset:u.readInt16BE(16),ySuperscriptXSize:u.readInt16BE(18),ySuperscriptYSize:u.readInt16BE(20),ySuperscriptXOffset:u.readInt16BE(22),ySuperscriptYOffset:u.readInt16BE(24),yStrikeoutSize:u.readInt16BE(26),yStrikeoutPosition:u.readInt16BE(28),sFamilyClass:u.readInt16BE(30),panose:[u.readUInt8(32),u.readUInt8(33),u.readUInt8(34),u.readUInt8(35),u.readUInt8(36),u.readUInt8(37),u.readUInt8(38),u.readUInt8(39),u.readUInt8(40),u.readUInt8(41)],ulUnicodeRange1:u.readUInt32BE(42),ulUnicodeRange2:u.readUInt32BE(46),ulUnicodeRange3:u.readUInt32BE(50),ulUnicodeRange4:u.readUInt32BE(54),achVendID:String.fromCharCode(u.readUInt8(58),u.readUInt8(59),u.readUInt8(60),u.readUInt8(61)),fsSelection:u.readUInt16BE(62),usFirstCharIndex:u.readUInt16BE(64),usLastCharIndex:u.readUInt16BE(66),sTypoAscender:u.readInt16BE(68),sTypoDescender:u.readInt16BE(70),sTypoLineGap:u.readInt16BE(72),usWinAscent:u.readUInt16BE(74),usWinDescent:u.readUInt16BE(76)};return b.version>=1&&(b.ulCodePageRange1=u.readUInt32BE(78),b.ulCodePageRange2=u.readUInt32BE(82)),b.version>=2&&(b.sxHeight=u.readInt16BE(86),b.sCapHeight=u.readInt16BE(88),b.usDefaultChar=u.readUInt16BE(90),b.usBreakChar=u.readUInt16BE(92),b.usMaxContent=u.readUInt16BE(94)),b}},954:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(980);d.default=function(v){return{version:b.formatFixed(v.readUInt16BE(0),v.readUInt16BE(2)),italicAngle:b.formatFixed(v.readUInt16BE(4),v.readUInt16BE(6)),underlinePosition:v.readInt16BE(8),underlineThickness:v.readInt16BE(10),isFixedPitch:v.readUInt32BE(12),minMemType42:v.readUInt32BE(16),maxMemType42:v.readUInt32BE(20),minMemType1:v.readUInt32BE(24),maxMemType1:v.readUInt32BE(28)}}},980:(g,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.formatFixed=function(u,b){return u+b/65536},d.formatLongDateTime=function(u,b){return 1e3*(u*4294967296+b-2082844800)}},459:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(56),v=u(456),a=u(49),i={win32:()=>({}).WINDIR?[b.join({}.WINDIR,"Fonts")]:["C:\\Windows\\Fonts"],darwin:()=>{const r=v.homedir();return[...r?[b.join(r,"/Library/Fonts")]:[],"/Library/Fonts","/Network/Library/Fonts","/System/Library/Fonts","/System Folder/Fonts"]},linux:()=>{const r=v.homedir();return["/usr/share/fonts","/usr/local/share/fonts",...r?[b.join(r,".fonts"),b.join(r,".local/share/fonts")]:[]]}};function h(r){const s=Object.assign({extensions:["ttf","otf","ttc","woff","woff2"],additionalFolders:[]},r),l=v.platform(),f=i[l];if(!f)throw new Error(`Unsupported platform: ${l}`);const _=f();return a.default([..._,...s.additionalFolders],s.extensions)}g.exports=Object.assign(h,{default:h}),d.default=h},49:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(89),v=u(269),a=u(56),i=v.promisify(b.readdir),h=v.promisify(b.stat);async function r(s,l,f=10){if(f<=0)return[];let _;try{_=await i(s)}catch{return[]}const C=[];return await Promise.all(_.map(async p=>{const y=a.join(s,p);let L;try{L=await h(y)}catch{return}L.isFile()&&l.test(y)?C.push(y):L.isDirectory()&&C.push(...await r(y,l,f-1))})),C}d.default=async function(s,l){const f=new Set;return await Promise.all(s.map(async _=>{const C=await r(a.resolve(_),new RegExp(`\\.${l.map(p=>`(?:${p})`).join("|")}$`));for(const p of C)f.add(p)})),[...f]}},593:(g,d,u)=>{const b=u(411),v=Symbol("max"),a=Symbol("length"),i=Symbol("lengthCalculator"),h=Symbol("allowStale"),r=Symbol("maxAge"),s=Symbol("dispose"),l=Symbol("noDisposeOnSet"),f=Symbol("lruList"),_=Symbol("cache"),C=Symbol("updateAgeOnGet"),p=()=>1,y=(A,F,k)=>{const O=A[_].get(F);if(O){const I=O.value;if(L(A,I)){if(D(A,O),!A[h])return}else k&&(A[C]&&(O.value.now=Date.now()),A[f].unshiftNode(O));return I.value}},L=(A,F)=>{if(!F||!F.maxAge&&!A[r])return!1;const k=Date.now()-F.now;return F.maxAge?k>F.maxAge:A[r]&&k>A[r]},T=A=>{if(A[a]>A[v])for(let F=A[f].tail;A[a]>A[v]&&F!==null;){const k=F.prev;D(A,F),F=k}},D=(A,F)=>{if(F){const k=F.value;A[s]&&A[s](k.key,k.value),A[a]-=k.length,A[_].delete(k.key),A[f].removeNode(F)}};class B{constructor(F,k,O,I,P){this.key=F,this.value=k,this.length=O,this.now=I,this.maxAge=P||0}}const H=(A,F,k,O)=>{let I=k.value;L(A,I)&&(D(A,k),A[h]||(I=void 0)),I&&F.call(O,I.value,I.key,A)};g.exports=class{constructor(A){if(typeof A=="number"&&(A={max:A}),A||(A={}),A.max&&(typeof A.max!="number"||A.max<0))throw new TypeError("max must be a non-negative number");this[v]=A.max||1/0;const F=A.length||p;if(this[i]=typeof F!="function"?p:F,this[h]=A.stale||!1,A.maxAge&&typeof A.maxAge!="number")throw new TypeError("maxAge must be a number");this[r]=A.maxAge||0,this[s]=A.dispose,this[l]=A.noDisposeOnSet||!1,this[C]=A.updateAgeOnGet||!1,this.reset()}set max(A){if(typeof A!="number"||A<0)throw new TypeError("max must be a non-negative number");this[v]=A||1/0,T(this)}get max(){return this[v]}set allowStale(A){this[h]=!!A}get allowStale(){return this[h]}set maxAge(A){if(typeof A!="number")throw new TypeError("maxAge must be a non-negative number");this[r]=A,T(this)}get maxAge(){return this[r]}set lengthCalculator(A){typeof A!="function"&&(A=p),A!==this[i]&&(this[i]=A,this[a]=0,this[f].forEach(F=>{F.length=this[i](F.value,F.key),this[a]+=F.length})),T(this)}get lengthCalculator(){return this[i]}get length(){return this[a]}get itemCount(){return this[f].length}rforEach(A,F){F=F||this;for(let k=this[f].tail;k!==null;){const O=k.prev;H(this,A,k,F),k=O}}forEach(A,F){F=F||this;for(let k=this[f].head;k!==null;){const O=k.next;H(this,A,k,F),k=O}}keys(){return this[f].toArray().map(A=>A.key)}values(){return this[f].toArray().map(A=>A.value)}reset(){this[s]&&this[f]&&this[f].length&&this[f].forEach(A=>this[s](A.key,A.value)),this[_]=new Map,this[f]=new b,this[a]=0}dump(){return this[f].map(A=>!L(this,A)&&{k:A.key,v:A.value,e:A.now+(A.maxAge||0)}).toArray().filter(A=>A)}dumpLru(){return this[f]}set(A,F,k){if((k=k||this[r])&&typeof k!="number")throw new TypeError("maxAge must be a number");const O=k?Date.now():0,I=this[i](F,A);if(this[_].has(A)){if(I>this[v])return D(this,this[_].get(A)),!1;const V=this[_].get(A).value;return this[s]&&(this[l]||this[s](A,V.value)),V.now=O,V.maxAge=k,V.value=F,this[a]+=I-V.length,V.length=I,this.get(A),T(this),!0}const P=new B(A,F,I,O,k);return P.length>this[v]?(this[s]&&this[s](A,F),!1):(this[a]+=P.length,this[f].unshift(P),this[_].set(A,this[f].head),T(this),!0)}has(A){if(!this[_].has(A))return!1;const F=this[_].get(A).value;return!L(this,F)}get(A){return y(this,A,!0)}peek(A){return y(this,A,!1)}pop(){const A=this[f].tail;return A?(D(this,A),A.value):null}del(A){D(this,this[_].get(A))}load(A){this.reset();const F=Date.now();for(let k=A.length-1;k>=0;k--){const O=A[k],I=O.e||0;if(I===0)this.set(O.k,O.v);else{const P=I-F;P>0&&this.set(O.k,O.v,P)}}}prune(){this[_].forEach((A,F)=>y(this,F,!1))}}},602:(g,d,u)=>{u.r(d),u.d(d,{BoundingBox:()=>h,Font:()=>$i,Glyph:()=>kt,Path:()=>s,_parse:()=>ae,load:()=>Qs,loadSync:()=>er,parse:()=>$t});var b=u(311),v=u.n(b);function a(e,t,n,o,S){return Math.pow(1-S,3)*e+3*Math.pow(1-S,2)*S*t+3*(1-S)*Math.pow(S,2)*n+Math.pow(S,3)*o}function i(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}i.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},i.prototype.addPoint=function(e,t){typeof e=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),typeof t=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},i.prototype.addX=function(e){this.addPoint(e,null)},i.prototype.addY=function(e){this.addPoint(null,e)},i.prototype.addBezier=function(e,t,n,o,S,x,E,M){const R=[e,t],U=[n,o],N=[S,x],j=[E,M];this.addPoint(e,t),this.addPoint(E,M);for(let q=0;q<=1;q++){const oe=6*R[q]-12*U[q]+6*N[q],Q=-3*R[q]+9*U[q]-9*N[q]+3*j[q],pe=3*U[q]-3*R[q];if(Q===0){if(oe===0)continue;const me=-pe/oe;0<me&&me<1&&(q===0&&this.addX(a(R[q],U[q],N[q],j[q],me)),q===1&&this.addY(a(R[q],U[q],N[q],j[q],me)));continue}const Y=Math.pow(oe,2)-4*pe*Q;if(Y<0)continue;const ee=(-oe+Math.sqrt(Y))/(2*Q);0<ee&&ee<1&&(q===0&&this.addX(a(R[q],U[q],N[q],j[q],ee)),q===1&&this.addY(a(R[q],U[q],N[q],j[q],ee)));const _e=(-oe-Math.sqrt(Y))/(2*Q);0<_e&&_e<1&&(q===0&&this.addX(a(R[q],U[q],N[q],j[q],_e)),q===1&&this.addY(a(R[q],U[q],N[q],j[q],_e)))}},i.prototype.addQuad=function(e,t,n,o,S,x){const E=e+.6666666666666666*(n-e),M=t+2/3*(o-t),R=E+1/3*(S-e),U=M+1/3*(x-t);this.addBezier(e,t,E,M,R,U,S,x)};const h=i;function r(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}r.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},r.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},r.prototype.curveTo=r.prototype.bezierCurveTo=function(e,t,n,o,S,x){this.commands.push({type:"C",x1:e,y1:t,x2:n,y2:o,x:S,y:x})},r.prototype.quadTo=r.prototype.quadraticCurveTo=function(e,t,n,o){this.commands.push({type:"Q",x1:e,y1:t,x:n,y:o})},r.prototype.close=r.prototype.closePath=function(){this.commands.push({type:"Z"})},r.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof h){const t=e;return this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),void this.close()}Array.prototype.push.apply(this.commands,e)},r.prototype.getBoundingBox=function(){const e=new h;let t=0,n=0,o=0,S=0;for(let x=0;x<this.commands.length;x++){const E=this.commands[x];switch(E.type){case"M":e.addPoint(E.x,E.y),t=o=E.x,n=S=E.y;break;case"L":e.addPoint(E.x,E.y),o=E.x,S=E.y;break;case"Q":e.addQuad(o,S,E.x1,E.y1,E.x,E.y),o=E.x,S=E.y;break;case"C":e.addBezier(o,S,E.x1,E.y1,E.x2,E.y2,E.x,E.y),o=E.x,S=E.y;break;case"Z":o=t,S=n;break;default:throw new Error("Unexpected path command "+E.type)}}return e.isEmpty()&&e.addPoint(0,0),e},r.prototype.draw=function(e){e.beginPath();for(let t=0;t<this.commands.length;t+=1){const n=this.commands[t];n.type==="M"?e.moveTo(n.x,n.y):n.type==="L"?e.lineTo(n.x,n.y):n.type==="C"?e.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):n.type==="Q"?e.quadraticCurveTo(n.x1,n.y1,n.x,n.y):n.type==="Z"&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},r.prototype.toPathData=function(e){function t(S){return Math.round(S)===S?""+Math.round(S):S.toFixed(e)}function n(){let S="";for(let x=0;x<arguments.length;x+=1){const E=arguments[x];E>=0&&x>0&&(S+=" "),S+=t(E)}return S}e=e!==void 0?e:2;let o="";for(let S=0;S<this.commands.length;S+=1){const x=this.commands[S];x.type==="M"?o+="M"+n(x.x,x.y):x.type==="L"?o+="L"+n(x.x,x.y):x.type==="C"?o+="C"+n(x.x1,x.y1,x.x2,x.y2,x.x,x.y):x.type==="Q"?o+="Q"+n(x.x1,x.y1,x.x,x.y):x.type==="Z"&&(o+="Z")}return o},r.prototype.toSVG=function(e){let t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&&this.fill!=="black"&&(this.fill===null?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>",t},r.prototype.toDOMElement=function(e){const t=this.toPathData(e),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",t),n};const s=r;function l(e){throw new Error(e)}function f(e,t){e||l(t)}const _={fail:l,argument:f,assert:f},C=2147483648,p={},y={},L={};function T(e){return function(){return e}}y.BYTE=function(e){return _.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},L.BYTE=T(1),y.CHAR=function(e){return[e.charCodeAt(0)]},L.CHAR=T(1),y.CHARARRAY=function(e){const t=[];for(let n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t},L.CHARARRAY=function(e){return e.length},y.USHORT=function(e){return[e>>8&255,255&e]},L.USHORT=T(2),y.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},L.SHORT=T(2),y.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},L.UINT24=T(3),y.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},L.ULONG=T(4),y.LONG=function(e){return e>=C&&(e=-(2*C-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},L.LONG=T(4),y.FIXED=y.ULONG,L.FIXED=L.ULONG,y.FWORD=y.SHORT,L.FWORD=L.SHORT,y.UFWORD=y.USHORT,L.UFWORD=L.USHORT,y.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},L.LONGDATETIME=T(8),y.TAG=function(e){return _.argument(e.length===4,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},L.TAG=T(4),y.Card8=y.BYTE,L.Card8=L.BYTE,y.Card16=y.USHORT,L.Card16=L.USHORT,y.OffSize=y.BYTE,L.OffSize=L.BYTE,y.SID=y.USHORT,L.SID=L.USHORT,y.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?[247+((e-=108)>>8),255&e]:e>=-1131&&e<=-108?[251+((e=-e-108)>>8),255&e]:e>=-32768&&e<=32767?y.NUMBER16(e):y.NUMBER32(e)},L.NUMBER=function(e){return y.NUMBER(e).length},y.NUMBER16=function(e){return[28,e>>8&255,255&e]},L.NUMBER16=T(3),y.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},L.NUMBER32=T(5),y.REAL=function(e){let t=e.toString();const n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(n){const x=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));t=(Math.round(e*x)/x).toString()}let o="";for(let x=0,E=t.length;x<E;x+=1){const M=t[x];o+=M==="e"?t[++x]==="-"?"c":"b":M==="."?"a":M==="-"?"e":M}o+=1&o.length?"f":"ff";const S=[30];for(let x=0,E=o.length;x<E;x+=2)S.push(parseInt(o.substr(x,2),16));return S},L.REAL=function(e){return y.REAL(e).length},y.NAME=y.CHARARRAY,L.NAME=L.CHARARRAY,y.STRING=y.CHARARRAY,L.STRING=L.CHARARRAY,p.UTF8=function(e,t,n){const o=[],S=n;for(let x=0;x<S;x++,t+=1)o[x]=e.getUint8(t);return String.fromCharCode.apply(null,o)},p.UTF16=function(e,t,n){const o=[],S=n/2;for(let x=0;x<S;x++,t+=2)o[x]=e.getUint16(t);return String.fromCharCode.apply(null,o)},y.UTF16=function(e){const t=[];for(let n=0;n<e.length;n+=1){const o=e.charCodeAt(n);t[t.length]=o>>8&255,t[t.length]=255&o}return t},L.UTF16=function(e){return 2*e.length};const D={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};p.MACSTRING=function(e,t,n,o){const S=D[o];if(S===void 0)return;let x="";for(let E=0;E<n;E++){const M=e.getUint8(t+E);x+=M<=127?String.fromCharCode(M):S[127&M]}return x};const B=typeof WeakMap=="function"&&new WeakMap;let H;function A(e){return e>=-128&&e<=127}function F(e,t,n){let o=0;const S=e.length;for(;t<S&&o<64&&e[t]===0;)++t,++o;return n.push(128|o-1),t}function k(e,t,n){let o=0;const S=e.length;let x=t;for(;x<S&&o<64;){const E=e[x];if(!A(E)||E===0&&x+1<S&&e[x+1]===0)break;++x,++o}n.push(o-1);for(let E=t;E<x;++E)n.push(e[E]+256&255);return x}function O(e,t,n){let o=0;const S=e.length;let x=t;for(;x<S&&o<64;){const E=e[x];if(E===0||A(E)&&x+1<S&&A(e[x+1]))break;++x,++o}n.push(64|o-1);for(let E=t;E<x;++E){const M=e[E];n.push(M+65536>>8&255,M+256&255)}return x}y.MACSTRING=function(e,t){const n=function(S){if(!H){H={};for(let R in D)H[R]=new String(R)}const x=H[S];if(x===void 0)return;if(B){const R=B.get(x);if(R!==void 0)return R}const E=D[S];if(E===void 0)return;const M={};for(let R=0;R<E.length;R++)M[E.charCodeAt(R)]=R+128;return B&&B.set(x,M),M}(t);if(n===void 0)return;const o=[];for(let S=0;S<e.length;S++){let x=e.charCodeAt(S);if(x>=128&&(x=n[x],x===void 0))return;o[S]=x}return o},L.MACSTRING=function(e,t){const n=y.MACSTRING(e,t);return n!==void 0?n.length:0},y.VARDELTAS=function(e){let t=0;const n=[];for(;t<e.length;){const o=e[t];t=o===0?F(e,t,n):o>=-128&&o<=127?k(e,t,n):O(e,t,n)}return n},y.INDEX=function(e){let t=1;const n=[t],o=[];for(let M=0;M<e.length;M+=1){const R=y.OBJECT(e[M]);Array.prototype.push.apply(o,R),t+=R.length,n.push(t)}if(o.length===0)return[0,0];const S=[],x=1+Math.floor(Math.log(t)/Math.log(2))/8|0,E=[void 0,y.BYTE,y.USHORT,y.UINT24,y.ULONG][x];for(let M=0;M<n.length;M+=1){const R=E(n[M]);Array.prototype.push.apply(S,R)}return Array.prototype.concat(y.Card16(e.length),y.OffSize(x),S,o)},L.INDEX=function(e){return y.INDEX(e).length},y.DICT=function(e){let t=[];const n=Object.keys(e),o=n.length;for(let S=0;S<o;S+=1){const x=parseInt(n[S],0),E=e[x];t=t.concat(y.OPERAND(E.value,E.type)),t=t.concat(y.OPERATOR(x))}return t},L.DICT=function(e){return y.DICT(e).length},y.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},y.OPERAND=function(e,t){let n=[];if(Array.isArray(t))for(let o=0;o<t.length;o+=1)_.argument(e.length===t.length,"Not enough arguments given for type"+t),n=n.concat(y.OPERAND(e[o],t[o]));else if(t==="SID")n=n.concat(y.NUMBER(e));else if(t==="offset")n=n.concat(y.NUMBER32(e));else if(t==="number")n=n.concat(y.NUMBER(e));else{if(t!=="real")throw new Error("Unknown operand type "+t);n=n.concat(y.REAL(e))}return n},y.OP=y.BYTE,L.OP=L.BYTE;const I=typeof WeakMap=="function"&&new WeakMap;function P(e,t,n){for(let o=0;o<t.length;o+=1){const S=t[o];this[S.name]=S.value}if(this.tableName=e,this.fields=t,n){const o=Object.keys(n);for(let S=0;S<o.length;S+=1){const x=o[S],E=n[x];this[x]!==void 0&&(this[x]=E)}}}function V(e,t,n){n===void 0&&(n=t.length);const o=new Array(t.length+1);o[0]={name:e+"Count",type:"USHORT",value:n};for(let S=0;S<t.length;S++)o[S+1]={name:e+S,type:"USHORT",value:t[S]};return o}function te(e,t,n){const o=t.length,S=new Array(o+1);S[0]={name:e+"Count",type:"USHORT",value:o};for(let x=0;x<o;x++)S[x+1]={name:e+x,type:"TABLE",value:n(t[x],x)};return S}function he(e,t,n){const o=t.length;let S=[];S[0]={name:e+"Count",type:"USHORT",value:o};for(let x=0;x<o;x++)S=S.concat(n(t[x],x));return S}function J(e){e.format===1?P.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(V("glyph",e.glyphs))):_.assert(!1,"Can't create coverage table format 2 yet.")}function le(e){P.call(this,"scriptListTable",he("scriptRecord",e,function(t,n){const o=t.script;let S=o.defaultLangSys;return _.assert(!!S,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+n,type:"TAG",value:t.tag},{name:"script"+n,type:"TABLE",value:new P("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new P("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:S.reqFeatureIndex}].concat(V("featureIndex",S.featureIndexes)))}].concat(he("langSys",o.langSysRecords,function(x,E){const M=x.langSys;return[{name:"langSysTag"+E,type:"TAG",value:x.tag},{name:"langSys"+E,type:"TABLE",value:new P("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:M.reqFeatureIndex}].concat(V("featureIndex",M.featureIndexes)))}]})))}]}))}function G(e){P.call(this,"featureListTable",he("featureRecord",e,function(t,n){const o=t.feature;return[{name:"featureTag"+n,type:"TAG",value:t.tag},{name:"feature"+n,type:"TABLE",value:new P("featureTable",[{name:"featureParams",type:"USHORT",value:o.featureParams}].concat(V("lookupListIndex",o.lookupListIndexes)))}]}))}function z(e,t){P.call(this,"lookupListTable",te("lookup",e,function(n){let o=t[n.lookupType];return _.assert(!!o,"Unable to write GSUB lookup type "+n.lookupType+" tables."),new P("lookupTable",[{name:"lookupType",type:"USHORT",value:n.lookupType},{name:"lookupFlag",type:"USHORT",value:n.lookupFlag}].concat(te("subtable",n.subtables,o)))}))}y.CHARSTRING=function(e){if(I){const o=I.get(e);if(o!==void 0)return o}let t=[];const n=e.length;for(let o=0;o<n;o+=1){const S=e[o];t=t.concat(y[S.type](S.value))}return I&&I.set(e,t),t},L.CHARSTRING=function(e){return y.CHARSTRING(e).length},y.OBJECT=function(e){const t=y[e.type];return _.argument(t!==void 0,"No encoding function for type "+e.type),t(e.value)},L.OBJECT=function(e){const t=L[e.type];return _.argument(t!==void 0,"No sizeOf function for type "+e.type),t(e.value)},y.TABLE=function(e){let t=[];const n=e.fields.length,o=[],S=[];for(let x=0;x<n;x+=1){const E=e.fields[x],M=y[E.type];_.argument(M!==void 0,"No encoding function for field type "+E.type+" ("+E.name+")");let R=e[E.name];R===void 0&&(R=E.value);const U=M(R);E.type==="TABLE"?(S.push(t.length),t=t.concat([0,0]),o.push(U)):t=t.concat(U)}for(let x=0;x<o.length;x+=1){const E=S[x],M=t.length;_.argument(M<65536,"Table "+e.tableName+" too big."),t[E]=M>>8,t[E+1]=255&M,t=t.concat(o[x])}return t},L.TABLE=function(e){let t=0;const n=e.fields.length;for(let o=0;o<n;o+=1){const S=e.fields[o],x=L[S.type];_.argument(x!==void 0,"No sizeOf function for field type "+S.type+" ("+S.name+")");let E=e[S.name];E===void 0&&(E=S.value),t+=x(E),S.type==="TABLE"&&(t+=2)}return t},y.RECORD=y.TABLE,L.RECORD=L.TABLE,y.LITERAL=function(e){return e},L.LITERAL=function(e){return e.length},P.prototype.encode=function(){return y.TABLE(this)},P.prototype.sizeOf=function(){return L.TABLE(this)},J.prototype=Object.create(P.prototype),J.prototype.constructor=J,le.prototype=Object.create(P.prototype),le.prototype.constructor=le,G.prototype=Object.create(P.prototype),G.prototype.constructor=G,z.prototype=Object.create(P.prototype),z.prototype.constructor=z;const W={Table:P,Record:P,Coverage:J,ScriptList:le,FeatureList:G,LookupList:z,ushortList:V,tableList:te,recordList:he};function Z(e,t){return e.getUint8(t)}function ne(e,t){return e.getUint16(t,!1)}function we(e,t){return e.getUint32(t,!1)}function se(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535}const Me={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function X(e,t){this.data=e,this.offset=t,this.relativeOffset=0}X.prototype.parseByte=function(){const e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},X.prototype.parseChar=function(){const e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},X.prototype.parseCard8=X.prototype.parseByte,X.prototype.parseUShort=function(){const e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},X.prototype.parseCard16=X.prototype.parseUShort,X.prototype.parseSID=X.prototype.parseUShort,X.prototype.parseOffset16=X.prototype.parseUShort,X.prototype.parseShort=function(){const e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},X.prototype.parseF2Dot14=function(){const e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},X.prototype.parseULong=function(){const e=we(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},X.prototype.parseOffset32=X.prototype.parseULong,X.prototype.parseFixed=function(){const e=se(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},X.prototype.parseString=function(e){const t=this.data,n=this.offset+this.relativeOffset;let o="";this.relativeOffset+=e;for(let S=0;S<e;S++)o+=String.fromCharCode(t.getUint8(n+S));return o},X.prototype.parseTag=function(){return this.parseString(4)},X.prototype.parseLongDateTime=function(){let e=we(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},X.prototype.parseVersion=function(e){const t=ne(this.data,this.offset+this.relativeOffset),n=ne(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e===void 0&&(e=4096),t+n/e/10},X.prototype.skip=function(e,t){t===void 0&&(t=1),this.relativeOffset+=Me[e]*t},X.prototype.parseULongList=function(e){e===void 0&&(e=this.parseULong());const t=new Array(e),n=this.data;let o=this.offset+this.relativeOffset;for(let S=0;S<e;S++)t[S]=n.getUint32(o),o+=4;return this.relativeOffset+=4*e,t},X.prototype.parseOffset16List=X.prototype.parseUShortList=function(e){e===void 0&&(e=this.parseUShort());const t=new Array(e),n=this.data;let o=this.offset+this.relativeOffset;for(let S=0;S<e;S++)t[S]=n.getUint16(o),o+=2;return this.relativeOffset+=2*e,t},X.prototype.parseShortList=function(e){const t=new Array(e),n=this.data;let o=this.offset+this.relativeOffset;for(let S=0;S<e;S++)t[S]=n.getInt16(o),o+=2;return this.relativeOffset+=2*e,t},X.prototype.parseByteList=function(e){const t=new Array(e),n=this.data;let o=this.offset+this.relativeOffset;for(let S=0;S<e;S++)t[S]=n.getUint8(o++);return this.relativeOffset+=e,t},X.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());const n=new Array(e);for(let o=0;o<e;o++)n[o]=t.call(this);return n},X.prototype.parseList32=function(e,t){t||(t=e,e=this.parseULong());const n=new Array(e);for(let o=0;o<e;o++)n[o]=t.call(this);return n},X.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());const n=new Array(e),o=Object.keys(t);for(let S=0;S<e;S++){const x={};for(let E=0;E<o.length;E++){const M=o[E],R=t[M];x[M]=R.call(this)}n[S]=x}return n},X.prototype.parseRecordList32=function(e,t){t||(t=e,e=this.parseULong());const n=new Array(e),o=Object.keys(t);for(let S=0;S<e;S++){const x={};for(let E=0;E<o.length;E++){const M=o[E],R=t[M];x[M]=R.call(this)}n[S]=x}return n},X.prototype.parseStruct=function(e){if(typeof e=="function")return e.call(this);{const t=Object.keys(e),n={};for(let o=0;o<t.length;o++){const S=t[o],x=e[S];n[S]=x.call(this)}return n}},X.prototype.parseValueRecord=function(e){if(e===void 0&&(e=this.parseUShort()),e===0)return;const t={};return 1&e&&(t.xPlacement=this.parseShort()),2&e&&(t.yPlacement=this.parseShort()),4&e&&(t.xAdvance=this.parseShort()),8&e&&(t.yAdvance=this.parseShort()),16&e&&(t.xPlaDevice=void 0,this.parseShort()),32&e&&(t.yPlaDevice=void 0,this.parseShort()),64&e&&(t.xAdvDevice=void 0,this.parseShort()),128&e&&(t.yAdvDevice=void 0,this.parseShort()),t},X.prototype.parseValueRecordList=function(){const e=this.parseUShort(),t=this.parseUShort(),n=new Array(t);for(let o=0;o<t;o++)n[o]=this.parseValueRecord(e);return n},X.prototype.parsePointer=function(e){const t=this.parseOffset16();if(t>0)return new X(this.data,this.offset+t).parseStruct(e)},X.prototype.parsePointer32=function(e){const t=this.parseOffset32();if(t>0)return new X(this.data,this.offset+t).parseStruct(e)},X.prototype.parseListOfLists=function(e){const t=this.parseOffset16List(),n=t.length,o=this.relativeOffset,S=new Array(n);for(let x=0;x<n;x++){const E=t[x];if(E!==0)if(this.relativeOffset=E,e){const M=this.parseOffset16List(),R=new Array(M.length);for(let U=0;U<M.length;U++)this.relativeOffset=E+M[U],R[U]=e.call(this);S[x]=R}else S[x]=this.parseUShortList();else S[x]=void 0}return this.relativeOffset=o,S},X.prototype.parseCoverage=function(){const e=this.offset+this.relativeOffset,t=this.parseUShort(),n=this.parseUShort();if(t===1)return{format:1,glyphs:this.parseUShortList(n)};if(t===2){const o=new Array(n);for(let S=0;S<n;S++)o[S]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:o}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},X.prototype.parseClassDef=function(){const e=this.offset+this.relativeOffset,t=this.parseUShort();if(t===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(t===2)return{format:2,ranges:this.parseRecordList({start:X.uShort,end:X.uShort,classId:X.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},X.list=function(e,t){return function(){return this.parseList(e,t)}},X.list32=function(e,t){return function(){return this.parseList32(e,t)}},X.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},X.recordList32=function(e,t){return function(){return this.parseRecordList32(e,t)}},X.pointer=function(e){return function(){return this.parsePointer(e)}},X.pointer32=function(e){return function(){return this.parsePointer32(e)}},X.tag=X.prototype.parseTag,X.byte=X.prototype.parseByte,X.uShort=X.offset16=X.prototype.parseUShort,X.uShortList=X.prototype.parseUShortList,X.uLong=X.offset32=X.prototype.parseULong,X.uLongList=X.prototype.parseULongList,X.struct=X.prototype.parseStruct,X.coverage=X.prototype.parseCoverage,X.classDef=X.prototype.parseClassDef;const ke={reserved:X.uShort,reqFeatureIndex:X.uShort,featureIndexes:X.uShortList};X.prototype.parseScriptList=function(){return this.parsePointer(X.recordList({tag:X.tag,script:X.pointer({defaultLangSys:X.pointer(ke),langSysRecords:X.recordList({tag:X.tag,langSys:X.pointer(ke)})})}))||[]},X.prototype.parseFeatureList=function(){return this.parsePointer(X.recordList({tag:X.tag,feature:X.pointer({featureParams:X.offset16,lookupListIndexes:X.uShortList})}))||[]},X.prototype.parseLookupList=function(e){return this.parsePointer(X.list(X.pointer(function(){const t=this.parseUShort();_.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown.");const n=this.parseUShort(),o=16&n;return{lookupType:t,lookupFlag:n,subtables:this.parseList(X.pointer(e[t])),markFilteringSet:o?this.parseUShort():void 0}})))||[]},X.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){const e=this.parseUShort(),t=this.parseUShort();return _.argument(e===1&&t<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:X.offset32,featureTableSubstitutionOffset:X.offset32})})||[]};const ae={getByte:Z,getCard8:Z,getUShort:ne,getCard16:ne,getShort:function(e,t){return e.getInt16(t,!1)},getULong:we,getFixed:se,getTag:function(e,t){let n="";for(let o=t;o<t+4;o+=1)n+=String.fromCharCode(e.getInt8(o));return n},getOffset:function(e,t,n){let o=0;for(let S=0;S<n;S+=1)o<<=8,o+=e.getUint8(t+S);return o},getBytes:function(e,t,n){const o=[];for(let S=t;S<n;S+=1)o.push(e.getUint8(S));return o},bytesToString:function(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return t},Parser:X};function _t(e,t,n){e.segments.push({end:t,start:t,delta:-(t-n),offset:0,glyphIndex:n})}const Re=function(e,t){const n={};n.version=ae.getUShort(e,t),_.argument(n.version===0,"cmap table version should be 0."),n.numTables=ae.getUShort(e,t+2);let o=-1;for(let x=n.numTables-1;x>=0;x-=1){const E=ae.getUShort(e,t+4+8*x),M=ae.getUShort(e,t+4+8*x+2);if(E===3&&(M===0||M===1||M===10)){o=ae.getULong(e,t+4+8*x+4);break}}if(o===-1)throw new Error("No valid cmap sub-tables found.");const S=new ae.Parser(e,t+o);if(n.format=S.parseUShort(),n.format===12)(function(x,E){let M;E.parseUShort(),x.length=E.parseULong(),x.language=E.parseULong(),x.groupCount=M=E.parseULong(),x.glyphIndexMap={};for(let R=0;R<M;R+=1){const U=E.parseULong(),N=E.parseULong();let j=E.parseULong();for(let q=U;q<=N;q+=1)x.glyphIndexMap[q]=j,j++}})(n,S);else{if(n.format!==4)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");(function(x,E,M,R,U){let N;x.length=E.parseUShort(),x.language=E.parseUShort(),x.segCount=N=E.parseUShort()>>1,E.skip("uShort",3),x.glyphIndexMap={};const j=new ae.Parser(M,R+U+14),q=new ae.Parser(M,R+U+16+2*N),oe=new ae.Parser(M,R+U+16+4*N),Q=new ae.Parser(M,R+U+16+6*N);let pe=R+U+16+8*N;for(let Y=0;Y<N-1;Y+=1){let ee;const _e=j.parseUShort(),me=q.parseUShort(),Le=oe.parseShort(),ce=Q.parseUShort();for(let re=me;re<=_e;re+=1)ce!==0?(pe=Q.offset+Q.relativeOffset-2,pe+=ce,pe+=2*(re-me),ee=ae.getUShort(M,pe),ee!==0&&(ee=ee+Le&65535)):ee=re+Le&65535,x.glyphIndexMap[re]=ee}})(n,S,e,t,o)}return n},xe=function(e){let t,n=!0;for(t=e.length-1;t>0;t-=1)if(e.get(t).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}let o=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(o=o.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),o=o.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);const S=new W.Table("cmap",o);for(S.segments=[],t=0;t<e.length;t+=1){const oe=e.get(t);for(let Q=0;Q<oe.unicodes.length;Q+=1)_t(S,oe.unicodes[Q],t);S.segments=S.segments.sort(function(Q,pe){return Q.start-pe.start})}(function(oe){oe.segments.push({end:65535,start:65535,delta:1,offset:0})})(S);const x=S.segments.length;let E=0,M=[],R=[],U=[],N=[],j=[],q=[];for(t=0;t<x;t+=1){const oe=S.segments[t];oe.end<=65535&&oe.start<=65535?(M=M.concat({name:"end_"+t,type:"USHORT",value:oe.end}),R=R.concat({name:"start_"+t,type:"USHORT",value:oe.start}),U=U.concat({name:"idDelta_"+t,type:"SHORT",value:oe.delta}),N=N.concat({name:"idRangeOffset_"+t,type:"USHORT",value:oe.offset}),oe.glyphId!==void 0&&(j=j.concat({name:"glyph_"+t,type:"USHORT",value:oe.glyphId}))):E+=1,n||oe.glyphIndex===void 0||(q=q.concat({name:"cmap12Start_"+t,type:"ULONG",value:oe.start}),q=q.concat({name:"cmap12End_"+t,type:"ULONG",value:oe.end}),q=q.concat({name:"cmap12Glyph_"+t,type:"ULONG",value:oe.glyphIndex}))}if(S.segCountX2=2*(x-E),S.searchRange=2*Math.pow(2,Math.floor(Math.log(x-E)/Math.log(2))),S.entrySelector=Math.log(S.searchRange/2)/Math.log(2),S.rangeShift=S.segCountX2-S.searchRange,S.fields=S.fields.concat(M),S.fields.push({name:"reservedPad",type:"USHORT",value:0}),S.fields=S.fields.concat(R),S.fields=S.fields.concat(U),S.fields=S.fields.concat(N),S.fields=S.fields.concat(j),S.cmap4Length=14+2*M.length+2+2*R.length+2*U.length+2*N.length+2*j.length,!n){const oe=16+4*q.length;S.cmap12Offset=20+S.cmap4Length,S.fields=S.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:oe},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:q.length/3}]),S.fields=S.fields.concat(q)}return S},Ce=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],be=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],Ee=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Pe=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function Ne(e){this.font=e}function rt(e){this.cmap=e}function Qe(e,t){this.encoding=e,this.charset=t}function ze(e){switch(e.version){case 1:this.names=Pe.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(let t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<Pe.length?this.names[t]=Pe[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-Pe.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(let t=0;t<e.numberOfGlyphs;t++)this.names[t]=Pe[t+e.glyphNameIndex[t]];break;default:this.names=[]}}Ne.prototype.charToGlyphIndex=function(e){const t=e.charCodeAt(0),n=this.font.glyphs;if(n)for(let o=0;o<n.length;o+=1){const S=n.get(o);for(let x=0;x<S.unicodes.length;x+=1)if(S.unicodes[x]===t)return o}return null},rt.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.charCodeAt(0)]||0},Qe.prototype.charToGlyphIndex=function(e){const t=e.charCodeAt(0),n=this.encoding[t];return this.charset.indexOf(n)},ze.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},ze.prototype.glyphIndexToName=function(e){return this.names[e]};const Ae=function(e,t,n,o,S){e.beginPath(),e.moveTo(t,n),e.lineTo(o,S),e.stroke()};function Ke(e,t,n,o,S){let x;return(t&o)>0?(x=e.parseByte(),!(t&S)&&(x=-x),x=n+x):x=(t&S)>0?n:n+e.parseShort(),x}function bt(e,t,n){const o=new ae.Parser(t,n);let S,x;if(e.numberOfContours=o.parseShort(),e._xMin=o.parseShort(),e._yMin=o.parseShort(),e._xMax=o.parseShort(),e._yMax=o.parseShort(),e.numberOfContours>0){const E=e.endPointIndices=[];for(let R=0;R<e.numberOfContours;R+=1)E.push(o.parseUShort());e.instructionLength=o.parseUShort(),e.instructions=[];for(let R=0;R<e.instructionLength;R+=1)e.instructions.push(o.parseByte());const M=E[E.length-1]+1;S=[];for(let R=0;R<M;R+=1)if(x=o.parseByte(),S.push(x),(8&x)>0){const U=o.parseByte();for(let N=0;N<U;N+=1)S.push(x),R+=1}if(_.argument(S.length===M,"Bad flags."),E.length>0){const R=[];let U;if(M>0){for(let q=0;q<M;q+=1)x=S[q],U={},U.onCurve=!!(1&x),U.lastPointOfContour=E.indexOf(q)>=0,R.push(U);let N=0;for(let q=0;q<M;q+=1)x=S[q],U=R[q],U.x=Ke(o,x,N,2,16),N=U.x;let j=0;for(let q=0;q<M;q+=1)x=S[q],U=R[q],U.y=Ke(o,x,j,4,32),j=U.y}e.points=R}else e.points=[]}else if(e.numberOfContours===0)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];let E=!0;for(;E;){S=o.parseUShort();const M={glyphIndex:o.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&S)>0?(2&S)>0?(M.dx=o.parseShort(),M.dy=o.parseShort()):M.matchedPoints=[o.parseUShort(),o.parseUShort()]:(2&S)>0?(M.dx=o.parseChar(),M.dy=o.parseChar()):M.matchedPoints=[o.parseByte(),o.parseByte()],(8&S)>0?M.xScale=M.yScale=o.parseF2Dot14():(64&S)>0?(M.xScale=o.parseF2Dot14(),M.yScale=o.parseF2Dot14()):(128&S)>0&&(M.xScale=o.parseF2Dot14(),M.scale01=o.parseF2Dot14(),M.scale10=o.parseF2Dot14(),M.yScale=o.parseF2Dot14()),e.components.push(M),E=!!(32&S)}if(256&S){e.instructionLength=o.parseUShort(),e.instructions=[];for(let M=0;M<e.instructionLength;M+=1)e.instructions.push(o.parseByte())}}}function nt(e,t){const n=[];for(let o=0;o<e.length;o+=1){const S=e[o],x={x:t.xScale*S.x+t.scale01*S.y+t.dx,y:t.scale10*S.x+t.yScale*S.y+t.dy,onCurve:S.onCurve,lastPointOfContour:S.lastPointOfContour};n.push(x)}return n}function dt(e){const t=new s;if(!e)return t;const n=function(o){const S=[];let x=[];for(let E=0;E<o.length;E+=1){const M=o[E];x.push(M),M.lastPointOfContour&&(S.push(x),x=[])}return _.argument(x.length===0,"There are still points left in the current contour."),S}(e);for(let o=0;o<n.length;++o){const S=n[o];let x=null,E=S[S.length-1],M=S[0];if(E.onCurve)t.moveTo(E.x,E.y);else if(M.onCurve)t.moveTo(M.x,M.y);else{const R={x:.5*(E.x+M.x),y:.5*(E.y+M.y)};t.moveTo(R.x,R.y)}for(let R=0;R<S.length;++R)if(x=E,E=M,M=S[(R+1)%S.length],E.onCurve)t.lineTo(E.x,E.y);else{let U=x,N=M;x.onCurve||(U={x:.5*(E.x+x.x),y:.5*(E.y+x.y)},t.lineTo(U.x,U.y)),M.onCurve||(N={x:.5*(E.x+M.x),y:.5*(E.y+M.y)}),t.lineTo(U.x,U.y),t.quadraticCurveTo(E.x,E.y,N.x,N.y)}t.closePath()}return t}function Et(e,t){if(t.isComposite)for(let n=0;n<t.components.length;n+=1){const o=t.components[n],S=e.get(o.glyphIndex);if(S.getPath(),S.points){let x;if(o.matchedPoints===void 0)x=nt(S.points,o);else{if(o.matchedPoints[0]>t.points.length-1||o.matchedPoints[1]>S.points.length-1)throw Error("Matched points out of range in "+t.name);const E=t.points[o.matchedPoints[0]];let M=S.points[o.matchedPoints[1]];const R={xScale:o.xScale,scale01:o.scale01,scale10:o.scale10,yScale:o.yScale,dx:0,dy:0};M=nt([M],R)[0],R.dx=E.x-M.x,R.dy=E.y-M.y,x=nt(S.points,R)}t.points=t.points.concat(x)}}return dt(t.points)}const Xt={getPath:dt,parse:function(e,t,n,o){const S=new pt.GlyphSet(o);for(let x=0;x<n.length-1;x+=1){const E=n[x];E!==n[x+1]?S.push(x,pt.ttfGlyphLoader(o,x,bt,e,t+E,Et)):S.push(x,pt.glyphLoader(o,x))}return S}};function et(e){this.bindConstructorValues(e)}et.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||e.unicode!==void 0?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",function(t,n){let o=n||new s;return{configurable:!0,get:function(){return typeof o=="function"&&(o=o()),o},set:function(S){o=S}}}(0,e.path))},et.prototype.addUnicode=function(e){this.unicodes.length===0&&(this.unicode=e),this.unicodes.push(e)},et.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},et.prototype.getPath=function(e,t,n,o,S){let x,E;e=e!==void 0?e:0,t=t!==void 0?t:0,n=n!==void 0?n:72,o||(o={});let M=o.xScale,R=o.yScale;if(o.hinting&&S&&S.hinting&&(E=this.path&&S.hinting.exec(this,n)),E)x=Xt.getPath(E).commands,e=Math.round(e),t=Math.round(t),M=R=1;else{x=this.path.commands;const N=1/this.path.unitsPerEm*n;M===void 0&&(M=N),R===void 0&&(R=N)}const U=new s;for(let N=0;N<x.length;N+=1){const j=x[N];j.type==="M"?U.moveTo(e+j.x*M,t+-j.y*R):j.type==="L"?U.lineTo(e+j.x*M,t+-j.y*R):j.type==="Q"?U.quadraticCurveTo(e+j.x1*M,t+-j.y1*R,e+j.x*M,t+-j.y*R):j.type==="C"?U.curveTo(e+j.x1*M,t+-j.y1*R,e+j.x2*M,t+-j.y2*R,e+j.x*M,t+-j.y*R):j.type==="Z"&&U.closePath()}return U},et.prototype.getContours=function(){if(this.points===void 0)return[];const e=[];let t=[];for(let n=0;n<this.points.length;n+=1){const o=this.points[n];t.push(o),o.lastPointOfContour&&(e.push(t),t=[])}return _.argument(t.length===0,"There are still points left in the current contour."),e},et.prototype.getMetrics=function(){const e=this.path.commands,t=[],n=[];for(let S=0;S<e.length;S+=1){const x=e[S];x.type!=="Z"&&(t.push(x.x),n.push(x.y)),x.type!=="Q"&&x.type!=="C"||(t.push(x.x1),n.push(x.y1)),x.type==="C"&&(t.push(x.x2),n.push(x.y2))}const o={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},et.prototype.draw=function(e,t,n,o,S){this.getPath(t,n,o,S).draw(e)},et.prototype.drawPoints=function(e,t,n,o){function S(U,N,j,q){const oe=2*Math.PI;e.beginPath();for(let Q=0;Q<U.length;Q+=1)e.moveTo(N+U[Q].x*q,j+U[Q].y*q),e.arc(N+U[Q].x*q,j+U[Q].y*q,2,0,oe,!1);e.closePath(),e.fill()}t=t!==void 0?t:0,n=n!==void 0?n:0,o=o!==void 0?o:24;const x=1/this.path.unitsPerEm*o,E=[],M=[],R=this.path;for(let U=0;U<R.commands.length;U+=1){const N=R.commands[U];N.x!==void 0&&E.push({x:N.x,y:-N.y}),N.x1!==void 0&&M.push({x:N.x1,y:-N.y1}),N.x2!==void 0&&M.push({x:N.x2,y:-N.y2})}e.fillStyle="blue",S(E,t,n,x),e.fillStyle="red",S(M,t,n,x)},et.prototype.drawMetrics=function(e,t,n,o){let S;t=t!==void 0?t:0,n=n!==void 0?n:0,o=o!==void 0?o:24,S=1/this.path.unitsPerEm*o,e.lineWidth=1,e.strokeStyle="black",Ae(e,t,-1e4,t,1e4),Ae(e,-1e4,n,1e4,n);const x=this.xMin||0;let E=this.yMin||0;const M=this.xMax||0;let R=this.yMax||0;const U=this.advanceWidth||0;e.strokeStyle="blue",Ae(e,t+x*S,-1e4,t+x*S,1e4),Ae(e,t+M*S,-1e4,t+M*S,1e4),Ae(e,-1e4,n+-E*S,1e4,n+-E*S),Ae(e,-1e4,n+-R*S,1e4,n+-R*S),e.strokeStyle="green",Ae(e,t+U*S,-1e4,t+U*S,1e4)};const kt=et;function Rt(e,t,n){Object.defineProperty(e,t,{get:function(){return e.path,e[n]},set:function(o){e[n]=o},enumerable:!0,configurable:!0})}function It(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(let n=0;n<t.length;n++)this.glyphs[n]=t[n];this.length=t&&t.length||0}It.prototype.get=function(e){return typeof this.glyphs[e]=="function"&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},It.prototype.push=function(e,t){this.glyphs[e]=t,this.length++};const pt={GlyphSet:It,glyphLoader:function(e,t){return new kt({index:t,font:e})},ttfGlyphLoader:function(e,t,n,o,S,x){return function(){const E=new kt({index:t,font:e});return E.path=function(){n(E,o,S);const M=x(e.glyphs,E);return M.unitsPerEm=e.unitsPerEm,M},Rt(E,"xMin","_xMin"),Rt(E,"xMax","_xMax"),Rt(E,"yMin","_yMin"),Rt(E,"yMax","_yMax"),E}},cffGlyphLoader:function(e,t,n,o){return function(){const S=new kt({index:t,font:e});return S.path=function(){const x=n(e,S,o);return x.unitsPerEm=e.unitsPerEm,x},S}}};function Yt(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(!Yt(e[n],t[n]))return!1;return!0}return!1}function Pt(e){let t;return t=e.length<1240?107:e.length<33900?1131:32768,t}function ot(e,t,n){const o=[],S=[],x=ae.getCard16(e,t);let E,M;if(x!==0){const R=ae.getByte(e,t+2);E=t+(x+1)*R+2;let U=t+3;for(let N=0;N<x+1;N+=1)o.push(ae.getOffset(e,U,R)),U+=R;M=E+o[x]}else M=t+2;for(let R=0;R<o.length-1;R+=1){let U=ae.getBytes(e,E+o[R],E+o[R+1]);n&&(U=n(U)),S.push(U)}return{objects:S,startOffset:t,endOffset:M}}function ts(e,t){let n,o,S,x;if(t===28)return n=e.parseByte(),o=e.parseByte(),n<<8|o;if(t===29)return n=e.parseByte(),o=e.parseByte(),S=e.parseByte(),x=e.parseByte(),n<<24|o<<16|S<<8|x;if(t===30)return function(E){let M="";const R=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];for(;;){const U=E.parseByte(),N=U>>4,j=15&U;if(N===15||(M+=R[N],j===15))break;M+=R[j]}return parseFloat(M)}(e);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return n=e.parseByte(),256*(t-247)+n+108;if(t>=251&&t<=254)return n=e.parseByte(),256*-(t-251)-n-108;throw new Error("Invalid b0 "+t)}function Zt(e,t,n){t=t!==void 0?t:0;const o=new ae.Parser(e,t),S=[];let x=[];for(n=n!==void 0?n:e.length;o.relativeOffset<n;){let E=o.parseByte();E<=21?(E===12&&(E=1200+o.parseByte()),S.push([E,x]),x=[]):x.push(ts(o,E))}return function(E){const M={};for(let R=0;R<E.length;R+=1){const U=E[R][0],N=E[R][1];let j;if(j=N.length===1?N[0]:N,M.hasOwnProperty(U)&&!isNaN(M[U]))throw new Error("Object "+M+" already has key "+U);M[U]=j}return M}(S)}function Ct(e,t){return t<=390?Ce[t]:e[t-391]}function Jt(e,t,n){const o={};let S;for(let x=0;x<t.length;x+=1){const E=t[x];if(Array.isArray(E.type)){const M=[];M.length=E.type.length;for(let R=0;R<E.type.length;R++)S=e[E.op]!==void 0?e[E.op][R]:void 0,S===void 0&&(S=E.value!==void 0&&E.value[R]!==void 0?E.value[R]:null),E.type[R]==="SID"&&(S=Ct(n,S)),M[R]=S;o[E.name]=M}else S=e[E.op],S===void 0&&(S=E.value!==void 0?E.value:null),E.type==="SID"&&(S=Ct(n,S)),o[E.name]=S}return o}const Qt=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],ei=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function is(e,t){return Jt(Zt(e,0,e.byteLength),Qt,t)}function ti(e,t,n,o){return Jt(Zt(e,t,n),ei,o)}function ii(e,t,n,o){const S=[];for(let x=0;x<n.length;x+=1){const E=is(new DataView(new Uint8Array(n[x]).buffer),o);E._subrs=[],E._subrsBias=0;const M=E.private[0],R=E.private[1];if(M!==0&&R!==0){const U=ti(e,R+t,M,o);if(E._defaultWidthX=U.defaultWidthX,E._nominalWidthX=U.nominalWidthX,U.subrs!==0){const N=ot(e,R+U.subrs+t);E._subrs=N.objects,E._subrsBias=Pt(E._subrs)}E._privateDict=U}S.push(E)}return S}function ss(e,t,n){let o,S,x,E;const M=new s,R=[];let U,N,j,q,oe=0,Q=!1,pe=!1,Y=0,ee=0;if(e.isCIDFont){const ce=e.tables.cff.topDict._fdSelect[t.index],re=e.tables.cff.topDict._fdArray[ce];U=re._subrs,N=re._subrsBias,j=re._defaultWidthX,q=re._nominalWidthX}else U=e.tables.cff.topDict._subrs,N=e.tables.cff.topDict._subrsBias,j=e.tables.cff.topDict._defaultWidthX,q=e.tables.cff.topDict._nominalWidthX;let _e=j;function me(ce,re){pe&&M.closePath(),M.moveTo(ce,re),pe=!0}function Le(){let ce;ce=R.length%2!=0,ce&&!Q&&(_e=R.shift()+q),oe+=R.length>>1,R.length=0,Q=!0}return function ce(re){let ue,Te,ye,Ie,We,qe,Fe,$e,Ue,Ge,He,Ve,Be=0;for(;Be<re.length;){let je=re[Be];switch(Be+=1,je){case 1:case 3:case 18:case 23:Le();break;case 4:R.length>1&&!Q&&(_e=R.shift()+q,Q=!0),ee+=R.pop(),me(Y,ee);break;case 5:for(;R.length>0;)Y+=R.shift(),ee+=R.shift(),M.lineTo(Y,ee);break;case 6:for(;R.length>0&&(Y+=R.shift(),M.lineTo(Y,ee),R.length!==0);)ee+=R.shift(),M.lineTo(Y,ee);break;case 7:for(;R.length>0&&(ee+=R.shift(),M.lineTo(Y,ee),R.length!==0);)Y+=R.shift(),M.lineTo(Y,ee);break;case 8:for(;R.length>0;)o=Y+R.shift(),S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Y=x+R.shift(),ee=E+R.shift(),M.curveTo(o,S,x,E,Y,ee);break;case 10:We=R.pop()+N,qe=U[We],qe&&ce(qe);break;case 11:return;case 12:switch(je=re[Be],Be+=1,je){case 35:o=Y+R.shift(),S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Fe=x+R.shift(),$e=E+R.shift(),Ue=Fe+R.shift(),Ge=$e+R.shift(),He=Ue+R.shift(),Ve=Ge+R.shift(),Y=He+R.shift(),ee=Ve+R.shift(),R.shift(),M.curveTo(o,S,x,E,Fe,$e),M.curveTo(Ue,Ge,He,Ve,Y,ee);break;case 34:o=Y+R.shift(),S=ee,x=o+R.shift(),E=S+R.shift(),Fe=x+R.shift(),$e=E,Ue=Fe+R.shift(),Ge=E,He=Ue+R.shift(),Ve=ee,Y=He+R.shift(),M.curveTo(o,S,x,E,Fe,$e),M.curveTo(Ue,Ge,He,Ve,Y,ee);break;case 36:o=Y+R.shift(),S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Fe=x+R.shift(),$e=E,Ue=Fe+R.shift(),Ge=E,He=Ue+R.shift(),Ve=Ge+R.shift(),Y=He+R.shift(),M.curveTo(o,S,x,E,Fe,$e),M.curveTo(Ue,Ge,He,Ve,Y,ee);break;case 37:o=Y+R.shift(),S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Fe=x+R.shift(),$e=E+R.shift(),Ue=Fe+R.shift(),Ge=$e+R.shift(),He=Ue+R.shift(),Ve=Ge+R.shift(),Math.abs(He-Y)>Math.abs(Ve-ee)?Y=He+R.shift():ee=Ve+R.shift(),M.curveTo(o,S,x,E,Fe,$e),M.curveTo(Ue,Ge,He,Ve,Y,ee);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+je),R.length=0}break;case 14:R.length>0&&!Q&&(_e=R.shift()+q,Q=!0),pe&&(M.closePath(),pe=!1);break;case 19:case 20:Le(),Be+=oe+7>>3;break;case 21:R.length>2&&!Q&&(_e=R.shift()+q,Q=!0),ee+=R.pop(),Y+=R.pop(),me(Y,ee);break;case 22:R.length>1&&!Q&&(_e=R.shift()+q,Q=!0),Y+=R.pop(),me(Y,ee);break;case 24:for(;R.length>2;)o=Y+R.shift(),S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Y=x+R.shift(),ee=E+R.shift(),M.curveTo(o,S,x,E,Y,ee);Y+=R.shift(),ee+=R.shift(),M.lineTo(Y,ee);break;case 25:for(;R.length>6;)Y+=R.shift(),ee+=R.shift(),M.lineTo(Y,ee);o=Y+R.shift(),S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Y=x+R.shift(),ee=E+R.shift(),M.curveTo(o,S,x,E,Y,ee);break;case 26:for(R.length%2&&(Y+=R.shift());R.length>0;)o=Y,S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Y=x,ee=E+R.shift(),M.curveTo(o,S,x,E,Y,ee);break;case 27:for(R.length%2&&(ee+=R.shift());R.length>0;)o=Y+R.shift(),S=ee,x=o+R.shift(),E=S+R.shift(),Y=x+R.shift(),ee=E,M.curveTo(o,S,x,E,Y,ee);break;case 28:ue=re[Be],Te=re[Be+1],R.push((ue<<24|Te<<16)>>16),Be+=2;break;case 29:We=R.pop()+e.gsubrsBias,qe=e.gsubrs[We],qe&&ce(qe);break;case 30:for(;R.length>0&&(o=Y,S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Y=x+R.shift(),ee=E+(R.length===1?R.shift():0),M.curveTo(o,S,x,E,Y,ee),R.length!==0);)o=Y+R.shift(),S=ee,x=o+R.shift(),E=S+R.shift(),ee=E+R.shift(),Y=x+(R.length===1?R.shift():0),M.curveTo(o,S,x,E,Y,ee);break;case 31:for(;R.length>0&&(o=Y+R.shift(),S=ee,x=o+R.shift(),E=S+R.shift(),ee=E+R.shift(),Y=x+(R.length===1?R.shift():0),M.curveTo(o,S,x,E,Y,ee),R.length!==0);)o=Y,S=ee+R.shift(),x=o+R.shift(),E=S+R.shift(),Y=x+R.shift(),ee=E+(R.length===1?R.shift():0),M.curveTo(o,S,x,E,Y,ee);break;default:je<32?console.log("Glyph "+t.index+": unknown operator "+je):je<247?R.push(je-139):je<251?(ue=re[Be],Be+=1,R.push(256*(je-247)+ue+108)):je<255?(ue=re[Be],Be+=1,R.push(256*-(je-251)-ue-108)):(ue=re[Be],Te=re[Be+1],ye=re[Be+2],Ie=re[Be+3],Be+=4,R.push((ue<<24|Te<<16|ye<<8|Ie)/65536))}}}(n),t.advanceWidth=_e,M}function si(e,t){let n,o=Ce.indexOf(e);return o>=0&&(n=o),o=t.indexOf(e),o>=0?n=o+Ce.length:(n=Ce.length+t.length,t.push(e)),n}function ri(e,t,n){const o={};for(let S=0;S<e.length;S+=1){const x=e[S];let E=t[x.name];E===void 0||Yt(E,x.value)||(x.type==="SID"&&(E=si(E,n)),o[x.op]={name:x.name,type:x.type,value:E})}return o}function ni(e,t){const n=new W.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=ri(Qt,e,t),n}function oi(e){const t=new W.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function rs(e){const t=[],n=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});let o=0,S=0;for(let x=0;x<n.commands.length;x+=1){let E,M,R=n.commands[x];if(R.type==="Q"){const U=.3333333333333333,N=2/3;R={type:"C",x:R.x,y:R.y,x1:U*o+N*R.x1,y1:U*S+N*R.y1,x2:U*R.x+N*R.x1,y2:U*R.y+N*R.y1}}if(R.type==="M")E=Math.round(R.x-o),M=Math.round(R.y-S),t.push({name:"dx",type:"NUMBER",value:E}),t.push({name:"dy",type:"NUMBER",value:M}),t.push({name:"rmoveto",type:"OP",value:21}),o=Math.round(R.x),S=Math.round(R.y);else if(R.type==="L")E=Math.round(R.x-o),M=Math.round(R.y-S),t.push({name:"dx",type:"NUMBER",value:E}),t.push({name:"dy",type:"NUMBER",value:M}),t.push({name:"rlineto",type:"OP",value:5}),o=Math.round(R.x),S=Math.round(R.y);else if(R.type==="C"){const U=Math.round(R.x1-o),N=Math.round(R.y1-S),j=Math.round(R.x2-R.x1),q=Math.round(R.y2-R.y1);E=Math.round(R.x-R.x2),M=Math.round(R.y-R.y2),t.push({name:"dx1",type:"NUMBER",value:U}),t.push({name:"dy1",type:"NUMBER",value:N}),t.push({name:"dx2",type:"NUMBER",value:j}),t.push({name:"dy2",type:"NUMBER",value:q}),t.push({name:"dx",type:"NUMBER",value:E}),t.push({name:"dy",type:"NUMBER",value:M}),t.push({name:"rrcurveto",type:"OP",value:8}),o=Math.round(R.x),S=Math.round(R.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}const ns=function(e,t,n){n.tables.cff={};const o=function(Q,pe){const Y={};return Y.formatMajor=ae.getCard8(Q,pe),Y.formatMinor=ae.getCard8(Q,pe+1),Y.size=ae.getCard8(Q,pe+2),Y.offsetSize=ae.getCard8(Q,pe+3),Y.startOffset=pe,Y.endOffset=pe+4,Y}(e,t),S=ot(e,o.endOffset,ae.bytesToString),x=ot(e,S.endOffset),E=ot(e,x.endOffset,ae.bytesToString),M=ot(e,E.endOffset);n.gsubrs=M.objects,n.gsubrsBias=Pt(n.gsubrs);const R=ii(e,t,x.objects,E.objects);if(R.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+R.length);const U=R[0];if(n.tables.cff.topDict=U,U._privateDict&&(n.defaultWidthX=U._privateDict.defaultWidthX,n.nominalWidthX=U._privateDict.nominalWidthX),U.ros[0]!==void 0&&U.ros[1]!==void 0&&(n.isCIDFont=!0),n.isCIDFont){let Q=U.fdArray,pe=U.fdSelect;if(Q===0||pe===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");Q+=t;const Y=ii(e,t,ot(e,Q).objects,E.objects);U._fdArray=Y,pe+=t,U._fdSelect=function(ee,_e,me,Le){const ce=[];let re;const ue=new ae.Parser(ee,_e),Te=ue.parseCard8();if(Te===0)for(let ye=0;ye<me;ye++){if(re=ue.parseCard8(),re>=Le)throw new Error("CFF table CID Font FDSelect has bad FD index value "+re+" (FD count "+Le+")");ce.push(re)}else{if(Te!==3)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+Te);{const ye=ue.parseCard16();let Ie,We=ue.parseCard16();if(We!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+We);for(let qe=0;qe<ye;qe++){if(re=ue.parseCard8(),Ie=ue.parseCard16(),re>=Le)throw new Error("CFF table CID Font FDSelect has bad FD index value "+re+" (FD count "+Le+")");if(Ie>me)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+Ie);for(;We<Ie;We++)ce.push(re);We=Ie}if(Ie!==me)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+Ie)}}return ce}(e,pe,n.numGlyphs,Y.length)}const N=t+U.private[1],j=ti(e,N,U.private[0],E.objects);if(n.defaultWidthX=j.defaultWidthX,n.nominalWidthX=j.nominalWidthX,j.subrs!==0){const Q=ot(e,N+j.subrs);n.subrs=Q.objects,n.subrsBias=Pt(n.subrs)}else n.subrs=[],n.subrsBias=0;const q=ot(e,t+U.charStrings);n.nGlyphs=q.objects.length;const oe=function(Q,pe,Y,ee){let _e,me;const Le=new ae.Parser(Q,pe);Y-=1;const ce=[".notdef"],re=Le.parseCard8();if(re===0)for(let ue=0;ue<Y;ue+=1)_e=Le.parseSID(),ce.push(Ct(ee,_e));else if(re===1)for(;ce.length<=Y;){_e=Le.parseSID(),me=Le.parseCard8();for(let ue=0;ue<=me;ue+=1)ce.push(Ct(ee,_e)),_e+=1}else{if(re!==2)throw new Error("Unknown charset format "+re);for(;ce.length<=Y;){_e=Le.parseSID(),me=Le.parseCard16();for(let ue=0;ue<=me;ue+=1)ce.push(Ct(ee,_e)),_e+=1}}return ce}(e,t+U.charset,n.nGlyphs,E.objects);U.encoding===0?n.cffEncoding=new Qe(be,oe):U.encoding===1?n.cffEncoding=new Qe(Ee,oe):n.cffEncoding=function(Q,pe,Y){let ee;const _e={},me=new ae.Parser(Q,pe),Le=me.parseCard8();if(Le===0){const ce=me.parseCard8();for(let re=0;re<ce;re+=1)ee=me.parseCard8(),_e[ee]=re}else{if(Le!==1)throw new Error("Unknown encoding format "+Le);{const ce=me.parseCard8();ee=1;for(let re=0;re<ce;re+=1){const ue=me.parseCard8(),Te=me.parseCard8();for(let ye=ue;ye<=ue+Te;ye+=1)_e[ye]=ee,ee+=1}}}return new Qe(_e,Y)}(e,t+U.encoding,oe),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new pt.GlyphSet(n);for(let Q=0;Q<n.nGlyphs;Q+=1){const pe=q.objects[Q];n.glyphs.push(Q,pt.cffGlyphLoader(n,Q,ss,pe))}},os=function(e,t){const n=new W.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),o=1/t.unitsPerEm,S={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[o,0,0,o,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},x=[];let E;for(let N=1;N<e.length;N+=1)E=e.get(N),x.push(E.name);const M=[];n.header=new W.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),n.nameIndex=function(N){const j=new W.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);j.names=[];for(let q=0;q<N.length;q+=1)j.names.push({name:"name_"+q,type:"NAME",value:N[q]});return j}([t.postScriptName]);let R=ni(S,M);n.topDictIndex=oi(R),n.globalSubrIndex=new W.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),n.charsets=function(N,j){const q=new W.Record("Charsets",[{name:"format",type:"Card8",value:0}]);for(let oe=0;oe<N.length;oe+=1){const Q=si(N[oe],j);q.fields.push({name:"glyph_"+oe,type:"SID",value:Q})}return q}(x,M),n.charStringsIndex=function(N){const j=new W.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]);for(let q=0;q<N.length;q+=1){const oe=N.get(q),Q=rs(oe);j.charStrings.push({name:oe.name,type:"CHARSTRING",value:Q})}return j}(e),n.privateDict=function(N,j){const q=new W.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return q.dict=ri(ei,{},j),q}(0,M),n.stringIndex=function(N){const j=new W.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);j.strings=[];for(let q=0;q<N.length;q+=1)j.strings.push({name:"string_"+q,type:"STRING",value:N[q]});return j}(M);const U=n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf();return S.charset=U,S.encoding=0,S.charStrings=S.charset+n.charsets.sizeOf(),S.private[1]=S.charStrings+n.charStringsIndex.sizeOf(),R=ni(S,M),n.topDictIndex=oi(R),n},as=function(e,t){const n={},o=new ae.Parser(e,t);return n.version=o.parseVersion(),n.fontRevision=Math.round(1e3*o.parseFixed())/1e3,n.checkSumAdjustment=o.parseULong(),n.magicNumber=o.parseULong(),_.argument(n.magicNumber===1594834165,"Font header has wrong magic number."),n.flags=o.parseUShort(),n.unitsPerEm=o.parseUShort(),n.created=o.parseLongDateTime(),n.modified=o.parseLongDateTime(),n.xMin=o.parseShort(),n.yMin=o.parseShort(),n.xMax=o.parseShort(),n.yMax=o.parseShort(),n.macStyle=o.parseUShort(),n.lowestRecPPEM=o.parseUShort(),n.fontDirectionHint=o.parseShort(),n.indexToLocFormat=o.parseShort(),n.glyphDataFormat=o.parseShort(),n},ls=function(e){const t=Math.round(new Date().getTime()/1e3)+2082844800;let n=t;return e.createdTimestamp&&(n=e.createdTimestamp+2082844800),new W.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)},hs=function(e,t){const n={},o=new ae.Parser(e,t);return n.version=o.parseVersion(),n.ascender=o.parseShort(),n.descender=o.parseShort(),n.lineGap=o.parseShort(),n.advanceWidthMax=o.parseUShort(),n.minLeftSideBearing=o.parseShort(),n.minRightSideBearing=o.parseShort(),n.xMaxExtent=o.parseShort(),n.caretSlopeRise=o.parseShort(),n.caretSlopeRun=o.parseShort(),n.caretOffset=o.parseShort(),o.relativeOffset+=8,n.metricDataFormat=o.parseShort(),n.numberOfHMetrics=o.parseUShort(),n},cs=function(e){return new W.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)},us=function(e,t,n,o,S){let x,E;const M=new ae.Parser(e,t);for(let R=0;R<o;R+=1){R<n&&(x=M.parseUShort(),E=M.parseShort());const U=S.get(R);U.advanceWidth=x,U.leftSideBearing=E}},ds=function(e){const t=new W.Table("hmtx",[]);for(let n=0;n<e.length;n+=1){const o=e.get(n),S=o.advanceWidth||0,x=o.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:S}),t.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:x})}return t},fs=function(e){const t=new W.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]);let n="";const o=12+4*e.length;for(let S=0;S<e.length;++S){let x=n.indexOf(e[S]);x<0&&(x=n.length,n+=e[S]),t.fields.push({name:"offset "+S,type:"USHORT",value:o+x}),t.fields.push({name:"length "+S,type:"USHORT",value:e[S].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),t},_s=function(e,t){const n=new ae.Parser(e,t),o=n.parseULong();_.argument(o===1,"Unsupported ltag table version."),n.skip("uLong",1);const S=n.parseULong(),x=[];for(let E=0;E<S;E++){let M="";const R=t+n.parseUShort(),U=n.parseUShort();for(let N=R;N<R+U;++N)M+=String.fromCharCode(e.getInt8(N));x.push(M)}return x},ps=function(e,t){const n={},o=new ae.Parser(e,t);return n.version=o.parseVersion(),n.numGlyphs=o.parseUShort(),n.version===1&&(n.maxPoints=o.parseUShort(),n.maxContours=o.parseUShort(),n.maxCompositePoints=o.parseUShort(),n.maxCompositeContours=o.parseUShort(),n.maxZones=o.parseUShort(),n.maxTwilightPoints=o.parseUShort(),n.maxStorage=o.parseUShort(),n.maxFunctionDefs=o.parseUShort(),n.maxInstructionDefs=o.parseUShort(),n.maxStackElements=o.parseUShort(),n.maxSizeOfInstructions=o.parseUShort(),n.maxComponentElements=o.parseUShort(),n.maxComponentDepth=o.parseUShort()),n},gs=function(e){return new W.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])},ai=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],li={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},vs={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},hi={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function ms(e,t,n){switch(e){case 0:if(t===65535)return"und";if(n)return n[t];break;case 1:return li[t];case 3:return hi[t]}}const Ut="utf-16",Ss={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},ys={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function ci(e,t,n){switch(e){case 0:return Ut;case 1:return ys[n]||Ss[t];case 3:if(t===1||t===10)return Ut}}function Ft(e){const t={};for(let n in e)t[e[n]]=parseInt(n);return t}function ui(e,t,n,o,S,x){return new W.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:o},{name:"length",type:"USHORT",value:S},{name:"offset",type:"USHORT",value:x}])}function di(e,t){let n=function(o,S){const x=o.length,E=S.length-x+1;e:for(let M=0;M<E;M++)for(;M<E;M++){for(let R=0;R<x;R++)if(S[M+R]!==o[R])continue e;return M}return-1}(e,t);if(n<0){n=t.length;let o=0;const S=e.length;for(;o<S;++o)t.push(e[o])}return n}const bs=function(e,t,n){const o={},S=new ae.Parser(e,t),x=S.parseUShort(),E=S.parseUShort(),M=S.offset+S.parseUShort();for(let R=0;R<E;R++){const U=S.parseUShort(),N=S.parseUShort(),j=S.parseUShort(),q=S.parseUShort(),oe=ai[q]||q,Q=S.parseUShort(),pe=S.parseUShort(),Y=ms(U,j,n),ee=ci(U,N,j);if(ee!==void 0&&Y!==void 0){let _e;if(_e=ee===Ut?p.UTF16(e,M+pe,Q):p.MACSTRING(e,M+pe,Q,ee),_e){let me=o[oe];me===void 0&&(me=o[oe]={}),me[Y]=_e}}}return x===1&&S.parseUShort(),o},Cs=function(e,t){let n;const o=[],S={},x=Ft(ai);for(let j in e){let q=x[j];if(q===void 0&&(q=j),n=parseInt(q),isNaN(n))throw new Error('Name table entry "'+j+'" does not exist, see nameTableNames for complete list.');S[n]=e[j],o.push(n)}const E=Ft(li),M=Ft(hi),R=[],U=[];for(let j=0;j<o.length;j++){n=o[j];const q=S[n];for(let oe in q){const Q=q[oe];let pe=1,Y=E[oe],ee=vs[Y];const _e=ci(pe,ee,Y);let me=y.MACSTRING(Q,_e);me===void 0&&(pe=0,Y=t.indexOf(oe),Y<0&&(Y=t.length,t.push(oe)),ee=4,me=y.UTF16(Q));const Le=di(me,U);R.push(ui(pe,ee,Y,n,me.length,Le));const ce=M[oe];if(ce!==void 0){const re=y.UTF16(Q),ue=di(re,U);R.push(ui(3,1,ce,n,re.length,ue))}}}R.sort(function(j,q){return j.platformID-q.platformID||j.encodingID-q.encodingID||j.languageID-q.languageID||j.nameID-q.nameID});const N=new W.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:R.length},{name:"stringOffset",type:"USHORT",value:6+12*R.length}]);for(let j=0;j<R.length;j++)N.fields.push({name:"record_"+j,type:"RECORD",value:R[j]});return N.fields.push({name:"strings",type:"LITERAL",value:U}),N},fi=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],ws=function(e,t){const n={},o=new ae.Parser(e,t);n.version=o.parseUShort(),n.xAvgCharWidth=o.parseShort(),n.usWeightClass=o.parseUShort(),n.usWidthClass=o.parseUShort(),n.fsType=o.parseUShort(),n.ySubscriptXSize=o.parseShort(),n.ySubscriptYSize=o.parseShort(),n.ySubscriptXOffset=o.parseShort(),n.ySubscriptYOffset=o.parseShort(),n.ySuperscriptXSize=o.parseShort(),n.ySuperscriptYSize=o.parseShort(),n.ySuperscriptXOffset=o.parseShort(),n.ySuperscriptYOffset=o.parseShort(),n.yStrikeoutSize=o.parseShort(),n.yStrikeoutPosition=o.parseShort(),n.sFamilyClass=o.parseShort(),n.panose=[];for(let S=0;S<10;S++)n.panose[S]=o.parseByte();return n.ulUnicodeRange1=o.parseULong(),n.ulUnicodeRange2=o.parseULong(),n.ulUnicodeRange3=o.parseULong(),n.ulUnicodeRange4=o.parseULong(),n.achVendID=String.fromCharCode(o.parseByte(),o.parseByte(),o.parseByte(),o.parseByte()),n.fsSelection=o.parseUShort(),n.usFirstCharIndex=o.parseUShort(),n.usLastCharIndex=o.parseUShort(),n.sTypoAscender=o.parseShort(),n.sTypoDescender=o.parseShort(),n.sTypoLineGap=o.parseShort(),n.usWinAscent=o.parseUShort(),n.usWinDescent=o.parseUShort(),n.version>=1&&(n.ulCodePageRange1=o.parseULong(),n.ulCodePageRange2=o.parseULong()),n.version>=2&&(n.sxHeight=o.parseShort(),n.sCapHeight=o.parseShort(),n.usDefaultChar=o.parseUShort(),n.usBreakChar=o.parseUShort(),n.usMaxContent=o.parseUShort()),n},xs=function(e){return new W.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)},Ls=function(e){for(let t=0;t<fi.length;t+=1){const n=fi[t];if(e>=n.begin&&e<n.end)return t}return-1},Es=function(e,t){const n={},o=new ae.Parser(e,t);switch(n.version=o.parseVersion(),n.italicAngle=o.parseFixed(),n.underlinePosition=o.parseShort(),n.underlineThickness=o.parseShort(),n.isFixedPitch=o.parseULong(),n.minMemType42=o.parseULong(),n.maxMemType42=o.parseULong(),n.minMemType1=o.parseULong(),n.maxMemType1=o.parseULong(),n.version){case 1:n.names=Pe.slice();break;case 2:n.numberOfGlyphs=o.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(let S=0;S<n.numberOfGlyphs;S++)n.glyphNameIndex[S]=o.parseUShort();n.names=[];for(let S=0;S<n.numberOfGlyphs;S++)if(n.glyphNameIndex[S]>=Pe.length){const x=o.parseChar();n.names.push(o.parseString(x))}break;case 2.5:n.numberOfGlyphs=o.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(let S=0;S<n.numberOfGlyphs;S++)n.offset[S]=o.parseChar()}return n},ks=function(){return new W.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])},Ye=new Array(9);Ye[1]=function(){const e=this.offset+this.relativeOffset,t=this.parseUShort();return t===1?{substFormat:1,coverage:this.parsePointer(X.coverage),deltaGlyphId:this.parseUShort()}:t===2?{substFormat:2,coverage:this.parsePointer(X.coverage),substitute:this.parseOffset16List()}:void _.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},Ye[2]=function(){const e=this.parseUShort();return _.argument(e===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(X.coverage),sequences:this.parseListOfLists()}},Ye[3]=function(){const e=this.parseUShort();return _.argument(e===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(X.coverage),alternateSets:this.parseListOfLists()}},Ye[4]=function(){const e=this.parseUShort();return _.argument(e===1,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(X.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};const gt={sequenceIndex:X.uShort,lookupListIndex:X.uShort};Ye[5]=function(){const e=this.offset+this.relativeOffset,t=this.parseUShort();if(t===1)return{substFormat:t,coverage:this.parsePointer(X.coverage),ruleSets:this.parseListOfLists(function(){const n=this.parseUShort(),o=this.parseUShort();return{input:this.parseUShortList(n-1),lookupRecords:this.parseRecordList(o,gt)}})};if(t===2)return{substFormat:t,coverage:this.parsePointer(X.coverage),classDef:this.parsePointer(X.classDef),classSets:this.parseListOfLists(function(){const n=this.parseUShort(),o=this.parseUShort();return{classes:this.parseUShortList(n-1),lookupRecords:this.parseRecordList(o,gt)}})};if(t===3){const n=this.parseUShort(),o=this.parseUShort();return{substFormat:t,coverages:this.parseList(n,X.pointer(X.coverage)),lookupRecords:this.parseRecordList(o,gt)}}_.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},Ye[6]=function(){const e=this.offset+this.relativeOffset,t=this.parseUShort();return t===1?{substFormat:1,coverage:this.parsePointer(X.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(gt)}})}:t===2?{substFormat:2,coverage:this.parsePointer(X.coverage),backtrackClassDef:this.parsePointer(X.classDef),inputClassDef:this.parsePointer(X.classDef),lookaheadClassDef:this.parsePointer(X.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(gt)}})}:t===3?{substFormat:3,backtrackCoverage:this.parseList(X.pointer(X.coverage)),inputCoverage:this.parseList(X.pointer(X.coverage)),lookaheadCoverage:this.parseList(X.pointer(X.coverage)),lookupRecords:this.parseRecordList(gt)}:void _.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},Ye[7]=function(){const e=this.parseUShort();_.argument(e===1,"GSUB Extension Substitution subtable identifier-format must be 1");const t=this.parseUShort(),n=new X(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:t,extension:Ye[t].call(n)}},Ye[8]=function(){const e=this.parseUShort();return _.argument(e===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(X.coverage),backtrackCoverage:this.parseList(X.pointer(X.coverage)),lookaheadCoverage:this.parseList(X.pointer(X.coverage)),substitutes:this.parseUShortList()}};const Tt=new Array(9);Tt[1]=function(e){return e.substFormat===1?new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.ushortList("substitute",e.substitute)))},Tt[3]=function(e){return _.assert(e.substFormat===1,"Lookup type 3 substFormat must be 1."),new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.tableList("altSet",e.alternateSets,function(t){return new W.Table("alternateSetTable",W.ushortList("alternate",t))})))},Tt[4]=function(e){return _.assert(e.substFormat===1,"Lookup type 4 substFormat must be 1."),new W.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new W.Coverage(e.coverage)}].concat(W.tableList("ligSet",e.ligatureSets,function(t){return new W.Table("ligatureSetTable",W.tableList("ligature",t,function(n){return new W.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:n.ligGlyph}].concat(W.ushortList("component",n.components,n.components.length+1)))}))})))};const Rs=function(e,t){const n=new X(e,t=t||0),o=n.parseVersion(1);return _.argument(o===1||o===1.1,"Unsupported GSUB table version."),o===1?{version:o,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ye)}:{version:o,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Ye),variations:n.parseFeatureVariationsList()}},Ts=function(e){return new W.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new W.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new W.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new W.LookupList(e.lookups,Tt)}])},Ds=function(e,t){const n=new ae.Parser(e,t),o=n.parseULong();_.argument(o===1,"Unsupported META table version."),n.parseULong(),n.parseULong();const S=n.parseULong(),x={};for(let E=0;E<S;E++){const M=n.parseTag(),R=n.parseULong(),U=n.parseULong(),N=p.UTF8(e,t+R,U);x[M]=N}return x},Ms=function(e){const t=Object.keys(e).length;let n="";const o=16+12*t,S=new W.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:o},{name:"numTags",type:"ULONG",value:t}]);for(let x in e){const E=n.length;n+=e[x],S.fields.push({name:"tag "+x,type:"TAG",value:x}),S.fields.push({name:"offset "+x,type:"ULONG",value:o+E}),S.fields.push({name:"length "+x,type:"ULONG",value:e[x].length})}return S.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),S};function _i(e){return Math.log(e)/Math.log(2)|0}function pi(e){for(;e.length%4!=0;)e.push(0);let t=0;for(let n=0;n<e.length;n+=4)t+=(e[n]<<24)+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];return t%=Math.pow(2,32),t}function gi(e,t,n,o){return new W.Record("Table Record",[{name:"tag",type:"TAG",value:e!==void 0?e:""},{name:"checkSum",type:"ULONG",value:t!==void 0?t:0},{name:"offset",type:"ULONG",value:n!==void 0?n:0},{name:"length",type:"ULONG",value:o!==void 0?o:0}])}function As(e){const t=new W.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;const n=Math.pow(2,_i(t.numTables));t.searchRange=16*n,t.entrySelector=_i(n),t.rangeShift=16*t.numTables-t.searchRange;const o=[],S=[];let x=t.sizeOf()+gi().sizeOf()*t.numTables;for(;x%4!=0;)x+=1,S.push({name:"padding",type:"BYTE",value:0});for(let E=0;E<e.length;E+=1){const M=e[E];_.argument(M.tableName.length===4,"Table name"+M.tableName+" is invalid.");const R=M.sizeOf(),U=gi(M.tableName,pi(M.encode()),x,R);for(o.push({name:U.tag+" Table Record",type:"RECORD",value:U}),S.push({name:M.tableName+" table",type:"RECORD",value:M}),x+=R,_.argument(!isNaN(x),"Something went wrong calculating the offset.");x%4!=0;)x+=1,S.push({name:"padding",type:"BYTE",value:0})}return o.sort(function(E,M){return E.value.tag>M.value.tag?1:-1}),t.fields=t.fields.concat(o),t.fields=t.fields.concat(S),t}function vi(e,t,n){for(let o=0;o<t.length;o+=1){const S=e.charToGlyphIndex(t[o]);if(S>0)return e.glyphs.get(S).getMetrics()}return n}function Bs(e){let t=0;for(let n=0;n<e.length;n+=1)t+=e[n];return t/e.length}const Os=function(e){const t=[],n=[],o=[],S=[],x=[],E=[],M=[];let R,U=0,N=0,j=0,q=0,oe=0;for(let Xe=0;Xe<e.glyphs.length;Xe+=1){const mt=e.glyphs.get(Xe),St=0|mt.unicode;if(isNaN(mt.advanceWidth))throw new Error("Glyph "+mt.name+" ("+Xe+"): advanceWidth is not a number.");(R>St||R===void 0)&&St>0&&(R=St),U<St&&(U=St);const ct=Ls(St);if(ct<32)N|=1<<ct;else if(ct<64)j|=1<<ct-32;else if(ct<96)q|=1<<ct-64;else{if(!(ct<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");oe|=1<<ct-96}if(mt.name===".notdef")continue;const yt=mt.getMetrics();t.push(yt.xMin),n.push(yt.yMin),o.push(yt.xMax),S.push(yt.yMax),E.push(yt.leftSideBearing),M.push(yt.rightSideBearing),x.push(mt.advanceWidth)}const Q={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,o),yMax:Math.max.apply(null,S),advanceWidthMax:Math.max.apply(null,x),advanceWidthAvg:Bs(x),minLeftSideBearing:Math.min.apply(null,E),maxLeftSideBearing:Math.max.apply(null,E),minRightSideBearing:Math.min.apply(null,M)};Q.ascender=e.ascender,Q.descender=e.descender;const pe=ls({flags:3,unitsPerEm:e.unitsPerEm,xMin:Q.xMin,yMin:Q.yMin,xMax:Q.xMax,yMax:Q.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),Y=cs({ascender:Q.ascender,descender:Q.descender,advanceWidthMax:Q.advanceWidthMax,minLeftSideBearing:Q.minLeftSideBearing,minRightSideBearing:Q.minRightSideBearing,xMaxExtent:Q.maxLeftSideBearing+(Q.xMax-Q.xMin),numberOfHMetrics:e.glyphs.length}),ee=gs(e.glyphs.length),_e=xs({xAvgCharWidth:Math.round(Q.advanceWidthAvg),usWeightClass:e.tables.os2.usWeightClass,usWidthClass:e.tables.os2.usWidthClass,usFirstCharIndex:R,usLastCharIndex:U,ulUnicodeRange1:N,ulUnicodeRange2:j,ulUnicodeRange3:q,ulUnicodeRange4:oe,fsSelection:e.tables.os2.fsSelection,sTypoAscender:Q.ascender,sTypoDescender:Q.descender,sTypoLineGap:0,usWinAscent:Q.yMax,usWinDescent:Math.abs(Q.yMin),ulCodePageRange1:1,sxHeight:vi(e,"xyvw",{yMax:Math.round(Q.ascender/2)}).yMax,sCapHeight:vi(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",Q).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0}),me=ds(e.glyphs),Le=xe(e.glyphs),ce=e.getEnglishName("fontFamily"),re=e.getEnglishName("fontSubfamily"),ue=ce+" "+re;let Te=e.getEnglishName("postScriptName");Te||(Te=ce.replace(/\s/g,"")+"-"+re);const ye={};for(let Xe in e.names)ye[Xe]=e.names[Xe];ye.uniqueID||(ye.uniqueID={en:e.getEnglishName("manufacturer")+":"+ue}),ye.postScriptName||(ye.postScriptName={en:Te}),ye.preferredFamily||(ye.preferredFamily=e.names.fontFamily),ye.preferredSubfamily||(ye.preferredSubfamily=e.names.fontSubfamily);const Ie=[],We=Cs(ye,Ie),qe=Ie.length>0?fs(Ie):void 0,Fe=ks(),$e=os(e.glyphs,{version:e.getEnglishName("version"),fullName:ue,familyName:ce,weightName:re,postScriptName:Te,unitsPerEm:e.unitsPerEm,fontBBox:[0,Q.yMin,Q.ascender,Q.advanceWidthMax]}),Ue=e.metas&&Object.keys(e.metas).length>0?Ms(e.metas):void 0,Ge=[pe,Y,ee,_e,We,Le,Fe,$e,me];qe&&Ge.push(qe),e.tables.gsub&&Ge.push(Ts(e.tables.gsub)),Ue&&Ge.push(Ue);const He=As(Ge),Ve=pi(He.encode()),Be=He.fields;let je=!1;for(let Xe=0;Xe<Be.length;Xe+=1)if(Be[Xe].name==="head table"){Be[Xe].value.checkSumAdjustment=2981146554-Ve,je=!0;break}if(!je)throw new Error("Could not find head table with checkSum to adjust.");return He};function Ht(e,t){let n=0,o=e.length-1;for(;n<=o;){const S=n+o>>>1,x=e[S].tag;if(x===t)return S;x<t?n=S+1:o=S-1}return-n-1}function mi(e,t){let n=0,o=e.length-1;for(;n<=o;){const S=n+o>>>1,x=e[S];if(x===t)return S;x<t?n=S+1:o=S-1}return-n-1}function Si(e,t){let n,o=0,S=e.length-1;for(;o<=S;){const x=o+S>>>1;n=e[x];const E=n.start;if(E===t)return n;E<t?o=x+1:S=x-1}if(o>0)return n=e[o-1],t>n.end?0:n}function yi(e,t){this.font=e,this.tableName=t}yi.prototype={searchTag:Ht,binSearch:mi,getTable:function(e){let t=this.font.tables[this.tableName];return!t&&e&&(t=this.font.tables[this.tableName]=this.createDefaultTable()),t},getScriptNames:function(){let e=this.getTable();return e?e.scripts.map(function(t){return t.tag}):[]},getDefaultScriptName:function(){let e=this.getTable();if(!e)return;let t=!1;for(let n=0;n<e.scripts.length;n++){const o=e.scripts[n].tag;if(o==="DFLT")return o;o==="latn"&&(t=!0)}return t?"latn":void 0},getScriptTable:function(e,t){const n=this.getTable(t);if(n){e=e||"DFLT";const o=n.scripts,S=Ht(n.scripts,e);if(S>=0)return o[S].script;if(t){const x={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return o.splice(-1-S,0,x),x.script}}},getLangSysTable:function(e,t,n){const o=this.getScriptTable(e,n);if(o){if(!t||t==="dflt"||t==="DFLT")return o.defaultLangSys;const S=Ht(o.langSysRecords,t);if(S>=0)return o.langSysRecords[S].langSys;if(n){const x={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return o.langSysRecords.splice(-1-S,0,x),x.langSys}}},getFeatureTable:function(e,t,n,o){const S=this.getLangSysTable(e,t,o);if(S){let x;const E=S.featureIndexes,M=this.font.tables[this.tableName].features;for(let R=0;R<E.length;R++)if(x=M[E[R]],x.tag===n)return x.feature;if(o){const R=M.length;return _.assert(R===0||n>=M[R-1].tag,"Features must be added in alphabetical order."),x={tag:n,feature:{params:0,lookupListIndexes:[]}},M.push(x),E.push(R),x.feature}}},getLookupTables:function(e,t,n,o,S){const x=this.getFeatureTable(e,t,n,S),E=[];if(x){let M;const R=x.lookupListIndexes,U=this.font.tables[this.tableName].lookups;for(let N=0;N<R.length;N++)M=U[R[N]],M.lookupType===o&&E.push(M);if(E.length===0&&S){M={lookupType:o,lookupFlag:0,subtables:[],markFilteringSet:void 0};const N=U.length;return U.push(M),R.push(N),[M]}}return E},getGlyphClass:function(e,t){switch(e.format){case 1:return e.startGlyph<=t&&t<e.startGlyph+e.classes.length?e.classes[t-e.startGlyph]:0;case 2:const n=Si(e.ranges,t);return n?n.classId:0}},getCoverageIndex:function(e,t){switch(e.format){case 1:const n=mi(e.glyphs,t);return n>=0?n:-1;case 2:const o=Si(e.ranges,t);return o?o.index+t-o.start:-1}},expandCoverage:function(e){if(e.format===1)return e.glyphs;{const t=[],n=e.ranges;for(let o=0;o<n.length;o++){const S=n[o],x=S.start,E=S.end;for(let M=x;M<=E;M++)t.push(M)}return t}}};const Dt=yi;function Mt(e){Dt.call(this,e,"gpos")}Mt.prototype=Dt.prototype,Mt.prototype.getKerningValue=function(e,t,n){for(let o=0;o<e.length;o++){const S=e[o].subtables;for(let x=0;x<S.length;x++){const E=S[x],M=this.getCoverageIndex(E.coverage,t);if(!(M<0))switch(E.posFormat){case 1:let R=E.pairSets[M];for(let q=0;q<R.length;q++){let oe=R[q];if(oe.secondGlyph===n)return oe.value1&&oe.value1.xAdvance||0}break;case 2:const U=this.getGlyphClass(E.classDef1,t),N=this.getGlyphClass(E.classDef2,n),j=E.classRecords[U][N];return j.value1&&j.value1.xAdvance||0}}}return 0},Mt.prototype.getKerningTables=function(e,t){if(this.font.tables.gpos)return this.getLookupTables(e,t,"kern",2)};const Is=Mt;function Ze(e){Dt.call(this,e,"gsub")}function Ps(e,t){const n=e.length;if(n!==t.length)return!1;for(let o=0;o<n;o++)if(e[o]!==t[o])return!1;return!0}function bi(e,t,n){const o=e.subtables;for(let S=0;S<o.length;S++){const x=o[S];if(x.substFormat===t)return x}if(n)return o.push(n),n}Ze.prototype=Dt.prototype,Ze.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Ze.prototype.getSingle=function(e,t,n){const o=[],S=this.getLookupTables(t,n,e,1);for(let x=0;x<S.length;x++){const E=S[x].subtables;for(let M=0;M<E.length;M++){const R=E[M],U=this.expandCoverage(R.coverage);let N;if(R.substFormat===1){const j=R.deltaGlyphId;for(N=0;N<U.length;N++){const q=U[N];o.push({sub:q,by:q+j})}}else{const j=R.substitute;for(N=0;N<U.length;N++)o.push({sub:U[N],by:j[N]})}}}return o},Ze.prototype.getAlternates=function(e,t,n){const o=[],S=this.getLookupTables(t,n,e,3);for(let x=0;x<S.length;x++){const E=S[x].subtables;for(let M=0;M<E.length;M++){const R=E[M],U=this.expandCoverage(R.coverage),N=R.alternateSets;for(let j=0;j<U.length;j++)o.push({sub:U[j],by:N[j]})}}return o},Ze.prototype.getLigatures=function(e,t,n){const o=[],S=this.getLookupTables(t,n,e,4);for(let x=0;x<S.length;x++){const E=S[x].subtables;for(let M=0;M<E.length;M++){const R=E[M],U=this.expandCoverage(R.coverage),N=R.ligatureSets;for(let j=0;j<U.length;j++){const q=U[j],oe=N[j];for(let Q=0;Q<oe.length;Q++){const pe=oe[Q];o.push({sub:[q].concat(pe.components),by:pe.ligGlyph})}}}}return o},Ze.prototype.addSingle=function(e,t,n,o){const S=bi(this.getLookupTables(n,o,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});_.assert(S.coverage.format===1,"Ligature: unable to modify coverage table format "+S.coverage.format);const x=t.sub;let E=this.binSearch(S.coverage.glyphs,x);E<0&&(E=-1-E,S.coverage.glyphs.splice(E,0,x),S.substitute.splice(E,0,0)),S.substitute[E]=t.by},Ze.prototype.addAlternate=function(e,t,n,o){const S=bi(this.getLookupTables(n,o,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});_.assert(S.coverage.format===1,"Ligature: unable to modify coverage table format "+S.coverage.format);const x=t.sub;let E=this.binSearch(S.coverage.glyphs,x);E<0&&(E=-1-E,S.coverage.glyphs.splice(E,0,x),S.alternateSets.splice(E,0,0)),S.alternateSets[E]=t.by},Ze.prototype.addLigature=function(e,t,n,o){const S=this.getLookupTables(n,o,e,4,!0)[0];let x=S.subtables[0];x||(x={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},S.subtables[0]=x),_.assert(x.coverage.format===1,"Ligature: unable to modify coverage table format "+x.coverage.format);const E=t.sub[0],M=t.sub.slice(1),R={ligGlyph:t.by,components:M};let U=this.binSearch(x.coverage.glyphs,E);if(U>=0){const N=x.ligatureSets[U];for(let j=0;j<N.length;j++)if(Ps(N[j].components,M))return;N.push(R)}else U=-1-U,x.coverage.glyphs.splice(U,0,E),x.ligatureSets.splice(U,0,[R])},Ze.prototype.getFeature=function(e,t,n){if(/ss\d\d/.test(e))return this.getSingle(e,t,n);switch(e){case"aalt":case"salt":return this.getSingle(e,t,n).concat(this.getAlternates(e,t,n));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,n)}},Ze.prototype.add=function(e,t,n,o){if(/ss\d\d/.test(e))return this.addSingle(e,t,n,o);switch(e){case"aalt":case"salt":return typeof t.by=="number"?this.addSingle(e,t,n,o):this.addAlternate(e,t,n,o);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,n,o)}};const Us=Ze;function Ci(e){const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let o=0;o<e.length;++o)n[o]=e[o];return t}function vt(e,t){if(!e)throw t}let wi,ft,xi,Nt;function Li(e){this.font=e,this._fpgmState=this._prepState=void 0,this._errorState=0}function Fs(e){return e}function Ei(e){return Math.sign(e)*Math.round(Math.abs(e))}function Hs(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function Ns(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function Ws(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function Gs(e){return Math.sign(e)*Math.floor(Math.abs(e))}const ki=function(e){const t=this.srPeriod;let n=this.srPhase,o=1;return e<0&&(e=-e,o=-1),e+=this.srThreshold-n,e=Math.trunc(e/t)*t,(e+=n)<0?n*o:e*o},tt={x:1,y:0,axis:"x",distance:function(e,t,n,o){return(n?e.xo:e.x)-(o?t.xo:t.x)},interpolate:function(e,t,n,o){let S,x,E,M,R,U,N;if(!o||o===this)return S=e.xo-t.xo,x=e.xo-n.xo,R=t.x-t.xo,U=n.x-n.xo,E=Math.abs(S),M=Math.abs(x),N=E+M,N===0?void(e.x=e.xo+(R+U)/2):void(e.x=e.xo+(R*M+U*E)/N);S=o.distance(e,t,!0,!0),x=o.distance(e,n,!0,!0),R=o.distance(t,t,!1,!0),U=o.distance(n,n,!1,!0),E=Math.abs(S),M=Math.abs(x),N=E+M,N!==0?tt.setRelative(e,e,(R*M+U*E)/N,o,!0):tt.setRelative(e,e,(R+U)/2,o,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,t,n,o,S){if(!o||o===this)return void(e.x=(S?t.xo:t.x)+n);const x=S?t.xo:t.x,E=S?t.yo:t.y,M=x+n*o.x,R=E+n*o.y;e.x=M+(e.y-R)/o.normalSlope},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},it={x:0,y:1,axis:"y",distance:function(e,t,n,o){return(n?e.yo:e.y)-(o?t.yo:t.y)},interpolate:function(e,t,n,o){let S,x,E,M,R,U,N;if(!o||o===this)return S=e.yo-t.yo,x=e.yo-n.yo,R=t.y-t.yo,U=n.y-n.yo,E=Math.abs(S),M=Math.abs(x),N=E+M,N===0?void(e.y=e.yo+(R+U)/2):void(e.y=e.yo+(R*M+U*E)/N);S=o.distance(e,t,!0,!0),x=o.distance(e,n,!0,!0),R=o.distance(t,t,!1,!0),U=o.distance(n,n,!1,!0),E=Math.abs(S),M=Math.abs(x),N=E+M,N!==0?it.setRelative(e,e,(R*M+U*E)/N,o,!0):it.setRelative(e,e,(R+U)/2,o,!0)},normalSlope:0,setRelative:function(e,t,n,o,S){if(!o||o===this)return void(e.y=(S?t.yo:t.y)+n);const x=S?t.xo:t.x,E=S?t.yo:t.y,M=x+n*o.x,R=E+n*o.y;e.y=R+o.normalSlope*(e.x-M)},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function wt(e,t){this.x=e,this.y=t,this.axis=void 0,this.slope=t/e,this.normalSlope=-e/t,Object.freeze(this)}function xt(e,t){const n=Math.sqrt(e*e+t*t);return t/=n,(e/=n)==1&&t===0?tt:e===0&&t===1?it:new wt(e,t)}function st(e,t,n,o){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*t)/64,this.lastPointOfContour=n,this.onCurve=o,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(tt),Object.freeze(it),wt.prototype.distance=function(e,t,n,o){return this.x*tt.distance(e,t,n,o)+this.y*it.distance(e,t,n,o)},wt.prototype.interpolate=function(e,t,n,o){let S,x,E,M,R,U,N;E=o.distance(e,t,!0,!0),M=o.distance(e,n,!0,!0),S=o.distance(t,t,!1,!0),x=o.distance(n,n,!1,!0),R=Math.abs(E),U=Math.abs(M),N=R+U,N!==0?this.setRelative(e,e,(S*U+x*R)/N,o,!0):this.setRelative(e,e,(S+x)/2,o,!0)},wt.prototype.setRelative=function(e,t,n,o,S){o=o||this;const x=S?t.xo:t.x,E=S?t.yo:t.y,M=x+n*o.x,R=E+n*o.y,U=o.normalSlope,N=this.slope,j=e.x,q=e.y;e.x=(N*j-U*M+R-q)/(N-U),e.y=N*(e.x-j)+q},wt.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},st.prototype.nextTouched=function(e){let t=this.nextPointOnContour;for(;!e.touched(t)&&t!==this;)t=t.nextPointOnContour;return t},st.prototype.prevTouched=function(e){let t=this.prevPointOnContour;for(;!e.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};const Lt=Object.freeze(new st(0,0)),zs={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function at(e,t){switch(this.env=e,this.stack=[],this.prog=t,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=tt,this.round=Ei}}function At(e){const t=e.tZone=new Array(e.gZone.length);for(let n=0;n<t.length;n++)t[n]=new st(0,0)}function Ri(e,t){const n=e.prog;let o,S=e.ip,x=1;do if(o=n[++S],o===88)x++;else if(o===89)x--;else if(o===64)S+=n[S+1]+1;else if(o===65)S+=2*n[S+1]+1;else if(o>=176&&o<=183)S+=o-176+1;else if(o>=184&&o<=191)S+=2*(o-184+1);else if(t&&x===1&&o===27)break;while(x>0);e.ip=S}function Ti(e,t){$.DEBUG&&console.log(t.step,"SVTCA["+e.axis+"]"),t.fv=t.pv=t.dpv=e}function Di(e,t){$.DEBUG&&console.log(t.step,"SPVTCA["+e.axis+"]"),t.pv=t.dpv=e}function Mi(e,t){$.DEBUG&&console.log(t.step,"SFVTCA["+e.axis+"]"),t.fv=e}function Ai(e,t){const n=t.stack,o=n.pop(),S=n.pop(),x=t.z2[o],E=t.z1[S];let M,R;$.DEBUG&&console.log("SPVTL["+e+"]",o,S),e?(M=x.y-E.y,R=E.x-x.x):(M=E.x-x.x,R=E.y-x.y),t.pv=t.dpv=xt(M,R)}function Bi(e,t){const n=t.stack,o=n.pop(),S=n.pop(),x=t.z2[o],E=t.z1[S];let M,R;$.DEBUG&&console.log("SFVTL["+e+"]",o,S),e?(M=x.y-E.y,R=E.x-x.x):(M=E.x-x.x,R=E.y-x.y),t.fv=xt(M,R)}function Wt(e){$.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function Oi(e,t){const n=t.stack.pop(),o=t.z0[n],S=t.fv,x=t.pv;$.DEBUG&&console.log(t.step,"MDAP["+e+"]",n);let E=x.distance(o,Lt);e&&(E=t.round(E)),S.setRelative(o,Lt,E,x),S.touch(o),t.rp0=t.rp1=n}function Ii(e,t){const n=t.z2,o=n.length-2;let S,x,E;$.DEBUG&&console.log(t.step,"IUP["+e.axis+"]");for(let M=0;M<o;M++)S=n[M],e.touched(S)||(x=S.prevTouched(e),x!==S&&(E=S.nextTouched(e),x===E&&e.setRelative(S,S,e.distance(x,x,!1,!0),e,!0),e.interpolate(S,x,E,e)))}function Pi(e,t){const n=t.stack,o=e?t.rp1:t.rp2,S=(e?t.z0:t.z1)[o],x=t.fv,E=t.pv;let M=t.loop;const R=t.z2;for(;M--;){const U=n.pop(),N=R[U],j=E.distance(S,S,!1,!0);x.setRelative(N,N,j,E),x.touch(N),$.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-M)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",U)}t.loop=1}function Ui(e,t){const n=t.stack,o=e?t.rp1:t.rp2,S=(e?t.z0:t.z1)[o],x=t.fv,E=t.pv,M=n.pop(),R=t.z2[t.contours[M]];let U=R;$.DEBUG&&console.log(t.step,"SHC["+e+"]",M);const N=E.distance(S,S,!1,!0);do U!==S&&x.setRelative(U,U,N,E),U=U.nextPointOnContour;while(U!==R)}function Fi(e,t){const n=t.stack,o=e?t.rp1:t.rp2,S=(e?t.z0:t.z1)[o],x=t.fv,E=t.pv,M=n.pop();let R,U;switch($.DEBUG&&console.log(t.step,"SHZ["+e+"]",M),M){case 0:R=t.tZone;break;case 1:R=t.gZone;break;default:throw new Error("Invalid zone")}const N=E.distance(S,S,!1,!0),j=R.length-2;for(let q=0;q<j;q++)U=R[q],x.setRelative(U,U,N,E)}function Hi(e,t){const n=t.stack,o=n.pop()/64,S=n.pop(),x=t.z1[S],E=t.z0[t.rp0],M=t.fv,R=t.pv;M.setRelative(x,E,o,R),M.touch(x),$.DEBUG&&console.log(t.step,"MSIRP["+e+"]",o,S),t.rp1=t.rp0,t.rp2=S,e&&(t.rp0=S)}function Ni(e,t){const n=t.stack,o=n.pop(),S=n.pop(),x=t.z0[S],E=t.fv,M=t.pv;let R=t.cvt[o];$.DEBUG&&console.log(t.step,"MIAP["+e+"]",o,"(",R,")",S);let U=M.distance(x,Lt);e&&(Math.abs(U-R)<t.cvCutIn&&(U=R),U=t.round(U)),E.setRelative(x,Lt,U,M),t.zp0===0&&(x.xo=x.x,x.yo=x.y),E.touch(x),t.rp0=t.rp1=S}function Wi(e,t){const n=t.stack,o=n.pop(),S=t.z2[o];$.DEBUG&&console.log(t.step,"GC["+e+"]",o),n.push(64*t.dpv.distance(S,Lt,e,!1))}function Gi(e,t){const n=t.stack,o=n.pop(),S=n.pop(),x=t.z1[o],E=t.z0[S],M=t.dpv.distance(E,x,e,e);$.DEBUG&&console.log(t.step,"MD["+e+"]",o,S,"->",M),t.stack.push(Math.round(64*M))}function Gt(e,t){const n=t.stack,o=n.pop(),S=t.fv,x=t.pv,E=t.ppem,M=t.deltaBase+16*(e-1),R=t.deltaShift,U=t.z0;$.DEBUG&&console.log(t.step,"DELTAP["+e+"]",o,n);for(let N=0;N<o;N++){const j=n.pop(),q=n.pop();if(M+((240&q)>>4)!==E)continue;let oe=(15&q)-8;oe>=0&&oe++,$.DEBUG&&console.log(t.step,"DELTAPFIX",j,"by",oe*R);const Q=U[j];S.setRelative(Q,Q,oe*R,x)}}function Bt(e,t){const n=t.stack,o=n.pop();$.DEBUG&&console.log(t.step,"ROUND[]"),n.push(64*t.round(o/64))}function zt(e,t){const n=t.stack,o=n.pop(),S=t.ppem,x=t.deltaBase+16*(e-1),E=t.deltaShift;$.DEBUG&&console.log(t.step,"DELTAC["+e+"]",o,n);for(let M=0;M<o;M++){const R=n.pop(),U=n.pop();if(x+((240&U)>>4)!==S)continue;let N=(15&U)-8;N>=0&&N++;const j=N*E;$.DEBUG&&console.log(t.step,"DELTACFIX",R,"by",j),t.cvt[R]+=j}}function zi(e,t){const n=t.stack,o=n.pop(),S=n.pop(),x=t.z2[o],E=t.z1[S];let M,R;$.DEBUG&&console.log(t.step,"SDPVTL["+e+"]",o,S),e?(M=x.y-E.y,R=E.x-x.x):(M=E.x-x.x,R=E.y-x.y),t.dpv=xt(M,R)}function lt(e,t){const n=t.stack,o=t.prog;let S=t.ip;$.DEBUG&&console.log(t.step,"PUSHB["+e+"]");for(let x=0;x<e;x++)n.push(o[++S]);t.ip=S}function ht(e,t){let n=t.ip;const o=t.prog,S=t.stack;$.DEBUG&&console.log(t.ip,"PUSHW["+e+"]");for(let x=0;x<e;x++){let E=o[++n]<<8|o[++n];32768&E&&(E=-(1+(65535^E))),S.push(E)}t.ip=n}function fe(e,t,n,o,S,x){const E=x.stack,M=e&&E.pop(),R=E.pop(),U=x.rp0,N=x.z0[U],j=x.z1[R],q=x.minDis,oe=x.fv,Q=x.dpv;let pe,Y,ee,_e;Y=pe=Q.distance(j,N,!0,!0),ee=Y>=0?1:-1,Y=Math.abs(Y),e&&(_e=x.cvt[M],o&&Math.abs(Y-_e)<x.cvCutIn&&(Y=_e)),n&&Y<q&&(Y=q),o&&(Y=x.round(Y)),oe.setRelative(j,N,ee*Y,Q),oe.touch(j),$.DEBUG&&console.log(x.step,(e?"MIRP[":"MDRP[")+(t?"M":"m")+(n?">":"_")+(o?"R":"_")+(S===0?"Gr":S===1?"Bl":S===2?"Wh":"")+"]",e?M+"("+x.cvt[M]+","+_e+")":"",R,"(d =",pe,"->",ee*Y,")"),x.rp1=x.rp0,x.rp2=R,t&&(x.rp0=R)}Li.prototype.exec=function(e,t){if(typeof t!="number")throw new Error("Point size is not a number!");if(this._errorState>2)return;const n=this.font;let o=this._prepState;if(!o||o.ppem!==t){let S=this._fpgmState;if(!S){at.prototype=zs,S=this._fpgmState=new at("fpgm",n.tables.fpgm),S.funcs=[],S.font=n,$.DEBUG&&(console.log("---EXEC FPGM---"),S.step=-1);try{ft(S)}catch(E){return console.log("Hinting error in FPGM:"+E),void(this._errorState=3)}}at.prototype=S,o=this._prepState=new at("prep",n.tables.prep),o.ppem=t;const x=n.tables.cvt;if(x){const E=o.cvt=new Array(x.length),M=t/n.unitsPerEm;for(let R=0;R<x.length;R++)E[R]=x[R]*M}else o.cvt=[];$.DEBUG&&(console.log("---EXEC PREP---"),o.step=-1);try{ft(o)}catch(E){this._errorState<2&&console.log("Hinting error in PREP:"+E),this._errorState=2}}if(!(this._errorState>1))try{return xi(e,o)}catch(S){return this._errorState<1&&(console.log("Hinting error:"+S),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}},xi=function(e,t){const n=t.ppem/t.font.unitsPerEm,o=n;let S,x,E,M=e.components;if(at.prototype=t,M){const R=t.font;x=[],S=[];for(let U=0;U<M.length;U++){const N=M[U],j=R.glyphs.get(N.glyphIndex);E=new at("glyf",j.instructions),$.DEBUG&&(console.log("---EXEC COMP "+U+"---"),E.step=-1),Nt(j,E,n,o);const q=Math.round(N.dx*n),oe=Math.round(N.dy*o),Q=E.gZone,pe=E.contours;for(let ee=0;ee<Q.length;ee++){const _e=Q[ee];_e.xTouched=_e.yTouched=!1,_e.xo=_e.x=_e.x+q,_e.yo=_e.y=_e.y+oe}const Y=x.length;x.push.apply(x,Q);for(let ee=0;ee<pe.length;ee++)S.push(pe[ee]+Y)}e.instructions&&!E.inhibitGridFit&&(E=new at("glyf",e.instructions),E.gZone=E.z0=E.z1=E.z2=x,E.contours=S,x.push(new st(0,0),new st(Math.round(e.advanceWidth*n),0)),$.DEBUG&&(console.log("---EXEC COMPOSITE---"),E.step=-1),ft(E),x.length-=2)}else E=new at("glyf",e.instructions),$.DEBUG&&(console.log("---EXEC GLYPH---"),E.step=-1),Nt(e,E,n,o),x=E.gZone;return x},Nt=function(e,t,n,o){const S=e.points||[],x=S.length,E=t.gZone=t.z0=t.z1=t.z2=[],M=t.contours=[];let R,U,N;for(let j=0;j<x;j++)R=S[j],E[j]=new st(R.x*n,R.y*o,R.lastPointOfContour,R.onCurve);for(let j=0;j<x;j++)R=E[j],U||(U=R,M.push(j)),R.lastPointOfContour?(R.nextPointOnContour=U,U.prevPointOnContour=R,U=void 0):(N=E[j+1],R.nextPointOnContour=N,N.prevPointOnContour=R);if(!t.inhibitGridFit){if($.DEBUG){console.log("PROCESSING GLYPH",t.stack);for(let j=0;j<x;j++)console.log(j,E[j].x,E[j].y)}if(E.push(new st(0,0),new st(Math.round(e.advanceWidth*n),0)),ft(t),E.length-=2,$.DEBUG){console.log("FINISHED GLYPH",t.stack);for(let j=0;j<x;j++)console.log(j,E[j].x,E[j].y)}}},ft=function(e){let t=e.prog;if(!t)return;const n=t.length;let o;for(e.ip=0;e.ip<n;e.ip++){if($.DEBUG&&e.step++,o=wi[t[e.ip]],!o)throw new Error("unknown instruction: 0x"+Number(t[e.ip]).toString(16));o(e)}},wi=[Ti.bind(void 0,it),Ti.bind(void 0,tt),Di.bind(void 0,it),Di.bind(void 0,tt),Mi.bind(void 0,it),Mi.bind(void 0,tt),Ai.bind(void 0,0),Ai.bind(void 0,1),Bi.bind(void 0,0),Bi.bind(void 0,1),function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"SPVFS[]",n,o),e.pv=e.dpv=xt(o,n)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"SPVFS[]",n,o),e.fv=xt(o,n)},function(e){const t=e.stack,n=e.pv;$.DEBUG&&console.log(e.step,"GPV[]"),t.push(16384*n.x),t.push(16384*n.y)},function(e){const t=e.stack,n=e.fv;$.DEBUG&&console.log(e.step,"GFV[]"),t.push(16384*n.x),t.push(16384*n.y)},function(e){e.fv=e.pv,$.DEBUG&&console.log(e.step,"SFVTPV[]")},function(e){const t=e.stack,n=t.pop(),o=t.pop(),S=t.pop(),x=t.pop(),E=t.pop(),M=e.z0,R=e.z1,U=M[n],N=M[o],j=R[S],q=R[x],oe=e.z2[E];$.DEBUG&&console.log("ISECT[], ",n,o,S,x,E);const Q=U.x,pe=U.y,Y=N.x,ee=N.y,_e=j.x,me=j.y,Le=q.x,ce=q.y,re=(Q-Y)*(me-ce)-(pe-ee)*(_e-Le),ue=Q*ee-pe*Y,Te=_e*ce-me*Le;oe.x=(ue*(_e-Le)-Te*(Q-Y))/re,oe.y=(ue*(me-ce)-Te*(pe-ee))/re},function(e){e.rp0=e.stack.pop(),$.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)},function(e){e.rp1=e.stack.pop(),$.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)},function(e){e.rp2=e.stack.pop(),$.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)},function(e){const t=e.stack.pop();switch($.DEBUG&&console.log(e.step,"SZP0[]",t),e.zp0=t,t){case 0:e.tZone||At(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const t=e.stack.pop();switch($.DEBUG&&console.log(e.step,"SZP1[]",t),e.zp1=t,t){case 0:e.tZone||At(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const t=e.stack.pop();switch($.DEBUG&&console.log(e.step,"SZP2[]",t),e.zp2=t,t){case 0:e.tZone||At(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){const t=e.stack.pop();switch($.DEBUG&&console.log(e.step,"SZPS[]",t),e.zp0=e.zp1=e.zp2=t,t){case 0:e.tZone||At(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),$.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)},function(e){$.DEBUG&&console.log(e.step,"RTG[]"),e.round=Ei},function(e){$.DEBUG&&console.log(e.step,"RTHG[]"),e.round=Ns},function(e){const t=e.stack.pop();$.DEBUG&&console.log(e.step,"SMD[]",t),e.minDis=t/64},function(e){$.DEBUG&&console.log(e.step,"ELSE[]"),Ri(e,!1)},function(e){const t=e.stack.pop();$.DEBUG&&console.log(e.step,"JMPR[]",t),e.ip+=t-1},function(e){const t=e.stack.pop();$.DEBUG&&console.log(e.step,"SCVTCI[]",t),e.cvCutIn=t/64},void 0,void 0,function(e){const t=e.stack;$.DEBUG&&console.log(e.step,"DUP[]"),t.push(t[t.length-1])},Wt,function(e){$.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"SWAP[]"),t.push(n),t.push(o)},function(e){const t=e.stack;$.DEBUG&&console.log(e.step,"DEPTH[]"),t.push(t.length)},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"CINDEX[]",n),t.push(t[t.length-n])},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"MINDEX[]",n),t.push(t.splice(t.length-n,1)[0])},void 0,void 0,void 0,function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"LOOPCALL[]",n,o);const S=e.ip,x=e.prog;e.prog=e.funcs[n];for(let E=0;E<o;E++)ft(e),$.DEBUG&&console.log(++e.step,E+1<o?"next loopcall":"done loopcall",E);e.ip=S,e.prog=x},function(e){const t=e.stack.pop();$.DEBUG&&console.log(e.step,"CALL[]",t);const n=e.ip,o=e.prog;e.prog=e.funcs[t],ft(e),e.ip=n,e.prog=o,$.DEBUG&&console.log(++e.step,"returning from",t)},function(e){if(e.env!=="fpgm")throw new Error("FDEF not allowed here");const t=e.stack,n=e.prog;let o=e.ip;const S=t.pop(),x=o;for($.DEBUG&&console.log(e.step,"FDEF[]",S);n[++o]!==45;);e.ip=o,e.funcs[S]=n.slice(x+1,o)},void 0,Oi.bind(void 0,0),Oi.bind(void 0,1),Ii.bind(void 0,it),Ii.bind(void 0,tt),Pi.bind(void 0,0),Pi.bind(void 0,1),Ui.bind(void 0,0),Ui.bind(void 0,1),Fi.bind(void 0,0),Fi.bind(void 0,1),function(e){const t=e.stack;let n=e.loop;const o=e.fv,S=t.pop()/64,x=e.z2;for(;n--;){const E=t.pop(),M=x[E];$.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-n)+": ":"")+"SHPIX[]",E,S),o.setRelative(M,M,S),o.touch(M)}e.loop=1},function(e){const t=e.stack,n=e.rp1,o=e.rp2;let S=e.loop;const x=e.z0[n],E=e.z1[o],M=e.fv,R=e.dpv,U=e.z2;for(;S--;){const N=t.pop(),j=U[N];$.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-S)+": ":"")+"IP[]",N,n,"<->",o),M.interpolate(j,x,E,R),M.touch(j)}e.loop=1},Hi.bind(void 0,0),Hi.bind(void 0,1),function(e){const t=e.stack,n=e.rp0,o=e.z0[n];let S=e.loop;const x=e.fv,E=e.pv,M=e.z1;for(;S--;){const R=t.pop(),U=M[R];$.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-S)+": ":"")+"ALIGNRP[]",R),x.setRelative(U,o,0,E),x.touch(U)}e.loop=1},function(e){$.DEBUG&&console.log(e.step,"RTDG[]"),e.round=Hs},Ni.bind(void 0,0),Ni.bind(void 0,1),function(e){const t=e.prog;let n=e.ip;const o=e.stack,S=t[++n];$.DEBUG&&console.log(e.step,"NPUSHB[]",S);for(let x=0;x<S;x++)o.push(t[++n]);e.ip=n},function(e){let t=e.ip;const n=e.prog,o=e.stack,S=n[++t];$.DEBUG&&console.log(e.step,"NPUSHW[]",S);for(let x=0;x<S;x++){let E=n[++t]<<8|n[++t];32768&E&&(E=-(1+(65535^E))),o.push(E)}e.ip=t},function(e){const t=e.stack;let n=e.store;n||(n=e.store=[]);const o=t.pop(),S=t.pop();$.DEBUG&&console.log(e.step,"WS",o,S),n[S]=o},function(e){const t=e.stack,n=e.store,o=t.pop();$.DEBUG&&console.log(e.step,"RS",o);const S=n&&n[o]||0;t.push(S)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"WCVTP",n,o),e.cvt[o]=n/64},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"RCVT",n),t.push(64*e.cvt[n])},Wi.bind(void 0,0),Wi.bind(void 0,1),void 0,Gi.bind(void 0,0),Gi.bind(void 0,1),function(e){$.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)},void 0,function(e){$.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0},void 0,void 0,function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"LT[]",n,o),t.push(o<n?1:0)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"LTEQ[]",n,o),t.push(o<=n?1:0)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"GT[]",n,o),t.push(o>n?1:0)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"GTEQ[]",n,o),t.push(o>=n?1:0)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"EQ[]",n,o),t.push(n===o?1:0)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"NEQ[]",n,o),t.push(n!==o?1:0)},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"ODD[]",n),t.push(Math.trunc(n)%2?1:0)},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"EVEN[]",n),t.push(Math.trunc(n)%2?0:1)},function(e){let t=e.stack.pop();$.DEBUG&&console.log(e.step,"IF[]",t),t||(Ri(e,!0),$.DEBUG&&console.log(e.step,"EIF[]"))},function(e){$.DEBUG&&console.log(e.step,"EIF[]")},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"AND[]",n,o),t.push(n&&o?1:0)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"OR[]",n,o),t.push(n||o?1:0)},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"NOT[]",n),t.push(n?0:1)},Gt.bind(void 0,1),function(e){const t=e.stack.pop();$.DEBUG&&console.log(e.step,"SDB[]",t),e.deltaBase=t},function(e){const t=e.stack.pop();$.DEBUG&&console.log(e.step,"SDS[]",t),e.deltaShift=Math.pow(.5,t)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"ADD[]",n,o),t.push(o+n)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"SUB[]",n,o),t.push(o-n)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"DIV[]",n,o),t.push(64*o/n)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"MUL[]",n,o),t.push(o*n/64)},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"ABS[]",n),t.push(Math.abs(n))},function(e){const t=e.stack;let n=t.pop();$.DEBUG&&console.log(e.step,"NEG[]",n),t.push(-n)},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"FLOOR[]",n),t.push(64*Math.floor(n/64))},function(e){const t=e.stack,n=t.pop();$.DEBUG&&console.log(e.step,"CEILING[]",n),t.push(64*Math.ceil(n/64))},Bt.bind(void 0,0),Bt.bind(void 0,1),Bt.bind(void 0,2),Bt.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"WCVTF[]",n,o),e.cvt[o]=n*e.ppem/e.font.unitsPerEm},Gt.bind(void 0,2),Gt.bind(void 0,3),zt.bind(void 0,1),zt.bind(void 0,2),zt.bind(void 0,3),function(e){let t,n=e.stack.pop();switch($.DEBUG&&console.log(e.step,"SROUND[]",n),e.round=ki,192&n){case 0:t=.5;break;case 64:t=1;break;case 128:t=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=t,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid SROUND value")}n&=15,e.srThreshold=n===0?0:(n/8-.5)*t},function(e){let t,n=e.stack.pop();switch($.DEBUG&&console.log(e.step,"S45ROUND[]",n),e.round=ki,192&n){case 0:t=Math.sqrt(2)/2;break;case 64:t=Math.sqrt(2);break;case 128:t=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=t,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid S45ROUND value")}n&=15,e.srThreshold=n===0?0:(n/8-.5)*t},void 0,void 0,function(e){$.DEBUG&&console.log(e.step,"ROFF[]"),e.round=Fs},void 0,function(e){$.DEBUG&&console.log(e.step,"RUTG[]"),e.round=Ws},function(e){$.DEBUG&&console.log(e.step,"RDTG[]"),e.round=Gs},Wt,Wt,void 0,void 0,void 0,void 0,void 0,function(e){const t=e.stack.pop();$.DEBUG&&console.log(e.step,"SCANCTRL[]",t)},zi.bind(void 0,0),zi.bind(void 0,1),function(e){const t=e.stack,n=t.pop();let o=0;$.DEBUG&&console.log(e.step,"GETINFO[]",n),1&n&&(o=35),32&n&&(o|=4096),t.push(o)},void 0,function(e){const t=e.stack,n=t.pop(),o=t.pop(),S=t.pop();$.DEBUG&&console.log(e.step,"ROLL[]"),t.push(o),t.push(n),t.push(S)},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"MAX[]",n,o),t.push(Math.max(o,n))},function(e){const t=e.stack,n=t.pop(),o=t.pop();$.DEBUG&&console.log(e.step,"MIN[]",n,o),t.push(Math.min(o,n))},function(e){const t=e.stack.pop();$.DEBUG&&console.log(e.step,"SCANTYPE[]",t)},function(e){const t=e.stack.pop();let n=e.stack.pop();switch($.DEBUG&&console.log(e.step,"INSTCTRL[]",t,n),t){case 1:return void(e.inhibitGridFit=!!n);case 2:return void(e.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,lt.bind(void 0,1),lt.bind(void 0,2),lt.bind(void 0,3),lt.bind(void 0,4),lt.bind(void 0,5),lt.bind(void 0,6),lt.bind(void 0,7),lt.bind(void 0,8),ht.bind(void 0,1),ht.bind(void 0,2),ht.bind(void 0,3),ht.bind(void 0,4),ht.bind(void 0,5),ht.bind(void 0,6),ht.bind(void 0,7),ht.bind(void 0,8),fe.bind(void 0,0,0,0,0,0),fe.bind(void 0,0,0,0,0,1),fe.bind(void 0,0,0,0,0,2),fe.bind(void 0,0,0,0,0,3),fe.bind(void 0,0,0,0,1,0),fe.bind(void 0,0,0,0,1,1),fe.bind(void 0,0,0,0,1,2),fe.bind(void 0,0,0,0,1,3),fe.bind(void 0,0,0,1,0,0),fe.bind(void 0,0,0,1,0,1),fe.bind(void 0,0,0,1,0,2),fe.bind(void 0,0,0,1,0,3),fe.bind(void 0,0,0,1,1,0),fe.bind(void 0,0,0,1,1,1),fe.bind(void 0,0,0,1,1,2),fe.bind(void 0,0,0,1,1,3),fe.bind(void 0,0,1,0,0,0),fe.bind(void 0,0,1,0,0,1),fe.bind(void 0,0,1,0,0,2),fe.bind(void 0,0,1,0,0,3),fe.bind(void 0,0,1,0,1,0),fe.bind(void 0,0,1,0,1,1),fe.bind(void 0,0,1,0,1,2),fe.bind(void 0,0,1,0,1,3),fe.bind(void 0,0,1,1,0,0),fe.bind(void 0,0,1,1,0,1),fe.bind(void 0,0,1,1,0,2),fe.bind(void 0,0,1,1,0,3),fe.bind(void 0,0,1,1,1,0),fe.bind(void 0,0,1,1,1,1),fe.bind(void 0,0,1,1,1,2),fe.bind(void 0,0,1,1,1,3),fe.bind(void 0,1,0,0,0,0),fe.bind(void 0,1,0,0,0,1),fe.bind(void 0,1,0,0,0,2),fe.bind(void 0,1,0,0,0,3),fe.bind(void 0,1,0,0,1,0),fe.bind(void 0,1,0,0,1,1),fe.bind(void 0,1,0,0,1,2),fe.bind(void 0,1,0,0,1,3),fe.bind(void 0,1,0,1,0,0),fe.bind(void 0,1,0,1,0,1),fe.bind(void 0,1,0,1,0,2),fe.bind(void 0,1,0,1,0,3),fe.bind(void 0,1,0,1,1,0),fe.bind(void 0,1,0,1,1,1),fe.bind(void 0,1,0,1,1,2),fe.bind(void 0,1,0,1,1,3),fe.bind(void 0,1,1,0,0,0),fe.bind(void 0,1,1,0,0,1),fe.bind(void 0,1,1,0,0,2),fe.bind(void 0,1,1,0,0,3),fe.bind(void 0,1,1,0,1,0),fe.bind(void 0,1,1,0,1,1),fe.bind(void 0,1,1,0,1,2),fe.bind(void 0,1,1,0,1,3),fe.bind(void 0,1,1,1,0,0),fe.bind(void 0,1,1,1,0,1),fe.bind(void 0,1,1,1,0,2),fe.bind(void 0,1,1,1,0,3),fe.bind(void 0,1,1,1,1,0),fe.bind(void 0,1,1,1,1,1),fe.bind(void 0,1,1,1,1,2),fe.bind(void 0,1,1,1,1,3)];const $s=Li;function De(e){(e=e||{}).empty||(vt(e.familyName,"When creating a new Font object, familyName is required."),vt(e.styleName,"When creating a new Font object, styleName is required."),vt(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),vt(e.ascender,"When creating a new Font object, ascender is required."),vt(e.descender,"When creating a new Font object, descender is required."),vt(e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||e.familyName+e.styleName},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables={os2:{usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new pt.GlyphSet(this,e.glyphs||[]),this.encoding=new Ne(this),this.position=new Is(this),this.substitution=new Us(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:this.outlinesFormat==="truetype"?this._hinting=new $s(this):void 0}})}De.prototype.hasChar=function(e){return this.encoding.charToGlyphIndex(e)!==null},De.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},De.prototype.charToGlyph=function(e){const t=this.charToGlyphIndex(e);let n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},De.prototype.stringToGlyphs=function(e,t){t=t||this.defaultRenderOptions;const n=[];for(let E=0;E<e.length;E+=1){const M=e[E];n.push(this.charToGlyphIndex(M))}let o=n.length;if(t.features){const E=t.script||this.substitution.getDefaultScriptName();let M=[];t.features.liga&&(M=M.concat(this.substitution.getFeature("liga",E,t.language))),t.features.rlig&&(M=M.concat(this.substitution.getFeature("rlig",E,t.language)));for(let R=0;R<o;R+=1)for(let U=0;U<M.length;U++){const N=M[U],j=N.sub,q=j.length;let oe=0;for(;oe<q&&j[oe]===n[R+oe];)oe++;oe===q&&(n.splice(R,q,N.by),o=o-q+1)}}const S=new Array(o),x=this.glyphs.get(0);for(let E=0;E<o;E+=1)S[E]=this.glyphs.get(n[E])||x;return S},De.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},De.prototype.nameToGlyph=function(e){const t=this.nameToGlyphIndex(e);let n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},De.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},De.prototype.getKerningValue=function(e,t){return e=e.index||e,t=t.index||t,this.kerningPairs[e+","+t]||0},De.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},De.prototype.forEachGlyph=function(e,t,n,o,S,x){t=t!==void 0?t:0,n=n!==void 0?n:0,o=o!==void 0?o:72,S=S||this.defaultRenderOptions;const E=1/this.unitsPerEm*o,M=this.stringToGlyphs(e,S);let R;if(S.kerning){const U=S.script||this.position.getDefaultScriptName();R=this.position.getKerningTables(U,S.language)}for(let U=0;U<M.length;U+=1){const N=M[U];x.call(this,N,t,n,o,S),N.advanceWidth&&(t+=N.advanceWidth*E),S.kerning&&U<M.length-1&&(t+=(R?this.position.getKerningValue(R,N.index,M[U+1].index):this.getKerningValue(N,M[U+1]))*E),S.letterSpacing?t+=S.letterSpacing*o:S.tracking&&(t+=S.tracking/1e3*o)}return t},De.prototype.getPath=function(e,t,n,o,S){const x=new s;return this.forEachGlyph(e,t,n,o,S,function(E,M,R,U){const N=E.getPath(M,R,U,S,this);x.extend(N)}),x},De.prototype.getPaths=function(e,t,n,o,S){const x=[];return this.forEachGlyph(e,t,n,o,S,function(E,M,R,U){const N=E.getPath(M,R,U,S,this);x.push(N)}),x},De.prototype.getAdvanceWidth=function(e,t,n){return this.forEachGlyph(e,0,0,t,n,function(){})},De.prototype.draw=function(e,t,n,o,S,x){this.getPath(t,n,o,S,x).draw(e)},De.prototype.drawPoints=function(e,t,n,o,S,x){this.forEachGlyph(t,n,o,S,x,function(E,M,R,U){E.drawPoints(e,M,R,U)})},De.prototype.drawMetrics=function(e,t,n,o,S,x){this.forEachGlyph(t,n,o,S,x,function(E,M,R,U){E.drawMetrics(e,M,R,U)})},De.prototype.getEnglishName=function(e){const t=this.names[e];if(t)return t.en},De.prototype.validate=function(){const e=this;function t(o,S){}function n(o){const S=e.getEnglishName(o);S&&S.trim().length>0}n("fontFamily"),n("weightName"),n("manufacturer"),n("copyright"),n("version"),this.unitsPerEm>0},De.prototype.toTables=function(){return Os(this)},De.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},De.prototype.toArrayBuffer=function(){const e=this.toTables().encode(),t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let o=0;o<e.length;o++)n[o]=e[o];return t},De.prototype.download=function(e){const t=this.getEnglishName("fontFamily"),n=this.getEnglishName("fontSubfamily");e=e||t.replace(/\s/g,"")+"-"+n+".otf";const o=this.toArrayBuffer();if(typeof window<"u")window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,o.byteLength,function(S){S.root.getFile(e,{create:!0},function(x){x.createWriter(function(E){const M=new DataView(o),R=new Blob([M],{type:"font/opentype"});E.write(R),E.addEventListener("writeend",function(){location.href=x.toURL()},!1)})})},function(S){throw new Error(S.name+": "+S.message)});else{const S=u(89),x=function(E){const M=new Buffer(E.byteLength),R=new Uint8Array(E);for(let U=0;U<M.length;++U)M[U]=R[U];return M}(o);S.writeFileSync(e,x)}},De.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},De.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},De.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};const $i=De;function js(e,t,n){const o={},S=new ae.Parser(e,t);return o.tag=S.parseTag(),o.minValue=S.parseFixed(),o.defaultValue=S.parseFixed(),o.maxValue=S.parseFixed(),S.skip("uShort",1),o.name=n[S.parseUShort()]||{},o}function qs(e,t,n,o){const S={},x=new ae.Parser(e,t);S.name=o[x.parseUShort()]||{},x.skip("uShort",1),S.coordinates={};for(let E=0;E<n.length;++E)S.coordinates[n[E].tag]=x.parseFixed();return S}const Ks=function(e,t,n){const o=new ae.Parser(e,t),S=o.parseULong();_.argument(S===65536,"Unsupported fvar table version.");const x=o.parseOffset16();o.skip("uShort",1);const E=o.parseUShort(),M=o.parseUShort(),R=o.parseUShort(),U=o.parseUShort(),N=[];for(let oe=0;oe<E;oe++)N.push(js(e,t+x+oe*M,n));const j=[],q=t+x+E*M;for(let oe=0;oe<R;oe++)j.push(qs(e,q+oe*U,N,n));return{axes:N,instances:j}},Je=new Array(10);Je[1]=function(){const e=this.offset+this.relativeOffset,t=this.parseUShort();return t===1?{posFormat:1,coverage:this.parsePointer(X.coverage),value:this.parseValueRecord()}:t===2?{posFormat:2,coverage:this.parsePointer(X.coverage),values:this.parseValueRecordList()}:void _.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Je[2]=function(){const e=this.offset+this.relativeOffset,t=this.parseUShort(),n=this.parsePointer(X.coverage),o=this.parseUShort(),S=this.parseUShort();if(t===1)return{posFormat:t,coverage:n,valueFormat1:o,valueFormat2:S,pairSets:this.parseList(X.pointer(X.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(o),value2:this.parseValueRecord(S)}})))};if(t===2){const x=this.parsePointer(X.classDef),E=this.parsePointer(X.classDef),M=this.parseUShort(),R=this.parseUShort();return{posFormat:t,coverage:n,valueFormat1:o,valueFormat2:S,classDef1:x,classDef2:E,class1Count:M,class2Count:R,classRecords:this.parseList(M,X.list(R,function(){return{value1:this.parseValueRecord(o),value2:this.parseValueRecord(S)}}))}}_.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.")},Je[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Je[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Je[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Je[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Je[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Je[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Je[9]=function(){return{error:"GPOS Lookup 9 not supported"}},new Array(10);const Vs=function(e,t){const n=new X(e,t=t||0),o=n.parseVersion(1);return _.argument(o===1||o===1.1,"Unsupported GPOS table version "+o),o===1?{version:o,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Je)}:{version:o,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(Je),variations:n.parseFeatureVariationsList()}},Xs=function(e,t){const n=new ae.Parser(e,t),o=n.parseUShort();if(o===0)return function(S){const x={};S.skip("uShort");const E=S.parseUShort();_.argument(E===0,"Unsupported kern sub-table version."),S.skip("uShort",2);const M=S.parseUShort();S.skip("uShort",3);for(let R=0;R<M;R+=1){const U=S.parseUShort(),N=S.parseUShort(),j=S.parseShort();x[U+","+N]=j}return x}(n);if(o===1)return function(S){const x={};S.skip("uShort"),S.parseULong()>1&&console.warn("Only the first kern subtable is supported."),S.skip("uLong");const E=255&S.parseUShort();if(S.skip("uShort"),E===0){const M=S.parseUShort();S.skip("uShort",3);for(let R=0;R<M;R+=1){const U=S.parseUShort(),N=S.parseUShort(),j=S.parseShort();x[U+","+N]=j}}return x}(n);throw new Error("Unsupported kern table version ("+o+").")},Ys=function(e,t,n,o){const S=new ae.Parser(e,t),x=o?S.parseUShort:S.parseULong,E=[];for(let M=0;M<n+1;M+=1){let R=x.call(S);o&&(R*=2),E.push(R)}return E};function Zs(e,t){u(89).readFile(e,function(n,o){if(n)return t(n.message);t(null,Ci(o))})}function Js(e,t){const n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer",n.onload=function(){return n.response?t(null,n.response):t("Font could not be loaded: "+n.statusText)},n.onerror=function(){t("Font could not be loaded")},n.send()}function ji(e,t){const n=[];let o=12;for(let S=0;S<t;S+=1){const x=ae.getTag(e,o),E=ae.getULong(e,o+4),M=ae.getULong(e,o+8),R=ae.getULong(e,o+12);n.push({tag:x,checksum:E,offset:M,length:R,compression:!1}),o+=16}return n}function Oe(e,t){if(t.compression==="WOFF"){const n=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),o=new Uint8Array(t.length);if(v()(n,o),o.byteLength!==t.length)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(o.buffer,0),offset:0}}return{data:e,offset:t.offset}}function $t(e){let t,n;const o=new $i({empty:!0}),S=new DataView(e,0);let x,E=[];const M=ae.getTag(S,0);if(M===String.fromCharCode(0,1,0,0)||M==="true"||M==="typ1")o.outlinesFormat="truetype",x=ae.getUShort(S,4),E=ji(S,x);else if(M==="OTTO")o.outlinesFormat="cff",x=ae.getUShort(S,4),E=ji(S,x);else{if(M!=="wOFF")throw new Error("Unsupported OpenType signature "+M);{const ce=ae.getTag(S,4);if(ce===String.fromCharCode(0,1,0,0))o.outlinesFormat="truetype";else{if(ce!=="OTTO")throw new Error("Unsupported OpenType flavor "+M);o.outlinesFormat="cff"}x=ae.getUShort(S,12),E=function(re,ue){const Te=[];let ye=44;for(let Ie=0;Ie<ue;Ie+=1){const We=ae.getTag(re,ye),qe=ae.getULong(re,ye+4),Fe=ae.getULong(re,ye+8),$e=ae.getULong(re,ye+12);let Ue;Ue=Fe<$e&&"WOFF",Te.push({tag:We,offset:qe,compression:Ue,compressedLength:Fe,length:$e}),ye+=20}return Te}(S,x)}}let R,U,N,j,q,oe,Q,pe,Y,ee,_e;for(let ce=0;ce<x;ce+=1){const re=E[ce];let ue;switch(re.tag){case"cmap":ue=Oe(S,re),o.tables.cmap=Re(ue.data,ue.offset),o.encoding=new rt(o.tables.cmap);break;case"cvt ":ue=Oe(S,re),_e=new ae.Parser(ue.data,ue.offset),o.tables.cvt=_e.parseShortList(re.length/2);break;case"fvar":U=re;break;case"fpgm":ue=Oe(S,re),_e=new ae.Parser(ue.data,ue.offset),o.tables.fpgm=_e.parseByteList(re.length);break;case"head":ue=Oe(S,re),o.tables.head=as(ue.data,ue.offset),o.unitsPerEm=o.tables.head.unitsPerEm,t=o.tables.head.indexToLocFormat;break;case"hhea":ue=Oe(S,re),o.tables.hhea=hs(ue.data,ue.offset),o.ascender=o.tables.hhea.ascender,o.descender=o.tables.hhea.descender,o.numberOfHMetrics=o.tables.hhea.numberOfHMetrics;break;case"hmtx":oe=re;break;case"ltag":ue=Oe(S,re),n=_s(ue.data,ue.offset);break;case"maxp":ue=Oe(S,re),o.tables.maxp=ps(ue.data,ue.offset),o.numGlyphs=o.tables.maxp.numGlyphs;break;case"name":Y=re;break;case"OS/2":ue=Oe(S,re),o.tables.os2=ws(ue.data,ue.offset);break;case"post":ue=Oe(S,re),o.tables.post=Es(ue.data,ue.offset),o.glyphNames=new ze(o.tables.post);break;case"prep":ue=Oe(S,re),_e=new ae.Parser(ue.data,ue.offset),o.tables.prep=_e.parseByteList(re.length);break;case"glyf":N=re;break;case"loca":pe=re;break;case"CFF ":R=re;break;case"kern":Q=re;break;case"GPOS":j=re;break;case"GSUB":q=re;break;case"meta":ee=re}}const me=Oe(S,Y);if(o.tables.name=bs(me.data,me.offset,n),o.names=o.tables.name,N&&pe){const ce=t===0,re=Oe(S,pe),ue=Ys(re.data,re.offset,o.numGlyphs,ce),Te=Oe(S,N);o.glyphs=Xt.parse(Te.data,Te.offset,ue,o)}else{if(!R)throw new Error("Font doesn't contain TrueType or CFF outlines.");{const ce=Oe(S,R);ns(ce.data,ce.offset,o)}}const Le=Oe(S,oe);if(us(Le.data,Le.offset,o.numberOfHMetrics,o.numGlyphs,o.glyphs),function(ce){let re;const ue=ce.tables.cmap.glyphIndexMap,Te=Object.keys(ue);for(let ye=0;ye<Te.length;ye+=1){const Ie=Te[ye],We=ue[Ie];re=ce.glyphs.get(We),re.addUnicode(parseInt(Ie))}for(let ye=0;ye<ce.glyphs.length;ye+=1)re=ce.glyphs.get(ye),ce.cffEncoding?ce.isCIDFont?re.name="gid"+ye:re.name=ce.cffEncoding.charset[ye]:ce.glyphNames.names&&(re.name=ce.glyphNames.glyphIndexToName(ye))}(o),Q){const ce=Oe(S,Q);o.kerningPairs=Xs(ce.data,ce.offset)}else o.kerningPairs={};if(j){const ce=Oe(S,j);o.tables.gpos=Vs(ce.data,ce.offset)}if(q){const ce=Oe(S,q);o.tables.gsub=Rs(ce.data,ce.offset)}if(U){const ce=Oe(S,U);o.tables.fvar=Ks(ce.data,ce.offset,o.names)}if(ee){const ce=Oe(S,ee);o.tables.meta=Ds(ce.data,ce.offset),o.metas=o.tables.meta}return o}function Qs(e,t){(typeof window>"u"?Zs:Js)(e,function(n,o){if(n)return t(n);let S;try{S=$t(o)}catch(x){return t(x,null)}return t(null,S)})}function er(e){return $t(Ci(u(89).readFileSync(e)))}},896:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(978);class v extends b.Writable{constructor(){super(...arguments),this.offset=0,this._waiters=[],this._closed=!1}_write(h,r,s){let l=0;const f=()=>{for(;this._waiters.length>0;){const _=this._waiters[0];if(this._buffer){const C=this._buffer.size-this._buffer.offset;if(!(C+h.length>=_.size)){if(!_.skip){const p=Buffer.alloc(C+h.length);this._buffer.buf.copy(p,0,this._buffer.offset,this._buffer.size),h.copy(p,C,0,h.length),this._buffer.buf=p}this._buffer.offset=0,this._buffer.size=C+h.length,s();break}if(_.skip)this._buffer=void 0,_.resolve();else{const p=Math.min(C,_.size),y=Buffer.alloc(_.size);this._buffer.buf.copy(y,0,this._buffer.offset,this._buffer.offset+p),h.copy(y,p,0,_.size-p),_.resolve(y)}if(this.offset+=_.size,this._waiters.shift(),this._buffer=void 0,C+h.length===_.size){s();break}l+=_.size-C}else{if(!(h.length-l>=_.size)){this._buffer={buf:_.skip?void 0:h.slice(l),offset:0,size:h.length-l},l=h.length,s();break}if(_.skip?_.resolve():_.resolve(h.slice(l,l+_.size)),this.offset+=_.size,this._waiters.shift(),l+=_.size,h.length===l){s();break}}}this._processTrigger=h.length-l>0?f:void 0};f()}_destroy(h,r){this._processTrigger=void 0;for(const s of this._waiters)s.reject(h||new Error("stream destroyed"));this._waiters=[],this._closed=!0}_final(h){this._processTrigger=void 0;for(const r of this._waiters)r.reject(new Error("not enough data in stream"));this._waiters=[],this._closed=!0}read(h){return new Promise((r,s)=>{this._closed&&s(new Error("stream is closed")),this._waiters.push({resolve:r,reject:s,size:h,skip:!1}),this._processTrigger&&this._processTrigger()})}skip(h){return new Promise((r,s)=>{this._closed&&s(new Error("stream is closed")),this._waiters.push({resolve:r,reject:s,size:h,skip:!0}),this._processTrigger&&this._processTrigger()})}}function a(){return new v}g.exports=Object.assign(a,{default:a}),d.default=a},311:g=>{function d(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function u(A,F){this.source=A,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=F,this.destLen=0,this.ltree=new d,this.dtree=new d}var b=new d,v=new d,a=new Uint8Array(30),i=new Uint16Array(30),h=new Uint8Array(30),r=new Uint16Array(30),s=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new d,f=new Uint8Array(320);function _(A,F,k,O){var I,P;for(I=0;I<k;++I)A[I]=0;for(I=0;I<30-k;++I)A[I+k]=I/k|0;for(P=O,I=0;I<30;++I)F[I]=P,P+=1<<A[I]}var C=new Uint16Array(16);function p(A,F,k,O){var I,P;for(I=0;I<16;++I)A.table[I]=0;for(I=0;I<O;++I)A.table[F[k+I]]++;for(A.table[0]=0,P=0,I=0;I<16;++I)C[I]=P,P+=A.table[I];for(I=0;I<O;++I)F[k+I]&&(A.trans[C[F[k+I]]++]=I)}function y(A){A.bitcount--||(A.tag=A.source[A.sourceIndex++],A.bitcount=7);var F=1&A.tag;return A.tag>>>=1,F}function L(A,F,k){if(!F)return k;for(;A.bitcount<24;)A.tag|=A.source[A.sourceIndex++]<<A.bitcount,A.bitcount+=8;var O=A.tag&65535>>>16-F;return A.tag>>>=F,A.bitcount-=F,O+k}function T(A,F){for(;A.bitcount<24;)A.tag|=A.source[A.sourceIndex++]<<A.bitcount,A.bitcount+=8;var k=0,O=0,I=0,P=A.tag;do O=2*O+(1&P),P>>>=1,++I,k+=F.table[I],O-=F.table[I];while(O>=0);return A.tag=P,A.bitcount-=I,F.trans[k+O]}function D(A,F,k){var O,I,P,V,te,he;for(O=L(A,5,257),I=L(A,5,1),P=L(A,4,4),V=0;V<19;++V)f[V]=0;for(V=0;V<P;++V){var J=L(A,3,0);f[s[V]]=J}for(p(l,f,0,19),te=0;te<O+I;){var le=T(A,l);switch(le){case 16:var G=f[te-1];for(he=L(A,2,3);he;--he)f[te++]=G;break;case 17:for(he=L(A,3,3);he;--he)f[te++]=0;break;case 18:for(he=L(A,7,11);he;--he)f[te++]=0;break;default:f[te++]=le}}p(F,f,0,O),p(k,f,O,I)}function B(A,F,k){for(;;){var O,I,P,V,te=T(A,F);if(te===256)return 0;if(te<256)A.dest[A.destLen++]=te;else for(O=L(A,a[te-=257],i[te]),I=T(A,k),V=P=A.destLen-L(A,h[I],r[I]);V<P+O;++V)A.dest[A.destLen++]=A.dest[V]}}function H(A){for(var F,k;A.bitcount>8;)A.sourceIndex--,A.bitcount-=8;if((F=256*(F=A.source[A.sourceIndex+1])+A.source[A.sourceIndex])!==(65535&~(256*A.source[A.sourceIndex+3]+A.source[A.sourceIndex+2])))return-3;for(A.sourceIndex+=4,k=F;k;--k)A.dest[A.destLen++]=A.source[A.sourceIndex++];return A.bitcount=0,0}(function(A,F){var k;for(k=0;k<7;++k)A.table[k]=0;for(A.table[7]=24,A.table[8]=152,A.table[9]=112,k=0;k<24;++k)A.trans[k]=256+k;for(k=0;k<144;++k)A.trans[24+k]=k;for(k=0;k<8;++k)A.trans[168+k]=280+k;for(k=0;k<112;++k)A.trans[176+k]=144+k;for(k=0;k<5;++k)F.table[k]=0;for(F.table[5]=32,k=0;k<32;++k)F.trans[k]=k})(b,v),_(a,i,4,3),_(h,r,2,1),a[28]=0,i[28]=258,g.exports=function(A,F){var k,O,I=new u(A,F);do{switch(k=y(I),L(I,2,0)){case 0:O=H(I);break;case 1:O=B(I,b,v);break;case 2:D(I,I.ltree,I.dtree),O=B(I,I.ltree,I.dtree);break;default:O=-3}if(O!==0)throw new Error("Data error")}while(!k);return I.destLen<I.dest.length?typeof I.dest.slice=="function"?I.dest.slice(0,I.destLen):I.dest.subarray(0,I.destLen):I.dest}},371:g=>{g.exports=function(d){d.prototype[Symbol.iterator]=function*(){for(let u=this.head;u;u=u.next)yield u.value}}},411:(g,d,u)=>{function b(r){var s=this;if(s instanceof b||(s=new b),s.tail=null,s.head=null,s.length=0,r&&typeof r.forEach=="function")r.forEach(function(_){s.push(_)});else if(arguments.length>0)for(var l=0,f=arguments.length;l<f;l++)s.push(arguments[l]);return s}function v(r,s,l){var f=s===r.head?new h(l,null,s,r):new h(l,s,s.next,r);return f.next===null&&(r.tail=f),f.prev===null&&(r.head=f),r.length++,f}function a(r,s){r.tail=new h(s,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function i(r,s){r.head=new h(s,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function h(r,s,l,f){if(!(this instanceof h))return new h(r,s,l,f);this.list=f,this.value=r,s?(s.next=this,this.prev=s):this.prev=null,l?(l.prev=this,this.next=l):this.next=null}g.exports=b,b.Node=h,b.create=b,b.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var s=r.next,l=r.prev;return s&&(s.prev=l),l&&(l.next=s),r===this.head&&(this.head=s),r===this.tail&&(this.tail=l),r.list.length--,r.next=null,r.prev=null,r.list=null,s},b.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var s=this.head;r.list=this,r.next=s,s&&(s.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}},b.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var s=this.tail;r.list=this,r.prev=s,s&&(s.next=r),this.tail=r,this.head||(this.head=r),this.length++}},b.prototype.push=function(){for(var r=0,s=arguments.length;r<s;r++)a(this,arguments[r]);return this.length},b.prototype.unshift=function(){for(var r=0,s=arguments.length;r<s;r++)i(this,arguments[r]);return this.length},b.prototype.pop=function(){if(this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}},b.prototype.shift=function(){if(this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}},b.prototype.forEach=function(r,s){s=s||this;for(var l=this.head,f=0;l!==null;f++)r.call(s,l.value,f,this),l=l.next},b.prototype.forEachReverse=function(r,s){s=s||this;for(var l=this.tail,f=this.length-1;l!==null;f--)r.call(s,l.value,f,this),l=l.prev},b.prototype.get=function(r){for(var s=0,l=this.head;l!==null&&s<r;s++)l=l.next;if(s===r&&l!==null)return l.value},b.prototype.getReverse=function(r){for(var s=0,l=this.tail;l!==null&&s<r;s++)l=l.prev;if(s===r&&l!==null)return l.value},b.prototype.map=function(r,s){s=s||this;for(var l=new b,f=this.head;f!==null;)l.push(r.call(s,f.value,this)),f=f.next;return l},b.prototype.mapReverse=function(r,s){s=s||this;for(var l=new b,f=this.tail;f!==null;)l.push(r.call(s,f.value,this)),f=f.prev;return l},b.prototype.reduce=function(r,s){var l,f=this.head;if(arguments.length>1)l=s;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");f=this.head.next,l=this.head.value}for(var _=0;f!==null;_++)l=r(l,f.value,_),f=f.next;return l},b.prototype.reduceReverse=function(r,s){var l,f=this.tail;if(arguments.length>1)l=s;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");f=this.tail.prev,l=this.tail.value}for(var _=this.length-1;f!==null;_--)l=r(l,f.value,_),f=f.prev;return l},b.prototype.toArray=function(){for(var r=new Array(this.length),s=0,l=this.head;l!==null;s++)r[s]=l.value,l=l.next;return r},b.prototype.toArrayReverse=function(){for(var r=new Array(this.length),s=0,l=this.tail;l!==null;s++)r[s]=l.value,l=l.prev;return r},b.prototype.slice=function(r,s){(s=s||this.length)<0&&(s+=this.length),(r=r||0)<0&&(r+=this.length);var l=new b;if(s<r||s<0)return l;r<0&&(r=0),s>this.length&&(s=this.length);for(var f=0,_=this.head;_!==null&&f<r;f++)_=_.next;for(;_!==null&&f<s;f++,_=_.next)l.push(_.value);return l},b.prototype.sliceReverse=function(r,s){(s=s||this.length)<0&&(s+=this.length),(r=r||0)<0&&(r+=this.length);var l=new b;if(s<r||s<0)return l;r<0&&(r=0),s>this.length&&(s=this.length);for(var f=this.length,_=this.tail;_!==null&&f>s;f--)_=_.prev;for(;_!==null&&f>r;f--,_=_.prev)l.push(_.value);return l},b.prototype.splice=function(r,s,...l){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var f=0,_=this.head;_!==null&&f<r;f++)_=_.next;var C=[];for(f=0;_&&f<s;f++)C.push(_.value),_=this.removeNode(_);for(_===null&&(_=this.tail),_!==this.head&&_!==this.tail&&(_=_.prev),f=0;f<l.length;f++)_=v(this,_,l[f]);return C},b.prototype.reverse=function(){for(var r=this.head,s=this.tail,l=r;l!==null;l=l.prev){var f=l.prev;l.prev=l.next,l.next=f}return this.head=s,this.tail=r,this};try{u(371)(b)}catch{}},109:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0});const b=u(98),v=u(104);let a;d.default=async function(h,r){var s,l;if(!a){if(typeof navigator<"u"&&"fonts"in navigator){try{const C=await((l=(s=navigator.permissions).request)===null||l===void 0?void 0:l.call(s,{name:"local-fonts"}));if(C&&C.state!=="granted")throw new Error("Permission to access local fonts not granted.")}catch(C){if(C.name!=="TypeError")throw C}const _={};try{const C=await navigator.fonts.query();for(const p of C)_.hasOwnProperty(p.family)||(_[p.family]=[]),_[p.family].push(p);a=Promise.resolve(_)}catch(C){console.error(C.name,C.message)}}else if(typeof process!="object"&&"queryLocalFonts"in window){const _={};try{const C=await window.queryLocalFonts();for(const p of C)_.hasOwnProperty(p.family)||(_[p.family]=[]),_[p.family].push(p);a=Promise.resolve(_)}catch(C){console.error(C.name,C.message)}}a||(a=Promise.resolve({}))}const f=await a;for(const _ of(0,v.default)(h)){if(i.includes(_))return;if(f.hasOwnProperty(_)&&f[_].length>0){const C=f[_][0];if("blob"in C){const p=await C.blob(),y=await p.arrayBuffer();return(0,b.loadBuffer)(y,{cacheSize:r})}return}}};const i=["serif","sans-serif","cursive","fantasy","monospace","system-ui","emoji","math","fangsong"]},833:(g,d,u)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.enableLigatures=void 0;const b=u(109);d.enableLigatures=function(v,a=[]){let i,h,r,s=0;return v.registerCharacterJoiner(l=>{const f=v.options.fontFamily;if(f&&(s===0||i!==f)){h=void 0,s=1,i=f;const _=i;(0,b.default)(_,1e5).then(C=>{_===v.options.fontFamily&&(s=2,h=C,C&&v.refresh(0,v.rows-1))}).catch(C=>{_===v.options.fontFamily&&(s=3,v.options.logLevel==="debug"&&console.debug(r,new Error("Failure while loading font")),h=void 0,r=C)})}return h&&s===2?h.findLigatureRanges(l).map(_=>[_[0],_[1]]):function(_,C){const p=[];for(let y=0;y<_.length;y++)for(let L=0;L<C.length;L++)if(_.startsWith(C[L],y)){p.push([y,y+C[L].length]),y+=C[L].length-1;break}return p}(l,a)})}},104:(g,d)=>{function u(i,h){let r="",s=!1;for(;i.offset<i.input.length;){const l=i.input[i.offset++];if(s)/[\dA-Fa-f]/.test(l)?(i.offset--,r+=v(i)):l!==`
`&&(r+=l),s=!1;else switch(l){case h:return r;case"\\":s=!0;break;default:r+=l}}throw new Error("Unterminated string")}function b(i){let h="",r=!1;for(;i.offset<i.input.length;){const s=i.input[i.offset++];if(r)/[\dA-Fa-f]/.test(s)?(i.offset--,h+=v(i)):h+=s,r=!1;else switch(s){case"\\":r=!0;break;case",":return h;default:/\s/.test(s)?h.endsWith(" ")||(h+=" "):h+=s}}return h}function v(i){let h="";for(;i.offset<i.input.length;){const r=i.input[i.offset++];if(/\s/.test(r))return a(h);if(h.length>=6||!/[\dA-Fa-f]/.test(r))return i.offset--,a(h);h+=r}return a(h)}function a(i){return String.fromCodePoint(parseInt(i,16))}Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(i){if(typeof i!="string")throw new Error("Font family must be a string");const h={input:i,offset:0},r=[];let s="";for(;h.offset<h.input.length;){const l=h.input[h.offset++];switch(l){case"'":case'"':s+=u(h,l);break;case",":r.push(s),s="";break;default:/\s/.test(l)||(h.offset--,s+=b(h),r.push(s),s="")}}return r}},89:g=>{g.exports=ie},56:g=>{g.exports=de},978:g=>{g.exports=ge},269:g=>{g.exports=ve},82:()=>{},456:()=>{}},c={};function w(g){var d=c[g];if(d!==void 0)return d.exports;var u=c[g]={exports:{}};return K[g].call(u.exports,u,u.exports,w),u.exports}w.n=g=>{var d=g&&g.__esModule?()=>g.default:()=>g;return w.d(d,{a:d}),d},w.d=(g,d)=>{for(var u in d)w.o(d,u)&&!w.o(g,u)&&Object.defineProperty(g,u,{enumerable:!0,get:d[u]})},w.o=(g,d)=>Object.prototype.hasOwnProperty.call(g,d),w.r=g=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})};var m={};return(()=>{var g=m;Object.defineProperty(g,"__esModule",{value:!0}),g.LigaturesAddon=void 0;const d=w(833);g.LigaturesAddon=class{constructor(u){this._fallbackLigatures=((u==null?void 0:u.fallbackLigatures)||["<--","<---","<<-","<-","->","->>","-->","--->","<==","<===","<<=","<=","=>","=>>","==>","===>",">=",">>=","<->","<-->","<--->","<---->","<=>","<==>","<===>","<====>","-------->","<~~","<~","~>","~~>","::",":::","==","!=","===","!==",":=",":-",":+","<*","<*>","*>","<|","<|>","|>","+:","-:","=:",":>","++","+++","<!--","<!---","<***>"]).sort((b,v)=>v.length-b.length)}activate(u){this._terminal=u,this._characterJoinerId=(0,d.enableLigatures)(u,this._fallbackLigatures)}dispose(){var u;this._characterJoinerId!==void 0&&((u=this._terminal)===null||u===void 0||u.deregisterCharacterJoiner(this._characterJoinerId),this._characterJoinerId=void 0)}}})(),m})()})})(Kt,Kt.exports);var cr=Kt.exports,Qi={exports:{}};(function(Se,$){(function(ie,de){Se.exports=de()})(self,function(){return(()=>{var ie={345:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=w=>(this._listeners.push(w),{dispose:()=>{if(!this._disposed){for(let m=0;m<this._listeners.length;m++)if(this._listeners[m]===w)return void this._listeners.splice(m,1)}}})),this._event}fire(w,m){const g=[];for(let d=0;d<this._listeners.length;d++)g.push(this._listeners[d]);for(let d=0;d<g.length;d++)g[d].call(void 0,w,m)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},c.forwardEvent=function(w,m){return w(g=>m.fire(g))}}},de={};function ve(K){var c=de[K];if(c!==void 0)return c.exports;var w=de[K]={exports:{}};return ie[K](w,w.exports,ve),w.exports}var ge={};return(()=>{var K=ge;Object.defineProperty(K,"__esModule",{value:!0}),K.SearchAddon=void 0;const c=ve(345),w=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";K.SearchAddon=class{constructor(){this._linesCacheTimeoutId=0,this._onDidChangeResults=new c.EventEmitter,this.onDidChangeResults=this._onDidChangeResults.event}activate(m){this._terminal=m,this._onDataDisposable=this._terminal.onWriteParsed(()=>this._updateMatches()),this._onResizeDisposable=this._terminal.onResize(()=>this._updateMatches())}_updateMatches(){var m;this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&(!((m=this._lastSearchOptions)===null||m===void 0)&&m.decorations)&&(this._highlightTimeout=setTimeout(()=>{var g,d;this.findPrevious(this._cachedSearchTerm,Object.assign(Object.assign({},this._lastSearchOptions),{incremental:!0,noScroll:!0})),this._resultIndex=this._searchResults?this._searchResults.size-1:-1,this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:(d=(g=this._searchResults)===null||g===void 0?void 0:g.size)!==null&&d!==void 0?d:-1})},200))}dispose(){var m,g;this.clearDecorations(),(m=this._onDataDisposable)===null||m===void 0||m.dispose(),(g=this._onResizeDisposable)===null||g===void 0||g.dispose()}clearDecorations(m){var g,d,u,b;(g=this._selectedDecoration)===null||g===void 0||g.dispose(),(d=this._searchResults)===null||d===void 0||d.clear(),(u=this._resultDecorations)===null||u===void 0||u.forEach(v=>{for(const a of v)a.dispose()}),(b=this._resultDecorations)===null||b===void 0||b.clear(),this._searchResults=void 0,this._resultDecorations=void 0,m||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){var m;(m=this._selectedDecoration)===null||m===void 0||m.dispose(),this._selectedDecoration=void 0}findNext(m,g){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=g,g!=null&&g.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&m===this._cachedSearchTerm||this._highlightAllMatches(m,g)),this._fireResults(m,this._findNextAndSelect(m,g),g)}_highlightAllMatches(m,g){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!m||m.length===0)return void this.clearDecorations();g=g||{},this.clearDecorations(!0),this._searchResults=new Map,this._resultDecorations=new Map;const d=this._resultDecorations;let u=this._find(m,0,0,g);for(;u&&!this._searchResults.get(`${u.row}-${u.col}`);)if(this._searchResults.set(`${u.row}-${u.col}`,u),u=this._find(m,u.col+u.term.length>=this._terminal.cols?u.row+1:u.row,u.col+u.term.length>=this._terminal.cols?0:u.col+1,g),this._searchResults.size>1e3)return this.clearDecorations(),void(this._resultIndex=void 0);this._searchResults.forEach(b=>{const v=this._createResultDecoration(b,g.decorations);if(v){const a=d.get(v.marker.line)||[];a.push(v),d.set(v.marker.line,a)}})}_find(m,g,d,u){var b;if(!this._terminal||!m||m.length===0)return(b=this._terminal)===null||b===void 0||b.clearSelection(),void this.clearDecorations();if(d>this._terminal.cols)throw new Error(`Invalid col: ${d} to search in terminal of ${this._terminal.cols} cols`);let v;this._initLinesCache();const a={startRow:g,startCol:d};if(v=this._findInLine(m,a,u),!v)for(let i=g+1;i<this._terminal.buffer.active.baseY+this._terminal.rows&&(a.startRow=i,a.startCol=0,v=this._findInLine(m,a,u),!v);i++);return v}_findNextAndSelect(m,g){var d;if(!this._terminal||!m||m.length===0)return(d=this._terminal)===null||d===void 0||d.clearSelection(),this.clearDecorations(),this._cachedSearchTerm=void 0,this._resultIndex=-1,!1;this._cachedSearchTerm!==m&&(this._resultIndex=void 0,this._terminal.clearSelection());let u,b=0,v=0;if(this._terminal.hasSelection()){const h=!!g&&g.incremental;u=this._terminal.getSelectionPosition(),v=h?u.start.y:u.end.y,b=h?u.start.x:u.end.x}this._initLinesCache();const a={startRow:v,startCol:b};let i=this._findInLine(m,a,g);if(!i)for(let h=v+1;h<this._terminal.buffer.active.baseY+this._terminal.rows&&(a.startRow=h,a.startCol=0,i=this._findInLine(m,a,g),!i);h++);if(!i&&v!==0)for(let h=0;h<v&&(a.startRow=h,a.startCol=0,i=this._findInLine(m,a,g),!i);h++);return!i&&u&&(a.startRow=u.start.y,a.startCol=0,i=this._findInLine(m,a,g)),this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0?this._resultIndex=0:(this._resultIndex++,this._resultIndex>=this._searchResults.size&&(this._resultIndex=0))),this._selectResult(i,g==null?void 0:g.decorations,g==null?void 0:g.noScroll)}findPrevious(m,g){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");return this._lastSearchOptions=g,g!=null&&g.decorations&&(this._resultIndex===void 0&&this._cachedSearchTerm!==void 0&&m===this._cachedSearchTerm||this._highlightAllMatches(m,g)),this._fireResults(m,this._findPreviousAndSelect(m,g),g)}_fireResults(m,g,d){var u;return d!=null&&d.decorations&&(this._resultIndex!==void 0&&((u=this._searchResults)===null||u===void 0?void 0:u.size)!==void 0?this._onDidChangeResults.fire({resultIndex:this._resultIndex,resultCount:this._searchResults.size}):this._onDidChangeResults.fire(void 0)),this._cachedSearchTerm=m,g}_findPreviousAndSelect(m,g){var d;if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let u;if(!this._terminal||!m||m.length===0)return u=void 0,(d=this._terminal)===null||d===void 0||d.clearSelection(),this.clearDecorations(),this._resultIndex=-1,!1;this._cachedSearchTerm!==m&&(this._resultIndex=void 0,this._terminal.clearSelection());let b=this._terminal.buffer.active.baseY+this._terminal.rows,v=this._terminal.cols;const a=!0,i=!!g&&g.incremental;let h;this._terminal.hasSelection()&&(h=this._terminal.getSelectionPosition(),b=h.start.y,v=h.start.x),this._initLinesCache();const r={startRow:b,startCol:v};if(i?(u=this._findInLine(m,r,g,!1),u&&u.row===b&&u.col===v||(h&&(r.startRow=h.end.y,r.startCol=h.end.x),u=this._findInLine(m,r,g,!0))):u=this._findInLine(m,r,g,a),!u){r.startCol=Math.max(r.startCol,this._terminal.cols);for(let s=b-1;s>=0&&(r.startRow=s,u=this._findInLine(m,r,g,a),!u);s--);}if(!u&&b!==this._terminal.buffer.active.baseY+this._terminal.rows)for(let s=this._terminal.buffer.active.baseY+this._terminal.rows;s>=b&&(r.startRow=s,u=this._findInLine(m,r,g,a),!u);s--);return this._searchResults&&(this._searchResults.size===0?this._resultIndex=-1:this._resultIndex===void 0||this._resultIndex<0?this._resultIndex=this._searchResults.size-1:(this._resultIndex--,this._resultIndex===-1&&(this._resultIndex=this._searchResults.size-1))),!(u||!h)||this._selectResult(u,g==null?void 0:g.decorations,g==null?void 0:g.noScroll)}_initLinesCache(){const m=this._terminal;this._linesCache||(this._linesCache=new Array(m.buffer.active.length),this._cursorMoveListener=m.onCursorMove(()=>this._destroyLinesCache()),this._resizeListener=m.onResize(()=>this._destroyLinesCache())),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(m,g,d){return(m===0||w.includes(g[m-1]))&&(m+d.length===g.length||w.includes(g[m+d.length]))}_findInLine(m,g,d={},u=!1){var b;const v=this._terminal,a=g.startRow,i=g.startCol,h=v.buffer.active.getLine(a);if(h!=null&&h.isWrapped)return u?void(g.startCol+=v.cols):(g.startRow--,g.startCol+=v.cols,this._findInLine(m,g,d));let r=(b=this._linesCache)===null||b===void 0?void 0:b[a];r||(r=this._translateBufferLineToStringWithWrap(a,!0),this._linesCache&&(this._linesCache[a]=r));const[s,l]=r,f=this._bufferColsToStringOffset(a,i),_=d.caseSensitive?m:m.toLowerCase(),C=d.caseSensitive?s:s.toLowerCase();let p=-1;if(d.regex){const y=RegExp(_,"g");let L;if(u)for(;L=y.exec(C.slice(0,f));)p=y.lastIndex-L[0].length,m=L[0],y.lastIndex-=m.length-1;else L=y.exec(C.slice(f)),L&&L[0].length>0&&(p=f+(y.lastIndex-L[0].length),m=L[0])}else u?f-_.length>=0&&(p=C.lastIndexOf(_,f-_.length)):p=C.indexOf(_,f);if(p>=0){if(d.wholeWord&&!this._isWholeWord(p,C,m))return;let y=0;for(;y<l.length-1&&p>=l[y+1];)y++;let L=y;for(;L<l.length-1&&p+m.length>=l[L+1];)L++;const T=p-l[y],D=p+m.length-l[L],B=this._stringLengthToBufferSize(a+y,T);return{term:m,col:B,row:a+y,size:this._stringLengthToBufferSize(a+L,D)-B+v.cols*(L-y)}}}_stringLengthToBufferSize(m,g){const d=this._terminal.buffer.active.getLine(m);if(!d)return 0;for(let u=0;u<g;u++){const b=d.getCell(u);if(!b)break;const v=b.getChars();v.length>1&&(g-=v.length-1);const a=d.getCell(u+1);a&&a.getWidth()===0&&g++}return g}_bufferColsToStringOffset(m,g){const d=this._terminal;let u=m,b=0,v=d.buffer.active.getLine(u);for(;g>0&&v;){for(let a=0;a<g&&a<d.cols;a++){const i=v.getCell(a);if(!i)break;i.getWidth()&&(b+=i.getCode()===0?1:i.getChars().length)}if(u++,v=d.buffer.active.getLine(u),v&&!v.isWrapped)break;g-=d.cols}return b}_translateBufferLineToStringWithWrap(m,g){var d;const u=this._terminal,b=[],v=[0];let a=u.buffer.active.getLine(m);for(;a;){const i=u.buffer.active.getLine(m+1),h=!!i&&i.isWrapped;let r=a.translateToString(!h&&g);if(h&&i){const s=a.getCell(a.length-1);s&&s.getCode()===0&&s.getWidth()===1&&((d=i.getCell(0))===null||d===void 0?void 0:d.getWidth())===2&&(r=r.slice(0,-1))}if(b.push(r),!h)break;v.push(v[v.length-1]+r.length),m++,a=i}return[b.join(""),v]}_selectResult(m,g,d){var u,b;const v=this._terminal;if(this.clearActiveDecoration(),!m)return v.clearSelection(),!1;if(v.select(m.col,m.row,m.size),g){const a=v.registerMarker(-v.buffer.active.baseY-v.buffer.active.cursorY+m.row);a&&(this._selectedDecoration=v.registerDecoration({marker:a,x:m.col,width:m.size,backgroundColor:g.activeMatchBackground,layer:"top",overviewRulerOptions:{color:g.activeMatchColorOverviewRuler}}),(u=this._selectedDecoration)===null||u===void 0||u.onRender(i=>this._applyStyles(i,g.activeMatchBorder,!0)),(b=this._selectedDecoration)===null||b===void 0||b.onDispose(()=>a.dispose()))}if(!d&&(m.row>=v.buffer.active.viewportY+v.rows||m.row<v.buffer.active.viewportY)){let a=m.row-v.buffer.active.viewportY;a-=Math.floor(v.rows/2),v.scrollLines(a)}return!0}_applyStyles(m,g,d){m.clientWidth<=0||(m.classList.contains("xterm-find-result-decoration")||(m.classList.add("xterm-find-result-decoration"),g&&(m.style.outline=`1px solid ${g}`)),d&&m.classList.add("xterm-find-active-result-decoration"))}_createResultDecoration(m,g){var d;const u=this._terminal,b=u.registerMarker(-u.buffer.active.baseY-u.buffer.active.cursorY+m.row);if(!b)return;const v=u.registerDecoration({marker:b,x:m.col,width:m.size,backgroundColor:g.matchBackground,overviewRulerOptions:!((d=this._resultDecorations)===null||d===void 0)&&d.get(b.line)?void 0:{color:g.matchOverviewRuler,position:"center"}});return v==null||v.onRender(a=>this._applyStyles(a,g.matchBorder,!1)),v==null||v.onDispose(()=>b.dispose()),v}}})(),ge})()})})(Qi);var ur=Qi.exports,es={exports:{}};(function(Se,$){(function(ie,de){Se.exports=de()})(self,function(){return(()=>{var ie={6:(K,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkComputer=c.WebLinkProvider=void 0,c.WebLinkProvider=class{constructor(m,g,d,u={}){this._terminal=m,this._regex=g,this._handler=d,this._options=u}provideLinks(m,g){const d=w.computeLink(m,this._regex,this._terminal,this._handler);g(this._addCallbacks(d))}_addCallbacks(m){return m.map(g=>(g.leave=this._options.leave,g.hover=(d,u)=>{if(this._options.hover){const{range:b}=g;this._options.hover(d,u,b)}},g))}};class w{static computeLink(g,d,u,b){const v=new RegExp(d.source,(d.flags||"")+"g"),[a,i]=w._translateBufferLineToStringWithWrap(g-1,!1,u);let h,r=-1;const s=[];for(;(h=v.exec(a))!==null;){const l=h[1];if(!l){console.log("match found without corresponding matchIndex");break}if(r=a.indexOf(l,r+1),v.lastIndex=r+l.length,r<0)break;let f=r+l.length,_=i+1;for(;f>u.cols;)f-=u.cols,_++;let C=r+1,p=i+1;for(;C>u.cols;)C-=u.cols,p++;const y={start:{x:C,y:p},end:{x:f,y:_}};s.push({range:y,text:l,activate:b})}return s}static _translateBufferLineToStringWithWrap(g,d,u){let b,v,a="";do{const h=u.buffer.active.getLine(g);if(!h)break;h.isWrapped&&g--,v=h.isWrapped}while(v);const i=g;do{const h=u.buffer.active.getLine(g+1);b=!!h&&h.isWrapped;const r=u.buffer.active.getLine(g);if(!r)break;a+=r.translateToString(!b&&d).substring(0,u.cols),g++}while(b);return[a,i]}}c.LinkComputer=w}},de={};function ve(K){var c=de[K];if(c!==void 0)return c.exports;var w=de[K]={exports:{}};return ie[K](w,w.exports,ve),w.exports}var ge={};return(()=>{var K=ge;Object.defineProperty(K,"__esModule",{value:!0}),K.WebLinksAddon=void 0;const c=ve(6),w=new RegExp(`(?:^|[^\\da-z\\.-]+)((https?:\\/\\/)((([\\da-z\\.-]+)\\.([a-z\\.]{2,18}))|((\\d{1,3}\\.){3}\\d{1,3})|(localhost))(:\\d{1,5})?((\\/[\\/\\w\\.\\-%~:+@]*)*([^:"'\\s]))?(\\?[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;~\\=\\.\\-]*)?(#[0-9\\w\\[\\]\\(\\)\\/\\?\\!#@$%&'*+,:;~\\=\\.\\-]*)?)($|[^\\/\\w\\.\\-%]+)`);function m(g,d){const u=window.open();if(u){try{u.opener=null}catch{}u.location.href=d}else console.warn("Opening link blocked as opener could not be cleared")}K.WebLinksAddon=class{constructor(g=m,d={}){this._handler=g,this._options=d}activate(g){this._terminal=g;const d=this._options,u=d.urlRegex||w;this._linkProvider=this._terminal.registerLinkProvider(new c.WebLinkProvider(this._terminal,u,this._handler,d))}dispose(){var g;(g=this._linkProvider)===null||g===void 0||g.dispose()}}})(),ge})()})})(es);var dr=es.exports;const fr={foreground:"#eeeeec",background:"#300a24",cursor:"#bbbbbb",black:"#2e3436",brightBlack:"#555753",red:"#cc0000",brightRed:"#ef2929",green:"#4e9a06",brightGreen:"#8ae234",yellow:"#c4a000",brightYellow:"#fce94f",blue:"#3465a4",brightBlue:"#729fcf",magenta:"#75507b",brightMagenta:"#ad7fa8",cyan:"#06989a",brightCyan:"#34e2e2",white:"#d3d7cf",brightWhite:"#eeeeec"},_r={foreground:"#F8F8F2",background:"#282A36",cursor:"#bbbbbb",selectionBackground:"#44475A",black:"#21222C",brightBlack:"#6272A4",red:"#FF5555",brightRed:"#FF6E6E",green:"#50FA7B",brightGreen:"#69FF94",yellow:"#F1FA8C",brightYellow:"#FFFFA5",blue:"#BD93F9",brightBlue:"#D6ACFF",magenta:"#FF79C6",brightMagenta:"#FF92DF",cyan:"#8BE9FD",brightCyan:"#A4FFFF",white:"#F8F8F2",brightWhite:"#FFFFFF"},pr={foreground:"#abb2bf",background:"#282c34",cursor:"#bbbbbb",selectionBackground:"#abb2bf30",black:"#3f4451",brightBlack:"#4f5666",red:"#e05561",brightRed:"#ff616e",green:"#8cc265",brightGreen:"#a5e075",yellow:"#d18f52",brightYellow:"#f0a45d",blue:"#4aa5f0",brightBlue:"#4dc4ff",magenta:"#c162de",brightMagenta:"#de73ff",cyan:"#42b3c2",brightCyan:"#4cd1e0",white:"#d7dae0",brightWhite:"#e6e6e6"},gr={foreground:"#C5C8C6",background:"#161719",cursor:"#D0D0D0",black:"#000000",brightBlack:"#000000",red:"#FD5FF1",brightRed:"#FD5FF1",green:"#87C38A",brightGreen:"#94FA36",yellow:"#FFD7B1",brightYellow:"#F5FFA8",blue:"#85BEFD",brightBlue:"#96CBFE",magenta:"#B9B6FC",brightMagenta:"#B9B6FC",cyan:"#85BEFD",brightCyan:"#85BEFD",white:"#E0E0E0",brightWhite:"#E0E0E0"},jt=Se=>{switch(Se){case"Ubuntu":return fr;case"Dracula":return _r;case"Arthur":return gr;case"OneDark":return pr;case"Default":return}const $=document.documentElement.style;function ie(de){return $.getPropertyValue(de)}return{cursor:ie("--vscode-editorCursor-foreground"),foreground:ie("--vscode-terminal-foreground"),background:ie("--vscode-editor-background"),black:ie("--vscode-terminal-ansiBlack"),brightBlack:ie("--vscode-terminal-ansiBrightBlack"),blue:ie("--vscode-terminal-ansiBlue"),brightBlue:ie("--vscode-terminal-ansBrightiBlue"),green:ie("--vscode-terminal-ansiGreen"),brightGreen:ie("--vscode-terminal-ansiBrightGreen"),red:ie("--vscode-terminal-ansiRed"),brightRed:ie("--vscode-terminal-ansiBrightRed"),cyan:ie("--vscode-terminal-ansiCyan"),brightCyan:ie("--vscode-terminal-ansiBrightCyan"),magenta:ie("--vscode-terminal-ansiMagenta"),brightMagenta:ie("--vscode-terminal-ansiBrightMagenta"),yellow:ie("--vscode-terminal-ansiYellow"),brightYellow:ie("--vscode-terminal-ansiBrightYellow"),white:ie("--vscode-terminal-ansiWhite"),brightWhite:ie("--vscode-terminal-ansiBrightWhite"),selectionBackground:ie("--vscode-editor-selectionBackground")}};/*!
 * xterm-addon-search-bar.js v0.2.0
 * (c) 2018-2020 yinshuxun
 * Released under the MIT License.
 */function vr(Se,$){$===void 0&&($={});var ie=$.insertAt;if(!(!Se||typeof document>"u")){var de=document.head||document.getElementsByTagName("head")[0],ve=document.createElement("style");ve.type="text/css",ie==="top"&&de.firstChild?de.insertBefore(ve,de.firstChild):de.appendChild(ve),ve.styleSheet?ve.styleSheet.cssText=Se:ve.appendChild(document.createTextNode(Se))}}var mr='.xterm-search-bar__addon{position:absolute;max-width:1467px;top:0;right:28px;color:#000;background:#fff;padding:5px 10px;box-shadow:0 2px 8px #000;background-color:#252526;z-index:999;display:flex}.xterm-search-bar__addon .search-bar__input{background-color:#3c3c3c;color:#ccc;border:0;padding:2px;height:20px;width:227px}.xterm-search-bar__addon .search-bar__btn{min-width:20px;width:20px;height:20px;display:flex;display:-webkit-flex;flex:initial;background-position:50%;margin-left:3px;background-repeat:no-repeat;background-color:#252526;border:0;cursor:pointer}.xterm-search-bar__addon .search-bar__btn:hover{background-color:#666}.xterm-search-bar__addon .search-bar__btn.prev{margin-left:20px;background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTUuNCA4YS42LjYgMCAwMS4xNzYtLjQyNGw0LTRhLjU5OC41OTggMCAwMS44NDggMCAuNTk4LjU5OCAwIDAxMCAuODQ4TDYuODQ5IDhsMy41NzUgMy41NzZhLjU5OC41OTggMCAwMTAgLjg0OC41OTguNTk4IDAgMDEtLjg0OCAwbC00LTRBLjYuNiAwIDAxNS40IDgiLz48L3N2Zz4=")}.xterm-search-bar__addon .search-bar__btn.next{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTEwLjYgOGEuNi42IDAgMDEtLjE3Ni40MjRsLTQgNGEuNTk4LjU5OCAwIDAxLS44NDggMCAuNTk4LjU5OCAwIDAxMC0uODQ4TDkuMTUxIDggNS41NzYgNC40MjRhLjU5OC41OTggMCAwMTAtLjg0OC41OTguNTk4IDAgMDEuODQ4IDBsNCA0QS42LjYgMCAwMTEwLjYgOCIvPjwvc3ZnPg==")}.xterm-search-bar__addon .search-bar__btn.close{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTcgNmwyLTJhLjcxMS43MTEgMCAwMDAtMSAuNzExLjcxMSAwIDAwLTEgMEw2IDUgNCAzYS43MTEuNzExIDAgMDAtMSAwIC43MTEuNzExIDAgMDAwIDFsMiAyLTIgMmEuNzExLjcxMSAwIDAwMCAxIC43MTEuNzExIDAgMDAxIDBsMi0yIDIgMmEuNzExLjcxMSAwIDAwMSAwIC43MTEuNzExIDAgMDAwLTFMNyA2eiIvPjwvc3ZnPg==")}';vr(mr);const qt="xterm-search-bar__addon";class Sr{constructor($){this.options=$||{},this.options&&this.options.searchAddon&&(this.searchAddon=this.options.searchAddon)}activate($){this.terminal=$,this.searchAddon||console.error("Cannot use search bar addon until search addon has been loaded!")}dispose(){this.hidden()}show(){if(!this.terminal||!this.terminal.element)return;if(this.searchBarElement){this.searchBarElement.style.visibility="visible",this.searchBarElement.querySelector("input").select();return}this.terminal.element.style.position="relative";const $=document.createElement("div");$.innerHTML=`
       <input type="text" class="search-bar__input" name="search-bar__input"/>
       <button class="search-bar__btn prev"></button>
       <button class="search-bar__btn next"></button>
       <button class="search-bar__btn close"></button>
    `,$.className=qt;const ie=this.terminal.element.parentElement;this.searchBarElement=$,["relative","absoulte","fixed"].includes(ie.style.position)||(ie.style.position="relative"),ie.appendChild(this.searchBarElement),this.on(".search-bar__btn.close","click",()=>{this.hidden()}),this.on(".search-bar__btn.next","click",()=>{this.searchAddon.findNext(this.searchKey,{incremental:!1})}),this.on(".search-bar__btn.prev","click",()=>{this.searchAddon.findPrevious(this.searchKey,{incremental:!1})}),this.on(".search-bar__input","keyup",de=>{this.searchKey=de.target.value,this.searchAddon.findNext(this.searchKey,{incremental:de.key!=="Enter"})}),this.searchBarElement.querySelector("input").select()}hidden(){this.searchBarElement&&this.terminal.element.parentElement&&(this.searchBarElement.style.visibility="hidden")}on($,ie,de){const ve=this.terminal.element.parentElement;ve.addEventListener(ie,ge=>{let K=ge.target;for(;K!==document.querySelector($);){if(K===ve){K=null;break}K=K.parentElement}K===document.querySelector($)&&(de.call(this,ge),ge.stopPropagation())})}addNewStyle($){let ie=document.getElementById(qt);ie||(ie=document.createElement("style"),ie.type="text/css",ie.id=qt,document.getElementsByTagName("head")[0].appendChild(ie)),ie.appendChild(document.createTextNode($))}}const yr={props:["theme"],data(){return{themeList:["Auto","Arthur","Dracula","OneDark","Ubuntu","Default"]}},methods:{send(Se){this.$emit("send",Se)},showProgres(){let Se="echo Top Memory Progress: && ps -eo pid,user,rss,pmem,pcpu,cputime,comm,cmd | ";Se+=`awk 'NR<2{print $0;next}{print $0| "sort -k 3 -nr"}' | head -16 | `,Se+="numfmt --header --to=iec --from-unit=1024 --field 3 | cut -c 1-130",this.send(Se)},changeTheme(Se){this.$emit("update:theme",Se)}}};var br=function(){var $=this,ie=$._self._c;return ie("div",{staticClass:"terminal-toolbar pl-3 gap-x-4 h-[25px] flex items-center"},[ie("div",{staticClass:"terminal-toolbar-selection"},[$._v(" Vim: "),ie("i",{staticClass:"el-icon-edit",attrs:{title:"Edit Profile"},on:{click:function(de){return $.send("vi /etc/profile")}}}),ie("i",{staticClass:"el-icon-wind-power",attrs:{title:"Show Line Number"},on:{click:function(de){return $.send(":set nu")}}}),ie("i",{staticClass:"el-icon-set-up",attrs:{title:"Format"},on:{click:function(de){return $.send("gg=G")}}}),ie("i",{staticClass:"el-icon-check",attrs:{title:"Save"},on:{click:function(de){return $.send(":wq")}}}),ie("i",{staticClass:"el-icon-close",attrs:{title:"Close"},on:{click:function(de){return $.send(":q!")}}})]),ie("div",{staticClass:"terminal-toolbar-selection"},[$._v(" "+$._s($.$t("ssh.util"))+": "),ie("i",{staticClass:"el-icon-coin",attrs:{title:"Disk Usage"},on:{click:function(de){return $.send("du -h -d 1| sort -h")}}}),ie("i",{staticClass:"el-icon-stopwatch",attrs:{title:"Listening Port"},on:{click:function(de){return $.send("netstat -anp|grep 'LISTEN\\b'|less")}}}),ie("i",{staticClass:"el-icon-data-line",attrs:{title:"List Progress"},on:{click:$.showProgres}}),ie("i",{staticClass:"el-icon-document-delete",attrs:{title:"Clear Screen"},on:{click:function(de){return $.send("clear")}}})]),ie("div",{staticClass:"terminal-toolbar-selection"},[$._v(" "+$._s($.$t("ssh.theme"))+": "),ie("vsc-radio-group",{staticClass:"inline-block",attrs:{value:$.theme,size:"mini"},on:{input:$.changeTheme}},$._l($.themeList,function(de,ve){return ie("vsc-radio-button",{key:ve,attrs:{label:de}})}),1)],1)])},Cr=[],wr=Vt(yr,br,Cr,!1,null,"e66ea9de",null,null);const xr=wr.exports;const Lr={mixins:[Ki],data(){return{live:!0,lastTime:null,receivedData:!1,option:{query:null,previousMinute:30}}},mounted(){this.on("query",Se=>{this.option.query||(this.option.query=Se)}).on("lastTime",({lastTime:Se,hasLog:$})=>{this.lastTime||setInterval(()=>{!this.live||!this.receivedData||(this.receivedData=!1,this.emit("getLogs",{live:!0,start:this.lastTime,hasLog:$,query:this.option.query}))},3e3),(!this.lastTime||$)&&(this.lastTime=Se),this.receivedData=!0})},methods:{loadLogs(){this.emit("getLogs",this.option)},openDocument(){this.emit("openDocument")}}};var Er=function(){var $=this,ie=$._self._c;return ie("div",{staticClass:"terminal-toolbar pl-3 gap-x-4 h-10 flex items-center"},[ie("vsc-input",{staticClass:"ml-1",staticStyle:{width:"300px"},attrs:{theme:"base","prefix-icon":"el-icon-search",size:"mini",placeholder:"Loki queries",clearable:!1},nativeOn:{keyup:function(de){return!de.type.indexOf("key")&&$._k(de.keyCode,"enter",13,de.key,"Enter")?null:$.loadLogs.apply(null,arguments)}},model:{value:$.option.query,callback:function(de){$.$set($.option,"query",de)},expression:"option.query"}}),ie("i",{staticClass:"el-icon-document",attrs:{title:"Document"},on:{click:$.openDocument}}),ie(sr,{staticStyle:{width:"130px"},attrs:{placeholder:"Forever",size:"small"},on:{change:$.loadLogs},model:{value:$.option.previousMinute,callback:function(de){$.$set($.option,"previousMinute",de)},expression:"option.previousMinute"}},[ie(ut,{attrs:{value:15,label:"Last 15 minutes"}}),ie(ut,{attrs:{value:30,label:"Last 30 minutes"}}),ie(ut,{attrs:{value:60,label:"Last 1 hours"}}),ie(ut,{attrs:{value:120,label:"Last 2 hours"}}),ie(ut,{attrs:{value:180,label:"Last 3 hours"}}),ie(ut,{attrs:{value:1440,label:"Last 24 hours"}}),ie(ut,{attrs:{value:2880,label:"Last 2 days"}}),ie(ut,{attrs:{value:10080,label:"Last 7 days"}})],1),ie("div",{staticClass:"inline-block ml-[-8px] mr-2"},[ie("label",{staticClass:"mr-2"},[$._v("Live")]),ie(ir,{model:{value:$.live,callback:function(de){$.live=de},expression:"live"}})],1),ie("i",{staticClass:"el-icon-refresh-left icon",staticStyle:{"margin-left":"-10px"},attrs:{title:"Refresh"},on:{click:$.loadLogs}})],1)},kr=[],Rr=Vt(Lr,Er,kr,!1,null,"7afb1dba",null,null);const Tr=Rr.exports;const Dr={components:{SSHToolbar:xr,LokiToolbar:Tr},mixins:[Ki],data(){return{theme:"vscode",dbType:null,terminal:null,isSSH:!1,remainHeight:756,listenThemeChange:!0}},watch:{theme(Se){this.terminal.options.theme=jt(Se),this.emit("updateOption",{key:"terminalTheme",value:Se})}},mounted(){this.calcHeight(),this.on("terminalConfig",({fontSize:Se,fontFamily:$,theme:ie,dbType:de})=>{this.dbType=de;let ve=!1;ie&&(this.theme=ie);const ge=new nr.Terminal({theme:jt(this.theme),cursorStyle:"bar",cursorBlink:!0,allowProposedApi:!0,fontSize:Se,fontFamily:$,disableStdin:!1,lineHeight:1.1,cursorBlink:!0,scrollback:1e6,tabStopWidth:8,bellStyle:"sound"});this.terminal=ge;const K=new ar.FitAddon;new ResizeObserver(()=>this.calcHeight(K)).observe(this.$refs.box);const c=new ur.SearchAddon,w=new Sr({searchAddon:c});ge.attachCustomKeyEventHandler(b=>{if(b.code=="Escape"&&w.hidden(),b.shiftKey&&b.code=="Insert")return!1;const v=qi(b)&&!b.altKey&&!b.shiftKey,a=!v&&!b.shiftKey&&b.altKey;if(v){const h=b.code;if(h=="KeyC"&&ge.hasSelection())return document.execCommand("copy"),!1;if(h=="KeyV")return!1;if(h=="KeyF")return w.show(),!1;if(["PageDown","PageUp"].includes(h))return!1}else a&&this.dbType=="SSH"&&code=="KeyV"&&this.emit("data",[22]);const i=new b.constructor(b.type,b);return document.body.dispatchEvent(i),!0});const m=document.getElementById("terminal-container");ge.open(m),ge.loadAddon(K),ge.loadAddon(c),ge.loadAddon(w),ge.loadAddon(new or.CanvasAddon),ge.loadAddon(new cr.LigaturesAddon);let g;ge.loadAddon(new dr.WebLinksAddon((b,v)=>{if(!qi(b)){const a=g;if(g=new Date().getTime(),!a||g-a>200)return}this.emit("openLink",v)})),K.fit(),ge.focus(),ge.onData(b=>{this.emit("data",b)});const d=()=>{this.calcHeight(),this.$nextTick(()=>{K.fit(),this.emit("resize",{cols:ge.cols,rows:ge.rows})})};window.addEventListener("resize",d,!1),window.onfocus=()=>{ge.focus()},document.querySelector("#terminal-container").oncontextmenu=async b=>{if(b.stopPropagation(),ge.hasSelection())document.execCommand("copy"),ge.clearSelection();else{const v=await navigator.clipboard.readText();this.emit("data",v.replace(/\r\n/g,"\r"))}};let u=!1;this.on("connecting",b=>{ge.write(b),ge.write("\x1B[2K\r")}).on("data",b=>{u||(ge.clear(),u=!0),ge.write(b)}).on("init-terminal",b=>{this.isSSH=!0,d()}).on("error",b=>{ve||(ve=!0,ge.write(b))}).on("theme",()=>{this.theme=="Auto"&&(ge.options.theme=jt(this.theme))}),this.emit("initTerminal",{cols:ge.cols,rows:ge.rows})}).init()},methods:{calcHeight(Se){let $=8;this.isSSH&&($+=20),this.dbType==rr.LOKI&&($+=35),this.remainHeight=window.innerHeight-$,Se&&this.$nextTick(()=>{Se.fit()})},send(Se){this.emit("data",""),setTimeout(()=>{var $;this.emit("data",`${Se}
\r`),($=this.terminal)==null||$.focus()},100)}}};var Mr=function(){var $=this,ie=$._self._c;return ie("div",{ref:"box",staticClass:"box"},[$.isSSH?ie("SSHToolbar",{attrs:{theme:$.theme},on:{"update:theme":function(de){$.theme=de},send:$.send}}):$._e(),$.dbType=="Loki"?ie("LokiToolbar",{on:{send:$.send}}):$._e(),ie("div",{style:{height:$.remainHeight+"px"},attrs:{id:"terminal-container"}})],1)},Ar=[],Br=Vt(Dr,Mr,Ar,!1,null,"4e380604",null,null);const Wr=Br.exports;export{Wr as default};
